<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff application/org.openjdk.jmc.flightrecorder.ui/src/main/java/org/openjdk/jmc/flightrecorder/ui/common/ItemHistogram.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../../../../l10n/org.openjdk.jmc.flightrecorder.ui.zh_CN/src/main/resources/org/openjdk/jmc/flightrecorder/ui/messages/internal/messages_zh_CN.properties.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="../messages/internal/Messages.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>application/org.openjdk.jmc.flightrecorder.ui/src/main/java/org/openjdk/jmc/flightrecorder/ui/common/ItemHistogram.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
113 		}
114 
115 	}
116 
117 	public static class ItemHistogramBuilder {
118 
119 		private final AggregationGrid grid = new AggregationGrid();
120 		private final List&lt;IColumn&gt; columns = new ArrayList&lt;&gt;();
121 
122 		public void addCountColumn() {
123 			columns.add(new ColumnBuilder(Messages.COUNT_COLUMN_NAME, COUNT_COL_ID, AggregationGrid::getCount)
124 					.columnDrawer(COUNT_DRAWER).style(SWT.RIGHT).build());
125 		}
126 
127 		public void addColumn(String colId, IAggregator&lt;?, ?&gt; a) {
128 			int style = a.getValueType() instanceof LinearKindOfQuantity ? SWT.RIGHT : SWT.NONE;
129 			addColumn(colId, ic -&gt; ic.getAggregate(a), a.getName(), a.getDescription(), style);
130 		}
131 
132 		public void addPercentageColumn(String colId, IAggregator&lt;?, ?&gt; a) {




133 			int style = a.getValueType() instanceof LinearKindOfQuantity ? SWT.RIGHT : SWT.NONE;
134 			addPercentageColumn(colId, (rowItems, allItems) -&gt; {
135 				if (a.getValueType() instanceof LinearKindOfQuantity) {
136 					IQuantity rowResult = (IQuantity) rowItems.getAggregate(a);
137 					IQuantity allResult = (IQuantity) allItems.getAggregate(a);
138 					if (rowResult != null &amp;&amp; allResult != null) {
139 						return UnitLookup.PERCENT.quantity(rowResult.ratioTo(allResult) * 100);
140 					}
141 				}
142 				return rowItems.getAggregate(a);
<span class="line-modified">143 			}, a.getName(), a.getDescription(), style);</span>
144 		}
145 
146 		public void addColumn(
147 			String colId, Function&lt;IItemCollection, ?&gt; valueFunction, String name, String description) {
148 			addColumn(colId, valueFunction, name, description, SWT.NONE);
149 		}
150 
151 		public void addColumn(
152 			String colId, Function&lt;IItemCollection, ?&gt; valueFunction, String name, String description, int style) {
153 			columns.add(new ColumnBuilder(name, colId, grid.addColumn(valueFunction)).description(description)
154 					.style(style).build());
155 		}
156 
157 		public void addPercentageColumn(
158 			String colId, BiFunction&lt;IItemCollection, IItemCollection, ?&gt; valueFunction, String name,
159 			String description, int style) {
160 			columns.add(new ColumnBuilder(name, colId, grid.addPercentageColumn(valueFunction)).description(description)
161 					.style(style).build());
162 		}
163 
</pre>
</td>
<td>
<hr />
<pre>
113 		}
114 
115 	}
116 
117 	public static class ItemHistogramBuilder {
118 
119 		private final AggregationGrid grid = new AggregationGrid();
120 		private final List&lt;IColumn&gt; columns = new ArrayList&lt;&gt;();
121 
122 		public void addCountColumn() {
123 			columns.add(new ColumnBuilder(Messages.COUNT_COLUMN_NAME, COUNT_COL_ID, AggregationGrid::getCount)
124 					.columnDrawer(COUNT_DRAWER).style(SWT.RIGHT).build());
125 		}
126 
127 		public void addColumn(String colId, IAggregator&lt;?, ?&gt; a) {
128 			int style = a.getValueType() instanceof LinearKindOfQuantity ? SWT.RIGHT : SWT.NONE;
129 			addColumn(colId, ic -&gt; ic.getAggregate(a), a.getName(), a.getDescription(), style);
130 		}
131 
132 		public void addPercentageColumn(String colId, IAggregator&lt;?, ?&gt; a) {
<span class="line-added">133 			addPercentageColumn(colId, a, a.getName(), a.getDescription());</span>
<span class="line-added">134 		}</span>
<span class="line-added">135 </span>
<span class="line-added">136 		public void addPercentageColumn(String colId, IAggregator&lt;?, ?&gt; a, String name, String description) {</span>
137 			int style = a.getValueType() instanceof LinearKindOfQuantity ? SWT.RIGHT : SWT.NONE;
138 			addPercentageColumn(colId, (rowItems, allItems) -&gt; {
139 				if (a.getValueType() instanceof LinearKindOfQuantity) {
140 					IQuantity rowResult = (IQuantity) rowItems.getAggregate(a);
141 					IQuantity allResult = (IQuantity) allItems.getAggregate(a);
142 					if (rowResult != null &amp;&amp; allResult != null) {
143 						return UnitLookup.PERCENT.quantity(rowResult.ratioTo(allResult) * 100);
144 					}
145 				}
146 				return rowItems.getAggregate(a);
<span class="line-modified">147 			}, name, description, style);</span>
148 		}
149 
150 		public void addColumn(
151 			String colId, Function&lt;IItemCollection, ?&gt; valueFunction, String name, String description) {
152 			addColumn(colId, valueFunction, name, description, SWT.NONE);
153 		}
154 
155 		public void addColumn(
156 			String colId, Function&lt;IItemCollection, ?&gt; valueFunction, String name, String description, int style) {
157 			columns.add(new ColumnBuilder(name, colId, grid.addColumn(valueFunction)).description(description)
158 					.style(style).build());
159 		}
160 
161 		public void addPercentageColumn(
162 			String colId, BiFunction&lt;IItemCollection, IItemCollection, ?&gt; valueFunction, String name,
163 			String description, int style) {
164 			columns.add(new ColumnBuilder(name, colId, grid.addPercentageColumn(valueFunction)).description(description)
165 					.style(style).build());
166 		}
167 
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../../../../l10n/org.openjdk.jmc.flightrecorder.ui.zh_CN/src/main/resources/org/openjdk/jmc/flightrecorder/ui/messages/internal/messages_zh_CN.properties.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="../messages/internal/Messages.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>