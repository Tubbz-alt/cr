<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff application/tests/org.openjdk.jmc.greychart.test/src/test/java/org/openjdk/jmc/greychart/impl/SampleBufferTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../../pom.xml.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../../org.openjdk.jmc.ide.launch.test/pom.xml.sdiff.html" target="_top">next &gt;</a></center>    <h2>application/tests/org.openjdk.jmc.greychart.test/src/test/java/org/openjdk/jmc/greychart/impl/SampleBufferTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 69 		Assert.assertEquals(2, countValids(buffer));
 70 		Assert.assertEquals(45, Math.round(buffer.getSamples()[0].y));
 71 		Assert.assertEquals(75, Math.round(buffer.getSamples()[1].y));
 72 	}
 73 
 74 	/*
 75 	 * Two values in different buckets not next to each other.
 76 	 * 
 77 	 * Previously this test assumed that intermediary points would be interpolated. That does not
 78 	 * seem to be required anymore by the consumers of the API.
 79 	 */
 80 	@Test
 81 	public void testTwoBorderCrossings() {
 82 		AveragingSampleBuffer buffer = new AveragingSampleBuffer(3);
 83 		buffer.addDataPoint(1.0 / 6.0, 40);
 84 		buffer.addDataPoint(5.0 / 6.0, 80);
 85 		buffer.fixSamples();
 86 		Assert.assertEquals(2, countValids(buffer));
 87 		Assert.assertEquals(42.5, buffer.getSamples()[0].y, 0);
 88 		double dy = buffer.getSamples()[2].y - buffer.getSamples()[0].y;
<span class="line-modified"> 89 		int dx =  buffer.getSamples()[2].x - buffer.getSamples()[0].x;</span>
 90 		double midY = ((dy / dx) * (dx / 2)) + buffer.getSamples()[0].y;
 91 		Assert.assertEquals(60, Math.round(midY), 0);
 92 		Assert.assertEquals(77.5, buffer.getSamples()[2].y, 0);
 93 	}
 94 
 95 	@Test
 96 	public void testBorderCases1() {
 97 		AveragingSampleBuffer buffer = new AveragingSampleBuffer(4);
 98 		buffer.addDataPoint(0, 50);
 99 		buffer.addDataPoint(1.5 / 4, 80);
100 		buffer.fixSamples();
101 		Assert.assertEquals(2, countValids(buffer));
102 		Assert.assertEquals(60.0, buffer.getSamples()[0].y, 0);
103 		Assert.assertEquals(77.5, buffer.getSamples()[1].y, 0);
104 	}
105 
106 	@Test
107 	public void testBorderCases3() {
108 		AveragingSampleBuffer buffer = new AveragingSampleBuffer(4);
109 		buffer.addDataPoint(2.5 / 4, 80);
</pre>
</td>
<td>
<hr />
<pre>
 69 		Assert.assertEquals(2, countValids(buffer));
 70 		Assert.assertEquals(45, Math.round(buffer.getSamples()[0].y));
 71 		Assert.assertEquals(75, Math.round(buffer.getSamples()[1].y));
 72 	}
 73 
 74 	/*
 75 	 * Two values in different buckets not next to each other.
 76 	 * 
 77 	 * Previously this test assumed that intermediary points would be interpolated. That does not
 78 	 * seem to be required anymore by the consumers of the API.
 79 	 */
 80 	@Test
 81 	public void testTwoBorderCrossings() {
 82 		AveragingSampleBuffer buffer = new AveragingSampleBuffer(3);
 83 		buffer.addDataPoint(1.0 / 6.0, 40);
 84 		buffer.addDataPoint(5.0 / 6.0, 80);
 85 		buffer.fixSamples();
 86 		Assert.assertEquals(2, countValids(buffer));
 87 		Assert.assertEquals(42.5, buffer.getSamples()[0].y, 0);
 88 		double dy = buffer.getSamples()[2].y - buffer.getSamples()[0].y;
<span class="line-modified"> 89 		int dx = buffer.getSamples()[2].x - buffer.getSamples()[0].x;</span>
 90 		double midY = ((dy / dx) * (dx / 2)) + buffer.getSamples()[0].y;
 91 		Assert.assertEquals(60, Math.round(midY), 0);
 92 		Assert.assertEquals(77.5, buffer.getSamples()[2].y, 0);
 93 	}
 94 
 95 	@Test
 96 	public void testBorderCases1() {
 97 		AveragingSampleBuffer buffer = new AveragingSampleBuffer(4);
 98 		buffer.addDataPoint(0, 50);
 99 		buffer.addDataPoint(1.5 / 4, 80);
100 		buffer.fixSamples();
101 		Assert.assertEquals(2, countValids(buffer));
102 		Assert.assertEquals(60.0, buffer.getSamples()[0].y, 0);
103 		Assert.assertEquals(77.5, buffer.getSamples()[1].y, 0);
104 	}
105 
106 	@Test
107 	public void testBorderCases3() {
108 		AveragingSampleBuffer buffer = new AveragingSampleBuffer(4);
109 		buffer.addDataPoint(2.5 / 4, 80);
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../../pom.xml.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../../org.openjdk.jmc.ide.launch.test/pom.xml.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>