<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff application/org.openjdk.jmc.joverflow/src/main/java/org/openjdk/jmc/joverflow/descriptors/ConcurrentHashMapDescriptorForJdk8.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../batch/ReferencedObjCluster.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../heap/model/JavaClass.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>application/org.openjdk.jmc.joverflow/src/main/java/org/openjdk/jmc/joverflow/descriptors/ConcurrentHashMapDescriptorForJdk8.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
161 	public void iterateMap(MapIteratorCallback cb) {
162 		int[] index = {factory.tableFieldIdx, factory.nextTableFieldIdx};
163 		for (int i = 0; i &lt; 2; i++) {
164 			JavaThing tableThing = fields[index[i]];
165 			JavaObjectArray table;
166 			if (tableThing != null &amp;&amp; tableThing instanceof JavaObjectArray) {
167 				table = (JavaObjectArray) tableThing;
168 				if (cb.scanImplementationObject(table)) {
169 					JavaHeapObject[] tableElems = table.getElements();
170 					int numElements = getNumElements();
171 					if (numElements != 0) {
172 						iterateOneTable(tableElems, cb);
173 					}
174 				}
175 			}
176 		}
177 	}
178 
179 	/**
180 	 * Overrides superclass method. Get the capacity of each of the two tables inside the
<span class="line-modified">181 	 * ConcurrentHashMap and add them. This might not be revised in the future, according to</span>
<span class="line-modified">182 	 * how the ConcurrentHashMap works</span>
183 	 */
184 	@Override
185 	public int getCapacity() {
186 		if (cachedTotalCapacity != -1) {
187 			return cachedTotalCapacity;
188 		}
189 
190 		int totalCapacity = 0;
191 		int[] index = {factory.tableFieldIdx, factory.nextTableFieldIdx};
192 		for (int i = 0; i &lt; 2; i++) {
193 			JavaThing tableThing = fields[index[i]];
194 			if (tableThing != null &amp;&amp; tableThing instanceof JavaObjectArray) {
195 				JavaObjectArray table = (JavaObjectArray) tableThing;
196 				totalCapacity += table.getLength();
197 			}
198 		}
199 
200 		cachedTotalCapacity = totalCapacity;
201 		return totalCapacity;
202 	}
</pre>
</td>
<td>
<hr />
<pre>
161 	public void iterateMap(MapIteratorCallback cb) {
162 		int[] index = {factory.tableFieldIdx, factory.nextTableFieldIdx};
163 		for (int i = 0; i &lt; 2; i++) {
164 			JavaThing tableThing = fields[index[i]];
165 			JavaObjectArray table;
166 			if (tableThing != null &amp;&amp; tableThing instanceof JavaObjectArray) {
167 				table = (JavaObjectArray) tableThing;
168 				if (cb.scanImplementationObject(table)) {
169 					JavaHeapObject[] tableElems = table.getElements();
170 					int numElements = getNumElements();
171 					if (numElements != 0) {
172 						iterateOneTable(tableElems, cb);
173 					}
174 				}
175 			}
176 		}
177 	}
178 
179 	/**
180 	 * Overrides superclass method. Get the capacity of each of the two tables inside the
<span class="line-modified">181 	 * ConcurrentHashMap and add them. This might not be revised in the future, according to how the</span>
<span class="line-modified">182 	 * ConcurrentHashMap works</span>
183 	 */
184 	@Override
185 	public int getCapacity() {
186 		if (cachedTotalCapacity != -1) {
187 			return cachedTotalCapacity;
188 		}
189 
190 		int totalCapacity = 0;
191 		int[] index = {factory.tableFieldIdx, factory.nextTableFieldIdx};
192 		for (int i = 0; i &lt; 2; i++) {
193 			JavaThing tableThing = fields[index[i]];
194 			if (tableThing != null &amp;&amp; tableThing instanceof JavaObjectArray) {
195 				JavaObjectArray table = (JavaObjectArray) tableThing;
196 				totalCapacity += table.getLength();
197 			}
198 		}
199 
200 		cachedTotalCapacity = totalCapacity;
201 		return totalCapacity;
202 	}
</pre>
</td>
</tr>
</table>
<center><a href="../batch/ReferencedObjCluster.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../heap/model/JavaClass.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>