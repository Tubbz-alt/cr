<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff application/org.openjdk.jmc.flightrecorder.ui/src/main/java/org/openjdk/jmc/flightrecorder/ui/views/stacktrace/StacktraceView.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>application/org.openjdk.jmc.flightrecorder.ui/src/main/java/org/openjdk/jmc/flightrecorder/ui/views/stacktrace/StacktraceView.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
718 				event.gc.setBackground(SIBLINGS_COUNT_COLOR);
719 				event.gc.fillRectangle(event.x + siblingsStart, event.y, siblingsWidth, event.height);
720 				// Draw group
721 				double offset = (forkOffset + frame.getBranch().getItemOffsetInFork()) / total;
722 				double fraction = frame.getItemCount() / total;
723 				event.gc.setBackground(COUNT_COLOR);
724 				int startPixel = (int) Math.floor(event.width * offset);
725 				int widthPixel = (int) Math.round(event.width * fraction);
726 				event.gc.fillRectangle(event.x + startPixel, event.y, Math.max(widthPixel, 1), event.height);
727 				event.detail &amp;= ~SWT.BACKGROUND;
728 			}
729 		}
730 	};
731 
732 	private final ColumnLabelProvider percentageLabelProvider = new ColumnLabelProvider() {
733 		@Override
734 		public String getText(Object element) {
735 			StacktraceFrame frame = (StacktraceFrame) element;
736 			int itemCount = frame.getItemCount();
737 			int totalCount = getRootFork(frame.getBranch().getParentFork()).getItemsInFork();
<span class="line-modified">738 			return String.format(&quot;%.2f%%&quot;, (itemCount / (float) totalCount) * 100F);</span>
739 		}
740 
741 		@Override
742 		public String getToolTipText(Object element) {
743 			StacktraceFrame frame = (StacktraceFrame) element;
744 			Fork rootFork = getRootFork(frame.getBranch().getParentFork());
745 			int itemCount = frame.getItemCount();
746 			int totalCount = rootFork.getItemsInFork();
747 			Fork parentFork = frame.getBranch().getParentFork();
748 			int itemsInSiblings = parentFork.getItemsInFork() - frame.getBranch().getFirstFrame().getItemCount();
749 			String frameFraction = UnitLookup.PERCENT_UNITY.quantity(itemCount / (double) totalCount)
750 					.displayUsing(IDisplayable.AUTO);
751 			StringBuilder sb = new StringBuilder(&quot;&lt;form&gt;&quot;); //$NON-NLS-1$
752 			sb.append(&quot;&lt;li style=&#39;image&#39; value=&#39;&quot; + COUNT_IMG_KEY + &quot;&#39;&gt;&quot;); //$NON-NLS-1$ //$NON-NLS-2$
753 			sb.append(Messages.stackTraceMessage(itemCount, totalCount, frameFraction));
754 			sb.append(&quot;&lt;/li&gt;&quot;); //$NON-NLS-1$
755 			sb.append(&quot;&lt;li style=&#39;image&#39; value=&#39;&quot; + SIBLINGS_IMG_KEY + &quot;&#39;&gt;&quot;); //$NON-NLS-1$ //$NON-NLS-2$
756 			sb.append(Messages.siblingMessage(itemsInSiblings, parentFork.getBranchCount() - 1));
757 			sb.append(&quot;&lt;/li&gt;&quot;); //$NON-NLS-1$
758 			sb.append(&quot;&lt;/form&gt;&quot;); //$NON-NLS-1$
</pre>
</td>
<td>
<hr />
<pre>
718 				event.gc.setBackground(SIBLINGS_COUNT_COLOR);
719 				event.gc.fillRectangle(event.x + siblingsStart, event.y, siblingsWidth, event.height);
720 				// Draw group
721 				double offset = (forkOffset + frame.getBranch().getItemOffsetInFork()) / total;
722 				double fraction = frame.getItemCount() / total;
723 				event.gc.setBackground(COUNT_COLOR);
724 				int startPixel = (int) Math.floor(event.width * offset);
725 				int widthPixel = (int) Math.round(event.width * fraction);
726 				event.gc.fillRectangle(event.x + startPixel, event.y, Math.max(widthPixel, 1), event.height);
727 				event.detail &amp;= ~SWT.BACKGROUND;
728 			}
729 		}
730 	};
731 
732 	private final ColumnLabelProvider percentageLabelProvider = new ColumnLabelProvider() {
733 		@Override
734 		public String getText(Object element) {
735 			StacktraceFrame frame = (StacktraceFrame) element;
736 			int itemCount = frame.getItemCount();
737 			int totalCount = getRootFork(frame.getBranch().getParentFork()).getItemsInFork();
<span class="line-modified">738 			return UnitLookup.PERCENT_UNITY.quantity(itemCount / (double) totalCount).displayUsing(IDisplayable.AUTO);</span>
739 		}
740 
741 		@Override
742 		public String getToolTipText(Object element) {
743 			StacktraceFrame frame = (StacktraceFrame) element;
744 			Fork rootFork = getRootFork(frame.getBranch().getParentFork());
745 			int itemCount = frame.getItemCount();
746 			int totalCount = rootFork.getItemsInFork();
747 			Fork parentFork = frame.getBranch().getParentFork();
748 			int itemsInSiblings = parentFork.getItemsInFork() - frame.getBranch().getFirstFrame().getItemCount();
749 			String frameFraction = UnitLookup.PERCENT_UNITY.quantity(itemCount / (double) totalCount)
750 					.displayUsing(IDisplayable.AUTO);
751 			StringBuilder sb = new StringBuilder(&quot;&lt;form&gt;&quot;); //$NON-NLS-1$
752 			sb.append(&quot;&lt;li style=&#39;image&#39; value=&#39;&quot; + COUNT_IMG_KEY + &quot;&#39;&gt;&quot;); //$NON-NLS-1$ //$NON-NLS-2$
753 			sb.append(Messages.stackTraceMessage(itemCount, totalCount, frameFraction));
754 			sb.append(&quot;&lt;/li&gt;&quot;); //$NON-NLS-1$
755 			sb.append(&quot;&lt;li style=&#39;image&#39; value=&#39;&quot; + SIBLINGS_IMG_KEY + &quot;&#39;&gt;&quot;); //$NON-NLS-1$ //$NON-NLS-2$
756 			sb.append(Messages.siblingMessage(itemsInSiblings, parentFork.getBranchCount() - 1));
757 			sb.append(&quot;&lt;/li&gt;&quot;); //$NON-NLS-1$
758 			sb.append(&quot;&lt;/form&gt;&quot;); //$NON-NLS-1$
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>