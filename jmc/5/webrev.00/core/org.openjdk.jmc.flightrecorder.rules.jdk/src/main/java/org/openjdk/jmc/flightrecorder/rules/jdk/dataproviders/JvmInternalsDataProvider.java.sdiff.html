<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff core/org.openjdk.jmc.flightrecorder.rules.jdk/src/main/java/org/openjdk/jmc/flightrecorder/rules/jdk/dataproviders/JvmInternalsDataProvider.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../cpu/CompareCpuRule.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../exceptions/FatalErrorRule.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>core/org.openjdk.jmc.flightrecorder.rules.jdk/src/main/java/org/openjdk/jmc/flightrecorder/rules/jdk/dataproviders/JvmInternalsDataProvider.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 40 /**
 41  * Helper class used to share analysis of JVM related information, such as flags.
 42  */
 43 @SuppressWarnings(&quot;nls&quot;)
 44 public class JvmInternalsDataProvider {
 45 
 46 	private static final String[] PREFIXES = new String[] {&quot;-Xmx&quot;, &quot;-Xms&quot;, &quot;-Xmn&quot;, &quot;-Xss&quot;, &quot;-Xmaxjitcodesize&quot;};
 47 	/**
 48 	 * Flags that are OK to use multiple times if different values are provided. Check for
 49 	 * duplicates using the full argument.
 50 	 */
 51 	private static final String[] VERBATIM = new String[] {&quot;-verbose&quot;, &quot;--add-exports&quot;, &quot;--add-opens&quot;};
 52 	/**
 53 	 * Flags that are OK to use multiple times if different values are provided. Check for
 54 	 * duplicates using flag name without options (i.e. for &#39;-javaagent:c:/myjar.jar=option1&#39;,
 55 	 * comparison is done with &#39;c:/myjar.jar&#39;).
 56 	 */
 57 	private static final String[] OPTIONS = new String[] {&quot;-XX&quot;, &quot;-javaagent&quot;, &quot;-agent&quot;};
 58 	private static final Map&lt;String, String&gt; EQUIVALENT = new HashMap&lt;&gt;();
 59 
<span class="line-removed"> 60 </span>
 61 	static {
 62 		putBiMap(&quot;-Xbatch&quot;, &quot;BackgroundCompilation&quot;);
 63 		putBiMap(&quot;-Xmaxjitcodesize&quot;, &quot;ReservedCodeCacheSize&quot;);
 64 		putBiMap(&quot;-Xmx&quot;, &quot;MaxHeapSize&quot;);
 65 		putBiMap(&quot;-Xmn&quot;, &quot;NewSize&quot;);
 66 		putBiMap(&quot;-Xss&quot;, &quot;ThreadStackSize&quot;);
 67 		putBiMap(&quot;-Xusealtsigs&quot;, &quot;UseAltSigs&quot;);
 68 		putBiMap(&quot;-cp&quot;, &quot;classpath&quot;);
 69 		putBiMap(&quot;-esa&quot;, &quot;enablesystemassertions&quot;);
 70 		putBiMap(&quot;-dsa&quot;, &quot;disablesystemassertions&quot;);
 71 		putBiMap(&quot;-Xconcgc&quot;, &quot;UseConcMarkSweepGC&quot;);
 72 		putBiMap(&quot;-Xnoconcgc&quot;, &quot;UseConcMarkSweepGC&quot;);
 73 		putBiMap(&quot;-Xnoclassgc&quot;, &quot;ClassUnloading&quot;);
 74 		putBiMap(&quot;-Xminf&quot;, &quot;MinHeapFreeRatio&quot;);
 75 		putBiMap(&quot;-Xmaxf&quot;, &quot;MaxHeapFreeRatio&quot;);
 76 		putBiMap(&quot;-Xrs&quot;, &quot;ReduceSignalUsage&quot;);
 77 		putBiMap(&quot;-Dcom.sun.management&quot;, &quot;ManagementServer&quot;);
 78 		putBiMap(&quot;-Xshare:dump&quot;, &quot;DumpSharedSpaces&quot;);
 79 		putBiMap(&quot;-Xboundthreads&quot;, &quot;UseBoundThreads&quot;);
 80 		putBiMap(&quot;AlwaysTenure&quot;, &quot;NeverTenure&quot;);
</pre>
<hr />
<pre>
138 						}
139 						break;
140 					}
141 				}
142 				for (int i = 0; i &lt; PREFIXES.length; i++) {
143 					flag = scrubPrefix(flag, PREFIXES[i]);
144 				}
145 				String equivalentArgument = EQUIVALENT.get(flag);
146 				if (equivalentArgument != null &amp;&amp; !seenFlags.containsKey(flag)
147 						&amp;&amp; seenFlags.containsKey(equivalentArgument)) {
148 					flag = equivalentArgument;
149 				}
150 			}
151 			if (seenFlags.containsKey(flag)) {
152 				if (!dupes.containsKey(flag)) {
153 					dupes.put(flag, new ArrayList&lt;String&gt;());
154 					dupes.get(flag).add(seenFlags.get(flag));
155 				}
156 				dupes.get(flag).add(fullArgument);
157 
<span class="line-modified">158 			}</span>
<span class="line-removed">159 			else {</span>
160 				seenFlags.put(flag, fullArgument);
<span class="line-modified">161 			}		</span>
162 		}
163 		return dupes.values();
164 	}
165 
166 	private static String scrubPrefix(String argument, String prefix) {
167 		return argument.startsWith(prefix) ? prefix : argument;
168 	}
169 
170 }
</pre>
</td>
<td>
<hr />
<pre>
 40 /**
 41  * Helper class used to share analysis of JVM related information, such as flags.
 42  */
 43 @SuppressWarnings(&quot;nls&quot;)
 44 public class JvmInternalsDataProvider {
 45 
 46 	private static final String[] PREFIXES = new String[] {&quot;-Xmx&quot;, &quot;-Xms&quot;, &quot;-Xmn&quot;, &quot;-Xss&quot;, &quot;-Xmaxjitcodesize&quot;};
 47 	/**
 48 	 * Flags that are OK to use multiple times if different values are provided. Check for
 49 	 * duplicates using the full argument.
 50 	 */
 51 	private static final String[] VERBATIM = new String[] {&quot;-verbose&quot;, &quot;--add-exports&quot;, &quot;--add-opens&quot;};
 52 	/**
 53 	 * Flags that are OK to use multiple times if different values are provided. Check for
 54 	 * duplicates using flag name without options (i.e. for &#39;-javaagent:c:/myjar.jar=option1&#39;,
 55 	 * comparison is done with &#39;c:/myjar.jar&#39;).
 56 	 */
 57 	private static final String[] OPTIONS = new String[] {&quot;-XX&quot;, &quot;-javaagent&quot;, &quot;-agent&quot;};
 58 	private static final Map&lt;String, String&gt; EQUIVALENT = new HashMap&lt;&gt;();
 59 

 60 	static {
 61 		putBiMap(&quot;-Xbatch&quot;, &quot;BackgroundCompilation&quot;);
 62 		putBiMap(&quot;-Xmaxjitcodesize&quot;, &quot;ReservedCodeCacheSize&quot;);
 63 		putBiMap(&quot;-Xmx&quot;, &quot;MaxHeapSize&quot;);
 64 		putBiMap(&quot;-Xmn&quot;, &quot;NewSize&quot;);
 65 		putBiMap(&quot;-Xss&quot;, &quot;ThreadStackSize&quot;);
 66 		putBiMap(&quot;-Xusealtsigs&quot;, &quot;UseAltSigs&quot;);
 67 		putBiMap(&quot;-cp&quot;, &quot;classpath&quot;);
 68 		putBiMap(&quot;-esa&quot;, &quot;enablesystemassertions&quot;);
 69 		putBiMap(&quot;-dsa&quot;, &quot;disablesystemassertions&quot;);
 70 		putBiMap(&quot;-Xconcgc&quot;, &quot;UseConcMarkSweepGC&quot;);
 71 		putBiMap(&quot;-Xnoconcgc&quot;, &quot;UseConcMarkSweepGC&quot;);
 72 		putBiMap(&quot;-Xnoclassgc&quot;, &quot;ClassUnloading&quot;);
 73 		putBiMap(&quot;-Xminf&quot;, &quot;MinHeapFreeRatio&quot;);
 74 		putBiMap(&quot;-Xmaxf&quot;, &quot;MaxHeapFreeRatio&quot;);
 75 		putBiMap(&quot;-Xrs&quot;, &quot;ReduceSignalUsage&quot;);
 76 		putBiMap(&quot;-Dcom.sun.management&quot;, &quot;ManagementServer&quot;);
 77 		putBiMap(&quot;-Xshare:dump&quot;, &quot;DumpSharedSpaces&quot;);
 78 		putBiMap(&quot;-Xboundthreads&quot;, &quot;UseBoundThreads&quot;);
 79 		putBiMap(&quot;AlwaysTenure&quot;, &quot;NeverTenure&quot;);
</pre>
<hr />
<pre>
137 						}
138 						break;
139 					}
140 				}
141 				for (int i = 0; i &lt; PREFIXES.length; i++) {
142 					flag = scrubPrefix(flag, PREFIXES[i]);
143 				}
144 				String equivalentArgument = EQUIVALENT.get(flag);
145 				if (equivalentArgument != null &amp;&amp; !seenFlags.containsKey(flag)
146 						&amp;&amp; seenFlags.containsKey(equivalentArgument)) {
147 					flag = equivalentArgument;
148 				}
149 			}
150 			if (seenFlags.containsKey(flag)) {
151 				if (!dupes.containsKey(flag)) {
152 					dupes.put(flag, new ArrayList&lt;String&gt;());
153 					dupes.get(flag).add(seenFlags.get(flag));
154 				}
155 				dupes.get(flag).add(fullArgument);
156 
<span class="line-modified">157 			} else {</span>

158 				seenFlags.put(flag, fullArgument);
<span class="line-modified">159 			}</span>
160 		}
161 		return dupes.values();
162 	}
163 
164 	private static String scrubPrefix(String argument, String prefix) {
165 		return argument.startsWith(prefix) ? prefix : argument;
166 	}
167 
168 }
</pre>
</td>
</tr>
</table>
<center><a href="../cpu/CompareCpuRule.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../exceptions/FatalErrorRule.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>