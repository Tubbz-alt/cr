<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff core/tests/org.openjdk.jmc.flightrecorder.rules.jdk.test/src/test/java/org/openjdk/jmc/flightrecorder/test/rules/jdk/TestRulesWithJfr.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../../../../../../org.openjdk.jmc.flightrecorder/src/main/java/org/openjdk/jmc/flightrecorder/internal/EventAppearance.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>core/tests/org.openjdk.jmc.flightrecorder.rules.jdk.test/src/test/java/org/openjdk/jmc/flightrecorder/test/rules/jdk/TestRulesWithJfr.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
149 
150 		// Compare the baseline with the current rule results
151 		boolean resultsEqual = rulesReport.compareAndLog(baselineReport);
152 
153 		// Save file for later inspection and/or updating the baseline with
154 		if (!resultsEqual) {
155 			// Save the generated file to XML
156 			saveToFile(rulesReport.toXml(), BASELINE_DIR, JFR_RULE_BASELINE_JFR, onlyOneRecording);
157 		}
158 
159 		// Assert that the comparison returned true
160 		Assert.assertTrue(DetailsTracker.getEntries(), resultsEqual);
161 	}
162 
163 	private static void saveToFile(Document doc, String directory, String fileName, boolean onlyOneRecording) {
164 		String filePath = getResultDir().getAbsolutePath() + File.separator
165 				+ ((directory != null) ? (directory + File.separator) : &quot;&quot;)
166 				+ (onlyOneRecording ? &quot;Generated_One_&quot; : &quot;Generated_&quot;) + fileName;
167 		File resultFile = new File(filePath);
168 		prepareFile(resultFile);
<span class="line-modified">169 		try {</span>
<span class="line-modified">170 			writeDomToStream(doc, new FileOutputStream(resultFile));</span>
<span class="line-modified">171 		} catch (FileNotFoundException e) {</span>
172 			e.printStackTrace();
173 		}
174 	}
175 
176 	private static void prepareFile(File file) {
177 		if (file.exists()) {
178 			file.delete();
179 		}
180 		File parent = file.getParentFile();
181 		if (parent != null) {
182 			parent.mkdirs();
183 		}
184 		try {
185 			file.createNewFile();
186 		} catch (IOException e) {
187 			e.printStackTrace();
188 			Assert.fail(&quot;Error creating file \&quot;&quot; + file.getAbsolutePath() + &quot;\&quot;. Error:\n&quot; + e.getMessage());
189 		}
190 	}
191 
</pre>
</td>
<td>
<hr />
<pre>
149 
150 		// Compare the baseline with the current rule results
151 		boolean resultsEqual = rulesReport.compareAndLog(baselineReport);
152 
153 		// Save file for later inspection and/or updating the baseline with
154 		if (!resultsEqual) {
155 			// Save the generated file to XML
156 			saveToFile(rulesReport.toXml(), BASELINE_DIR, JFR_RULE_BASELINE_JFR, onlyOneRecording);
157 		}
158 
159 		// Assert that the comparison returned true
160 		Assert.assertTrue(DetailsTracker.getEntries(), resultsEqual);
161 	}
162 
163 	private static void saveToFile(Document doc, String directory, String fileName, boolean onlyOneRecording) {
164 		String filePath = getResultDir().getAbsolutePath() + File.separator
165 				+ ((directory != null) ? (directory + File.separator) : &quot;&quot;)
166 				+ (onlyOneRecording ? &quot;Generated_One_&quot; : &quot;Generated_&quot;) + fileName;
167 		File resultFile = new File(filePath);
168 		prepareFile(resultFile);
<span class="line-modified">169 		try (FileOutputStream resultFos = new FileOutputStream(resultFile)) {</span>
<span class="line-modified">170 			writeDomToStream(doc, resultFos);</span>
<span class="line-modified">171 		} catch (IOException e) {</span>
172 			e.printStackTrace();
173 		}
174 	}
175 
176 	private static void prepareFile(File file) {
177 		if (file.exists()) {
178 			file.delete();
179 		}
180 		File parent = file.getParentFile();
181 		if (parent != null) {
182 			parent.mkdirs();
183 		}
184 		try {
185 			file.createNewFile();
186 		} catch (IOException e) {
187 			e.printStackTrace();
188 			Assert.fail(&quot;Error creating file \&quot;&quot; + file.getAbsolutePath() + &quot;\&quot;. Error:\n&quot; + e.getMessage());
189 		}
190 	}
191 
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../../../../../../org.openjdk.jmc.flightrecorder/src/main/java/org/openjdk/jmc/flightrecorder/internal/EventAppearance.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>