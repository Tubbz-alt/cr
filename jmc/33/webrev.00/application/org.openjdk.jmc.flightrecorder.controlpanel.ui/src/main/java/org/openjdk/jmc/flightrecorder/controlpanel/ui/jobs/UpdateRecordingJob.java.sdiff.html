<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff application/org.openjdk.jmc.flightrecorder.controlpanel.ui/src/main/java/org/openjdk/jmc/flightrecorder/controlpanel/ui/jobs/UpdateRecordingJob.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../actions/StartRecordingAction.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../model/EventConfiguration.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>application/org.openjdk.jmc.flightrecorder.controlpanel.ui/src/main/java/org/openjdk/jmc/flightrecorder/controlpanel/ui/jobs/UpdateRecordingJob.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
52 /**
53  * Tries to update an existing recording with a new recording settings.
54  */
55 public class UpdateRecordingJob extends Job {
56 	private final IRecordingDescriptor m_recordingDescriptor;
57 	private final IConstrainedMap&lt;String&gt; m_recordingOptions;
58 	private final IConstrainedMap&lt;EventOptionID&gt; m_recordingSettings;
59 	private final IServerHandle m_server;
60 
61 	public UpdateRecordingJob(IServerHandle server, IRecordingDescriptor recordingDescriptor,
62 			IConstrainedMap&lt;String&gt; recordingOptions, IConstrainedMap&lt;EventOptionID&gt; recordingSettings) {
63 		super(NLS.bind(Messages.UPDATE_RECORDING_JOB_NAME, recordingDescriptor.getName()));
64 		this.m_server = server;
65 		this.m_recordingDescriptor = recordingDescriptor;
66 		m_recordingOptions = recordingOptions;
67 		m_recordingSettings = recordingSettings;
68 	}
69 
70 	@Override
71 	protected IStatus run(IProgressMonitor monitor) {
<span class="line-modified">72 		IConnectionHandle connection = null;</span>
<span class="line-removed">73 		try {</span>
<span class="line-removed">74 			connection = m_server.connect(getName());</span>
75 			IFlightRecorderService flightRecorderService = connection.getServiceOrThrow(IFlightRecorderService.class);
76 			flightRecorderService.updateRecordingOptions(m_recordingDescriptor, m_recordingOptions);
77 			flightRecorderService.updateEventOptions(m_recordingDescriptor, m_recordingSettings);
78 			return StatusFactory.createOk(Messages.UPDATE_RECORDING_JOB_SUCCESS_MSG);
79 		} catch (Exception e) {
80 			ControlPanel.getDefault().getLogger().log(Level.WARNING, &quot;Could not update recording&quot;, e); //$NON-NLS-1$
81 			return StatusFactory.createErr(
82 					NLS.bind(Messages.UPDATE_RECORDING_JOB_SERVICE_ERROR_MSG, m_recordingDescriptor.getName()));
<span class="line-removed">83 		} finally {</span>
<span class="line-removed">84 			IOToolkit.closeSilently(connection);</span>
85 		}
86 	}
87 }
</pre>
</td>
<td>
<hr />
<pre>
52 /**
53  * Tries to update an existing recording with a new recording settings.
54  */
55 public class UpdateRecordingJob extends Job {
56 	private final IRecordingDescriptor m_recordingDescriptor;
57 	private final IConstrainedMap&lt;String&gt; m_recordingOptions;
58 	private final IConstrainedMap&lt;EventOptionID&gt; m_recordingSettings;
59 	private final IServerHandle m_server;
60 
61 	public UpdateRecordingJob(IServerHandle server, IRecordingDescriptor recordingDescriptor,
62 			IConstrainedMap&lt;String&gt; recordingOptions, IConstrainedMap&lt;EventOptionID&gt; recordingSettings) {
63 		super(NLS.bind(Messages.UPDATE_RECORDING_JOB_NAME, recordingDescriptor.getName()));
64 		this.m_server = server;
65 		this.m_recordingDescriptor = recordingDescriptor;
66 		m_recordingOptions = recordingOptions;
67 		m_recordingSettings = recordingSettings;
68 	}
69 
70 	@Override
71 	protected IStatus run(IProgressMonitor monitor) {
<span class="line-modified">72 		try (IConnectionHandle connection = m_server.connect(getName())) {</span>


73 			IFlightRecorderService flightRecorderService = connection.getServiceOrThrow(IFlightRecorderService.class);
74 			flightRecorderService.updateRecordingOptions(m_recordingDescriptor, m_recordingOptions);
75 			flightRecorderService.updateEventOptions(m_recordingDescriptor, m_recordingSettings);
76 			return StatusFactory.createOk(Messages.UPDATE_RECORDING_JOB_SUCCESS_MSG);
77 		} catch (Exception e) {
78 			ControlPanel.getDefault().getLogger().log(Level.WARNING, &quot;Could not update recording&quot;, e); //$NON-NLS-1$
79 			return StatusFactory.createErr(
80 					NLS.bind(Messages.UPDATE_RECORDING_JOB_SERVICE_ERROR_MSG, m_recordingDescriptor.getName()));


81 		}
82 	}
83 }
</pre>
</td>
</tr>
</table>
<center><a href="../actions/StartRecordingAction.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../../index.html" target="_top">index</a> <a href="../model/EventConfiguration.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>