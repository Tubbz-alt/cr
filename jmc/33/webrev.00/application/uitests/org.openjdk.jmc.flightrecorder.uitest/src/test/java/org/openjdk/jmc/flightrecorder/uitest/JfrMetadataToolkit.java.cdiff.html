<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff application/uitests/org.openjdk.jmc.flightrecorder.uitest/src/test/java/org/openjdk/jmc/flightrecorder/uitest/JfrMetadataToolkit.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../../../../tests/org.openjdk.jmc.rjmx.test/src/test/java/org/openjdk/jmc/rjmx/test/subscription/MRIMetadataServiceTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="MetadataTestBase.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>application/uitests/org.openjdk.jmc.flightrecorder.uitest/src/test/java/org/openjdk/jmc/flightrecorder/uitest/JfrMetadataToolkit.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 46,24 ***</span>
  @SuppressWarnings(&quot;restriction&quot;)
  public class JfrMetadataToolkit {
  
  	protected static SortedMap&lt;String, SortedMap&lt;String, String&gt;&gt; parseRecordingFile(File recordingFile) {
  		SortedMap&lt;String, SortedMap&lt;String, String&gt;&gt; eventTypeMap = new TreeMap&lt;&gt;();
<span class="line-modified">! 		InputStream stream = null;</span>
<span class="line-removed">- 		try {</span>
<span class="line-removed">- 			stream = IOToolkit.openUncompressedStream(recordingFile);</span>
  			EventArray[] eventArrays = FlightRecordingLoader.loadStream(stream, false, false);
  			for (EventArray entry : eventArrays) {
  				SortedMap&lt;String, String&gt; attrs = new TreeMap&lt;&gt;();
  				for (IAccessorKey&lt;?&gt; a : entry.getType().getAccessorKeys().keySet()) {
  					attrs.put(a.getIdentifier(), a.getContentType().getIdentifier());
  				}
  				String eventTypeId = entry.getType().getIdentifier();
  				eventTypeMap.put(eventTypeId, attrs);
  			}
  		} catch (Exception e) {
<span class="line-removed">- 			IOToolkit.closeSilently(stream);</span>
  			throw new RuntimeException(e);
  		}
  		return eventTypeMap;
  	}
  
<span class="line-new-header">--- 46,21 ---</span>
  @SuppressWarnings(&quot;restriction&quot;)
  public class JfrMetadataToolkit {
  
  	protected static SortedMap&lt;String, SortedMap&lt;String, String&gt;&gt; parseRecordingFile(File recordingFile) {
  		SortedMap&lt;String, SortedMap&lt;String, String&gt;&gt; eventTypeMap = new TreeMap&lt;&gt;();
<span class="line-modified">! 		try (InputStream stream = IOToolkit.openUncompressedStream(recordingFile)) {</span>
  			EventArray[] eventArrays = FlightRecordingLoader.loadStream(stream, false, false);
  			for (EventArray entry : eventArrays) {
  				SortedMap&lt;String, String&gt; attrs = new TreeMap&lt;&gt;();
  				for (IAccessorKey&lt;?&gt; a : entry.getType().getAccessorKeys().keySet()) {
  					attrs.put(a.getIdentifier(), a.getContentType().getIdentifier());
  				}
  				String eventTypeId = entry.getType().getIdentifier();
  				eventTypeMap.put(eventTypeId, attrs);
  			}
  		} catch (Exception e) {
  			throw new RuntimeException(e);
  		}
  		return eventTypeMap;
  	}
  
</pre>
<center><a href="../../../../../../../../../../tests/org.openjdk.jmc.rjmx.test/src/test/java/org/openjdk/jmc/rjmx/test/subscription/MRIMetadataServiceTest.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="MetadataTestBase.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>