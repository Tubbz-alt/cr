<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff application/org.openjdk.jmc.rjmx/src/main/java/org/openjdk/jmc/rjmx/ConnectionToolkit.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../../../org.openjdk.jmc.rjmx.services.jfr/src/main/java/org/openjdk/jmc/rjmx/services/jfr/internal/FlightRecorderServiceV2.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="JVMSupportToolkit.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>application/org.openjdk.jmc.rjmx/src/main/java/org/openjdk/jmc/rjmx/ConnectionToolkit.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
329 	/**
330 	 * Returns the default port number for the management agent.
331 	 *
332 	 * @return the default port for the management agent. May vary depending on which JVM version
333 	 *         the method is executed in.
334 	 */
335 	public static int getDefaultPort() {
336 		return RJMXConnection.VALUE_DEFAULT_REMOTE_PORT_JMX;
337 	}
338 
339 	/**
340 	 * Returns {@code true} if the connection handle is connected to a JRockit, {@code false}
341 	 * otherwise.
342 	 *
343 	 * @param connectionHandle
344 	 *            the connection handle to check.
345 	 * @return {@code true} if the connection handle is connected to a JRockit, {@code false}
346 	 *         otherwise.
347 	 */
348 	public static boolean isJRockit(IConnectionHandle connectionHandle) {
<span class="line-removed">349 </span>
350 		String vmName = getVMName(connectionHandle);
351 		return JavaVMVersionToolkit.isJRockitJVMName(vmName);
352 	}
353 
354 	/**
355 	 * Returns {@code true} if the connection handle is connected to a HotSpot, {@code false}
356 	 * otherwise. This method requires the connection handle to be connected.
357 	 *
358 	 * @param connectionHandle
359 	 *            the connection handle to check.
360 	 * @return {@code true} if the connection handle is connected to a HotSpot, {@code false}
361 	 *         otherwise.
362 	 */
363 	public static boolean isHotSpot(IConnectionHandle connectionHandle) {
364 		String vmName = getVMName(connectionHandle);
365 		return vmName != null &amp;&amp; JavaVMVersionToolkit.isHotspotJVMName(vmName);
366 	}
367 










368 	/**
369 	 * This will return true if the java version is above or equal the supplied value. (For example
370 	 * 1.7.0_40).
371 	 *
372 	 * @param connectionHandle
373 	 *            the connectionHandle to check.
374 	 * @param minVersion
375 	 *            the java version needed.
376 	 * @return {@code true} if the version is above or equal the supplied value, {@code true} if no
377 	 *         version can be obtained from the connection, {@code false} otherwise.
378 	 */
379 	public static boolean isJavaVersionAboveOrEqual(IConnectionHandle connectionHandle, JavaVersion minVersion) {
380 		JavaVersion version = getJavaVersion(connectionHandle);
381 		return version != null ? version.isGreaterOrEqualThan(minVersion) : true;
382 	}
383 
384 	private static String getVMName(IConnectionHandle connectionHandle) {
385 		MBeanServerConnection connection = connectionHandle.getServiceOrDummy(MBeanServerConnection.class);
386 		try {
387 			// getAttribute may fail if the connection handle
</pre>
<hr />
<pre>
394 		return null;
395 	}
396 
397 	private static JavaVersion getJavaVersion(IConnectionHandle connectionHandle) {
398 		try {
399 			MBeanServerConnection server = connectionHandle.getServiceOrThrow(MBeanServerConnection.class);
400 			Map&lt;String, String&gt; serverProps = getRuntimeBean(server).getSystemProperties();
401 			String javaVersion = serverProps.get(&quot;java.version&quot;); //$NON-NLS-1$
402 			if (javaVersion != null) {
403 				return new JavaVersion(javaVersion);
404 			}
405 			RJMXPlugin.getDefault().getLogger().log(Level.WARNING,
406 					&quot;System Properties from &quot; + connectionHandle.getDescription() //$NON-NLS-1$
407 							+ &quot; contained no java.version property!&quot;); //$NON-NLS-1$
408 		} catch (Exception e) {
409 			RJMXPlugin.getDefault().getLogger().log(Level.WARNING,
410 					&quot;Could not check the java.version from System Properties!&quot;, e); //$NON-NLS-1$
411 		}
412 		return null;
413 	}
<span class="line-removed">414 </span>
415 }
</pre>
</td>
<td>
<hr />
<pre>
329 	/**
330 	 * Returns the default port number for the management agent.
331 	 *
332 	 * @return the default port for the management agent. May vary depending on which JVM version
333 	 *         the method is executed in.
334 	 */
335 	public static int getDefaultPort() {
336 		return RJMXConnection.VALUE_DEFAULT_REMOTE_PORT_JMX;
337 	}
338 
339 	/**
340 	 * Returns {@code true} if the connection handle is connected to a JRockit, {@code false}
341 	 * otherwise.
342 	 *
343 	 * @param connectionHandle
344 	 *            the connection handle to check.
345 	 * @return {@code true} if the connection handle is connected to a JRockit, {@code false}
346 	 *         otherwise.
347 	 */
348 	public static boolean isJRockit(IConnectionHandle connectionHandle) {

349 		String vmName = getVMName(connectionHandle);
350 		return JavaVMVersionToolkit.isJRockitJVMName(vmName);
351 	}
352 
353 	/**
354 	 * Returns {@code true} if the connection handle is connected to a HotSpot, {@code false}
355 	 * otherwise. This method requires the connection handle to be connected.
356 	 *
357 	 * @param connectionHandle
358 	 *            the connection handle to check.
359 	 * @return {@code true} if the connection handle is connected to a HotSpot, {@code false}
360 	 *         otherwise.
361 	 */
362 	public static boolean isHotSpot(IConnectionHandle connectionHandle) {
363 		String vmName = getVMName(connectionHandle);
364 		return vmName != null &amp;&amp; JavaVMVersionToolkit.isHotspotJVMName(vmName);
365 	}
366 
<span class="line-added">367 	/**</span>
<span class="line-added">368 	 * Returns {@code true} if the connection handle is associated with an Oracle built JVM,</span>
<span class="line-added">369 	 * {@code false} otherwise. This method &lt;b&gt;does not&lt;/b&gt; require the connection handle to be</span>
<span class="line-added">370 	 * connected.</span>
<span class="line-added">371 	 */</span>
<span class="line-added">372 	public static boolean isOracle(IConnectionHandle handle) {</span>
<span class="line-added">373 		String vendor = handle.getServerDescriptor().getJvmInfo().getJvmVendor();</span>
<span class="line-added">374 		return vendor != null &amp;&amp; vendor.contains(&quot;Oracle&quot;);</span>
<span class="line-added">375 	}</span>
<span class="line-added">376 </span>
377 	/**
378 	 * This will return true if the java version is above or equal the supplied value. (For example
379 	 * 1.7.0_40).
380 	 *
381 	 * @param connectionHandle
382 	 *            the connectionHandle to check.
383 	 * @param minVersion
384 	 *            the java version needed.
385 	 * @return {@code true} if the version is above or equal the supplied value, {@code true} if no
386 	 *         version can be obtained from the connection, {@code false} otherwise.
387 	 */
388 	public static boolean isJavaVersionAboveOrEqual(IConnectionHandle connectionHandle, JavaVersion minVersion) {
389 		JavaVersion version = getJavaVersion(connectionHandle);
390 		return version != null ? version.isGreaterOrEqualThan(minVersion) : true;
391 	}
392 
393 	private static String getVMName(IConnectionHandle connectionHandle) {
394 		MBeanServerConnection connection = connectionHandle.getServiceOrDummy(MBeanServerConnection.class);
395 		try {
396 			// getAttribute may fail if the connection handle
</pre>
<hr />
<pre>
403 		return null;
404 	}
405 
406 	private static JavaVersion getJavaVersion(IConnectionHandle connectionHandle) {
407 		try {
408 			MBeanServerConnection server = connectionHandle.getServiceOrThrow(MBeanServerConnection.class);
409 			Map&lt;String, String&gt; serverProps = getRuntimeBean(server).getSystemProperties();
410 			String javaVersion = serverProps.get(&quot;java.version&quot;); //$NON-NLS-1$
411 			if (javaVersion != null) {
412 				return new JavaVersion(javaVersion);
413 			}
414 			RJMXPlugin.getDefault().getLogger().log(Level.WARNING,
415 					&quot;System Properties from &quot; + connectionHandle.getDescription() //$NON-NLS-1$
416 							+ &quot; contained no java.version property!&quot;); //$NON-NLS-1$
417 		} catch (Exception e) {
418 			RJMXPlugin.getDefault().getLogger().log(Level.WARNING,
419 					&quot;Could not check the java.version from System Properties!&quot;, e); //$NON-NLS-1$
420 		}
421 		return null;
422 	}

423 }
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../../../org.openjdk.jmc.rjmx.services.jfr/src/main/java/org/openjdk/jmc/rjmx/services/jfr/internal/FlightRecorderServiceV2.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="JVMSupportToolkit.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>