<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff core/org.openjdk.jmc.agent/src/main/java/org/openjdk/jmc/agent/util/expression/ReferenceChain.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../TypeUtils.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>core/org.openjdk.jmc.agent/src/main/java/org/openjdk/jmc/agent/util/expression/ReferenceChain.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -35,27 +35,49 @@</span>
  import org.objectweb.asm.Type;
  
  import java.util.LinkedList;
  import java.util.List;
  
<span class="udiff-line-modified-removed">- public class ReferenceChain {</span>
<span class="udiff-line-modified-added">+ /**</span>
<span class="udiff-line-added">+  * A ReferenceChain instance presents a field reference expression.</span>
<span class="udiff-line-added">+  * </span>
<span class="udiff-line-added">+  * eg. &lt;code&gt;OuterClass.this.field.STATIC_FIELD&lt;/code&gt; is a reference chain consisting elements: a qualified-this </span>
<span class="udiff-line-added">+  * reference and two field reference (&lt;code&gt;field&lt;/code&gt; and &lt;code&gt;STATIC_FIELD&lt;/code&gt;).</span>
<span class="udiff-line-added">+  * </span>
<span class="udiff-line-added">+  */</span>
<span class="udiff-line-added">+ public final class ReferenceChain {</span>
  	private final Class&lt;?&gt; callerClass;
  	private final List&lt;ReferenceChainElement&gt; references;
  
<span class="udiff-line-added">+ 	/**</span>
<span class="udiff-line-added">+ 	 * @param callerClass the caller class making this reference</span>
<span class="udiff-line-added">+ 	 */</span>
  	public ReferenceChain(Class&lt;?&gt; callerClass) {
  		this.callerClass = callerClass;
  		this.references = new LinkedList&lt;&gt;();
  	}
  
<span class="udiff-line-added">+ 	/**</span>
<span class="udiff-line-added">+ 	 * @return the caller class making this reference</span>
<span class="udiff-line-added">+ 	 */</span>
  	public Class&lt;?&gt; getCallerClass() {
  		return callerClass;
  	}
  
<span class="udiff-line-added">+ 	/**</span>
<span class="udiff-line-added">+ 	 * @return all elements on the reference chain</span>
<span class="udiff-line-added">+ 	 */</span>
  	public List&lt;ReferenceChainElement&gt; getReferences() {
  		return references;
  	}
  
<span class="udiff-line-added">+ 	/**</span>
<span class="udiff-line-added">+ 	 * Reduces the reference chain to prepend &quot;this&quot; or qualified-this references if necessary, and short-circuits on</span>
<span class="udiff-line-added">+ 	 * static references</span>
<span class="udiff-line-added">+ 	 * </span>
<span class="udiff-line-added">+ 	 * @return the normalized reference chain</span>
<span class="udiff-line-added">+ 	 */</span>
  	public ReferenceChain normalize() {
  		List&lt;ReferenceChainElement&gt; oldRefs = getReferences();
  		List&lt;ReferenceChainElement&gt; newRefs = new LinkedList&lt;&gt;();
  
  		// Take shortcuts on static references
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -80,21 +102,31 @@</span>
  		ReferenceChain ret = new ReferenceChain(callerClass);
  		ret.references.addAll(newRefs);
  		return ret;
  	}
  
<span class="udiff-line-added">+ 	/**</span>
<span class="udiff-line-added">+ 	 * @return the type of the last reference element</span>
<span class="udiff-line-added">+ 	 */</span>
  	public Type getType() {
  		if (references.isEmpty()) {
  			return Type.getType(callerClass);
  		}
  		return references.get(references.size() - 1).getReferencedType();
  	}
  
<span class="udiff-line-added">+ 	/**</span>
<span class="udiff-line-added">+ 	 * Appends a ReferenceChainElement to the chain</span>
<span class="udiff-line-added">+ 	 * @param ref ReferenceChainElement to be appended</span>
<span class="udiff-line-added">+ 	 */</span>
  	public void append(ReferenceChainElement ref) {
  		references.add(ref);
  	}
  
<span class="udiff-line-added">+ 	/**</span>
<span class="udiff-line-added">+ 	 * @return whether the reference is valid from a static context</span>
<span class="udiff-line-added">+ 	 */</span>
  	public boolean isStatic() {
  		if (references.isEmpty()) {
  			return false;
  		}
  
</pre>
<center><a href="../TypeUtils.java.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>