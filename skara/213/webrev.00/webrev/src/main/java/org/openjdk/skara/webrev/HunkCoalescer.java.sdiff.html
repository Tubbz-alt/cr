<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff webrev/src/main/java/org/openjdk/skara/webrev/HunkCoalescer.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>webrev/src/main/java/org/openjdk/skara/webrev/HunkCoalescer.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
241         var sourceAfterContextStart = hunk.source().range().end();
242         var sourceAfterContextEnd = hunk.source().range().end() + numContextLines;
243         sourceAfterContextEnd = Math.min(sourceAfterContextEnd, sourceContent.size() + 1);
244         if (nextNonEmptySourceHunk != null) {
245             var nextNonEmptySourceHunkStart = nextNonEmptySourceHunk.source().range().start();
246             sourceAfterContextEnd = sourceAfterContextEnd &gt; nextNonEmptySourceHunkStart
247                     ? Math.min(sourceAfterContextEnd, nextNonEmptySourceHunkStart)
248                     : Math.max(sourceAfterContextEnd, nextNonEmptySourceHunkStart);
249         }
250         var sourceAfterContextCount = sourceAfterContextEnd - sourceAfterContextStart;
251 
252         var destAfterContextStart = hunk.target().range().end();
253         var destAfterContextEnd = hunk.target().range().end() + numContextLines;
254         destAfterContextEnd = Math.min(destAfterContextEnd, destContent.size() + 1);
255         if (nextNonEmptyTargetHunk != null) {
256             var nextNonEmptyTargetHunkStart = nextNonEmptyTargetHunk.target().range().start();
257             destAfterContextEnd = destAfterContextEnd &gt; nextNonEmptyTargetHunkStart
258                     ? Math.min(destAfterContextEnd, nextNonEmptyTargetHunkStart)
259                     : Math.max(destAfterContextEnd, nextNonEmptyTargetHunkStart);
260         }






261         var destAfterContextCount = destAfterContextEnd - destAfterContextStart;
262 
263         var afterContextCount = Math.min(sourceAfterContextCount, destAfterContextCount);
264 
265         var sourceLineNumStart = hunk.source().lines().isEmpty() &amp;&amp; hunk.source().range().start() == 0 ?
266             sourceAfterContextStart + 1 : sourceAfterContextStart;
267         var sourceEndingLineNum = sourceLineNumStart + afterContextCount;
268         var sourceContextAfter = new ArrayList&lt;Line&gt;();
269         for (var lineNum = sourceLineNumStart; lineNum &lt; sourceEndingLineNum; lineNum++) {
270             var text = sourceContent.get(lineNum - 1);
271             sourceContextAfter.add(new Line(lineNum, text));
272         }
273 
274         var destLineNumStart = hunk.target().lines().isEmpty() &amp;&amp; hunk.target().range().start() == 0 ?
275             destAfterContextStart + 1 : destAfterContextStart;
276         var destEndingLineNum = destLineNumStart + afterContextCount;
277         var destContextAfter = new ArrayList&lt;Line&gt;();
278         for (var lineNum = destLineNumStart; lineNum &lt; destEndingLineNum; lineNum++) {
279             var text = destContent.get(lineNum - 1);
280             destContextAfter.add(new Line(lineNum, text));
</pre>
</td>
<td>
<hr />
<pre>
241         var sourceAfterContextStart = hunk.source().range().end();
242         var sourceAfterContextEnd = hunk.source().range().end() + numContextLines;
243         sourceAfterContextEnd = Math.min(sourceAfterContextEnd, sourceContent.size() + 1);
244         if (nextNonEmptySourceHunk != null) {
245             var nextNonEmptySourceHunkStart = nextNonEmptySourceHunk.source().range().start();
246             sourceAfterContextEnd = sourceAfterContextEnd &gt; nextNonEmptySourceHunkStart
247                     ? Math.min(sourceAfterContextEnd, nextNonEmptySourceHunkStart)
248                     : Math.max(sourceAfterContextEnd, nextNonEmptySourceHunkStart);
249         }
250         var sourceAfterContextCount = sourceAfterContextEnd - sourceAfterContextStart;
251 
252         var destAfterContextStart = hunk.target().range().end();
253         var destAfterContextEnd = hunk.target().range().end() + numContextLines;
254         destAfterContextEnd = Math.min(destAfterContextEnd, destContent.size() + 1);
255         if (nextNonEmptyTargetHunk != null) {
256             var nextNonEmptyTargetHunkStart = nextNonEmptyTargetHunk.target().range().start();
257             destAfterContextEnd = destAfterContextEnd &gt; nextNonEmptyTargetHunkStart
258                     ? Math.min(destAfterContextEnd, nextNonEmptyTargetHunkStart)
259                     : Math.max(destAfterContextEnd, nextNonEmptyTargetHunkStart);
260         }
<span class="line-added">261 </span>
<span class="line-added">262         if (nextNonEmptySourceHunk != null || nextNonEmptyTargetHunk != null) {</span>
<span class="line-added">263             sourceAfterContextEnd += numContextLines;</span>
<span class="line-added">264             destAfterContextEnd += numContextLines;</span>
<span class="line-added">265         }</span>
<span class="line-added">266 </span>
267         var destAfterContextCount = destAfterContextEnd - destAfterContextStart;
268 
269         var afterContextCount = Math.min(sourceAfterContextCount, destAfterContextCount);
270 
271         var sourceLineNumStart = hunk.source().lines().isEmpty() &amp;&amp; hunk.source().range().start() == 0 ?
272             sourceAfterContextStart + 1 : sourceAfterContextStart;
273         var sourceEndingLineNum = sourceLineNumStart + afterContextCount;
274         var sourceContextAfter = new ArrayList&lt;Line&gt;();
275         for (var lineNum = sourceLineNumStart; lineNum &lt; sourceEndingLineNum; lineNum++) {
276             var text = sourceContent.get(lineNum - 1);
277             sourceContextAfter.add(new Line(lineNum, text));
278         }
279 
280         var destLineNumStart = hunk.target().lines().isEmpty() &amp;&amp; hunk.target().range().start() == 0 ?
281             destAfterContextStart + 1 : destAfterContextStart;
282         var destEndingLineNum = destLineNumStart + afterContextCount;
283         var destContextAfter = new ArrayList&lt;Line&gt;();
284         for (var lineNum = destLineNumStart; lineNum &lt; destEndingLineNum; lineNum++) {
285             var text = destContent.get(lineNum - 1);
286             destContextAfter.add(new Line(lineNum, text));
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>