<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff bots/mlbridge/src/test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MailingListArchiveReaderBotTests.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="WebrevStorageTests.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>bots/mlbridge/src/test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 102,11 ***</span>
      void simpleArchive(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
               var webrevFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var ignored = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
<span class="line-new-header">--- 102,12 ---</span>
      void simpleArchive(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
               var webrevFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var ignored = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 116,11 ***</span>
                                                   censusBuilder.build(), &quot;master&quot;, listAddress,
                                                   Set.of(ignored.forge().currentUser().userName()),
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(&quot;rfr&quot;), Map.of(ignored.forge().currentUser().userName(),
                                                                         Pattern.compile(&quot;ready&quot;)),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(&quot;Extra1&quot;, &quot;val1&quot;, &quot;Extra2&quot;, &quot;val2&quot;),
                                                   Duration.ZERO);
<span class="line-new-header">--- 117,11 ---</span>
                                                   censusBuilder.build(), &quot;master&quot;, listAddress,
                                                   Set.of(ignored.forge().currentUser().userName()),
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(&quot;rfr&quot;), Map.of(ignored.forge().currentUser().userName(),
                                                                         Pattern.compile(&quot;ready&quot;)),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(&quot;Extra1&quot;, &quot;val1&quot;, &quot;Extra2&quot;, &quot;val2&quot;),
                                                   Duration.ZERO);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 178,11 ***</span>
              assertTrue(archiveContains(archiveFolder.path(), &quot;This is a pull request&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;This should now be ready&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;Patch:&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;Changes:&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;Webrev:&quot;));
<span class="line-modified">!             assertTrue(archiveContains(archiveFolder.path(), &quot;http://www.test.test/&quot;));</span>
              assertTrue(archiveContains(archiveFolder.path(), &quot;webrev.00&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;Issue:&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;http://issues.test/browse/TSTPRJ-1234&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;Fetch:&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;^ - &quot; + editHash.abbreviate() + &quot;: Change msg&quot;));
<span class="line-new-header">--- 179,11 ---</span>
              assertTrue(archiveContains(archiveFolder.path(), &quot;This is a pull request&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;This should now be ready&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;Patch:&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;Changes:&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;Webrev:&quot;));
<span class="line-modified">!             assertTrue(archiveContains(archiveFolder.path(), webrevServer.uri().toString()));</span>
              assertTrue(archiveContains(archiveFolder.path(), &quot;webrev.00&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;Issue:&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;http://issues.test/browse/TSTPRJ-1234&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;Fetch:&quot;));
              assertTrue(archiveContains(archiveFolder.path(), &quot;^ - &quot; + editHash.abbreviate() + &quot;: Change msg&quot;));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 260,11 ***</span>
      @Test
      void reviewComment(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var ignored = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
<span class="line-new-header">--- 261,12 ---</span>
      @Test
      void reviewComment(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var ignored = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 274,11 ***</span>
                                                   censusBuilder.build(), &quot;master&quot;, listAddress,
                                                   Set.of(ignored.forge().currentUser().userName()),
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 276,11 ---</span>
                                                   censusBuilder.build(), &quot;master&quot;, listAddress,
                                                   Set.of(ignored.forge().currentUser().userName()),
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 350,11 ***</span>
      @Test
      void combineComments(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
<span class="line-new-header">--- 352,12 ---</span>
      @Test
      void combineComments(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 363,11 ***</span>
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 366,11 ---</span>
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 437,11 ***</span>
      @Test
      void commentThreading(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var reviewer = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
<span class="line-new-header">--- 440,12 ---</span>
      @Test
      void commentThreading(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var reviewer = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 452,11 ***</span>
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 456,11 ---</span>
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 561,11 ***</span>
      @Test
      void commentThreadingSeparated(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var reviewer = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
<span class="line-new-header">--- 565,12 ---</span>
      @Test
      void commentThreadingSeparated(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var reviewer = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 575,11 ***</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, &quot;master&quot;, censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 580,11 ---</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, &quot;master&quot;, censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 618,11 ***</span>
      @Test
      void reviewContext(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
<span class="line-new-header">--- 623,12 ---</span>
      @Test
      void reviewContext(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 631,11 ***</span>
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 637,11 ---</span>
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 670,11 ***</span>
      @Test
      void multipleReviewContexts(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
<span class="line-new-header">--- 676,12 ---</span>
      @Test
      void multipleReviewContexts(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 683,11 ***</span>
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 690,11 ---</span>
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 741,11 ***</span>
      @Test
      void filterComments(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
<span class="line-new-header">--- 748,12 ---</span>
      @Test
      void filterComments(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 753,11 ***</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, &quot;master&quot;,
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 761,11 ---</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, &quot;master&quot;,
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 800,11 ***</span>
      @Test
      void incrementalChanges(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var commenter = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
<span class="line-new-header">--- 808,12 ---</span>
      @Test
      void incrementalChanges(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var commenter = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 813,11 ***</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, &quot;master&quot;,
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 822,11 ---</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, &quot;master&quot;,
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 923,11 ***</span>
      @Test
      void rebased(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
<span class="line-new-header">--- 932,12 ---</span>
      @Test
      void rebased(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 935,11 ***</span>
              var mlBot = new MailingListBridgeBot(sender, author, archive, &quot;master&quot;,
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 945,11 ---</span>
              var mlBot = new MailingListBridgeBot(sender, author, archive, &quot;master&quot;,
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1013,11 ***</span>
      @Test
      void incrementalAfterRebase(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
<span class="line-new-header">--- 1023,12 ---</span>
      @Test
      void incrementalAfterRebase(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
                                             .addAuthor(author.forge().currentUser().id());
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1025,11 ***</span>
              var mlBot = new MailingListBridgeBot(sender, author, archive, &quot;archive&quot;,
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 1036,11 ---</span>
              var mlBot = new MailingListBridgeBot(sender, author, archive, &quot;archive&quot;,
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1096,11 ***</span>
      void skipAddingExistingWebrev(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
               var webrevFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var ignored = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
<span class="line-new-header">--- 1107,12 ---</span>
      void skipAddingExistingWebrev(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
               var webrevFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var ignored = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1111,11 ***</span>
                                                   listAddress,
                                                   Set.of(ignored.forge().currentUser().userName()),
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 1123,11 ---</span>
                                                   listAddress,
                                                   Set.of(ignored.forge().currentUser().userName()),
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1171,11 ***</span>
      @Test
      void notifyReviewVerdicts(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var reviewer = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var from = EmailAddress.from(&quot;test&quot;, &quot;test@test.mail&quot;);
<span class="line-new-header">--- 1183,12 ---</span>
      @Test
      void notifyReviewVerdicts(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var reviewer = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var from = EmailAddress.from(&quot;test&quot;, &quot;test@test.mail&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1185,11 ***</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, &quot;master&quot;,
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 1198,11 ---</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, &quot;master&quot;,
                                                   censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1255,11 ***</span>
      @Test
      void ignoreComments(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer()) {</span>
              var author = credentials.getHostedRepository();
              var ignored = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
<span class="line-new-header">--- 1268,12 ---</span>
      @Test
      void ignoreComments(TestInfo testInfo) throws IOException {
          try (var credentials = new HostCredentials(testInfo);
               var tempFolder = new TemporaryDirectory();
               var archiveFolder = new TemporaryDirectory();
<span class="line-modified">!              var listServer = new TestMailmanServer();</span>
<span class="line-added">+              var webrevServer = new TestWebrevServer()) {</span>
              var author = credentials.getHostedRepository();
              var ignored = credentials.getHostedRepository();
              var archive = credentials.getHostedRepository();
              var listAddress = EmailAddress.parse(listServer.createList(&quot;test&quot;));
              var censusBuilder = credentials.getCensusBuilder()
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1270,11 ***</span>
                                                   listAddress,
                                                   Set.of(ignored.forge().currentUser().userName()),
                                                   Set.of(Pattern.compile(&quot;ignore this comment&quot;, Pattern.MULTILINE | Pattern.DOTALL)),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  URIBuilder.base(&quot;http://www.test.test/&quot;).build(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
<span class="line-new-header">--- 1284,11 ---</span>
                                                   listAddress,
                                                   Set.of(ignored.forge().currentUser().userName()),
                                                   Set.of(Pattern.compile(&quot;ignore this comment&quot;, Pattern.MULTILINE | Pattern.DOTALL)),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
<span class="line-modified">!                                                  webrevServer.uri(),</span>
                                                   Set.of(), Map.of(),
                                                   URIBuilder.base(&quot;http://issues.test/browse/&quot;).build(),
                                                   Map.of(), Duration.ZERO);
  
              // Populate the projects repository
</pre>
<center><a href="MailingListArchiveReaderBotTests.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="WebrevStorageTests.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>