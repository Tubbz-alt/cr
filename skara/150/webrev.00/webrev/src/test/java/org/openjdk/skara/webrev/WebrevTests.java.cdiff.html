<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff webrev/src/test/java/org/openjdk/skara/webrev/WebrevTests.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../main/java/org/openjdk/skara/webrev/RemovedPatchView.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>webrev/src/test/java/org/openjdk/skara/webrev/WebrevTests.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 113,6 ***</span>
<span class="line-new-header">--- 113,64 ---</span>
  
              new Webrev.Builder(repo, webrevFolder.path()).generate(hash1, hash2);
              assertContains(webrevFolder.path().resolve(&quot;index.html&quot;), &quot;&lt;td&gt;4 lines changed; 0 ins; 4 del; 0 mod; 1 unchg&lt;/td&gt;&quot;);
          }
      }
<span class="line-added">+ </span>
<span class="line-added">+     @ParameterizedTest</span>
<span class="line-added">+     @EnumSource(VCS.class)</span>
<span class="line-added">+     void removeBinaryFile(VCS vcs) throws IOException {</span>
<span class="line-added">+         try (var tmp = new TemporaryDirectory()) {</span>
<span class="line-added">+             var repo = Repository.init(tmp.path().resolve(&quot;repo&quot;), vcs);</span>
<span class="line-added">+             var binaryFile = repo.root().resolve(&quot;x.jpg&quot;);</span>
<span class="line-added">+             byte[] contents = {0x1, 0x2, 0x3, 0x4, 0x5, 0x0, 0x2, 0x3, 0x4, 0x5};</span>
<span class="line-added">+             Files.write(binaryFile, contents);</span>
<span class="line-added">+             repo.add(binaryFile);</span>
<span class="line-added">+             var hash1 = repo.commit(&quot;Added binary file&quot;, &quot;a&quot;, &quot;a@a.a&quot;);</span>
<span class="line-added">+             repo.remove(binaryFile);</span>
<span class="line-added">+             var hash2 = repo.commit(&quot;Removed binary file&quot;, &quot;a&quot;, &quot;a@a.a&quot;);</span>
<span class="line-added">+ </span>
<span class="line-added">+             new Webrev.Builder(repo, tmp.path().resolve(&quot;webrev&quot;)).generate(hash1, hash2);</span>
<span class="line-added">+         }</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     @ParameterizedTest</span>
<span class="line-added">+     @EnumSource(VCS.class)</span>
<span class="line-added">+     void addBinaryFile(VCS vcs) throws IOException {</span>
<span class="line-added">+         try (var tmp = new TemporaryDirectory()) {</span>
<span class="line-added">+             var repo = Repository.init(tmp.path().resolve(&quot;repo&quot;), vcs);</span>
<span class="line-added">+             var readme = repo.root().resolve(&quot;README&quot;);</span>
<span class="line-added">+             Files.writeString(readme, &quot;Hello\n&quot;);</span>
<span class="line-added">+             repo.add(readme);</span>
<span class="line-added">+             var hash1 = repo.commit(&quot;Added readme&quot;, &quot;a&quot;, &quot;a@a&quot;);</span>
<span class="line-added">+ </span>
<span class="line-added">+             var binaryFile = repo.root().resolve(&quot;x.jpg&quot;);</span>
<span class="line-added">+             byte[] contents = {0x1, 0x2, 0x3, 0x4, 0x5, 0x0, 0x2, 0x3, 0x4, 0x5};</span>
<span class="line-added">+             Files.write(binaryFile, contents);</span>
<span class="line-added">+             repo.add(binaryFile);</span>
<span class="line-added">+             var hash2 = repo.commit(&quot;Added binary file&quot;, &quot;a&quot;, &quot;a@a.a&quot;);</span>
<span class="line-added">+ </span>
<span class="line-added">+             new Webrev.Builder(repo, tmp.path().resolve(&quot;webrev&quot;)).generate(hash1, hash2);</span>
<span class="line-added">+         }</span>
<span class="line-added">+     }</span>
<span class="line-added">+ </span>
<span class="line-added">+     @ParameterizedTest</span>
<span class="line-added">+     @EnumSource(VCS.class)</span>
<span class="line-added">+     void modifyBinaryFile(VCS vcs) throws IOException {</span>
<span class="line-added">+         try (var tmp = new TemporaryDirectory()) {</span>
<span class="line-added">+             var repo = Repository.init(tmp.path().resolve(&quot;repo&quot;), vcs);</span>
<span class="line-added">+             var readme = repo.root().resolve(&quot;README&quot;);</span>
<span class="line-added">+             var binaryFile = repo.root().resolve(&quot;x.jpg&quot;);</span>
<span class="line-added">+             byte[] contents = {0x1, 0x2, 0x3, 0x4, 0x5, 0x0, 0x2, 0x3, 0x4, 0x5};</span>
<span class="line-added">+             Files.write(binaryFile, contents);</span>
<span class="line-added">+             repo.add(binaryFile);</span>
<span class="line-added">+             var hash1 = repo.commit(&quot;Added binary file&quot;, &quot;a&quot;, &quot;a@a.a&quot;);</span>
<span class="line-added">+ </span>
<span class="line-added">+             byte[] newContent =  {0x1, 0x2, 0x3, 0x4, 0x5, 0x0, 0x2, 0x3, 0x4, 0x5, 0x6};</span>
<span class="line-added">+             Files.write(binaryFile, newContent);</span>
<span class="line-added">+             repo.add(binaryFile);</span>
<span class="line-added">+             var hash2 = repo.commit(&quot;Modified binary file&quot;, &quot;a&quot;, &quot;a@a.a&quot;);</span>
<span class="line-added">+ </span>
<span class="line-added">+             new Webrev.Builder(repo, tmp.path().resolve(&quot;webrev&quot;)).generate(hash1, hash2);</span>
<span class="line-added">+         }</span>
<span class="line-added">+     }</span>
  }
</pre>
<center><a href="../../../../../../main/java/org/openjdk/skara/webrev/RemovedPatchView.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>