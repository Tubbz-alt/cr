<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff vcs/src/main/java/org/openjdk/skara/vcs/hg/HgRepository.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>vcs/src/main/java/org/openjdk/skara/vcs/hg/HgRepository.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
596     public Branch currentBranch() throws IOException {
597         try (var p = capture(&quot;hg&quot;, &quot;branch&quot;)) {
598             var res = await(p);
599             if (res.stdout().size() != 1) {
600                 throw new IllegalStateException(&quot;No current branch\n&quot; + res);
601             }
602             return new Branch(res.stdout().get(0));
603         }
604     }
605 
606     @Override
607     public Branch defaultBranch() throws IOException {
608         return new Branch(&quot;default&quot;);
609     }
610 
611     @Override
612     public Optional&lt;Tag&gt; defaultTag() throws IOException {
613         return Optional.of(new Tag(&quot;tip&quot;));
614     }
615 
<span class="line-removed">616 </span>
617     @Override
618     public Optional&lt;byte[]&gt; show(Path path, Hash hash) throws IOException {
619         var output = Files.createTempFile(&quot;hg-cat-rev-&quot; + hash.abbreviate(), &quot;.bin&quot;);
620         try (var p = capture(&quot;hg&quot;, &quot;cat&quot;, &quot;--output=&quot; + output, &quot;--rev=&quot; + hash.hex(), path.toString())) {
621             var res = p.await();
622             if (res.status() == 0 &amp;&amp; Files.exists(output)) {
623                 var bytes = Files.readAllBytes(output);
624                 Files.delete(output);
625                 return Optional.of(bytes);
626             }
627 
628             if (Files.exists(output)) {
629                 Files.delete(output);
630             }
631             return Optional.empty();
632         }
633     }
634 
635     @Override
636     public Diff diff(Hash from) throws IOException {
</pre>
</td>
<td>
<hr />
<pre>
596     public Branch currentBranch() throws IOException {
597         try (var p = capture(&quot;hg&quot;, &quot;branch&quot;)) {
598             var res = await(p);
599             if (res.stdout().size() != 1) {
600                 throw new IllegalStateException(&quot;No current branch\n&quot; + res);
601             }
602             return new Branch(res.stdout().get(0));
603         }
604     }
605 
606     @Override
607     public Branch defaultBranch() throws IOException {
608         return new Branch(&quot;default&quot;);
609     }
610 
611     @Override
612     public Optional&lt;Tag&gt; defaultTag() throws IOException {
613         return Optional.of(new Tag(&quot;tip&quot;));
614     }
615 

616     @Override
617     public Optional&lt;byte[]&gt; show(Path path, Hash hash) throws IOException {
618         var output = Files.createTempFile(&quot;hg-cat-rev-&quot; + hash.abbreviate(), &quot;.bin&quot;);
619         try (var p = capture(&quot;hg&quot;, &quot;cat&quot;, &quot;--output=&quot; + output, &quot;--rev=&quot; + hash.hex(), path.toString())) {
620             var res = p.await();
621             if (res.status() == 0 &amp;&amp; Files.exists(output)) {
622                 var bytes = Files.readAllBytes(output);
623                 Files.delete(output);
624                 return Optional.of(bytes);
625             }
626 
627             if (Files.exists(output)) {
628                 Files.delete(output);
629             }
630             return Optional.empty();
631         }
632     }
633 
634     @Override
635     public Diff diff(Hash from) throws IOException {
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>