<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff email/src/test/java/org/openjdk/skara/email/EmailTests.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../../../../../main/java/org/openjdk/skara/email/Email.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>email/src/test/java/org/openjdk/skara/email/EmailTests.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 50                      mail.recipients());
 51         assertEquals(&quot;The body&quot;, mail.body());
 52     }
 53 
 54     @Test
 55     void buildFrom() {
 56         var original = Email.create(EmailAddress.from(&quot;A&quot;, &quot;a@b.c&quot;), &quot;Subject&quot;, &quot;body&quot;)
 57                             .header(&quot;X&quot;, &quot;y&quot;)
 58                             .header(&quot;Z&quot;, &quot;a&quot;)
 59                             .recipient(EmailAddress.from(&quot;B&quot;, &quot;b@b.c&quot;))
 60                             .build();
 61         var copy = Email.from(original).build();
 62         assertEquals(&quot;Subject&quot;, copy.subject());
 63         assertEquals(&quot;body&quot;, copy.body());
 64         assertEquals(Set.of(&quot;X&quot;, &quot;Z&quot;), copy.headers());
 65         assertEquals(&quot;y&quot;, copy.headerValue(&quot;X&quot;));
 66         assertEquals(&quot;a&quot;, copy.headerValue(&quot;z&quot;));
 67         assertEquals(original, copy);
 68     }
 69 


















 70     @Test
 71     void caseInsensitiveHeaders() {
 72         var mail = Email.parse(&quot;Message-ID: &lt;a@b.c&gt;\n&quot; +
 73                                        &quot;date: Wed, 27 Mar 2019 14:31:00 +0100\n&quot; +
 74                                        &quot;SUBJECT: hello\n&quot; +
 75                                        &quot;FRom: B &lt;b@b.c&gt;\n&quot; +
 76                                        &quot;tO: C &lt;c@c.c&gt;, &lt;d@d.c&gt;\n&quot; +
 77                                        &quot;Extra-header: hello\n&quot; +
 78                                        &quot;\n&quot; +
 79                                        &quot;The body&quot;
 80         );
 81 
 82         assertEquals(EmailAddress.from(&quot;a@b.c&quot;), mail.id());
 83         assertEquals(&quot;hello&quot;, mail.subject());
 84         assertEquals(EmailAddress.from(&quot;B&quot;, &quot;b@b.c&quot;), mail.author());
 85         assertEquals(EmailAddress.from(&quot;B&quot;, &quot;b@b.c&quot;), mail.sender());
 86         assertEquals(List.of(EmailAddress.from(&quot;C&quot;, &quot;c@c.c&quot;),
 87                              EmailAddress.from(&quot;d@d.c&quot;)),
 88                      mail.recipients());
 89         assertEquals(&quot;The body&quot;, mail.body());
</pre>
</td>
<td>
<hr />
<pre>
 50                      mail.recipients());
 51         assertEquals(&quot;The body&quot;, mail.body());
 52     }
 53 
 54     @Test
 55     void buildFrom() {
 56         var original = Email.create(EmailAddress.from(&quot;A&quot;, &quot;a@b.c&quot;), &quot;Subject&quot;, &quot;body&quot;)
 57                             .header(&quot;X&quot;, &quot;y&quot;)
 58                             .header(&quot;Z&quot;, &quot;a&quot;)
 59                             .recipient(EmailAddress.from(&quot;B&quot;, &quot;b@b.c&quot;))
 60                             .build();
 61         var copy = Email.from(original).build();
 62         assertEquals(&quot;Subject&quot;, copy.subject());
 63         assertEquals(&quot;body&quot;, copy.body());
 64         assertEquals(Set.of(&quot;X&quot;, &quot;Z&quot;), copy.headers());
 65         assertEquals(&quot;y&quot;, copy.headerValue(&quot;X&quot;));
 66         assertEquals(&quot;a&quot;, copy.headerValue(&quot;z&quot;));
 67         assertEquals(original, copy);
 68     }
 69 
<span class="line-added"> 70     @Test</span>
<span class="line-added"> 71     void reparent() {</span>
<span class="line-added"> 72         var first = Email.create(EmailAddress.from(&quot;A&quot;, &quot;a@b.c&quot;), &quot;First&quot;, &quot;body&quot;)</span>
<span class="line-added"> 73                          .recipient(EmailAddress.from(&quot;B&quot;, &quot;b@b.c&quot;))</span>
<span class="line-added"> 74                          .build();</span>
<span class="line-added"> 75         var second = Email.create(EmailAddress.from(&quot;A&quot;, &quot;a@b.c&quot;), &quot;Second&quot;, &quot;body&quot;)</span>
<span class="line-added"> 76                           .recipient(EmailAddress.from(&quot;B&quot;, &quot;b@b.c&quot;))</span>
<span class="line-added"> 77                           .build();</span>
<span class="line-added"> 78         var reply = Email.reply(first, &quot;The reply&quot;, &quot;reply body&quot;)</span>
<span class="line-added"> 79                          .author(EmailAddress.from(&quot;C&quot;, &quot;c@b.c&quot;))</span>
<span class="line-added"> 80                          .build();</span>
<span class="line-added"> 81         assertEquals(first.id().toString(), reply.headerValue(&quot;In-Reply-To&quot;));</span>
<span class="line-added"> 82         assertEquals(first.id().toString(), reply.headerValue(&quot;References&quot;));</span>
<span class="line-added"> 83         var updated = Email.reparent(second, reply).build();</span>
<span class="line-added"> 84         assertEquals(second.id().toString(), updated.headerValue(&quot;In-Reply-To&quot;));</span>
<span class="line-added"> 85         assertEquals(second.id().toString(), updated.headerValue(&quot;References&quot;));</span>
<span class="line-added"> 86     }</span>
<span class="line-added"> 87 </span>
 88     @Test
 89     void caseInsensitiveHeaders() {
 90         var mail = Email.parse(&quot;Message-ID: &lt;a@b.c&gt;\n&quot; +
 91                                        &quot;date: Wed, 27 Mar 2019 14:31:00 +0100\n&quot; +
 92                                        &quot;SUBJECT: hello\n&quot; +
 93                                        &quot;FRom: B &lt;b@b.c&gt;\n&quot; +
 94                                        &quot;tO: C &lt;c@c.c&gt;, &lt;d@d.c&gt;\n&quot; +
 95                                        &quot;Extra-header: hello\n&quot; +
 96                                        &quot;\n&quot; +
 97                                        &quot;The body&quot;
 98         );
 99 
100         assertEquals(EmailAddress.from(&quot;a@b.c&quot;), mail.id());
101         assertEquals(&quot;hello&quot;, mail.subject());
102         assertEquals(EmailAddress.from(&quot;B&quot;, &quot;b@b.c&quot;), mail.author());
103         assertEquals(EmailAddress.from(&quot;B&quot;, &quot;b@b.c&quot;), mail.sender());
104         assertEquals(List.of(EmailAddress.from(&quot;C&quot;, &quot;c@c.c&quot;),
105                              EmailAddress.from(&quot;d@d.c&quot;)),
106                      mail.recipients());
107         assertEquals(&quot;The body&quot;, mail.body());
</pre>
</td>
</tr>
</table>
<center><a href="../../../../../../main/java/org/openjdk/skara/email/Email.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>