<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff bots/mlbridge/src/test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MailingListArchiveReaderBotTests.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>bots/mlbridge/src/test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 109,11 ***</span>
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
                                                   Set.of(&quot;rfr&quot;), Map.of(ignored.host().getCurrentUserDetails().userName(),
<span class="line-modified">!                                                                        Pattern.compile(&quot;ready&quot;)));</span>
  
              // Populate the projects repository
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType());
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
              localRepo.push(masterHash, author.getUrl(), &quot;master&quot;, true);
<span class="line-new-header">--- 109,12 ---</span>
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
                                                   Set.of(&quot;rfr&quot;), Map.of(ignored.host().getCurrentUserDetails().userName(),
<span class="line-modified">!                                                                        Pattern.compile(&quot;ready&quot;)),</span>
<span class="line-added">+                                                  Map.of(&quot;Extra1&quot;, &quot;val1&quot;, &quot;Extra2&quot;, &quot;val2&quot;));</span>
  
              // Populate the projects repository
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType());
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
              localRepo.push(masterHash, author.getUrl(), &quot;master&quot;, true);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 183,10 ***</span>
<span class="line-new-header">--- 184,12 ---</span>
              var mail = conversations.get(0).first();
              assertEquals(&quot;RFR: This is a pull request&quot;, mail.subject());
              assertEquals(pr.getAuthor().fullName(), mail.author().fullName().orElseThrow());
              assertEquals(noreplyAddress(archive), mail.author().address());
              assertEquals(from, mail.sender());
<span class="line-added">+             assertEquals(&quot;val1&quot;, mail.headerValue(&quot;Extra1&quot;));</span>
<span class="line-added">+             assertEquals(&quot;val2&quot;, mail.headerValue(&quot;Extra2&quot;));</span>
  
              // And there should be a webrev
              Repository.materialize(webrevFolder.path(), archive.getUrl(), &quot;webrev&quot;);
              assertTrue(webrevContains(webrevFolder.path(), &quot;1 lines changed&quot;));
              var comments = pr.getComments();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 258,11 ***</span>
                                                   Set.of(ignored.host().getCurrentUserDetails().userName()),
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
<span class="line-new-header">--- 261,11 ---</span>
                                                   Set.of(ignored.host().getCurrentUserDetails().userName()),
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 344,11 ***</span>
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
<span class="line-new-header">--- 347,11 ---</span>
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 425,11 ***</span>
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
<span class="line-new-header">--- 428,11 ---</span>
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 533,11 ***</span>
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
<span class="line-new-header">--- 536,11 ---</span>
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 582,11 ***</span>
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
<span class="line-new-header">--- 585,11 ---</span>
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(),
                                                   listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 649,11 ***</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
<span class="line-new-header">--- 652,11 ---</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 706,11 ***</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
<span class="line-new-header">--- 709,11 ---</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 825,11 ***</span>
              var mlBot = new MailingListBridgeBot(sender, author, archive, censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path().resolve(&quot;first&quot;), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
<span class="line-new-header">--- 828,11 ---</span>
              var mlBot = new MailingListBridgeBot(sender, author, archive, censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path().resolve(&quot;first&quot;), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 916,11 ***</span>
                                                   Set.of(ignored.host().getCurrentUserDetails().userName()),
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType());
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
              localRepo.push(masterHash, author.getUrl(), &quot;master&quot;, true);
<span class="line-new-header">--- 919,11 ---</span>
                                                   Set.of(ignored.host().getCurrentUserDetails().userName()),
                                                   Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType());
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
              localRepo.push(masterHash, author.getUrl(), &quot;master&quot;, true);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 987,11 ***</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
<span class="line-new-header">--- 990,11 ---</span>
              var mlBot = new MailingListBridgeBot(from, author, archive, censusBuilder.build(), &quot;master&quot;,
                                                   listAddress, Set.of(), Set.of(),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1069,11 ***</span>
                                                   Set.of(ignored.host().getCurrentUserDetails().userName()),
                                                   Set.of(Pattern.compile(&quot;ignore this comment&quot;, Pattern.MULTILINE | Pattern.DOTALL)),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
<span class="line-new-header">--- 1072,11 ---</span>
                                                   Set.of(ignored.host().getCurrentUserDetails().userName()),
                                                   Set.of(Pattern.compile(&quot;ignore this comment&quot;, Pattern.MULTILINE | Pattern.DOTALL)),
                                                   listServer.getArchive(), listServer.getSMTP(),
                                                   archive, &quot;webrev&quot;, Path.of(&quot;test&quot;),
                                                   URIBuilder.base(&quot;http://www.test.test/&quot;).build(),
<span class="line-modified">!                                                  Set.of(), Map.of(), Map.of());</span>
  
              // Populate the projects repository
              var reviewFile = Path.of(&quot;reviewfile.txt&quot;);
              var localRepo = CheckableRepository.init(tempFolder.path(), author.getRepositoryType(), reviewFile);
              var masterHash = localRepo.resolve(&quot;master&quot;).orElseThrow();
</pre>
<center><a href="MailingListArchiveReaderBotTests.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>