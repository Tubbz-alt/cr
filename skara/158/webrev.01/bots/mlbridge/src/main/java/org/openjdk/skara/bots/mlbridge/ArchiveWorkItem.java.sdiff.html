<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff bots/mlbridge/src/main/java/org/openjdk/skara/bots/mlbridge/ArchiveWorkItem.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="MailingListBridgeBot.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>bots/mlbridge/src/main/java/org/openjdk/skara/bots/mlbridge/ArchiveWorkItem.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
297             reviewArchive.addReviewComment(reviewComment);
298         }
299 
300         var newMails = reviewArchive.generatedEmails();
301         if (newMails.isEmpty()) {
302             return;
303         }
304 
305         // Push all new mails to the archive repository
306         newMails.forEach(reviewArchiveList::post);
307         pushMbox(archiveRepo, &quot;Adding comments for PR &quot; + bot.codeRepo().getName() + &quot;/&quot; + pr.getId());
308 
309         // Finally post all new mails to the actual list
310         for (var newMail : newMails) {
311             var filteredHeaders = newMail.headers().stream()
312                                          .filter(header -&gt; !header.startsWith(&quot;PR-&quot;))
313                                          .collect(Collectors.toMap(Function.identity(),
314                                                                    newMail::headerValue));
315             var filteredEmail = Email.from(newMail)
316                                      .replaceHeaders(filteredHeaders)

317                                      .build();
318             list.post(filteredEmail);
319         }
320     }
321 
322     @Override
323     public void handleRuntimeException(RuntimeException e) {
324         exceptionConsumer.accept(e);
325     }
326 }
</pre>
</td>
<td>
<hr />
<pre>
297             reviewArchive.addReviewComment(reviewComment);
298         }
299 
300         var newMails = reviewArchive.generatedEmails();
301         if (newMails.isEmpty()) {
302             return;
303         }
304 
305         // Push all new mails to the archive repository
306         newMails.forEach(reviewArchiveList::post);
307         pushMbox(archiveRepo, &quot;Adding comments for PR &quot; + bot.codeRepo().getName() + &quot;/&quot; + pr.getId());
308 
309         // Finally post all new mails to the actual list
310         for (var newMail : newMails) {
311             var filteredHeaders = newMail.headers().stream()
312                                          .filter(header -&gt; !header.startsWith(&quot;PR-&quot;))
313                                          .collect(Collectors.toMap(Function.identity(),
314                                                                    newMail::headerValue));
315             var filteredEmail = Email.from(newMail)
316                                      .replaceHeaders(filteredHeaders)
<span class="line-added">317                                      .headers(bot.headers())</span>
318                                      .build();
319             list.post(filteredEmail);
320         }
321     }
322 
323     @Override
324     public void handleRuntimeException(RuntimeException e) {
325         exceptionConsumer.accept(e);
326     }
327 }
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="MailingListBridgeBot.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>