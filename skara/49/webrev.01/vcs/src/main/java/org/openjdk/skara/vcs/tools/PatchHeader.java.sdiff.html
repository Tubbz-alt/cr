<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff vcs/src/main/java/org/openjdk/skara/vcs/tools/PatchHeader.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../resources/ext.py.sdiff.html" target="_top">next &gt;</a></center>    <h2>vcs/src/main/java/org/openjdk/skara/vcs/tools/PatchHeader.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 65     public Path targetPath() {
 66         return targetPath;
 67     }
 68 
 69     public FileType targetFileType() {
 70         return targetFileType;
 71     }
 72 
 73     public Hash targetHash() {
 74         return targetHash;
 75     }
 76 
 77     public Status status() {
 78         return status;
 79     }
 80 
 81     public static PatchHeader fromRawLine(String line) {
 82         if (line == null || line.isEmpty() || line.charAt(0) != &#39;:&#39;) {
 83             throw new IllegalArgumentException(&quot;Raw line does not start with colon: &quot; + line);
 84         }
<span class="line-modified"> 85         line = line.substring(1); // skip the first &#39;:&#39; char</span>

 86 
<span class="line-modified"> 87         var words = line.split(&quot;\\s&quot;);</span>
<span class="line-modified"> 88         var sourceType = FileType.fromOctal(words[0]);</span>
<span class="line-removed"> 89         var targetType = FileType.fromOctal(words[1]);</span>
 90 
<span class="line-modified"> 91         var sourceHash = new Hash(words[2]);</span>
<span class="line-modified"> 92         var targetHash = new Hash(words[3]);</span>
<span class="line-modified"> 93 </span>
<span class="line-removed"> 94         var status = Status.from(words[4]);</span>
 95 
 96         Path sourcePath = null;
 97         Path targetPath = null;
 98         if (status.isModified()) {
<span class="line-modified"> 99             sourcePath = Path.of(words[5]);</span>
100             targetPath = sourcePath;
101         } else if (status.isAdded()) {
<span class="line-modified">102             targetPath = Path.of(words[5]);</span>
103         } else if (status.isDeleted()) {
<span class="line-modified">104             sourcePath = Path.of(words[5]);</span>
105         } else {
106             // either copied or renamed
<span class="line-modified">107             sourcePath = Path.of(words[5]);</span>
<span class="line-modified">108             targetPath = Path.of(words[6]);</span>
109         }
110 
111         return new PatchHeader(sourcePath, sourceType, sourceHash, targetPath, targetType, targetHash, status);
112     }
113 
114     public String toRawLine() {
115         var sb = new StringBuilder();
116         sb.append(&quot;:&quot;);
117         if (sourceFileType == null) {
118             sb.append(&quot;000000&quot;);
119         } else {
120             sb.append(sourceFileType.toOctal());
121         }
122         sb.append(&quot; &quot;);
123         if (targetFileType == null) {
124             sb.append(&quot;000000&quot;);
125         } else {
126             sb.append(targetFileType.toOctal());
127         }
128         sb.append(&quot; &quot;);
</pre>
</td>
<td>
<hr />
<pre>
 65     public Path targetPath() {
 66         return targetPath;
 67     }
 68 
 69     public FileType targetFileType() {
 70         return targetFileType;
 71     }
 72 
 73     public Hash targetHash() {
 74         return targetHash;
 75     }
 76 
 77     public Status status() {
 78         return status;
 79     }
 80 
 81     public static PatchHeader fromRawLine(String line) {
 82         if (line == null || line.isEmpty() || line.charAt(0) != &#39;:&#39;) {
 83             throw new IllegalArgumentException(&quot;Raw line does not start with colon: &quot; + line);
 84         }
<span class="line-modified"> 85         var sourceType = FileType.fromOctal(line.substring(1, 7));</span>
<span class="line-added"> 86         var targetType = FileType.fromOctal(line.substring(8, 14));</span>
 87 
<span class="line-modified"> 88         var sourceHash = new Hash(line.substring(15, 55));</span>
<span class="line-modified"> 89         var targetHash = new Hash(line.substring(56, 96));</span>

 90 
<span class="line-modified"> 91         var rest = line.substring(97);</span>
<span class="line-modified"> 92         var parts = rest.split(&quot;\t&quot;);</span>
<span class="line-modified"> 93         var status = Status.from(parts[0]);</span>

 94 
 95         Path sourcePath = null;
 96         Path targetPath = null;
 97         if (status.isModified()) {
<span class="line-modified"> 98             sourcePath = Path.of(parts[1]);</span>
 99             targetPath = sourcePath;
100         } else if (status.isAdded()) {
<span class="line-modified">101             targetPath = Path.of(parts[1]);</span>
102         } else if (status.isDeleted()) {
<span class="line-modified">103             sourcePath = Path.of(parts[1]);</span>
104         } else {
105             // either copied or renamed
<span class="line-modified">106             sourcePath = Path.of(parts[1]);</span>
<span class="line-modified">107             targetPath = Path.of(parts[2]);</span>
108         }
109 
110         return new PatchHeader(sourcePath, sourceType, sourceHash, targetPath, targetType, targetHash, status);
111     }
112 
113     public String toRawLine() {
114         var sb = new StringBuilder();
115         sb.append(&quot;:&quot;);
116         if (sourceFileType == null) {
117             sb.append(&quot;000000&quot;);
118         } else {
119             sb.append(sourceFileType.toOctal());
120         }
121         sb.append(&quot; &quot;);
122         if (targetFileType == null) {
123             sb.append(&quot;000000&quot;);
124         } else {
125             sb.append(targetFileType.toOctal());
126         }
127         sb.append(&quot; &quot;);
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../resources/ext.py.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>