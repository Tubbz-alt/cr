<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff buildSrc/proxy/src/main/java/org/openjdk/skara/gradle/proxy/ProxyPlugin.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>buildSrc/proxy/src/main/java/org/openjdk/skara/gradle/proxy/ProxyPlugin.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -24,11 +24,14 @@</span>
  package org.openjdk.skara.gradle.proxy;
  
  import org.gradle.api.Plugin;
  import org.gradle.api.Project;
  
<span class="udiff-line-modified-removed">- import java.net.*;</span>
<span class="udiff-line-modified-added">+ import java.net.URI;</span>
<span class="udiff-line-added">+ import java.util.Arrays;</span>
  import java.util.List;
<span class="udiff-line-added">+ import java.util.stream.Collectors;</span>
  
  public class ProxyPlugin implements Plugin&lt;Project&gt; {
      public void apply(Project project) {
          for (var key : List.of(&quot;http_proxy&quot;, &quot;https_proxy&quot;)) {
              var value = System.getenv(key);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -43,15 +45,13 @@</span>
                  }
              }
          }
          var no_proxy = System.getenv(&quot;no_proxy&quot;);
          no_proxy = no_proxy == null ? System.getenv(&quot;NO_PROXY&quot;) : no_proxy;
<span class="udiff-line-modified-removed">-         if (no_proxy != null) {</span>
<span class="udiff-line-modified-removed">-             var hosts = no_proxy.replace(&quot;,&quot;, &quot;|&quot;)</span>
<span class="udiff-line-modified-removed">-                                 .replaceAll(&quot;^\\.&quot;, &quot;*.&quot;)</span>
<span class="udiff-line-modified-removed">-                                 .replaceAll(&quot;\\|\\.&quot;, &quot;|*.&quot;);</span>
<span class="udiff-line-modified-removed">-             if (System.getProperty(&quot;http.nonProxyHosts&quot;) == null) {</span>
<span class="udiff-line-removed">-                 System.setProperty(&quot;http.nonProxyHosts&quot;, hosts);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-modified-added">+         if (no_proxy != null &amp;&amp; System.getProperty(&quot;http.nonProxyHosts&quot;) == null) {</span>
<span class="udiff-line-modified-added">+             var hosts = Arrays.stream(no_proxy.split(&quot;,&quot;))</span>
<span class="udiff-line-modified-added">+                               .map(s -&gt; s.startsWith(&quot;.&quot;) ? &quot;*&quot; + s : s)</span>
<span class="udiff-line-modified-added">+                               .collect(Collectors.toList());</span>
<span class="udiff-line-modified-added">+             System.setProperty(&quot;http.nonProxyHosts&quot;, String.join(&quot;|&quot;, hosts));</span>
          }
      }
  }
</pre>
<center>&lt; prev <a href="../../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>