<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff cli/src/main/java/org/openjdk/skara/cli/GitPr.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="GitPublish.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>cli/src/main/java/org/openjdk/skara/cli/GitPr.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
303                   .helptext(&quot;Comma separated list of assignees&quot;)
304                   .optional(),
305             Option.shortcut(&quot;&quot;)
306                   .fullname(&quot;labels&quot;)
307                   .describe(&quot;LIST&quot;)
308                   .helptext(&quot;Comma separated list of labels&quot;)
309                   .optional(),
310             Option.shortcut(&quot;&quot;)
311                   .fullname(&quot;columns&quot;)
312                   .describe(&quot;id,title,author,assignees,labels&quot;)
313                   .helptext(&quot;Comma separated list of columns to show&quot;)
314                   .optional(),
315             Switch.shortcut(&quot;&quot;)
316                   .fullname(&quot;no-decoration&quot;)
317                   .helptext(&quot;Hide any decorations when listing PRs&quot;)
318                   .optional(),
319             Switch.shortcut(&quot;&quot;)
320                   .fullname(&quot;ignore-workspace&quot;)
321                   .helptext(&quot;Ignore local changes in worktree and staging area when creating pull request&quot;)
322                   .optional(),




323             Switch.shortcut(&quot;&quot;)
324                   .fullname(&quot;no-token&quot;)
325                   .helptext(&quot;Do not use a personal access token (PAT). Only works for read-only operations.&quot;)
326                   .optional(),
327             Switch.shortcut(&quot;&quot;)
328                   .fullname(&quot;mercurial&quot;)
329                   .helptext(&quot;Force use of Mercurial (hg)&quot;)
330                   .optional(),
331             Switch.shortcut(&quot;&quot;)
332                   .fullname(&quot;verbose&quot;)
333                   .helptext(&quot;Turn on verbose output&quot;)
334                   .optional(),
335             Switch.shortcut(&quot;&quot;)
336                   .fullname(&quot;debug&quot;)
337                   .helptext(&quot;Turn on debugging output&quot;)
338                   .optional(),
339             Switch.shortcut(&quot;&quot;)
340                   .fullname(&quot;version&quot;)
341                   .helptext(&quot;Print the version of this tool&quot;)
342                   .optional());
</pre>
<hr />
<pre>
614                         var path = patch.target().path().isPresent() ?
615                             patch.target().path().get() : patch.source().path().get();
616                         System.err.println(&quot;    &quot; + patch.status().toString() + &quot; &quot; + path.toString());
617                     }
618                     System.err.println(&quot;&quot;);
619                     System.err.println(&quot;If these changes are meant to be part of the pull request, run:&quot;);
620                     System.err.println(&quot;&quot;);
621                     System.err.println(&quot;    git commit -am &#39;Forgot to add some changes&#39;&quot;);
622                     System.err.println(&quot;&quot;);
623                     System.err.println(&quot;If these changes are *not* meant to be part of the pull request, run:&quot;);
624                     System.err.println(&quot;&quot;);
625                     System.err.println(&quot;    git stash&quot;);
626                     System.err.println(&quot;&quot;);
627                     System.err.println(&quot;(You can later restore the changes by running: git stash pop)&quot;);
628                     System.exit(1);
629                 }
630             }
631 
632             var upstream = repo.upstreamFor(currentBranch);
633             if (upstream.isEmpty()) {
<span class="line-modified">634                 System.err.println(&quot;error: there is no remote branch for the local branch &#39;&quot; + currentBranch.name() + &quot;&#39;&quot;);</span>
<span class="line-modified">635                 System.err.println(&quot;&quot;);</span>
<span class="line-modified">636                 System.err.println(&quot;A remote branch must be present at &quot; + remotePullPath + &quot; to create a pull request&quot;);</span>
<span class="line-modified">637                 System.err.println(&quot;To create a remote branch and push the commits for your local branch, run:&quot;);</span>
<span class="line-modified">638                 System.err.println(&quot;&quot;);</span>
<span class="line-modified">639                 System.err.println(&quot;    git publish&quot;);</span>
<span class="line-modified">640                 System.err.println(&quot;&quot;);</span>
<span class="line-modified">641                 System.err.println(&quot;If you created the remote branch from another client, you must update this repository.&quot;);</span>
<span class="line-modified">642                 System.err.println(&quot;To update remote information for this repository, run:&quot;);</span>
<span class="line-modified">643                 System.err.println(&quot;&quot;);</span>
<span class="line-modified">644                 System.err.println(&quot;    git fetch &quot; + remote);</span>
<span class="line-modified">645                 System.err.println(&quot;    git branch --set-upstream &quot; + currentBranch + &quot; &quot; + remote + &quot;/&quot; + currentBranch);</span>
<span class="line-modified">646                 System.err.println(&quot;&quot;);</span>
<span class="line-modified">647                 System.exit(1);</span>









648             }
649 
650             var upstreamRefName = upstream.get().substring(remote.length() + 1);
651             repo.fetch(uri, upstreamRefName);
652             var branchCommits = repo.commits(upstream.get() + &quot;..&quot; + currentBranch.name()).asList();
653             if (!branchCommits.isEmpty()) {
654                 System.err.println(&quot;error: there are local commits on branch &#39;&quot; + currentBranch.name() + &quot;&#39; not present in the remote repository &quot; + remotePullPath);
655                 System.err.println(&quot;&quot;);
656                 System.err.println(&quot;All commits must be present in the remote repository to be part of the pull request&quot;);
657                 System.err.println(&quot;The following commits are not present in the remote repository:&quot;);
658                 System.err.println(&quot;&quot;);
659                 for (var commit : branchCommits) {
660                     System.err.println(&quot;- &quot; + commit.hash().abbreviate() + &quot;: &quot; + commit.message().get(0));
661                 }
662                 System.err.println(&quot;&quot;);
663                 System.err.println(&quot;To push the above local commits to the remote repository, run:&quot;);
664                 System.err.println(&quot;&quot;);
665                 System.err.println(&quot;    git push &quot; + remote + &quot; &quot; + currentBranch.name());
666                 System.err.println(&quot;&quot;);
667                 System.exit(1);
</pre>
</td>
<td>
<hr />
<pre>
303                   .helptext(&quot;Comma separated list of assignees&quot;)
304                   .optional(),
305             Option.shortcut(&quot;&quot;)
306                   .fullname(&quot;labels&quot;)
307                   .describe(&quot;LIST&quot;)
308                   .helptext(&quot;Comma separated list of labels&quot;)
309                   .optional(),
310             Option.shortcut(&quot;&quot;)
311                   .fullname(&quot;columns&quot;)
312                   .describe(&quot;id,title,author,assignees,labels&quot;)
313                   .helptext(&quot;Comma separated list of columns to show&quot;)
314                   .optional(),
315             Switch.shortcut(&quot;&quot;)
316                   .fullname(&quot;no-decoration&quot;)
317                   .helptext(&quot;Hide any decorations when listing PRs&quot;)
318                   .optional(),
319             Switch.shortcut(&quot;&quot;)
320                   .fullname(&quot;ignore-workspace&quot;)
321                   .helptext(&quot;Ignore local changes in worktree and staging area when creating pull request&quot;)
322                   .optional(),
<span class="line-added">323             Switch.shortcut(&quot;&quot;)</span>
<span class="line-added">324                   .fullname(&quot;publish&quot;)</span>
<span class="line-added">325                   .helptext(&quot;Publish the local branch before creating the pull request&quot;)</span>
<span class="line-added">326                   .optional(),</span>
327             Switch.shortcut(&quot;&quot;)
328                   .fullname(&quot;no-token&quot;)
329                   .helptext(&quot;Do not use a personal access token (PAT). Only works for read-only operations.&quot;)
330                   .optional(),
331             Switch.shortcut(&quot;&quot;)
332                   .fullname(&quot;mercurial&quot;)
333                   .helptext(&quot;Force use of Mercurial (hg)&quot;)
334                   .optional(),
335             Switch.shortcut(&quot;&quot;)
336                   .fullname(&quot;verbose&quot;)
337                   .helptext(&quot;Turn on verbose output&quot;)
338                   .optional(),
339             Switch.shortcut(&quot;&quot;)
340                   .fullname(&quot;debug&quot;)
341                   .helptext(&quot;Turn on debugging output&quot;)
342                   .optional(),
343             Switch.shortcut(&quot;&quot;)
344                   .fullname(&quot;version&quot;)
345                   .helptext(&quot;Print the version of this tool&quot;)
346                   .optional());
</pre>
<hr />
<pre>
618                         var path = patch.target().path().isPresent() ?
619                             patch.target().path().get() : patch.source().path().get();
620                         System.err.println(&quot;    &quot; + patch.status().toString() + &quot; &quot; + path.toString());
621                     }
622                     System.err.println(&quot;&quot;);
623                     System.err.println(&quot;If these changes are meant to be part of the pull request, run:&quot;);
624                     System.err.println(&quot;&quot;);
625                     System.err.println(&quot;    git commit -am &#39;Forgot to add some changes&#39;&quot;);
626                     System.err.println(&quot;&quot;);
627                     System.err.println(&quot;If these changes are *not* meant to be part of the pull request, run:&quot;);
628                     System.err.println(&quot;&quot;);
629                     System.err.println(&quot;    git stash&quot;);
630                     System.err.println(&quot;&quot;);
631                     System.err.println(&quot;(You can later restore the changes by running: git stash pop)&quot;);
632                     System.exit(1);
633                 }
634             }
635 
636             var upstream = repo.upstreamFor(currentBranch);
637             if (upstream.isEmpty()) {
<span class="line-modified">638                 var shouldPublish = arguments.contains(&quot;publish&quot;);</span>
<span class="line-modified">639                 if (!shouldPublish) {</span>
<span class="line-modified">640                     var lines = repo.config(&quot;pr.publish&quot;);</span>
<span class="line-modified">641                     shouldPublish = lines.size() == 1 &amp;&amp; lines.get(0).toLowerCase().equals(&quot;true&quot;);</span>
<span class="line-modified">642                 }</span>
<span class="line-modified">643                 if (shouldPublish) {</span>
<span class="line-modified">644                     GitPublish.main(new String[] { remote });</span>
<span class="line-modified">645                 } else {</span>
<span class="line-modified">646                     System.err.println(&quot;error: there is no remote branch for the local branch &#39;&quot; + currentBranch.name() + &quot;&#39;&quot;);</span>
<span class="line-modified">647                     System.err.println(&quot;&quot;);</span>
<span class="line-modified">648                     System.err.println(&quot;A remote branch must be present at &quot; + remotePullPath + &quot; to create a pull request&quot;);</span>
<span class="line-modified">649                     System.err.println(&quot;To create a remote branch and push the commits for your local branch, run:&quot;);</span>
<span class="line-modified">650                     System.err.println(&quot;&quot;);</span>
<span class="line-modified">651                     System.err.println(&quot;    git publish&quot;);</span>
<span class="line-added">652                     System.err.println(&quot;&quot;);</span>
<span class="line-added">653                     System.err.println(&quot;If you created the remote branch from another client, you must update this repository.&quot;);</span>
<span class="line-added">654                     System.err.println(&quot;To update remote information for this repository, run:&quot;);</span>
<span class="line-added">655                     System.err.println(&quot;&quot;);</span>
<span class="line-added">656                     System.err.println(&quot;    git fetch &quot; + remote);</span>
<span class="line-added">657                     System.err.println(&quot;    git branch --set-upstream &quot; + currentBranch + &quot; &quot; + remote + &quot;/&quot; + currentBranch);</span>
<span class="line-added">658                     System.err.println(&quot;&quot;);</span>
<span class="line-added">659                     System.exit(1);</span>
<span class="line-added">660                 }</span>
661             }
662 
663             var upstreamRefName = upstream.get().substring(remote.length() + 1);
664             repo.fetch(uri, upstreamRefName);
665             var branchCommits = repo.commits(upstream.get() + &quot;..&quot; + currentBranch.name()).asList();
666             if (!branchCommits.isEmpty()) {
667                 System.err.println(&quot;error: there are local commits on branch &#39;&quot; + currentBranch.name() + &quot;&#39; not present in the remote repository &quot; + remotePullPath);
668                 System.err.println(&quot;&quot;);
669                 System.err.println(&quot;All commits must be present in the remote repository to be part of the pull request&quot;);
670                 System.err.println(&quot;The following commits are not present in the remote repository:&quot;);
671                 System.err.println(&quot;&quot;);
672                 for (var commit : branchCommits) {
673                     System.err.println(&quot;- &quot; + commit.hash().abbreviate() + &quot;: &quot; + commit.message().get(0));
674                 }
675                 System.err.println(&quot;&quot;);
676                 System.err.println(&quot;To push the above local commits to the remote repository, run:&quot;);
677                 System.err.println(&quot;&quot;);
678                 System.err.println(&quot;    git push &quot; + remote + &quot; &quot; + currentBranch.name());
679                 System.err.println(&quot;&quot;);
680                 System.exit(1);
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="GitPublish.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>