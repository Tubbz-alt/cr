<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff json/src/main/java/org/openjdk/skara/json/JSONParser.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../test/java/org/openjdk/skara/json/JSONParserTests.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>json/src/main/java/org/openjdk/skara/json/JSONParser.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
220                         var cp = Integer.parseInt(String.format(&quot;%c%c%c%c&quot;, u1, u2, u3, u4), 16);
221                         builder.append(new String(new int[]{cp}, 0, 1));
222                         break;
223                     default:
224                         throw failure(String.format(&quot;Unexpected escaped character &#39;%c&#39;&quot;, n));
225                 }
226             } else {
227                 builder.append(c);
228             }
229         }
230 
231         advance(); // step beyond closing &quot;
232         return new JSONString(builder.toString());
233     }
234 
235     private JSONArray parseArray() {
236         var error = &quot;array is not terminated with &#39;]&#39;&quot;;
237         var list = new ArrayList&lt;JSONValue&gt;();
238 
239         advance(); // step beyond opening &#39;[&#39;

240         expectMoreInput(error);
241 
242         while (current() != &#39;]&#39;) {
243             var val = parseValue();
244             list.add(val);
245 
246             expectMoreInput(error);
247             if (current() == &#39;,&#39;) {
248                 advance();
249             }
250             expectMoreInput(error);
251         }
252 
253         advance(); // step beyond closing &#39;]&#39;
254         return new JSONArray(list.toArray(new JSONValue[0]));
255     }
256 
257     public JSONNull parseNull() {
258         expect(&#39;u&#39;);
259         expect(&#39;l&#39;);
</pre>
<hr />
<pre>
250             expectMoreInput(error);
251         }
252 
253         advance(); // step beyond closing &#39;]&#39;
254         return new JSONArray(list.toArray(new JSONValue[0]));
255     }
256 
257     public JSONNull parseNull() {
258         expect(&#39;u&#39;);
259         expect(&#39;l&#39;);
260         expect(&#39;l&#39;);
261         advance();
262         return new JSONNull();
263     }
264 
265     public JSONObject parseObject() {
266         var error = &quot;object is not terminated with &#39;}&#39;&quot;;
267         var map = new HashMap&lt;String, JSONValue&gt;();
268 
269         advance(); // step beyond opening &#39;{&#39;

270         expectMoreInput(error);
271 
272         while (current() != &#39;}&#39;) {
273             var key = parseValue();
274             if (!(key instanceof JSONString)) {
275                 throw failure(&quot;a field must of type string&quot;);
276             }
277 
278             if (!hasInput() || current() != &#39;:&#39;) {
279                 throw failure(&quot;a field must be followed by &#39;:&#39;&quot;);
280             }
281             advance(); // skip &#39;:&#39;
282 
283             var val = parseValue();
284             map.put(key.asString(), val);
285 
286             expectMoreInput(error);
287             if (current() == &#39;,&#39;) {
288                 advance();
289             }
</pre>
</td>
<td>
<hr />
<pre>
220                         var cp = Integer.parseInt(String.format(&quot;%c%c%c%c&quot;, u1, u2, u3, u4), 16);
221                         builder.append(new String(new int[]{cp}, 0, 1));
222                         break;
223                     default:
224                         throw failure(String.format(&quot;Unexpected escaped character &#39;%c&#39;&quot;, n));
225                 }
226             } else {
227                 builder.append(c);
228             }
229         }
230 
231         advance(); // step beyond closing &quot;
232         return new JSONString(builder.toString());
233     }
234 
235     private JSONArray parseArray() {
236         var error = &quot;array is not terminated with &#39;]&#39;&quot;;
237         var list = new ArrayList&lt;JSONValue&gt;();
238 
239         advance(); // step beyond opening &#39;[&#39;
<span class="line-added">240         consumeWhitespace();</span>
241         expectMoreInput(error);
242 
243         while (current() != &#39;]&#39;) {
244             var val = parseValue();
245             list.add(val);
246 
247             expectMoreInput(error);
248             if (current() == &#39;,&#39;) {
249                 advance();
250             }
251             expectMoreInput(error);
252         }
253 
254         advance(); // step beyond closing &#39;]&#39;
255         return new JSONArray(list.toArray(new JSONValue[0]));
256     }
257 
258     public JSONNull parseNull() {
259         expect(&#39;u&#39;);
260         expect(&#39;l&#39;);
</pre>
<hr />
<pre>
251             expectMoreInput(error);
252         }
253 
254         advance(); // step beyond closing &#39;]&#39;
255         return new JSONArray(list.toArray(new JSONValue[0]));
256     }
257 
258     public JSONNull parseNull() {
259         expect(&#39;u&#39;);
260         expect(&#39;l&#39;);
261         expect(&#39;l&#39;);
262         advance();
263         return new JSONNull();
264     }
265 
266     public JSONObject parseObject() {
267         var error = &quot;object is not terminated with &#39;}&#39;&quot;;
268         var map = new HashMap&lt;String, JSONValue&gt;();
269 
270         advance(); // step beyond opening &#39;{&#39;
<span class="line-added">271         consumeWhitespace();</span>
272         expectMoreInput(error);
273 
274         while (current() != &#39;}&#39;) {
275             var key = parseValue();
276             if (!(key instanceof JSONString)) {
277                 throw failure(&quot;a field must of type string&quot;);
278             }
279 
280             if (!hasInput() || current() != &#39;:&#39;) {
281                 throw failure(&quot;a field must be followed by &#39;:&#39;&quot;);
282             }
283             advance(); // skip &#39;:&#39;
284 
285             var val = parseValue();
286             map.put(key.asString(), val);
287 
288             expectMoreInput(error);
289             if (current() == &#39;,&#39;) {
290                 advance();
291             }
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../test/java/org/openjdk/skara/json/JSONParserTests.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>