<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff bots/mlbridge/src/test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="MailingListArchiveReaderBotTests.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../../notify/src/test/java/org/openjdk/skara/bots/notify/UpdaterTests.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>bots/mlbridge/src/test/java/org/openjdk/skara/bots/mlbridge/MailingListBridgeBotTests.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 195,11 ***</span>
              assertEquals(1, conversations.size());
              var mail = conversations.get(0).first();
              assertEquals(&quot;RFR: 1234: This is a pull request&quot;, mail.subject());
              assertEquals(pr.author().fullName(), mail.author().fullName().orElseThrow());
              assertEquals(noreplyAddress(archive), mail.author().address());
<span class="line-modified">!             assertEquals(from, mail.sender());</span>
              assertEquals(&quot;val1&quot;, mail.headerValue(&quot;Extra1&quot;));
              assertEquals(&quot;val2&quot;, mail.headerValue(&quot;Extra2&quot;));
  
              // And there should be a webrev
              Repository.materialize(webrevFolder.path(), archive.url(), &quot;webrev&quot;);
<span class="line-new-header">--- 195,11 ---</span>
              assertEquals(1, conversations.size());
              var mail = conversations.get(0).first();
              assertEquals(&quot;RFR: 1234: This is a pull request&quot;, mail.subject());
              assertEquals(pr.author().fullName(), mail.author().fullName().orElseThrow());
              assertEquals(noreplyAddress(archive), mail.author().address());
<span class="line-modified">!             assertEquals(listAddress, mail.sender());</span>
              assertEquals(&quot;val1&quot;, mail.headerValue(&quot;Extra1&quot;));
              assertEquals(&quot;val2&quot;, mail.headerValue(&quot;Extra2&quot;));
  
              // And there should be a webrev
              Repository.materialize(webrevFolder.path(), archive.url(), &quot;webrev&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 248,11 ***</span>
              conversations = mailmanList.conversations(Duration.ofDays(1));
              assertEquals(1, conversations.size());
              assertEquals(3, conversations.get(0).allMessages().size());
              for (var newMail : conversations.get(0).allMessages()) {
                  assertEquals(noreplyAddress(archive), newMail.author().address());
<span class="line-modified">!                 assertEquals(from, newMail.sender());</span>
              }
              assertTrue(conversations.get(0).allMessages().get(2).body().contains(&quot;This is a comment ðŸ˜„&quot;));
          }
      }
  
<span class="line-new-header">--- 248,11 ---</span>
              conversations = mailmanList.conversations(Duration.ofDays(1));
              assertEquals(1, conversations.size());
              assertEquals(3, conversations.get(0).allMessages().size());
              for (var newMail : conversations.get(0).allMessages()) {
                  assertEquals(noreplyAddress(archive), newMail.author().address());
<span class="line-modified">!                 assertEquals(listAddress, newMail.sender());</span>
              }
              assertTrue(conversations.get(0).allMessages().get(2).body().contains(&quot;This is a comment ðŸ˜„&quot;));
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 338,11 ***</span>
              conversations = mailmanList.conversations(Duration.ofDays(1));
              assertEquals(1, conversations.size());
              assertEquals(3, conversations.get(0).allMessages().size());
              for (var newMail : conversations.get(0).allMessages()) {
                  assertEquals(noreplyAddress(archive), newMail.author().address());
<span class="line-modified">!                 assertEquals(from, newMail.sender());</span>
              }
          }
      }
  
      @Test
<span class="line-new-header">--- 338,11 ---</span>
              conversations = mailmanList.conversations(Duration.ofDays(1));
              assertEquals(1, conversations.size());
              assertEquals(3, conversations.get(0).allMessages().size());
              for (var newMail : conversations.get(0).allMessages()) {
                  assertEquals(noreplyAddress(archive), newMail.author().address());
<span class="line-modified">!                 assertEquals(listAddress, newMail.sender());</span>
              }
          }
      }
  
      @Test
</pre>
<hr />
<pre>
<span class="line-old-header">*** 811,11 ***</span>
              var mailmanList = mailmanServer.getList(listAddress.address());
              var conversations = mailmanList.conversations(Duration.ofDays(1));
              assertEquals(1, conversations.size());
              for (var newMail : conversations.get(0).allMessages()) {
                  assertEquals(noreplyAddress(archive), newMail.author().address());
<span class="line-modified">!                 assertEquals(from, newMail.sender());</span>
              }
  
              // Add a comment
              var commenterPr = commenter.pullRequest(pr.id());
              commenterPr.addReviewComment(masterHash, nextHash, reviewFile.toString(), 2, &quot;Review comment&quot;);
<span class="line-new-header">--- 811,11 ---</span>
              var mailmanList = mailmanServer.getList(listAddress.address());
              var conversations = mailmanList.conversations(Duration.ofDays(1));
              assertEquals(1, conversations.size());
              for (var newMail : conversations.get(0).allMessages()) {
                  assertEquals(noreplyAddress(archive), newMail.author().address());
<span class="line-modified">!                 assertEquals(listAddress, newMail.sender());</span>
              }
  
              // Add a comment
              var commenterPr = commenter.pullRequest(pr.id());
              commenterPr.addReviewComment(masterHash, nextHash, reviewFile.toString(), 2, &quot;Review comment&quot;);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 931,11 ***</span>
              var mailmanList = mailmanServer.getList(listAddress.address());
              var conversations = mailmanList.conversations(Duration.ofDays(1));
              assertEquals(1, conversations.size());
              for (var newMail : conversations.get(0).allMessages()) {
                  assertEquals(noreplyAddress(archive), newMail.author().address());
<span class="line-modified">!                 assertEquals(sender, newMail.sender());</span>
                  assertFalse(newMail.hasHeader(&quot;PR-Head-Hash&quot;));
              }
              assertEquals(&quot;Re: [Rev 01] RFR: This is a pull request&quot;, conversations.get(0).allMessages().get(1).subject());
          }
      }
<span class="line-new-header">--- 931,11 ---</span>
              var mailmanList = mailmanServer.getList(listAddress.address());
              var conversations = mailmanList.conversations(Duration.ofDays(1));
              assertEquals(1, conversations.size());
              for (var newMail : conversations.get(0).allMessages()) {
                  assertEquals(noreplyAddress(archive), newMail.author().address());
<span class="line-modified">!                 assertEquals(listAddress, newMail.sender());</span>
                  assertFalse(newMail.hasHeader(&quot;PR-Head-Hash&quot;));
              }
              assertEquals(&quot;Re: [Rev 01] RFR: This is a pull request&quot;, conversations.get(0).allMessages().get(1).subject());
          }
      }
</pre>
<center><a href="MailingListArchiveReaderBotTests.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../../notify/src/test/java/org/openjdk/skara/bots/notify/UpdaterTests.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>