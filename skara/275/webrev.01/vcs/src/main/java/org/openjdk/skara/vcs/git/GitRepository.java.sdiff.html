<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff vcs/src/main/java/org/openjdk/skara/vcs/git/GitRepository.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../ReadOnlyRepository.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../hg/HgRepository.java.sdiff.html" target="_top">next &gt;</a></center>    <h2>vcs/src/main/java/org/openjdk/skara/vcs/git/GitRepository.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 802             var path = unpackFile(entry.hash().hex());
 803             Files.createDirectories(to.getParent());
 804             Files.move(path, to, StandardCopyOption.REPLACE_EXISTING);
 805         }
 806     }
 807 
 808     @Override
 809     public List&lt;StatusEntry&gt; status(Hash from, Hash to) throws IOException {
 810         try (var p = capture(&quot;git&quot;, &quot;diff&quot;, &quot;--raw&quot;, &quot;--find-renames=99%&quot;, &quot;--find-copies=99%&quot;, &quot;--find-copies-harder&quot;, &quot;--no-abbrev&quot;, &quot;--no-color&quot;, from.hex(), to.hex())) {
 811             var res = await(p);
 812             var entries = new ArrayList&lt;StatusEntry&gt;();
 813             for (var line : res.stdout()) {
 814                 entries.add(StatusEntry.fromRawLine(line));
 815             }
 816             return entries;
 817         }
 818     }
 819 
 820     @Override
 821     public Diff diff(Hash from) throws IOException {
<span class="line-modified"> 822         return diff(from, null);</span>





 823     }
 824 
 825     @Override
 826     public Diff diff(Hash from, Hash to) throws IOException {





 827         var cmd = new ArrayList&lt;&gt;(List.of(&quot;git&quot;, &quot;diff&quot;, &quot;--patch&quot;,
 828                                                          &quot;--find-renames=99%&quot;,
 829                                                          &quot;--find-copies=99%&quot;,
 830                                                          &quot;--find-copies-harder&quot;,
 831                                                          &quot;--binary&quot;,
 832                                                          &quot;--raw&quot;,
 833                                                          &quot;--no-abbrev&quot;,
 834                                                          &quot;--unified=0&quot;,
 835                                                          &quot;--no-color&quot;,
 836                                                          from.hex()));
 837         if (to != null) {
 838             cmd.add(to.hex());
 839         }
 840 







 841         var p = start(cmd);
 842         try {
 843             var patches = UnifiedDiffParser.parseGitRaw(p.getInputStream());
 844             await(p);
 845             return new Diff(from, to, patches);
 846         } catch (Throwable t) {
 847             stop(p);
 848             throw t;
 849         }
 850     }
 851 
 852     @Override
 853     public List&lt;String&gt; config(String key) throws IOException {
 854         try (var p = capture(&quot;git&quot;, &quot;config&quot;, key)) {
 855             var res = p.await();
 856             return res.status() == 0 ? res.stdout() : List.of();
 857         }
 858     }
 859 
 860     @Override
</pre>
</td>
<td>
<hr />
<pre>
 802             var path = unpackFile(entry.hash().hex());
 803             Files.createDirectories(to.getParent());
 804             Files.move(path, to, StandardCopyOption.REPLACE_EXISTING);
 805         }
 806     }
 807 
 808     @Override
 809     public List&lt;StatusEntry&gt; status(Hash from, Hash to) throws IOException {
 810         try (var p = capture(&quot;git&quot;, &quot;diff&quot;, &quot;--raw&quot;, &quot;--find-renames=99%&quot;, &quot;--find-copies=99%&quot;, &quot;--find-copies-harder&quot;, &quot;--no-abbrev&quot;, &quot;--no-color&quot;, from.hex(), to.hex())) {
 811             var res = await(p);
 812             var entries = new ArrayList&lt;StatusEntry&gt;();
 813             for (var line : res.stdout()) {
 814                 entries.add(StatusEntry.fromRawLine(line));
 815             }
 816             return entries;
 817         }
 818     }
 819 
 820     @Override
 821     public Diff diff(Hash from) throws IOException {
<span class="line-modified"> 822         return diff(from, List.of());</span>
<span class="line-added"> 823     }</span>
<span class="line-added"> 824 </span>
<span class="line-added"> 825     @Override</span>
<span class="line-added"> 826     public Diff diff(Hash from, List&lt;Path&gt; files) throws IOException {</span>
<span class="line-added"> 827         return diff(from, null, files);</span>
 828     }
 829 
 830     @Override
 831     public Diff diff(Hash from, Hash to) throws IOException {
<span class="line-added"> 832         return diff(from, to, List.of());</span>
<span class="line-added"> 833     }</span>
<span class="line-added"> 834 </span>
<span class="line-added"> 835     @Override</span>
<span class="line-added"> 836     public Diff diff(Hash from, Hash to, List&lt;Path&gt; files) throws IOException {</span>
 837         var cmd = new ArrayList&lt;&gt;(List.of(&quot;git&quot;, &quot;diff&quot;, &quot;--patch&quot;,
 838                                                          &quot;--find-renames=99%&quot;,
 839                                                          &quot;--find-copies=99%&quot;,
 840                                                          &quot;--find-copies-harder&quot;,
 841                                                          &quot;--binary&quot;,
 842                                                          &quot;--raw&quot;,
 843                                                          &quot;--no-abbrev&quot;,
 844                                                          &quot;--unified=0&quot;,
 845                                                          &quot;--no-color&quot;,
 846                                                          from.hex()));
 847         if (to != null) {
 848             cmd.add(to.hex());
 849         }
 850 
<span class="line-added"> 851         if (files != null &amp;&amp; !files.isEmpty()) {</span>
<span class="line-added"> 852             cmd.add(&quot;--&quot;);</span>
<span class="line-added"> 853             for (var file : files) {</span>
<span class="line-added"> 854                 cmd.add(file.toString());</span>
<span class="line-added"> 855             }</span>
<span class="line-added"> 856         }</span>
<span class="line-added"> 857 </span>
 858         var p = start(cmd);
 859         try {
 860             var patches = UnifiedDiffParser.parseGitRaw(p.getInputStream());
 861             await(p);
 862             return new Diff(from, to, patches);
 863         } catch (Throwable t) {
 864             stop(p);
 865             throw t;
 866         }
 867     }
 868 
 869     @Override
 870     public List&lt;String&gt; config(String key) throws IOException {
 871         try (var p = capture(&quot;git&quot;, &quot;config&quot;, key)) {
 872             var res = p.await();
 873             return res.status() == 0 ? res.stdout() : List.of();
 874         }
 875     }
 876 
 877     @Override
</pre>
</td>
</tr>
</table>
<center><a href="../ReadOnlyRepository.java.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="../hg/HgRepository.java.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>