<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff cli/src/main/java/org/openjdk/skara/cli/GitPr.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="GitFork.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../forge/src/main/java/org/openjdk/skara/forge/CheckBuilder.java.cdiff.html" target="_top">next &gt;</a></center>    <h2>cli/src/main/java/org/openjdk/skara/cli/GitPr.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 21,24 ***</span>
   * questions.
   */
  package org.openjdk.skara.cli;
  
  import org.openjdk.skara.args.*;
  import org.openjdk.skara.host.*;
<span class="line-removed">- import org.openjdk.skara.vcs.*;</span>
<span class="line-removed">- import org.openjdk.skara.vcs.openjdk.*;</span>
  import org.openjdk.skara.proxy.HttpProxy;
  
  import java.io.IOException;
  import java.net.URI;
  import java.nio.file.*;
  import java.util.*;
  import java.util.concurrent.TimeUnit;
  import java.util.function.Supplier;
  import java.util.logging.Level;
<span class="line-removed">- import java.nio.charset.StandardCharsets;</span>
  
  public class GitPr {
      private static void exit(String fmt, Object...args) {
          System.err.println(String.format(fmt, args));
          System.exit(1);
<span class="line-new-header">--- 21,25 ---</span>
   * questions.
   */
  package org.openjdk.skara.cli;
  
  import org.openjdk.skara.args.*;
<span class="line-added">+ import org.openjdk.skara.forge.*;</span>
  import org.openjdk.skara.host.*;
  import org.openjdk.skara.proxy.HttpProxy;
<span class="line-added">+ import org.openjdk.skara.vcs.*;</span>
<span class="line-added">+ import org.openjdk.skara.vcs.openjdk.CommitMessageParsers;</span>
  
  import java.io.IOException;
  import java.net.URI;
<span class="line-added">+ import java.nio.charset.StandardCharsets;</span>
  import java.nio.file.*;
  import java.util.*;
  import java.util.concurrent.TimeUnit;
  import java.util.function.Supplier;
  import java.util.logging.Level;
  
  public class GitPr {
      private static void exit(String fmt, Object...args) {
          System.err.println(String.format(fmt, args));
          System.exit(1);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 98,11 ***</span>
          }
          return name;
      }
  
      private static HostedRepository getHostedRepositoryFor(URI uri, GitCredentials credentials) throws IOException {
<span class="line-modified">!         var host = RepositoryHost.from(uri, new PersonalAccessToken(credentials.username(), credentials.password()));</span>
          if (System.getenv(&quot;GIT_TOKEN&quot;) == null) {
              GitCredentials.approve(credentials);
          }
          var remoteRepo = host.repository(projectName(uri));
          var parentRepo = remoteRepo.parent();
<span class="line-new-header">--- 99,11 ---</span>
          }
          return name;
      }
  
      private static HostedRepository getHostedRepositoryFor(URI uri, GitCredentials credentials) throws IOException {
<span class="line-modified">!         var host = Forge.from(uri, new PersonalAccessToken(credentials.username(), credentials.password()));</span>
          if (System.getenv(&quot;GIT_TOKEN&quot;) == null) {
              GitCredentials.approve(credentials);
          }
          var remoteRepo = host.repository(projectName(uri));
          var parentRepo = remoteRepo.parent();
</pre>
<hr />
<pre>
<span class="line-old-header">*** 306,11 ***</span>
          var remotePullPath = repo.pullPath(remote);
          var username = arguments.contains(&quot;username&quot;) ? arguments.get(&quot;username&quot;).asString() : null;
          var token = isMercurial ? System.getenv(&quot;HG_TOKEN&quot;) :  System.getenv(&quot;GIT_TOKEN&quot;);
          var uri = Remote.toWebURI(remotePullPath);
          var credentials = GitCredentials.fill(uri.getHost(), uri.getPath(), username, token, uri.getScheme());
<span class="line-modified">!         var host = RepositoryHost.from(uri, new PersonalAccessToken(credentials.username(), credentials.password()));</span>
  
          var action = arguments.at(0).asString();
          if (action.equals(&quot;create&quot;)) {
              if (isMercurial) {
                  var currentBookmark = repo.currentBookmark();
<span class="line-new-header">--- 307,11 ---</span>
          var remotePullPath = repo.pullPath(remote);
          var username = arguments.contains(&quot;username&quot;) ? arguments.get(&quot;username&quot;).asString() : null;
          var token = isMercurial ? System.getenv(&quot;HG_TOKEN&quot;) :  System.getenv(&quot;GIT_TOKEN&quot;);
          var uri = Remote.toWebURI(remotePullPath);
          var credentials = GitCredentials.fill(uri.getHost(), uri.getPath(), username, token, uri.getScheme());
<span class="line-modified">!         var host = Forge.from(uri, new PersonalAccessToken(credentials.username(), credentials.password()));</span>
  
          var action = arguments.at(0).asString();
          if (action.equals(&quot;create&quot;)) {
              if (isMercurial) {
                  var currentBookmark = repo.currentBookmark();
</pre>
<center><a href="GitFork.java.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../../../../../../../forge/src/main/java/org/openjdk/skara/forge/CheckBuilder.java.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>