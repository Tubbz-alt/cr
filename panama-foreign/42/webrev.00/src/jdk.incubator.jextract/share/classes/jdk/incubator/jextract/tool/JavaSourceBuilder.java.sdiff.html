<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff src/jdk.incubator.jextract/share/classes/jdk/incubator/jextract/tool/JavaSourceBuilder.java</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>src/jdk.incubator.jextract/share/classes/jdk/incubator/jextract/tool/JavaSourceBuilder.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
285     }
286 
287     protected void addAddress(String name) {
288         incrAlign();
289         indent();
290         sb.append(PUB_MODS + &quot;MemoryAddress &quot; + javaSafeIdentifier(name) + &quot;$ADDR&quot; + &quot; = &quot;);
291         addAddressLookup(name);
292         sb.append(&quot;;\n&quot;);
293         decrAlign();
294     }
295 
296     protected void addConstant(String name, Class&lt;?&gt; type, Object value) {
297         incrAlign();
298         indent();
299         if (type == MemoryAddress.class || type == MemorySegment.class) {
300             //todo, skip for now (address constants and string constants)
301         } else {
302             sb.append(PUB_MODS + type.getName() + &quot; &quot; + javaSafeIdentifier(name));
303             sb.append(&quot; = &quot;);
304             if (type == float.class) {
<span class="line-modified">305                 sb.append(value);</span>
<span class="line-modified">306                 sb.append(&quot;f&quot;);</span>







307             } else if (type == long.class) {
308                 sb.append(value);
309                 sb.append(&quot;L&quot;);
310             } else if (type == double.class) {
<span class="line-modified">311                 sb.append(value);</span>
<span class="line-modified">312                 sb.append(&quot;d&quot;);</span>







313             } else {
314                 sb.append(&quot;(&quot; + type.getName() + &quot;)&quot;);
315                 sb.append(value + &quot;L&quot;);
316             }
317             sb.append(&quot;;\n&quot;);
318         }
319 
320         decrAlign();
321     }
322 
323     static int funcIntfCounter = 0;
324 
325     protected void addUpcallFactory(FunctionDescriptor desc) {
326         String fnName = &quot;FI&quot; + funcIntfCounter++;
327         incrAlign();
328         indent();
329         sb.append(PRI_MODS + &quot;FunctionDescriptor &quot; + fnName + &quot;$DESC = &quot;);
330         addFunction(desc);
331         sb.append(&quot;;\n&quot;);
332         indent();
</pre>
</td>
<td>
<hr />
<pre>
285     }
286 
287     protected void addAddress(String name) {
288         incrAlign();
289         indent();
290         sb.append(PUB_MODS + &quot;MemoryAddress &quot; + javaSafeIdentifier(name) + &quot;$ADDR&quot; + &quot; = &quot;);
291         addAddressLookup(name);
292         sb.append(&quot;;\n&quot;);
293         decrAlign();
294     }
295 
296     protected void addConstant(String name, Class&lt;?&gt; type, Object value) {
297         incrAlign();
298         indent();
299         if (type == MemoryAddress.class || type == MemorySegment.class) {
300             //todo, skip for now (address constants and string constants)
301         } else {
302             sb.append(PUB_MODS + type.getName() + &quot; &quot; + javaSafeIdentifier(name));
303             sb.append(&quot; = &quot;);
304             if (type == float.class) {
<span class="line-modified">305                 float f = ((Number)value).floatValue();</span>
<span class="line-modified">306                 if (Float.isNaN(f)) {</span>
<span class="line-added">307                     sb.append(&quot;Float.NaN&quot;);</span>
<span class="line-added">308                 } else if (Float.isInfinite(f)) {</span>
<span class="line-added">309                     sb.append(f &gt; 0? &quot;Float.POSITIVE_INFINITY&quot; : &quot;Float.NEGATIVE_INFINITY&quot;);</span>
<span class="line-added">310                 } else {</span>
<span class="line-added">311                     sb.append(value);</span>
<span class="line-added">312                     sb.append(&quot;f&quot;);</span>
<span class="line-added">313                 }</span>
314             } else if (type == long.class) {
315                 sb.append(value);
316                 sb.append(&quot;L&quot;);
317             } else if (type == double.class) {
<span class="line-modified">318                 double d = ((Number)value).doubleValue();</span>
<span class="line-modified">319                 if (Double.isNaN(d)) {</span>
<span class="line-added">320                     sb.append(&quot;Double.NaN&quot;);</span>
<span class="line-added">321                 } else if (Double.isInfinite(d)) {</span>
<span class="line-added">322                     sb.append(d &gt; 0? &quot;Double.POSITIVE_INFINITY&quot; : &quot;Double.NEGATIVE_INFINITY&quot;);</span>
<span class="line-added">323                 } else {</span>
<span class="line-added">324                    sb.append(value);</span>
<span class="line-added">325                    sb.append(&quot;d&quot;);</span>
<span class="line-added">326                 }</span>
327             } else {
328                 sb.append(&quot;(&quot; + type.getName() + &quot;)&quot;);
329                 sb.append(value + &quot;L&quot;);
330             }
331             sb.append(&quot;;\n&quot;);
332         }
333 
334         decrAlign();
335     }
336 
337     static int funcIntfCounter = 0;
338 
339     protected void addUpcallFactory(FunctionDescriptor desc) {
340         String fnName = &quot;FI&quot; + funcIntfCounter++;
341         incrAlign();
342         indent();
343         sb.append(PRI_MODS + &quot;FunctionDescriptor &quot; + fnName + &quot;$DESC = &quot;);
344         addFunction(desc);
345         sb.append(&quot;;\n&quot;);
346         indent();
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>