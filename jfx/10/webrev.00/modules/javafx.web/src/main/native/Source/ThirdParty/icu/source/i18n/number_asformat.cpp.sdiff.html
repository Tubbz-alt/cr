<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/i18n/number_asformat.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="number_affixutils.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="number_capi.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/i18n/number_asformat.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 45 
 46 Format* LocalizedNumberFormatterAsFormat::clone() const {
 47     return new LocalizedNumberFormatterAsFormat(*this);
 48 }
 49 
 50 UnicodeString&amp; LocalizedNumberFormatterAsFormat::format(const Formattable&amp; obj, UnicodeString&amp; appendTo,
 51                                                         FieldPosition&amp; pos, UErrorCode&amp; status) const {
 52     if (U_FAILURE(status)) { return appendTo; }
 53     UFormattedNumberData data;
 54     obj.populateDecimalQuantity(data.quantity, status);
 55     if (U_FAILURE(status)) {
 56         return appendTo;
 57     }
 58     fFormatter.formatImpl(&amp;data, status);
 59     if (U_FAILURE(status)) {
 60         return appendTo;
 61     }
 62     // always return first occurrence:
 63     pos.setBeginIndex(0);
 64     pos.setEndIndex(0);
<span class="line-modified"> 65     bool found = data.string.nextFieldPosition(pos, status);</span>
 66     if (found &amp;&amp; appendTo.length() != 0) {
 67         pos.setBeginIndex(pos.getBeginIndex() + appendTo.length());
 68         pos.setEndIndex(pos.getEndIndex() + appendTo.length());
 69     }
<span class="line-modified"> 70     appendTo.append(data.string.toTempUnicodeString());</span>
 71     return appendTo;
 72 }
 73 
 74 UnicodeString&amp; LocalizedNumberFormatterAsFormat::format(const Formattable&amp; obj, UnicodeString&amp; appendTo,
 75                                                         FieldPositionIterator* posIter,
 76                                                         UErrorCode&amp; status) const {
 77     if (U_FAILURE(status)) { return appendTo; }
 78     UFormattedNumberData data;
 79     obj.populateDecimalQuantity(data.quantity, status);
 80     if (U_FAILURE(status)) {
 81         return appendTo;
 82     }
 83     fFormatter.formatImpl(&amp;data, status);
 84     if (U_FAILURE(status)) {
 85         return appendTo;
 86     }
<span class="line-modified"> 87     appendTo.append(data.string.toTempUnicodeString());</span>
 88     if (posIter != nullptr) {
 89         FieldPositionIteratorHandler fpih(posIter, status);
<span class="line-modified"> 90         data.string.getAllFieldPositions(fpih, status);</span>
 91     }
 92     return appendTo;
 93 }
 94 
 95 void LocalizedNumberFormatterAsFormat::parseObject(const UnicodeString&amp;, Formattable&amp;,
 96                                                    ParsePosition&amp; parse_pos) const {
 97     // Not supported.
 98     parse_pos.setErrorIndex(0);
 99 }
100 
101 const LocalizedNumberFormatter&amp; LocalizedNumberFormatterAsFormat::getNumberFormatter() const {
102     return fFormatter;
103 }
104 
105 #endif /* #if !UCONFIG_NO_FORMATTING */
</pre>
</td>
<td>
<hr />
<pre>
 45 
 46 Format* LocalizedNumberFormatterAsFormat::clone() const {
 47     return new LocalizedNumberFormatterAsFormat(*this);
 48 }
 49 
 50 UnicodeString&amp; LocalizedNumberFormatterAsFormat::format(const Formattable&amp; obj, UnicodeString&amp; appendTo,
 51                                                         FieldPosition&amp; pos, UErrorCode&amp; status) const {
 52     if (U_FAILURE(status)) { return appendTo; }
 53     UFormattedNumberData data;
 54     obj.populateDecimalQuantity(data.quantity, status);
 55     if (U_FAILURE(status)) {
 56         return appendTo;
 57     }
 58     fFormatter.formatImpl(&amp;data, status);
 59     if (U_FAILURE(status)) {
 60         return appendTo;
 61     }
 62     // always return first occurrence:
 63     pos.setBeginIndex(0);
 64     pos.setEndIndex(0);
<span class="line-modified"> 65     bool found = data.getStringRef().nextFieldPosition(pos, status);</span>
 66     if (found &amp;&amp; appendTo.length() != 0) {
 67         pos.setBeginIndex(pos.getBeginIndex() + appendTo.length());
 68         pos.setEndIndex(pos.getEndIndex() + appendTo.length());
 69     }
<span class="line-modified"> 70     appendTo.append(data.getStringRef().toTempUnicodeString());</span>
 71     return appendTo;
 72 }
 73 
 74 UnicodeString&amp; LocalizedNumberFormatterAsFormat::format(const Formattable&amp; obj, UnicodeString&amp; appendTo,
 75                                                         FieldPositionIterator* posIter,
 76                                                         UErrorCode&amp; status) const {
 77     if (U_FAILURE(status)) { return appendTo; }
 78     UFormattedNumberData data;
 79     obj.populateDecimalQuantity(data.quantity, status);
 80     if (U_FAILURE(status)) {
 81         return appendTo;
 82     }
 83     fFormatter.formatImpl(&amp;data, status);
 84     if (U_FAILURE(status)) {
 85         return appendTo;
 86     }
<span class="line-modified"> 87     appendTo.append(data.getStringRef().toTempUnicodeString());</span>
 88     if (posIter != nullptr) {
 89         FieldPositionIteratorHandler fpih(posIter, status);
<span class="line-modified"> 90         data.getStringRef().getAllFieldPositions(fpih, status);</span>
 91     }
 92     return appendTo;
 93 }
 94 
 95 void LocalizedNumberFormatterAsFormat::parseObject(const UnicodeString&amp;, Formattable&amp;,
 96                                                    ParsePosition&amp; parse_pos) const {
 97     // Not supported.
 98     parse_pos.setErrorIndex(0);
 99 }
100 
101 const LocalizedNumberFormatter&amp; LocalizedNumberFormatterAsFormat::getNumberFormatter() const {
102     return fFormatter;
103 }
104 
105 #endif /* #if !UCONFIG_NO_FORMATTING */
</pre>
</td>
</tr>
</table>
<center><a href="number_affixutils.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="number_capi.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>