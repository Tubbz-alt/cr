<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/i18n/udateintervalformat.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="udat.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="ulocdata.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/i18n/udateintervalformat.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  1 // © 2016 and later: Unicode, Inc. and others.
  2 // License &amp; terms of use: http://www.unicode.org/copyright.html
  3 /*
  4 *****************************************************************************************
  5 * Copyright (C) 2010-2011, International Business Machines
  6 * Corporation and others. All Rights Reserved.
  7 *****************************************************************************************
  8 */
  9 
 10 #include &quot;unicode/utypes.h&quot;
 11 
 12 #if !UCONFIG_NO_FORMATTING
 13 
 14 #include &quot;unicode/udateintervalformat.h&quot;
 15 #include &quot;unicode/dtitvfmt.h&quot;
 16 #include &quot;unicode/dtintrv.h&quot;
 17 #include &quot;unicode/localpointer.h&quot;
 18 #include &quot;unicode/timezone.h&quot;
 19 #include &quot;unicode/locid.h&quot;
 20 #include &quot;unicode/unistr.h&quot;

 21 
 22 U_NAMESPACE_USE
 23 
 24 










 25 U_CAPI UDateIntervalFormat* U_EXPORT2
 26 udtitvfmt_open(const char*  locale,
 27                const UChar* skeleton,
 28                int32_t      skeletonLength,
 29                const UChar* tzID,
 30                int32_t      tzIDLength,
 31                UErrorCode*  status)
 32 {
 33     if (U_FAILURE(*status)) {
 34         return NULL;
 35     }
 36     if ((skeleton == NULL ? skeletonLength != 0 : skeletonLength &lt; -1) ||
 37         (tzID == NULL ? tzIDLength != 0 : tzIDLength &lt; -1)
 38     ) {
 39         *status = U_ILLEGAL_ARGUMENT_ERROR;
 40         return NULL;
 41     }
 42     UnicodeString skel((UBool)(skeletonLength == -1), skeleton, skeletonLength);
 43     LocalPointer&lt;DateIntervalFormat&gt; formatter(
 44             DateIntervalFormat::createInstance(skel, Locale(locale), *status));
</pre>
<hr />
<pre>
 88     }
 89     FieldPosition fp;
 90     if (position != 0) {
 91         fp.setField(position-&gt;field);
 92     }
 93 
 94     DateInterval interval = DateInterval(fromDate,toDate);
 95     ((const DateIntervalFormat*)formatter)-&gt;format( &amp;interval, res, fp, *status );
 96     if (U_FAILURE(*status)) {
 97         return -1;
 98     }
 99     if (position != 0) {
100         position-&gt;beginIndex = fp.getBeginIndex();
101         position-&gt;endIndex = fp.getEndIndex();
102     }
103 
104     return res.extract(result, resultCapacity, *status);
105 }
106 
107 

















108 #endif /* #if !UCONFIG_NO_FORMATTING */
</pre>
</td>
<td>
<hr />
<pre>
  1 // © 2016 and later: Unicode, Inc. and others.
  2 // License &amp; terms of use: http://www.unicode.org/copyright.html
  3 /*
  4 *****************************************************************************************
  5 * Copyright (C) 2010-2011, International Business Machines
  6 * Corporation and others. All Rights Reserved.
  7 *****************************************************************************************
  8 */
  9 
 10 #include &quot;unicode/utypes.h&quot;
 11 
 12 #if !UCONFIG_NO_FORMATTING
 13 
 14 #include &quot;unicode/udateintervalformat.h&quot;
 15 #include &quot;unicode/dtitvfmt.h&quot;
 16 #include &quot;unicode/dtintrv.h&quot;
 17 #include &quot;unicode/localpointer.h&quot;
 18 #include &quot;unicode/timezone.h&quot;
 19 #include &quot;unicode/locid.h&quot;
 20 #include &quot;unicode/unistr.h&quot;
<span class="line-added"> 21 #include &quot;formattedval_impl.h&quot;</span>
 22 
 23 U_NAMESPACE_USE
 24 
 25 
<span class="line-added"> 26 // Magic number: FDIV in ASCII</span>
<span class="line-added"> 27 UPRV_FORMATTED_VALUE_CAPI_AUTO_IMPL(</span>
<span class="line-added"> 28     FormattedDateInterval,</span>
<span class="line-added"> 29     UFormattedDateInterval,</span>
<span class="line-added"> 30     UFormattedDateIntervalImpl,</span>
<span class="line-added"> 31     UFormattedDateIntervalApiHelper,</span>
<span class="line-added"> 32     udtitvfmt,</span>
<span class="line-added"> 33     0x46444956)</span>
<span class="line-added"> 34 </span>
<span class="line-added"> 35 </span>
 36 U_CAPI UDateIntervalFormat* U_EXPORT2
 37 udtitvfmt_open(const char*  locale,
 38                const UChar* skeleton,
 39                int32_t      skeletonLength,
 40                const UChar* tzID,
 41                int32_t      tzIDLength,
 42                UErrorCode*  status)
 43 {
 44     if (U_FAILURE(*status)) {
 45         return NULL;
 46     }
 47     if ((skeleton == NULL ? skeletonLength != 0 : skeletonLength &lt; -1) ||
 48         (tzID == NULL ? tzIDLength != 0 : tzIDLength &lt; -1)
 49     ) {
 50         *status = U_ILLEGAL_ARGUMENT_ERROR;
 51         return NULL;
 52     }
 53     UnicodeString skel((UBool)(skeletonLength == -1), skeleton, skeletonLength);
 54     LocalPointer&lt;DateIntervalFormat&gt; formatter(
 55             DateIntervalFormat::createInstance(skel, Locale(locale), *status));
</pre>
<hr />
<pre>
 99     }
100     FieldPosition fp;
101     if (position != 0) {
102         fp.setField(position-&gt;field);
103     }
104 
105     DateInterval interval = DateInterval(fromDate,toDate);
106     ((const DateIntervalFormat*)formatter)-&gt;format( &amp;interval, res, fp, *status );
107     if (U_FAILURE(*status)) {
108         return -1;
109     }
110     if (position != 0) {
111         position-&gt;beginIndex = fp.getBeginIndex();
112         position-&gt;endIndex = fp.getEndIndex();
113     }
114 
115     return res.extract(result, resultCapacity, *status);
116 }
117 
118 
<span class="line-added">119 U_DRAFT void U_EXPORT2</span>
<span class="line-added">120 udtitvfmt_formatToResult(</span>
<span class="line-added">121                 const UDateIntervalFormat* formatter,</span>
<span class="line-added">122                 UFormattedDateInterval* result,</span>
<span class="line-added">123                 UDate           fromDate,</span>
<span class="line-added">124                 UDate           toDate,</span>
<span class="line-added">125                 UErrorCode*     status) {</span>
<span class="line-added">126     if (U_FAILURE(*status)) {</span>
<span class="line-added">127         return;</span>
<span class="line-added">128     }</span>
<span class="line-added">129     auto* resultImpl = UFormattedDateIntervalApiHelper::validate(result, *status);</span>
<span class="line-added">130     DateInterval interval = DateInterval(fromDate,toDate);</span>
<span class="line-added">131     resultImpl-&gt;fImpl = reinterpret_cast&lt;const DateIntervalFormat*&gt;(formatter)</span>
<span class="line-added">132         -&gt;formatToValue(interval, *status);</span>
<span class="line-added">133 }</span>
<span class="line-added">134 </span>
<span class="line-added">135 </span>
136 #endif /* #if !UCONFIG_NO_FORMATTING */
</pre>
</td>
</tr>
</table>
<center><a href="udat.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="ulocdata.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>