<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/i18n/gregocal.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="gender.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="gregoimp.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/i18n/gregocal.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 524                 jd += weekShift; // shift by weeks for week based fields.
 525             }
 526         }
 527 
 528         return jd;
 529 }
 530 
 531 int32_t GregorianCalendar::handleComputeMonthStart(int32_t eyear, int32_t month,
 532 
 533                                                    UBool /* useMonth */) const
 534 {
 535     GregorianCalendar *nonConstThis = (GregorianCalendar*)this; // cast away const
 536 
 537     // If the month is out of range, adjust it into range, and
 538     // modify the extended year value accordingly.
 539     if (month &lt; 0 || month &gt; 11) {
 540         eyear += ClockMath::floorDivide(month, 12, month);
 541     }
 542 
 543     UBool isLeap = eyear%4 == 0;
<span class="line-modified"> 544     int32_t y = eyear-1;</span>
<span class="line-modified"> 545     int32_t julianDay = 365*y + ClockMath::floorDivide(y, 4) + (kJan1_1JulianDay - 3);</span>
 546 
 547     nonConstThis-&gt;fIsGregorian = (eyear &gt;= fGregorianCutoverYear);
 548 #if defined (U_DEBUG_CAL)
 549     fprintf(stderr, &quot;%s:%d: (hcms%d/%d) fIsGregorian %s, fInvertGregorian %s\n&quot;,
 550         __FILE__, __LINE__, eyear,month, fIsGregorian?&quot;T&quot;:&quot;F&quot;, fInvertGregorian?&quot;T&quot;:&quot;F&quot;);
 551 #endif
 552     if (fInvertGregorian) {
 553         nonConstThis-&gt;fIsGregorian = !fIsGregorian;
 554     }
 555     if (fIsGregorian) {
 556         isLeap = isLeap &amp;&amp; ((eyear%100 != 0) || (eyear%400 == 0));
 557         // Add 2 because Gregorian calendar starts 2 days after
 558         // Julian calendar
 559         int32_t gregShift = Grego::gregorianShift(eyear);
 560 #if defined (U_DEBUG_CAL)
 561         fprintf(stderr, &quot;%s:%d: (hcms%d/%d) gregorian shift of %d += %d\n&quot;,
 562             __FILE__, __LINE__, eyear, month, julianDay, gregShift);
 563 #endif
 564         julianDay += gregShift;
 565     }
 566 
 567     // At this point julianDay indicates the day BEFORE the first
 568     // day of January 1, &lt;eyear&gt; of either the Julian or Gregorian
 569     // calendar.
 570 
 571     if (month != 0) {
 572         julianDay += isLeap?kLeapNumDays[month]:kNumDays[month];
 573     }
 574 
<span class="line-modified"> 575     return julianDay;</span>
 576 }
 577 
 578 int32_t GregorianCalendar::handleGetMonthLength(int32_t extendedYear, int32_t month)  const
 579 {
 580     // If the month is out of range, adjust it into range, and
 581     // modify the extended year value accordingly.
 582     if (month &lt; 0 || month &gt; 11) {
 583         extendedYear += ClockMath::floorDivide(month, 12, month);
 584     }
 585 
 586     return isLeapYear(extendedYear) ? kLeapMonthLength[month] : kMonthLength[month];
 587 }
 588 
 589 int32_t GregorianCalendar::handleGetYearLength(int32_t eyear) const {
 590     return isLeapYear(eyear) ? 366 : 365;
 591 }
 592 
 593 
 594 int32_t
 595 GregorianCalendar::monthLength(int32_t month) const
</pre>
</td>
<td>
<hr />
<pre>
 524                 jd += weekShift; // shift by weeks for week based fields.
 525             }
 526         }
 527 
 528         return jd;
 529 }
 530 
 531 int32_t GregorianCalendar::handleComputeMonthStart(int32_t eyear, int32_t month,
 532 
 533                                                    UBool /* useMonth */) const
 534 {
 535     GregorianCalendar *nonConstThis = (GregorianCalendar*)this; // cast away const
 536 
 537     // If the month is out of range, adjust it into range, and
 538     // modify the extended year value accordingly.
 539     if (month &lt; 0 || month &gt; 11) {
 540         eyear += ClockMath::floorDivide(month, 12, month);
 541     }
 542 
 543     UBool isLeap = eyear%4 == 0;
<span class="line-modified"> 544     int64_t y = (int64_t)eyear-1;</span>
<span class="line-modified"> 545     int64_t julianDay = 365*y + ClockMath::floorDivide(y, (int64_t)4) + (kJan1_1JulianDay - 3);</span>
 546 
 547     nonConstThis-&gt;fIsGregorian = (eyear &gt;= fGregorianCutoverYear);
 548 #if defined (U_DEBUG_CAL)
 549     fprintf(stderr, &quot;%s:%d: (hcms%d/%d) fIsGregorian %s, fInvertGregorian %s\n&quot;,
 550         __FILE__, __LINE__, eyear,month, fIsGregorian?&quot;T&quot;:&quot;F&quot;, fInvertGregorian?&quot;T&quot;:&quot;F&quot;);
 551 #endif
 552     if (fInvertGregorian) {
 553         nonConstThis-&gt;fIsGregorian = !fIsGregorian;
 554     }
 555     if (fIsGregorian) {
 556         isLeap = isLeap &amp;&amp; ((eyear%100 != 0) || (eyear%400 == 0));
 557         // Add 2 because Gregorian calendar starts 2 days after
 558         // Julian calendar
 559         int32_t gregShift = Grego::gregorianShift(eyear);
 560 #if defined (U_DEBUG_CAL)
 561         fprintf(stderr, &quot;%s:%d: (hcms%d/%d) gregorian shift of %d += %d\n&quot;,
 562             __FILE__, __LINE__, eyear, month, julianDay, gregShift);
 563 #endif
 564         julianDay += gregShift;
 565     }
 566 
 567     // At this point julianDay indicates the day BEFORE the first
 568     // day of January 1, &lt;eyear&gt; of either the Julian or Gregorian
 569     // calendar.
 570 
 571     if (month != 0) {
 572         julianDay += isLeap?kLeapNumDays[month]:kNumDays[month];
 573     }
 574 
<span class="line-modified"> 575     return static_cast&lt;int32_t&gt;(julianDay);</span>
 576 }
 577 
 578 int32_t GregorianCalendar::handleGetMonthLength(int32_t extendedYear, int32_t month)  const
 579 {
 580     // If the month is out of range, adjust it into range, and
 581     // modify the extended year value accordingly.
 582     if (month &lt; 0 || month &gt; 11) {
 583         extendedYear += ClockMath::floorDivide(month, 12, month);
 584     }
 585 
 586     return isLeapYear(extendedYear) ? kLeapMonthLength[month] : kMonthLength[month];
 587 }
 588 
 589 int32_t GregorianCalendar::handleGetYearLength(int32_t eyear) const {
 590     return isLeapYear(eyear) ? 366 : 365;
 591 }
 592 
 593 
 594 int32_t
 595 GregorianCalendar::monthLength(int32_t month) const
</pre>
</td>
</tr>
</table>
<center><a href="gender.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="gregoimp.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>