<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/common/uts46.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="utrie2_impl.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="uvector.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/common/uts46.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 555,27 ***</span>
                  return dest;
              }
              destArray=dest.getBuffer();
              destLength+=newLength-labelLength;
              labelLimit=labelStart+=newLength+1;
<span class="line-modified">!         } else if(0xdf&lt;=c &amp;&amp; c&lt;=0x200d &amp;&amp; (c==0xdf || c==0x3c2 || c&gt;=0x200c)) {</span>
              info.isTransDiff=TRUE;
              if(doMapDevChars) {
                  destLength=mapDevChars(dest, labelStart, labelLimit, errorCode);
                  if(U_FAILURE(errorCode)) {
                      return dest;
                  }
                  destArray=dest.getBuffer();
<span class="line-removed">-                 // Do not increment labelLimit in case c was removed.</span>
                  // All deviation characters have been mapped, no need to check for them again.
                  doMapDevChars=FALSE;
<span class="line-modified">!             } else {</span>
<span class="line-modified">!                 ++labelLimit;</span>
              }
<span class="line-removed">-         } else {</span>
<span class="line-removed">-             ++labelLimit;</span>
          }
      }
      // Permit an empty label at the end (0&lt;labelStart==labelLimit==destLength is ok)
      // but not an empty label elsewhere nor a completely empty domain name.
      // processLabel() sets UIDNA_ERROR_EMPTY_LABEL when labelLength==0.
      if(0==labelStart || labelStart&lt;labelLimit) {
<span class="line-new-header">--- 555,38 ---</span>
                  return dest;
              }
              destArray=dest.getBuffer();
              destLength+=newLength-labelLength;
              labelLimit=labelStart+=newLength+1;
<span class="line-modified">!             continue;</span>
<span class="line-added">+         } else if(c&lt;0xdf) {</span>
<span class="line-added">+             // pass</span>
<span class="line-added">+         } else if(c&lt;=0x200d &amp;&amp; (c==0xdf || c==0x3c2 || c&gt;=0x200c)) {</span>
              info.isTransDiff=TRUE;
              if(doMapDevChars) {
                  destLength=mapDevChars(dest, labelStart, labelLimit, errorCode);
                  if(U_FAILURE(errorCode)) {
                      return dest;
                  }
                  destArray=dest.getBuffer();
                  // All deviation characters have been mapped, no need to check for them again.
                  doMapDevChars=FALSE;
<span class="line-modified">!                 // Do not increment labelLimit in case c was removed.</span>
<span class="line-modified">!                 continue;</span>
<span class="line-added">+             }</span>
<span class="line-added">+         } else if(U16_IS_SURROGATE(c)) {</span>
<span class="line-added">+             if(U16_IS_SURROGATE_LEAD(c) ?</span>
<span class="line-added">+                     (labelLimit+1)==destLength || !U16_IS_TRAIL(destArray[labelLimit+1]) :</span>
<span class="line-added">+                     labelLimit==labelStart || !U16_IS_LEAD(destArray[labelLimit-1])) {</span>
<span class="line-added">+                 // Map an unpaired surrogate to U+FFFD before normalization so that when</span>
<span class="line-added">+                 // that removes characters we do not turn two unpaired ones into a pair.</span>
<span class="line-added">+                 info.labelErrors|=UIDNA_ERROR_DISALLOWED;</span>
<span class="line-added">+                 dest.setCharAt(labelLimit, 0xfffd);</span>
<span class="line-added">+                 destArray=dest.getBuffer();</span>
              }
          }
<span class="line-added">+         ++labelLimit;</span>
      }
      // Permit an empty label at the end (0&lt;labelStart==labelLimit==destLength is ok)
      // but not an empty label elsewhere nor a completely empty domain name.
      // processLabel() sets UIDNA_ERROR_EMPTY_LABEL when labelLength==0.
      if(0==labelStart || labelStart&lt;labelLimit) {
</pre>
<center><a href="utrie2_impl.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="uvector.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>