<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/common/uobject.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="unistr.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="uprops.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/common/uobject.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 41  *
 42  * Memory test on Windows/MSVC 6:
 43  * The global operators new and delete look as follows:
 44  *   04F 00000000 UNDEF  notype ()    External     | ??2@YAPAXI@Z (void * __cdecl operator new(unsigned int))
 45  *   03F 00000000 UNDEF  notype ()    External     | ??3@YAXPAX@Z (void __cdecl operator delete(void *))
 46  *
 47  * These lines are from output generated by the MSVC 6 tool dumpbin with
 48  * dumpbin /symbols *.obj
 49  *
 50  * ??2@YAPAXI@Z and ??3@YAXPAX@Z are the linker symbols in the .obj
 51  * files and are imported from msvcrtd.dll (in a debug build).
 52  *
 53  * Make sure that with the UMemory operators new and delete defined these two symbols
 54  * do not appear in the dumpbin /symbols output for the ICU libraries!
 55  *
 56  * If such a symbol appears in the output then look in the preceding lines in the output
 57  * for which file and function calls the global new or delete operator,
 58  * and replace with uprv_malloc/uprv_free.
 59  */
 60 
<span class="line-modified"> 61 void * U_EXPORT2 UMemory::operator new(size_t size) U_NO_THROW {</span>
 62     return uprv_malloc(size);
 63 }
 64 
<span class="line-modified"> 65 void U_EXPORT2 UMemory::operator delete(void *p) U_NO_THROW {</span>
 66     if(p!=NULL) {
 67         uprv_free(p);
 68     }
 69 }
 70 
<span class="line-modified"> 71 void * U_EXPORT2 UMemory::operator new[](size_t size) U_NO_THROW {</span>
 72     return uprv_malloc(size);
 73 }
 74 
<span class="line-modified"> 75 void U_EXPORT2 UMemory::operator delete[](void *p) U_NO_THROW {</span>
 76     if(p!=NULL) {
 77         uprv_free(p);
 78     }
 79 }
 80 
 81 #if U_HAVE_DEBUG_LOCATION_NEW
<span class="line-modified"> 82 void * U_EXPORT2 UMemory::operator new(size_t size, const char* /*file*/, int /*line*/) U_NO_THROW {</span>
 83     return UMemory::operator new(size);
 84 }
 85 
<span class="line-modified"> 86 void U_EXPORT2 UMemory::operator delete(void* p, const char* /*file*/, int /*line*/) U_NO_THROW {</span>
 87     UMemory::operator delete(p);
 88 }
 89 #endif /* U_HAVE_DEBUG_LOCATION_NEW */
 90 
 91 
 92 #endif
 93 
 94 UObject::~UObject() {}
 95 
 96 UClassID UObject::getDynamicClassID() const { return NULL; }
 97 
 98 U_NAMESPACE_END
 99 
100 U_NAMESPACE_USE
101 
102 U_CAPI void U_EXPORT2
103 uprv_deleteUObject(void *obj) {
104     delete static_cast&lt;UObject *&gt;(obj);
105 }
</pre>
</td>
<td>
<hr />
<pre>
 41  *
 42  * Memory test on Windows/MSVC 6:
 43  * The global operators new and delete look as follows:
 44  *   04F 00000000 UNDEF  notype ()    External     | ??2@YAPAXI@Z (void * __cdecl operator new(unsigned int))
 45  *   03F 00000000 UNDEF  notype ()    External     | ??3@YAXPAX@Z (void __cdecl operator delete(void *))
 46  *
 47  * These lines are from output generated by the MSVC 6 tool dumpbin with
 48  * dumpbin /symbols *.obj
 49  *
 50  * ??2@YAPAXI@Z and ??3@YAXPAX@Z are the linker symbols in the .obj
 51  * files and are imported from msvcrtd.dll (in a debug build).
 52  *
 53  * Make sure that with the UMemory operators new and delete defined these two symbols
 54  * do not appear in the dumpbin /symbols output for the ICU libraries!
 55  *
 56  * If such a symbol appears in the output then look in the preceding lines in the output
 57  * for which file and function calls the global new or delete operator,
 58  * and replace with uprv_malloc/uprv_free.
 59  */
 60 
<span class="line-modified"> 61 void * U_EXPORT2 UMemory::operator new(size_t size) U_NOEXCEPT {</span>
 62     return uprv_malloc(size);
 63 }
 64 
<span class="line-modified"> 65 void U_EXPORT2 UMemory::operator delete(void *p) U_NOEXCEPT {</span>
 66     if(p!=NULL) {
 67         uprv_free(p);
 68     }
 69 }
 70 
<span class="line-modified"> 71 void * U_EXPORT2 UMemory::operator new[](size_t size) U_NOEXCEPT {</span>
 72     return uprv_malloc(size);
 73 }
 74 
<span class="line-modified"> 75 void U_EXPORT2 UMemory::operator delete[](void *p) U_NOEXCEPT {</span>
 76     if(p!=NULL) {
 77         uprv_free(p);
 78     }
 79 }
 80 
 81 #if U_HAVE_DEBUG_LOCATION_NEW
<span class="line-modified"> 82 void * U_EXPORT2 UMemory::operator new(size_t size, const char* /*file*/, int /*line*/) U_NOEXCEPT {</span>
 83     return UMemory::operator new(size);
 84 }
 85 
<span class="line-modified"> 86 void U_EXPORT2 UMemory::operator delete(void* p, const char* /*file*/, int /*line*/) U_NOEXCEPT {</span>
 87     UMemory::operator delete(p);
 88 }
 89 #endif /* U_HAVE_DEBUG_LOCATION_NEW */
 90 
 91 
 92 #endif
 93 
 94 UObject::~UObject() {}
 95 
 96 UClassID UObject::getDynamicClassID() const { return NULL; }
 97 
 98 U_NAMESPACE_END
 99 
100 U_NAMESPACE_USE
101 
102 U_CAPI void U_EXPORT2
103 uprv_deleteUObject(void *obj) {
104     delete static_cast&lt;UObject *&gt;(obj);
105 }
</pre>
</td>
</tr>
</table>
<center><a href="unistr.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="uprops.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>