<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/i18n/unicode/dtitvfmt.h</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="decimfmt.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="dtitvinf.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/i18n/unicode/dtitvfmt.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  11 */
  12 
  13 #ifndef __DTITVFMT_H__
  14 #define __DTITVFMT_H__
  15 
  16 
  17 #include &quot;unicode/utypes.h&quot;
  18 
  19 /**
  20  * \file
  21  * \brief C++ API: Format and parse date interval in a language-independent manner.
  22  */
  23 
  24 #if !UCONFIG_NO_FORMATTING
  25 
  26 #include &quot;unicode/ucal.h&quot;
  27 #include &quot;unicode/smpdtfmt.h&quot;
  28 #include &quot;unicode/dtintrv.h&quot;
  29 #include &quot;unicode/dtitvinf.h&quot;
  30 #include &quot;unicode/dtptngen.h&quot;

  31 
  32 U_NAMESPACE_BEGIN
  33 
  34 












































































  35 
  36 /**
  37  * DateIntervalFormat is a class for formatting and parsing date
  38  * intervals in a language-independent manner.
  39  * Only formatting is supported, parsing is not supported.
  40  *
  41  * &lt;P&gt;
  42  * Date interval means from one date to another date,
  43  * for example, from &quot;Jan 11, 2008&quot; to &quot;Jan 18, 2008&quot;.
  44  * We introduced class DateInterval to represent it.
  45  * DateInterval is a pair of UDate, which is
  46  * the standard milliseconds since 24:00 GMT, Jan 1, 1970.
  47  *
  48  * &lt;P&gt;
  49  * DateIntervalFormat formats a DateInterval into
  50  * text as compactly as possible.
  51  * For example, the date interval format from &quot;Jan 11, 2008&quot; to &quot;Jan 18,. 2008&quot;
  52  * is &quot;Jan 11-18, 2008&quot; for English.
  53  * And it parses text into DateInterval,
  54  * although initially, parsing is not supported.
</pre>
<hr />
<pre>
 201  *
 202  * &lt;P&gt;
 203  * Code Sample: general usage
 204  * &lt;pre&gt;
 205  * \code
 206  *   // the date interval object which the DateIntervalFormat formats on
 207  *   // and parses into
 208  *   DateInterval*  dtInterval = new DateInterval(1000*3600*24, 1000*3600*24*2);
 209  *   UErrorCode status = U_ZERO_ERROR;
 210  *   DateIntervalFormat* dtIntervalFmt = DateIntervalFormat::createInstance(
 211  *                           UDAT_YEAR_MONTH_DAY,
 212  *                           Locale(&quot;en&quot;, &quot;GB&quot;, &quot;&quot;), status);
 213  *   UnicodeUnicodeString dateIntervalString;
 214  *   FieldPosition pos = 0;
 215  *   // formatting
 216  *   dtIntervalFmt-&gt;format(dtInterval, dateIntervalUnicodeString, pos, status);
 217  *   delete dtIntervalFmt;
 218  * \endcode
 219  * &lt;/pre&gt;
 220  */
<span class="line-removed"> 221 </span>
 222 class U_I18N_API DateIntervalFormat : public Format {
 223 public:
 224 
 225     /**
 226      * Construct a DateIntervalFormat from skeleton and  the default locale.
 227      *
 228      * This is a convenient override of
 229      * createInstance(const UnicodeString&amp; skeleton, const Locale&amp; locale,
 230      *                UErrorCode&amp;)
 231      * with the value of locale as default locale.
 232      *
 233      * @param skeleton  the skeleton on which interval format based.
 234      * @param status    output param set to success/failure code on exit
 235      * @return          a date time interval formatter which the caller owns.
 236      * @stable ICU 4.0
 237      */
 238     static DateIntervalFormat* U_EXPORT2 createInstance(
 239                                                const UnicodeString&amp; skeleton,
 240                                                UErrorCode&amp; status);
 241 
</pre>
<hr />
<pre>
 408     /**
 409      * Format a DateInterval to produce a string.
 410      *
 411      * @param dtInterval        DateInterval to be formatted.
 412      * @param appendTo          Output parameter to receive result.
 413      *                          Result is appended to existing contents.
 414      * @param fieldPosition     On input: an alignment field, if desired.
 415      *                          On output: the offsets of the alignment field.
 416      *                          There may be multiple instances of a given field type
 417      *                          in an interval format; in this case the fieldPosition
 418      *                          offsets refer to the first instance.
 419      * @param status            Output param filled with success/failure status.
 420      * @return                  Reference to &#39;appendTo&#39; parameter.
 421      * @stable ICU 4.0
 422      */
 423     UnicodeString&amp; format(const DateInterval* dtInterval,
 424                           UnicodeString&amp; appendTo,
 425                           FieldPosition&amp; fieldPosition,
 426                           UErrorCode&amp; status) const ;
 427 















 428 
 429     /**
 430      * Format 2 Calendars to produce a string.
 431      *
 432      * Note: &quot;fromCalendar&quot; and &quot;toCalendar&quot; are not const,
 433      * since calendar is not const in  SimpleDateFormat::format(Calendar&amp;),
 434      *
 435      * @param fromCalendar      calendar set to the from date in date interval
 436      *                          to be formatted into date interval string
 437      * @param toCalendar        calendar set to the to date in date interval
 438      *                          to be formatted into date interval string
 439      * @param appendTo          Output parameter to receive result.
 440      *                          Result is appended to existing contents.
 441      * @param fieldPosition     On input: an alignment field, if desired.
 442      *                          On output: the offsets of the alignment field.
 443      *                          There may be multiple instances of a given field type
 444      *                          in an interval format; in this case the fieldPosition
 445      *                          offsets refer to the first instance.
 446      * @param status            Output param filled with success/failure status.
 447      *                          Caller needs to make sure it is SUCCESS























 458     /**
 459      * Date interval parsing is not supported. Please do not use.
 460      * &lt;P&gt;
 461      * This method should handle parsing of
 462      * date time interval strings into Formattable objects with
 463      * DateInterval type, which is a pair of UDate.
 464      * &lt;P&gt;
 465      * Before calling, set parse_pos.index to the offset you want to start
 466      * parsing at in the source. After calling, parse_pos.index is the end of
 467      * the text you parsed. If error occurs, index is unchanged.
 468      * &lt;P&gt;
 469      * When parsing, leading whitespace is discarded (with a successful parse),
 470      * while trailing whitespace is left as is.
 471      * &lt;P&gt;
 472      * See Format::parseObject() for more.
 473      *
 474      * @param source    The string to be parsed into an object.
 475      * @param result    Formattable to be set to the parse result.
 476      *                  If parse fails, return contents are undefined.
 477      * @param parse_pos The position to start parsing at. Since no parsing
</pre>
<hr />
<pre>
 647      * Construct a DateIntervalFormat from DateFormat
 648      * and a DateIntervalInfo.
 649      *
 650      * It is a wrapper of the constructor.
 651      *
 652      * @param locale    the locale of this date interval formatter.
 653      * @param dtitvinf  the DateIntervalInfo object to be adopted.
 654      * @param skeleton  the skeleton of this formatter.
 655      * @param status    Output param set to success/failure code.
 656      * @return          a date time interval formatter which the caller owns.
 657      */
 658     static DateIntervalFormat* U_EXPORT2 create(const Locale&amp; locale,
 659                                                 DateIntervalInfo* dtitvinf,
 660                                                 const UnicodeString* skeleton,
 661                                                 UErrorCode&amp; status);
 662 
 663     /**
 664      *  Below are for generating interval patterns local to the formatter
 665      */
 666 
<span class="line-modified"> 667     /**</span>
<span class="line-modified"> 668      * Provide an updated FieldPosition posResult based on two formats,</span>
<span class="line-modified"> 669      * the FieldPosition values for each of them, and the pattern used</span>
<span class="line-modified"> 670      * to combine them. The idea is for posResult to indicate the first</span>
<span class="line-modified"> 671      * instance (if any) of the specified field in the combined result,</span>
<span class="line-modified"> 672      * with correct offsets.</span>
<span class="line-modified"> 673      *</span>
<span class="line-modified"> 674      * @param combiningPattern  Pattern used to combine pat0 and pat1</span>
<span class="line-removed"> 675      * @param pat0              Formatted date/time value to replace {0}</span>
<span class="line-removed"> 676      * @param pos0              FieldPosition within pat0</span>
<span class="line-removed"> 677      * @param pat1              Formatted date/time value to replace {1}</span>
<span class="line-removed"> 678      * @param pos1              FieldPosition within pat1</span>
<span class="line-removed"> 679      * @param posResult         FieldPosition to be set to the correct</span>
<span class="line-removed"> 680      *                          position of the first field instance when</span>
<span class="line-removed"> 681      *                          pat0 and pat1 are combined using combiningPattern</span>
<span class="line-removed"> 682      */</span>
<span class="line-removed"> 683     static void</span>
<span class="line-removed"> 684     adjustPosition(UnicodeString&amp; combiningPattern, // has {0} and {1} in it</span>
<span class="line-removed"> 685                    UnicodeString&amp; pat0, FieldPosition&amp; pos0, // pattern and pos corresponding to {0}</span>
<span class="line-removed"> 686                    UnicodeString&amp; pat1, FieldPosition&amp; pos1, // pattern and pos corresponding to {1}</span>
<span class="line-removed"> 687                    FieldPosition&amp; posResult);</span>
<span class="line-removed"> 688 </span>
 689 
 690     /**
 691      * Format 2 Calendars using fall-back interval pattern
 692      *
 693      * The full pattern used in this fall-back format is the
 694      * full pattern of the date formatter.
 695      *
 696      * gFormatterMutex must already be locked when calling this function.
 697      *
 698      * @param fromCalendar      calendar set to the from date in date interval
 699      *                          to be formatted into date interval string
 700      * @param toCalendar        calendar set to the to date in date interval
 701      *                          to be formatted into date interval string
 702      * @param fromToOnSameDay   TRUE iff from and to dates are on the same day
 703      *                          (any difference is in ampm/hours or below)
 704      * @param appendTo          Output parameter to receive result.
 705      *                          Result is appended to existing contents.
<span class="line-modified"> 706      * @param pos               On input: an alignment field, if desired.</span>
<span class="line-modified"> 707      *                          On output: the offsets of the alignment field.</span>
 708      * @param status            output param set to success/failure code on exit
 709      * @return                  Reference to &#39;appendTo&#39; parameter.
 710      * @internal (private)
 711      */
 712     UnicodeString&amp; fallbackFormat(Calendar&amp; fromCalendar,
 713                                   Calendar&amp; toCalendar,
 714                                   UBool fromToOnSameDay,
 715                                   UnicodeString&amp; appendTo,
<span class="line-modified"> 716                                   FieldPosition&amp; pos,</span>

 717                                   UErrorCode&amp; status) const;
 718 
 719 
 720 
 721     /**
 722      * Initialize interval patterns locale to this formatter
 723      *
 724      * This code is a bit complicated since
 725      * 1. the interval patterns saved in resource bundle files are interval
 726      *    patterns based on date or time only.
 727      *    It does not have interval patterns based on both date and time.
 728      *    Interval patterns on both date and time are algorithm generated.
 729      *
 730      *    For example, it has interval patterns on skeleton &quot;dMy&quot; and &quot;hm&quot;,
 731      *    but it does not have interval patterns on skeleton &quot;dMyhm&quot;.
 732      *
 733      *    The rule to generate interval patterns for both date and time skeleton are
 734      *    1) when the year, month, or day differs, concatenate the two original
 735      *    expressions with a separator between,
 736      *    For example, interval pattern from &quot;Jan 10, 2007 10:10 am&quot;
</pre>
<hr />
<pre>
 960      */
 961     void setPatternInfo(UCalendarDateFields field,
 962                         const UnicodeString* firstPart,
 963                         const UnicodeString* secondPart,
 964                         UBool laterDateFirst);
 965 
 966     /**
 967      * Format 2 Calendars to produce a string.
 968      * Implementation of the similar public format function.
 969      * Must be called with gFormatterMutex already locked.
 970      *
 971      * Note: &quot;fromCalendar&quot; and &quot;toCalendar&quot; are not const,
 972      * since calendar is not const in  SimpleDateFormat::format(Calendar&amp;),
 973      *
 974      * @param fromCalendar      calendar set to the from date in date interval
 975      *                          to be formatted into date interval string
 976      * @param toCalendar        calendar set to the to date in date interval
 977      *                          to be formatted into date interval string
 978      * @param appendTo          Output parameter to receive result.
 979      *                          Result is appended to existing contents.
<span class="line-modified"> 980      * @param fieldPosition     On input: an alignment field, if desired.</span>
<span class="line-modified"> 981      *                          On output: the offsets of the alignment field.</span>
<span class="line-modified"> 982      *                          There may be multiple instances of a given field type</span>
<span class="line-modified"> 983      *                          in an interval format; in this case the fieldPosition</span>
<span class="line-modified"> 984      *                          offsets refer to the first instance.</span>
 985      * @param status            Output param filled with success/failure status.
 986      *                          Caller needs to make sure it is SUCCESS
 987      *                          at the function entrance
 988      * @return                  Reference to &#39;appendTo&#39; parameter.
 989      * @internal (private)
 990      */
 991     UnicodeString&amp; formatImpl(Calendar&amp; fromCalendar,
 992                               Calendar&amp; toCalendar,
 993                               UnicodeString&amp; appendTo,
<span class="line-modified"> 994                               FieldPosition&amp; fieldPosition,</span>

 995                               UErrorCode&amp; status) const ;
 996 







 997 
 998     // from calendar field to pattern letter
 999     static const char16_t fgCalendarFieldToPatternLetter[];
1000 
1001 
1002     /**
1003      * The interval patterns for this locale.
1004      */
1005     DateIntervalInfo*     fInfo;
1006 
1007     /**
1008      * The DateFormat object used to format single pattern
1009      */
1010     SimpleDateFormat*     fDateFormat;
1011 
1012     /**
1013      * The 2 calendars with the from and to date.
1014      * could re-use the calendar in fDateFormat,
1015      * but keeping 2 calendars make it clear and clean.
1016      */
</pre>
</td>
<td>
<hr />
<pre>
  11 */
  12 
  13 #ifndef __DTITVFMT_H__
  14 #define __DTITVFMT_H__
  15 
  16 
  17 #include &quot;unicode/utypes.h&quot;
  18 
  19 /**
  20  * \file
  21  * \brief C++ API: Format and parse date interval in a language-independent manner.
  22  */
  23 
  24 #if !UCONFIG_NO_FORMATTING
  25 
  26 #include &quot;unicode/ucal.h&quot;
  27 #include &quot;unicode/smpdtfmt.h&quot;
  28 #include &quot;unicode/dtintrv.h&quot;
  29 #include &quot;unicode/dtitvinf.h&quot;
  30 #include &quot;unicode/dtptngen.h&quot;
<span class="line-added">  31 #include &quot;unicode/formattedvalue.h&quot;</span>
  32 
  33 U_NAMESPACE_BEGIN
  34 
  35 
<span class="line-added">  36 class FormattedDateIntervalData;</span>
<span class="line-added">  37 class DateIntervalFormat;</span>
<span class="line-added">  38 </span>
<span class="line-added">  39 #ifndef U_HIDE_DRAFT_API</span>
<span class="line-added">  40 /**</span>
<span class="line-added">  41  * An immutable class containing the result of a date interval formatting operation.</span>
<span class="line-added">  42  *</span>
<span class="line-added">  43  * Instances of this class are immutable and thread-safe.</span>
<span class="line-added">  44  *</span>
<span class="line-added">  45  * When calling nextPosition():</span>
<span class="line-added">  46  * The fields are returned from left to right. The special field category</span>
<span class="line-added">  47  * UFIELD_CATEGORY_DATE_INTERVAL_SPAN is used to indicate which datetime</span>
<span class="line-added">  48  * primitives came from which arguments: 0 means fromCalendar, and 1 means</span>
<span class="line-added">  49  * toCalendar. The span category will always occur before the</span>
<span class="line-added">  50  * corresponding fields in UFIELD_CATEGORY_DATE</span>
<span class="line-added">  51  * in the nextPosition() iterator.</span>
<span class="line-added">  52  *</span>
<span class="line-added">  53  * Not intended for public subclassing.</span>
<span class="line-added">  54  *</span>
<span class="line-added">  55  * @draft ICU 64</span>
<span class="line-added">  56  */</span>
<span class="line-added">  57 class U_I18N_API FormattedDateInterval : public UMemory, public FormattedValue {</span>
<span class="line-added">  58   public:</span>
<span class="line-added">  59     /**</span>
<span class="line-added">  60      * Default constructor; makes an empty FormattedDateInterval.</span>
<span class="line-added">  61      * @draft ICU 64</span>
<span class="line-added">  62      */</span>
<span class="line-added">  63     FormattedDateInterval() : fData(nullptr), fErrorCode(U_INVALID_STATE_ERROR) {}</span>
<span class="line-added">  64 </span>
<span class="line-added">  65     /**</span>
<span class="line-added">  66      * Move constructor: Leaves the source FormattedDateInterval in an undefined state.</span>
<span class="line-added">  67      * @draft ICU 64</span>
<span class="line-added">  68      */</span>
<span class="line-added">  69     FormattedDateInterval(FormattedDateInterval&amp;&amp; src) U_NOEXCEPT;</span>
<span class="line-added">  70 </span>
<span class="line-added">  71     /**</span>
<span class="line-added">  72      * Destruct an instance of FormattedDateInterval.</span>
<span class="line-added">  73      * @draft ICU 64</span>
<span class="line-added">  74      */</span>
<span class="line-added">  75     virtual ~FormattedDateInterval() U_OVERRIDE;</span>
<span class="line-added">  76 </span>
<span class="line-added">  77     /** Copying not supported; use move constructor instead. */</span>
<span class="line-added">  78     FormattedDateInterval(const FormattedDateInterval&amp;) = delete;</span>
<span class="line-added">  79 </span>
<span class="line-added">  80     /** Copying not supported; use move assignment instead. */</span>
<span class="line-added">  81     FormattedDateInterval&amp; operator=(const FormattedDateInterval&amp;) = delete;</span>
<span class="line-added">  82 </span>
<span class="line-added">  83     /**</span>
<span class="line-added">  84      * Move assignment: Leaves the source FormattedDateInterval in an undefined state.</span>
<span class="line-added">  85      * @draft ICU 64</span>
<span class="line-added">  86      */</span>
<span class="line-added">  87     FormattedDateInterval&amp; operator=(FormattedDateInterval&amp;&amp; src) U_NOEXCEPT;</span>
<span class="line-added">  88 </span>
<span class="line-added">  89     /** @copydoc FormattedValue::toString() */</span>
<span class="line-added">  90     UnicodeString toString(UErrorCode&amp; status) const U_OVERRIDE;</span>
<span class="line-added">  91 </span>
<span class="line-added">  92     /** @copydoc FormattedValue::toTempString() */</span>
<span class="line-added">  93     UnicodeString toTempString(UErrorCode&amp; status) const U_OVERRIDE;</span>
<span class="line-added">  94 </span>
<span class="line-added">  95     /** @copydoc FormattedValue::appendTo() */</span>
<span class="line-added">  96     Appendable &amp;appendTo(Appendable&amp; appendable, UErrorCode&amp; status) const U_OVERRIDE;</span>
<span class="line-added">  97 </span>
<span class="line-added">  98     /** @copydoc FormattedValue::nextPosition() */</span>
<span class="line-added">  99     UBool nextPosition(ConstrainedFieldPosition&amp; cfpos, UErrorCode&amp; status) const U_OVERRIDE;</span>
<span class="line-added"> 100 </span>
<span class="line-added"> 101   private:</span>
<span class="line-added"> 102     FormattedDateIntervalData *fData;</span>
<span class="line-added"> 103     UErrorCode fErrorCode;</span>
<span class="line-added"> 104     explicit FormattedDateInterval(FormattedDateIntervalData *results)</span>
<span class="line-added"> 105         : fData(results), fErrorCode(U_ZERO_ERROR) {}</span>
<span class="line-added"> 106     explicit FormattedDateInterval(UErrorCode errorCode)</span>
<span class="line-added"> 107         : fData(nullptr), fErrorCode(errorCode) {}</span>
<span class="line-added"> 108     friend class DateIntervalFormat;</span>
<span class="line-added"> 109 };</span>
<span class="line-added"> 110 #endif /* U_HIDE_DRAFT_API */</span>
<span class="line-added"> 111 </span>
 112 
 113 /**
 114  * DateIntervalFormat is a class for formatting and parsing date
 115  * intervals in a language-independent manner.
 116  * Only formatting is supported, parsing is not supported.
 117  *
 118  * &lt;P&gt;
 119  * Date interval means from one date to another date,
 120  * for example, from &quot;Jan 11, 2008&quot; to &quot;Jan 18, 2008&quot;.
 121  * We introduced class DateInterval to represent it.
 122  * DateInterval is a pair of UDate, which is
 123  * the standard milliseconds since 24:00 GMT, Jan 1, 1970.
 124  *
 125  * &lt;P&gt;
 126  * DateIntervalFormat formats a DateInterval into
 127  * text as compactly as possible.
 128  * For example, the date interval format from &quot;Jan 11, 2008&quot; to &quot;Jan 18,. 2008&quot;
 129  * is &quot;Jan 11-18, 2008&quot; for English.
 130  * And it parses text into DateInterval,
 131  * although initially, parsing is not supported.
</pre>
<hr />
<pre>
 278  *
 279  * &lt;P&gt;
 280  * Code Sample: general usage
 281  * &lt;pre&gt;
 282  * \code
 283  *   // the date interval object which the DateIntervalFormat formats on
 284  *   // and parses into
 285  *   DateInterval*  dtInterval = new DateInterval(1000*3600*24, 1000*3600*24*2);
 286  *   UErrorCode status = U_ZERO_ERROR;
 287  *   DateIntervalFormat* dtIntervalFmt = DateIntervalFormat::createInstance(
 288  *                           UDAT_YEAR_MONTH_DAY,
 289  *                           Locale(&quot;en&quot;, &quot;GB&quot;, &quot;&quot;), status);
 290  *   UnicodeUnicodeString dateIntervalString;
 291  *   FieldPosition pos = 0;
 292  *   // formatting
 293  *   dtIntervalFmt-&gt;format(dtInterval, dateIntervalUnicodeString, pos, status);
 294  *   delete dtIntervalFmt;
 295  * \endcode
 296  * &lt;/pre&gt;
 297  */

 298 class U_I18N_API DateIntervalFormat : public Format {
 299 public:
 300 
 301     /**
 302      * Construct a DateIntervalFormat from skeleton and  the default locale.
 303      *
 304      * This is a convenient override of
 305      * createInstance(const UnicodeString&amp; skeleton, const Locale&amp; locale,
 306      *                UErrorCode&amp;)
 307      * with the value of locale as default locale.
 308      *
 309      * @param skeleton  the skeleton on which interval format based.
 310      * @param status    output param set to success/failure code on exit
 311      * @return          a date time interval formatter which the caller owns.
 312      * @stable ICU 4.0
 313      */
 314     static DateIntervalFormat* U_EXPORT2 createInstance(
 315                                                const UnicodeString&amp; skeleton,
 316                                                UErrorCode&amp; status);
 317 
</pre>
<hr />
<pre>
 484     /**
 485      * Format a DateInterval to produce a string.
 486      *
 487      * @param dtInterval        DateInterval to be formatted.
 488      * @param appendTo          Output parameter to receive result.
 489      *                          Result is appended to existing contents.
 490      * @param fieldPosition     On input: an alignment field, if desired.
 491      *                          On output: the offsets of the alignment field.
 492      *                          There may be multiple instances of a given field type
 493      *                          in an interval format; in this case the fieldPosition
 494      *                          offsets refer to the first instance.
 495      * @param status            Output param filled with success/failure status.
 496      * @return                  Reference to &#39;appendTo&#39; parameter.
 497      * @stable ICU 4.0
 498      */
 499     UnicodeString&amp; format(const DateInterval* dtInterval,
 500                           UnicodeString&amp; appendTo,
 501                           FieldPosition&amp; fieldPosition,
 502                           UErrorCode&amp; status) const ;
 503 
<span class="line-added"> 504 #ifndef U_HIDE_DRAFT_API</span>
<span class="line-added"> 505     /**</span>
<span class="line-added"> 506      * Format a DateInterval to produce a FormattedDateInterval.</span>
<span class="line-added"> 507      *</span>
<span class="line-added"> 508      * The FormattedDateInterval exposes field information about the formatted string.</span>
<span class="line-added"> 509      *</span>
<span class="line-added"> 510      * @param dtInterval        DateInterval to be formatted.</span>
<span class="line-added"> 511      * @param status            Set if an error occurs.</span>
<span class="line-added"> 512      * @return                  A FormattedDateInterval containing the format result.</span>
<span class="line-added"> 513      * @draft ICU 64</span>
<span class="line-added"> 514      */</span>
<span class="line-added"> 515     FormattedDateInterval formatToValue(</span>
<span class="line-added"> 516         const DateInterval&amp; dtInterval,</span>
<span class="line-added"> 517         UErrorCode&amp; status) const;</span>
<span class="line-added"> 518 #endif /* U_HIDE_DRAFT_API */</span>
 519 
 520     /**
 521      * Format 2 Calendars to produce a string.
 522      *
 523      * Note: &quot;fromCalendar&quot; and &quot;toCalendar&quot; are not const,
 524      * since calendar is not const in  SimpleDateFormat::format(Calendar&amp;),
 525      *
 526      * @param fromCalendar      calendar set to the from date in date interval
 527      *                          to be formatted into date interval string
 528      * @param toCalendar        calendar set to the to date in date interval
 529      *                          to be formatted into date interval string
 530      * @param appendTo          Output parameter to receive result.
 531      *                          Result is appended to existing contents.
 532      * @param fieldPosition     On input: an alignment field, if desired.
 533      *                          On output: the offsets of the alignment field.
 534      *                          There may be multiple instances of a given field type
 535      *                          in an interval format; in this case the fieldPosition
 536      *                          offsets refer to the first instance.
 537      * @param status            Output param filled with success/failure status.
 538      *                          Caller needs to make sure it is SUCCESS
<span class="line-added"> 549 #ifndef U_HIDE_DRAFT_API</span>
<span class="line-added"> 550     /**</span>
<span class="line-added"> 551      * Format 2 Calendars to produce a FormattedDateInterval.</span>
<span class="line-added"> 552      *</span>
<span class="line-added"> 553      * The FormattedDateInterval exposes field information about the formatted string.</span>
<span class="line-added"> 554      *</span>
<span class="line-added"> 555      * Note: &quot;fromCalendar&quot; and &quot;toCalendar&quot; are not const,</span>
<span class="line-added"> 556      * since calendar is not const in  SimpleDateFormat::format(Calendar&amp;),</span>
<span class="line-added"> 557      *</span>
<span class="line-added"> 558      * @param fromCalendar      calendar set to the from date in date interval</span>
<span class="line-added"> 559      *                          to be formatted into date interval string</span>
<span class="line-added"> 560      * @param toCalendar        calendar set to the to date in date interval</span>
<span class="line-added"> 561      *                          to be formatted into date interval string</span>
<span class="line-added"> 562      * @param status            Set if an error occurs.</span>
<span class="line-added"> 563      * @return                  A FormattedDateInterval containing the format result.</span>
<span class="line-added"> 564      * @draft ICU 64</span>
<span class="line-added"> 565      */</span>
<span class="line-added"> 566     FormattedDateInterval formatToValue(</span>
<span class="line-added"> 567         Calendar&amp; fromCalendar,</span>
<span class="line-added"> 568         Calendar&amp; toCalendar,</span>
<span class="line-added"> 569         UErrorCode&amp; status) const;</span>
<span class="line-added"> 570 #endif /* U_HIDE_DRAFT_API */</span>
<span class="line-added"> 571 </span>
 572     /**
 573      * Date interval parsing is not supported. Please do not use.
 574      * &lt;P&gt;
 575      * This method should handle parsing of
 576      * date time interval strings into Formattable objects with
 577      * DateInterval type, which is a pair of UDate.
 578      * &lt;P&gt;
 579      * Before calling, set parse_pos.index to the offset you want to start
 580      * parsing at in the source. After calling, parse_pos.index is the end of
 581      * the text you parsed. If error occurs, index is unchanged.
 582      * &lt;P&gt;
 583      * When parsing, leading whitespace is discarded (with a successful parse),
 584      * while trailing whitespace is left as is.
 585      * &lt;P&gt;
 586      * See Format::parseObject() for more.
 587      *
 588      * @param source    The string to be parsed into an object.
 589      * @param result    Formattable to be set to the parse result.
 590      *                  If parse fails, return contents are undefined.
 591      * @param parse_pos The position to start parsing at. Since no parsing
</pre>
<hr />
<pre>
 761      * Construct a DateIntervalFormat from DateFormat
 762      * and a DateIntervalInfo.
 763      *
 764      * It is a wrapper of the constructor.
 765      *
 766      * @param locale    the locale of this date interval formatter.
 767      * @param dtitvinf  the DateIntervalInfo object to be adopted.
 768      * @param skeleton  the skeleton of this formatter.
 769      * @param status    Output param set to success/failure code.
 770      * @return          a date time interval formatter which the caller owns.
 771      */
 772     static DateIntervalFormat* U_EXPORT2 create(const Locale&amp; locale,
 773                                                 DateIntervalInfo* dtitvinf,
 774                                                 const UnicodeString* skeleton,
 775                                                 UErrorCode&amp; status);
 776 
 777     /**
 778      *  Below are for generating interval patterns local to the formatter
 779      */
 780 
<span class="line-modified"> 781     /** Like fallbackFormat, but only formats the range part of the fallback. */</span>
<span class="line-modified"> 782     void fallbackFormatRange(</span>
<span class="line-modified"> 783         Calendar&amp; fromCalendar,</span>
<span class="line-modified"> 784         Calendar&amp; toCalendar,</span>
<span class="line-modified"> 785         UnicodeString&amp; appendTo,</span>
<span class="line-modified"> 786         int8_t&amp; firstIndex,</span>
<span class="line-modified"> 787         FieldPositionHandler&amp; fphandler,</span>
<span class="line-modified"> 788         UErrorCode&amp; status) const;</span>














 789 
 790     /**
 791      * Format 2 Calendars using fall-back interval pattern
 792      *
 793      * The full pattern used in this fall-back format is the
 794      * full pattern of the date formatter.
 795      *
 796      * gFormatterMutex must already be locked when calling this function.
 797      *
 798      * @param fromCalendar      calendar set to the from date in date interval
 799      *                          to be formatted into date interval string
 800      * @param toCalendar        calendar set to the to date in date interval
 801      *                          to be formatted into date interval string
 802      * @param fromToOnSameDay   TRUE iff from and to dates are on the same day
 803      *                          (any difference is in ampm/hours or below)
 804      * @param appendTo          Output parameter to receive result.
 805      *                          Result is appended to existing contents.
<span class="line-modified"> 806      * @param firstIndex        See formatImpl for more information.</span>
<span class="line-modified"> 807      * @param fphandler         See formatImpl for more information.</span>
 808      * @param status            output param set to success/failure code on exit
 809      * @return                  Reference to &#39;appendTo&#39; parameter.
 810      * @internal (private)
 811      */
 812     UnicodeString&amp; fallbackFormat(Calendar&amp; fromCalendar,
 813                                   Calendar&amp; toCalendar,
 814                                   UBool fromToOnSameDay,
 815                                   UnicodeString&amp; appendTo,
<span class="line-modified"> 816                                   int8_t&amp; firstIndex,</span>
<span class="line-added"> 817                                   FieldPositionHandler&amp; fphandler,</span>
 818                                   UErrorCode&amp; status) const;
 819 
 820 
 821 
 822     /**
 823      * Initialize interval patterns locale to this formatter
 824      *
 825      * This code is a bit complicated since
 826      * 1. the interval patterns saved in resource bundle files are interval
 827      *    patterns based on date or time only.
 828      *    It does not have interval patterns based on both date and time.
 829      *    Interval patterns on both date and time are algorithm generated.
 830      *
 831      *    For example, it has interval patterns on skeleton &quot;dMy&quot; and &quot;hm&quot;,
 832      *    but it does not have interval patterns on skeleton &quot;dMyhm&quot;.
 833      *
 834      *    The rule to generate interval patterns for both date and time skeleton are
 835      *    1) when the year, month, or day differs, concatenate the two original
 836      *    expressions with a separator between,
 837      *    For example, interval pattern from &quot;Jan 10, 2007 10:10 am&quot;
</pre>
<hr />
<pre>
1061      */
1062     void setPatternInfo(UCalendarDateFields field,
1063                         const UnicodeString* firstPart,
1064                         const UnicodeString* secondPart,
1065                         UBool laterDateFirst);
1066 
1067     /**
1068      * Format 2 Calendars to produce a string.
1069      * Implementation of the similar public format function.
1070      * Must be called with gFormatterMutex already locked.
1071      *
1072      * Note: &quot;fromCalendar&quot; and &quot;toCalendar&quot; are not const,
1073      * since calendar is not const in  SimpleDateFormat::format(Calendar&amp;),
1074      *
1075      * @param fromCalendar      calendar set to the from date in date interval
1076      *                          to be formatted into date interval string
1077      * @param toCalendar        calendar set to the to date in date interval
1078      *                          to be formatted into date interval string
1079      * @param appendTo          Output parameter to receive result.
1080      *                          Result is appended to existing contents.
<span class="line-modified">1081      * @param firstIndex        0 if the first output date is fromCalendar;</span>
<span class="line-modified">1082      *                          1 if it corresponds to toCalendar;</span>
<span class="line-modified">1083      *                          -1 if there is only one date printed.</span>
<span class="line-modified">1084      * @param fphandler         Handler for field position information.</span>
<span class="line-modified">1085      *                          The fields will be from the UDateFormatField enum.</span>
1086      * @param status            Output param filled with success/failure status.
1087      *                          Caller needs to make sure it is SUCCESS
1088      *                          at the function entrance
1089      * @return                  Reference to &#39;appendTo&#39; parameter.
1090      * @internal (private)
1091      */
1092     UnicodeString&amp; formatImpl(Calendar&amp; fromCalendar,
1093                               Calendar&amp; toCalendar,
1094                               UnicodeString&amp; appendTo,
<span class="line-modified">1095                               int8_t&amp; firstIndex,</span>
<span class="line-added">1096                               FieldPositionHandler&amp; fphandler,</span>
1097                               UErrorCode&amp; status) const ;
1098 
<span class="line-added">1099     /** Version of formatImpl for DateInterval. */</span>
<span class="line-added">1100     UnicodeString&amp; formatIntervalImpl(const DateInterval&amp; dtInterval,</span>
<span class="line-added">1101                               UnicodeString&amp; appendTo,</span>
<span class="line-added">1102                               int8_t&amp; firstIndex,</span>
<span class="line-added">1103                               FieldPositionHandler&amp; fphandler,</span>
<span class="line-added">1104                               UErrorCode&amp; status) const;</span>
<span class="line-added">1105 </span>
1106 
1107     // from calendar field to pattern letter
1108     static const char16_t fgCalendarFieldToPatternLetter[];
1109 
1110 
1111     /**
1112      * The interval patterns for this locale.
1113      */
1114     DateIntervalInfo*     fInfo;
1115 
1116     /**
1117      * The DateFormat object used to format single pattern
1118      */
1119     SimpleDateFormat*     fDateFormat;
1120 
1121     /**
1122      * The 2 calendars with the from and to date.
1123      * could re-use the calendar in fDateFormat,
1124      * but keeping 2 calendars make it clear and clean.
1125      */
</pre>
</td>
</tr>
</table>
<center><a href="decimfmt.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="dtitvinf.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>