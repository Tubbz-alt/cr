<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/common/ubidiln.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ubidi_props_data.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="ubiditransform.cpp.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/common/ubidiln.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 515,11 ***</span>
      }
  }
  
  /* compute the runs array --------------------------------------------------- */
  
<span class="line-modified">! static int32_t getRunFromLogicalIndex(UBiDi *pBiDi, int32_t logicalIndex, UErrorCode *pErrorCode) {</span>
      Run *runs=pBiDi-&gt;runs;
      int32_t runCount=pBiDi-&gt;runCount, visualStart=0, i, length, logicalStart;
  
      for(i=0; i&lt;runCount; i++) {
          length=runs[i].visualLimit-visualStart;
<span class="line-new-header">--- 515,11 ---</span>
      }
  }
  
  /* compute the runs array --------------------------------------------------- */
  
<span class="line-modified">! static int32_t getRunFromLogicalIndex(UBiDi *pBiDi, int32_t logicalIndex) {</span>
      Run *runs=pBiDi-&gt;runs;
      int32_t runCount=pBiDi-&gt;runCount, visualStart=0, i, length, logicalStart;
  
      for(i=0; i&lt;runCount; i++) {
          length=runs[i].visualLimit-visualStart;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 528,13 ***</span>
              return i;
          }
          visualStart+=length;
      }
      /* we should never get here */
<span class="line-modified">!     U_ASSERT(FALSE);</span>
<span class="line-removed">-     *pErrorCode = U_INVALID_STATE_ERROR;</span>
<span class="line-removed">-     return 0;</span>
  }
  
  /*
   * Compute the runs array from the levels array.
   * After ubidi_getRuns() returns TRUE, runCount is guaranteed to be &gt;0
<span class="line-new-header">--- 528,11 ---</span>
              return i;
          }
          visualStart+=length;
      }
      /* we should never get here */
<span class="line-modified">!     UPRV_UNREACHABLE;</span>
  }
  
  /*
   * Compute the runs array from the levels array.
   * After ubidi_getRuns() returns TRUE, runCount is guaranteed to be &gt;0
</pre>
<hr />
<pre>
<span class="line-old-header">*** 545,11 ***</span>
   * sum of appropriate LRM/RLM_BEFORE/AFTER flags.
   * If option UBIDI_OPTION_REMOVE_CONTROLS is set, insertRemove will contain the
   * negative number of BiDi control characters within this run.
   */
  U_CFUNC UBool
<span class="line-modified">! ubidi_getRuns(UBiDi *pBiDi, UErrorCode *pErrorCode) {</span>
      /*
       * This method returns immediately if the runs are already set. This
       * includes the case of length==0 (handled in setPara)..
       */
      if (pBiDi-&gt;runCount&gt;=0) {
<span class="line-new-header">--- 543,11 ---</span>
   * sum of appropriate LRM/RLM_BEFORE/AFTER flags.
   * If option UBIDI_OPTION_REMOVE_CONTROLS is set, insertRemove will contain the
   * negative number of BiDi control characters within this run.
   */
  U_CFUNC UBool
<span class="line-modified">! ubidi_getRuns(UBiDi *pBiDi, UErrorCode*) {</span>
      /*
       * This method returns immediately if the runs are already set. This
       * includes the case of length==0 (handled in setPara)..
       */
      if (pBiDi-&gt;runCount&gt;=0) {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 686,22 ***</span>
      if(pBiDi-&gt;insertPoints.size&gt;0) {
          Point *point, *start=pBiDi-&gt;insertPoints.points,
                        *limit=start+pBiDi-&gt;insertPoints.size;
          int32_t runIndex;
          for(point=start; point&lt;limit; point++) {
<span class="line-modified">!             runIndex=getRunFromLogicalIndex(pBiDi, point-&gt;pos, pErrorCode);</span>
              pBiDi-&gt;runs[runIndex].insertRemove|=point-&gt;flag;
          }
      }
  
      /* handle remove BiDi control characters */
      if(pBiDi-&gt;controlCount&gt;0) {
          int32_t runIndex;
          const UChar *start=pBiDi-&gt;text, *limit=start+pBiDi-&gt;length, *pu;
          for(pu=start; pu&lt;limit; pu++) {
              if(IS_BIDI_CONTROL_CHAR(*pu)) {
<span class="line-modified">!                 runIndex=getRunFromLogicalIndex(pBiDi, (int32_t)(pu-start), pErrorCode);</span>
                  pBiDi-&gt;runs[runIndex].insertRemove--;
              }
          }
      }
  
<span class="line-new-header">--- 684,22 ---</span>
      if(pBiDi-&gt;insertPoints.size&gt;0) {
          Point *point, *start=pBiDi-&gt;insertPoints.points,
                        *limit=start+pBiDi-&gt;insertPoints.size;
          int32_t runIndex;
          for(point=start; point&lt;limit; point++) {
<span class="line-modified">!             runIndex=getRunFromLogicalIndex(pBiDi, point-&gt;pos);</span>
              pBiDi-&gt;runs[runIndex].insertRemove|=point-&gt;flag;
          }
      }
  
      /* handle remove BiDi control characters */
      if(pBiDi-&gt;controlCount&gt;0) {
          int32_t runIndex;
          const UChar *start=pBiDi-&gt;text, *limit=start+pBiDi-&gt;length, *pu;
          for(pu=start; pu&lt;limit; pu++) {
              if(IS_BIDI_CONTROL_CHAR(*pu)) {
<span class="line-modified">!                 runIndex=getRunFromLogicalIndex(pBiDi, (int32_t)(pu-start));</span>
                  pBiDi-&gt;runs[runIndex].insertRemove--;
              }
          }
      }
  
</pre>
<center><a href="ubidi_props_data.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="ubiditransform.cpp.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>