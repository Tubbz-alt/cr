<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/tools/toolutil/pkg_genc.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="package.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="pkg_gencmn.cpp.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/tools/toolutil/pkg_genc.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -307,20 +307,15 @@</span>
          entry, entry, entry, entry);
      T_FileStream_writeLine(out, bufferStr);
      T_FileStream_writeLine(out, assemblyHeader[assemblyHeaderIndex].beginLine);
  
      for(;;) {
<span class="udiff-line-added">+         memset(buffer, 0, sizeof(buffer));</span>
          length=T_FileStream_read(in, buffer, sizeof(buffer));
          if(length==0) {
              break;
          }
<span class="udiff-line-removed">-         if (length != sizeof(buffer)) {</span>
<span class="udiff-line-removed">-             /* pad with extra 0&#39;s when at the end of the file */</span>
<span class="udiff-line-removed">-             for(i=0; i &lt; (length % sizeof(uint32_t)); ++i) {</span>
<span class="udiff-line-removed">-                 buffer[length+i] = 0;</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         }</span>
          for(i=0; i&lt;(length/sizeof(buffer[0])); i++) {
              column = write32(out, buffer[i], column);
          }
      }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -683,27 +678,34 @@</span>
          /* set EM_386 because elf.h does not provide better defaults */
          *pCPU=EM_386;
          *pBits=32;
          *pIsBigEndian=(UBool)(U_IS_BIG_ENDIAN ? ELFDATA2MSB : ELFDATA2LSB);
  #elif U_PLATFORM_HAS_WIN32_API
<span class="udiff-line-modified-removed">- /* _M_IA64 should be defined in windows.h */</span>
<span class="udiff-line-modified-removed">- #   if defined(_M_IA64)</span>
<span class="udiff-line-modified-removed">-         *pCPU=IMAGE_FILE_MACHINE_IA64;</span>
<span class="udiff-line-modified-removed">-         *pBits = 64;</span>
<span class="udiff-line-modified-removed">- #   elif defined(_M_AMD64)</span>
<span class="udiff-line-modified-removed">- // link.exe does not really care about the .obj machine type and this will</span>
<span class="udiff-line-modified-removed">- // allow us to build a dll for both ARM &amp; x64 with an amd64 built tool</span>
<span class="udiff-line-modified-removed">- // ARM is same as x64 except for first 2 bytes of object file</span>
<span class="udiff-line-modified-removed">-         *pCPU = IMAGE_FILE_MACHINE_UNKNOWN;</span>
<span class="udiff-line-modified-removed">-         // *pCPU = IMAGE_FILE_MACHINE_ARMNT;   // If we wanted to be explicit</span>
<span class="udiff-line-modified-removed">-         // *pCPU = IMAGE_FILE_MACHINE_AMD64;   // We would use one of these names</span>
<span class="udiff-line-modified-removed">-         *pBits = 64;                           // Doesn&#39;t seem to be used for anything interesting?</span>
<span class="udiff-line-modified-added">+         // Windows always runs in little-endian mode.</span>
<span class="udiff-line-modified-added">+         *pIsBigEndian = FALSE;</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // Note: The various _M_&lt;arch&gt; macros are predefined by the MSVC compiler based</span>
<span class="udiff-line-modified-added">+         // on the target compilation architecture.</span>
<span class="udiff-line-modified-added">+         // https://docs.microsoft.com/cpp/preprocessor/predefined-macros</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         // link.exe will link an IMAGE_FILE_MACHINE_UNKNOWN data-only .obj file</span>
<span class="udiff-line-modified-added">+         // no matter what architecture it is targeting (though other values are</span>
<span class="udiff-line-modified-added">+         // required to match). Unfortunately, the variable name decoration/mangling</span>
<span class="udiff-line-modified-added">+         // is slightly different on x86, which means we can&#39;t use the UNKNOWN type</span>
<span class="udiff-line-modified-added">+         // for all architectures though.</span>
<span class="udiff-line-added">+ #   if defined(_M_IX86)</span>
<span class="udiff-line-added">+         *pCPU = IMAGE_FILE_MACHINE_I386;</span>
  #   else
<span class="udiff-line-modified-removed">-         *pCPU=IMAGE_FILE_MACHINE_I386;    // We would use one of these names</span>
<span class="udiff-line-modified-added">+         *pCPU = IMAGE_FILE_MACHINE_UNKNOWN;</span>
<span class="udiff-line-added">+ #   endif</span>
<span class="udiff-line-added">+ #   if defined(_M_IA64) || defined(_M_AMD64) || defined (_M_ARM64)</span>
<span class="udiff-line-added">+         *pBits = 64; // Doesn&#39;t seem to be used for anything interesting though?</span>
<span class="udiff-line-added">+ #   elif defined(_M_IX86) || defined(_M_ARM)</span>
          *pBits = 32;
<span class="udiff-line-added">+ #   else</span>
<span class="udiff-line-added">+ #      error &quot;Unknown platform for CAN_GENERATE_OBJECTS.&quot;</span>
  #   endif
<span class="udiff-line-removed">-         *pIsBigEndian=FALSE;</span>
  #else
  #   error &quot;Unknown platform for CAN_GENERATE_OBJECTS.&quot;
  #endif
          return;
      }
</pre>
<center><a href="package.cpp.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="pkg_gencmn.cpp.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>