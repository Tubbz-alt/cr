<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/i18n/unicode/translit.h</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="timezone.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="tzfmt.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/i18n/unicode/translit.h</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  14 
  15 #include &quot;unicode/utypes.h&quot;
  16 
  17 /**
  18  * \file
  19  * \brief C++ API: Tranforms text from one format to another.
  20  */
  21 
  22 #if !UCONFIG_NO_TRANSLITERATION
  23 
  24 #include &quot;unicode/uobject.h&quot;
  25 #include &quot;unicode/unistr.h&quot;
  26 #include &quot;unicode/parseerr.h&quot;
  27 #include &quot;unicode/utrans.h&quot; // UTransPosition, UTransDirection
  28 #include &quot;unicode/strenum.h&quot;
  29 
  30 U_NAMESPACE_BEGIN
  31 
  32 class UnicodeFilter;
  33 class UnicodeSet;
<span class="line-removed">  34 class CompoundTransliterator;</span>
  35 class TransliteratorParser;
  36 class NormalizationTransliterator;
  37 class TransliteratorIDParser;
  38 
  39 /**
  40  *
  41  * &lt;code&gt;Transliterator&lt;/code&gt; is an abstract class that
  42  * transliterates text from one format to another.  The most common
  43  * kind of transliterator is a script, or alphabet, transliterator.
  44  * For example, a Russian to Latin transliterator changes Russian text
  45  * written in Cyrillic characters to phonetically equivalent Latin
  46  * characters.  It does not &lt;em&gt;translate&lt;/em&gt; Russian to English!
  47  * Transliteration, unlike translation, operates on characters, without
  48  * reference to the meanings of words and sentences.
  49  *
  50  * &lt;p&gt;Although script conversion is its most common use, a
  51  * transliterator can actually perform a more general class of tasks.
  52  * In fact, &lt;code&gt;Transliterator&lt;/code&gt; defines a very general API
  53  * which specifies only that a segment of the input text is replaced
  54  * by new text.  The particulars of this conversion are determined
</pre>
<hr />
<pre>
  60  * retain no information between calls to
  61  * &lt;code&gt;transliterate()&lt;/code&gt;.  (However, this does &lt;em&gt;not&lt;/em&gt;
  62  * mean that threads may share transliterators without synchronizing
  63  * them.  Transliterators are not immutable, so they must be
  64  * synchronized when shared between threads.)  This might seem to
  65  * limit the complexity of the transliteration operation.  In
  66  * practice, subclasses perform complex transliterations by delaying
  67  * the replacement of text until it is known that no other
  68  * replacements are possible.  In other words, although the
  69  * &lt;code&gt;Transliterator&lt;/code&gt; objects are stateless, the source text
  70  * itself embodies all the needed information, and delayed operation
  71  * allows arbitrary complexity.
  72  *
  73  * &lt;p&gt;&lt;b&gt;Batch transliteration&lt;/b&gt;
  74  *
  75  * &lt;p&gt;The simplest way to perform transliteration is all at once, on a
  76  * string of existing text.  This is referred to as &lt;em&gt;batch&lt;/em&gt;
  77  * transliteration.  For example, given a string &lt;code&gt;input&lt;/code&gt;
  78  * and a transliterator &lt;code&gt;t&lt;/code&gt;, the call
  79  *
<span class="line-modified">  80  * \htmlonly&lt;blockquote&gt;\endhtmlonly&lt;code&gt;String result = t.transliterate(input);</span>
<span class="line-removed">  81  * &lt;/code&gt;\htmlonly&lt;/blockquote&gt;\endhtmlonly</span>
  82  *
  83  * will transliterate it and return the result.  Other methods allow
  84  * the client to specify a substring to be transliterated and to use
  85  * {@link Replaceable } objects instead of strings, in order to
  86  * preserve out-of-band information (such as text styles).
  87  *
  88  * &lt;p&gt;&lt;b&gt;Keyboard transliteration&lt;/b&gt;
  89  *
  90  * &lt;p&gt;Somewhat more involved is &lt;em&gt;keyboard&lt;/em&gt;, or incremental
  91  * transliteration.  This is the transliteration of text that is
  92  * arriving from some source (typically the user&#39;s keyboard) one
  93  * character at a time, or in some other piecemeal fashion.
  94  *
  95  * &lt;p&gt;In keyboard transliteration, a &lt;code&gt;Replaceable&lt;/code&gt; buffer
  96  * stores the text.  As text is inserted, as much as possible is
  97  * transliterated on the fly.  This means a GUI that displays the
  98  * contents of the buffer may show text being modified as each new
  99  * character arrives.
 100  *
<span class="line-modified"> 101  * &lt;p&gt;Consider the simple &lt;code&gt;RuleBasedTransliterator&lt;/code&gt;:</span>
<span class="line-modified"> 102  *</span>
<span class="line-modified"> 103  * \htmlonly&lt;blockquote&gt;\endhtmlonly&lt;code&gt;</span>
<span class="line-modified"> 104  * th&amp;gt;{theta}&lt;br&gt;</span>
<span class="line-modified"> 105  * t&amp;gt;{tau}</span>
<span class="line-removed"> 106  * &lt;/code&gt;\htmlonly&lt;/blockquote&gt;\endhtmlonly</span>
 107  *
 108  * When the user types &#39;t&#39;, nothing will happen, since the
 109  * transliterator is waiting to see if the next character is &#39;h&#39;.  To
 110  * remedy this, we introduce the notion of a cursor, marked by a &#39;|&#39;
 111  * in the output string:
<span class="line-modified"> 112  *</span>
<span class="line-modified"> 113  * \htmlonly&lt;blockquote&gt;\endhtmlonly&lt;code&gt;</span>
<span class="line-modified"> 114  * t&amp;gt;|{tau}&lt;br&gt;</span>
<span class="line-modified"> 115  * {tau}h&amp;gt;{theta}</span>
<span class="line-removed"> 116  * &lt;/code&gt;\htmlonly&lt;/blockquote&gt;\endhtmlonly</span>
 117  *
 118  * Now when the user types &#39;t&#39;, tau appears, and if the next character
 119  * is &#39;h&#39;, the tau changes to a theta.  This is accomplished by
 120  * maintaining a cursor position (independent of the insertion point,
 121  * and invisible in the GUI) across calls to
 122  * &lt;code&gt;transliterate()&lt;/code&gt;.  Typically, the cursor will
 123  * be coincident with the insertion point, but in a case like the one
 124  * above, it will precede the insertion point.
 125  *
 126  * &lt;p&gt;Keyboard transliteration methods maintain a set of three indices
 127  * that are updated with each call to
 128  * &lt;code&gt;transliterate()&lt;/code&gt;, including the cursor, start,
 129  * and limit.  Since these indices are changed by the method, they are
 130  * passed in an &lt;code&gt;int[]&lt;/code&gt; array. The &lt;code&gt;START&lt;/code&gt; index
 131  * marks the beginning of the substring that the transliterator will
 132  * look at.  It is advanced as text becomes committed (but it is not
 133  * the committed index; that&#39;s the &lt;code&gt;CURSOR&lt;/code&gt;).  The
 134  * &lt;code&gt;CURSOR&lt;/code&gt; index, described above, marks the point at
 135  * which the transliterator last stopped, either because it reached
 136  * the end, or because it required more characters to disambiguate
 137  * between possible inputs.  The &lt;code&gt;CURSOR&lt;/code&gt; can also be
<span class="line-modified"> 138  * explicitly set by rules in a &lt;code&gt;RuleBasedTransliterator&lt;/code&gt;.</span>
 139  * Any characters before the &lt;code&gt;CURSOR&lt;/code&gt; index are frozen;
 140  * future keyboard transliteration calls within this input sequence
 141  * will not change them.  New text is inserted at the
 142  * &lt;code&gt;LIMIT&lt;/code&gt; index, which marks the end of the substring that
 143  * the transliterator looks at.
 144  *
 145  * &lt;p&gt;Because keyboard transliteration assumes that more characters
 146  * are to arrive, it is conservative in its operation.  It only
 147  * transliterates when it can do so unambiguously.  Otherwise it waits
 148  * for more characters to arrive.  When the client code knows that no
 149  * more characters are forthcoming, perhaps because the user has
 150  * performed some input termination operation, then it should call
 151  * &lt;code&gt;finishTransliteration()&lt;/code&gt; to complete any
 152  * pending transliterations.
 153  *
 154  * &lt;p&gt;&lt;b&gt;Inverses&lt;/b&gt;
 155  *
 156  * &lt;p&gt;Pairs of transliterators may be inverses of one another.  For
 157  * example, if transliterator &lt;b&gt;A&lt;/b&gt; transliterates characters by
 158  * incrementing their Unicode value (so &quot;abc&quot; -&gt; &quot;def&quot;), and
</pre>
<hr />
<pre>
 220  * &lt;code&gt;registerInstance()&lt;/code&gt; at run time.  A registered instance
 221  * acts a template; future calls to {@link #createInstance } with the ID
 222  * of the registered object return clones of that object.  Thus any
 223  * object passed to &lt;tt&gt;registerInstance()&lt;/tt&gt; must implement
 224  * &lt;tt&gt;clone()&lt;/tt&gt; propertly.  To register a transliterator subclass
 225  * without instantiating it (until it is needed), users may call
 226  * {@link #registerFactory }.  In this case, the objects are
 227  * instantiated by invoking the zero-argument public constructor of
 228  * the class.
 229  *
 230  * &lt;p&gt;&lt;b&gt;Subclassing&lt;/b&gt;
 231  *
 232  * Subclasses must implement the abstract method
 233  * &lt;code&gt;handleTransliterate()&lt;/code&gt;.  &lt;p&gt;Subclasses should override
 234  * the &lt;code&gt;transliterate()&lt;/code&gt; method taking a
 235  * &lt;code&gt;Replaceable&lt;/code&gt; and the &lt;code&gt;transliterate()&lt;/code&gt;
 236  * method taking a &lt;code&gt;String&lt;/code&gt; and &lt;code&gt;StringBuffer&lt;/code&gt;
 237  * if the performance of these methods can be improved over the
 238  * performance obtained by the default implementations in this class.
 239  *

























































































































































































































































 240  * @author Alan Liu
 241  * @stable ICU 2.0
 242  */
 243 class U_I18N_API Transliterator : public UObject {
 244 
 245 private:
 246 
 247     /**
 248      * Programmatic name, e.g., &quot;Latin-Arabic&quot;.
 249      */
 250     UnicodeString ID;
 251 
 252     /**
 253      * This transliterator&#39;s filter.  Any character for which
 254      * &lt;tt&gt;filter.contains()&lt;/tt&gt; returns &lt;tt&gt;false&lt;/tt&gt; will not be
 255      * altered by this transliterator.  If &lt;tt&gt;filter&lt;/tt&gt; is
 256      * &lt;tt&gt;null&lt;/tt&gt; then no filtering is applied.
 257      */
 258     UnicodeFilter* filter;
 259 
</pre>
<hr />
<pre>
 482      * @param index an array of three integers.
 483      * @param insertion text to be inserted and possibly
 484      * transliterated into the translation buffer at
 485      * &lt;code&gt;index.limit&lt;/code&gt;.
 486      * @param status    Output param to filled in with a success or an error.
 487      * @see #transliterate(Replaceable&amp;, UTransPosition&amp;, const UnicodeString&amp;, UErrorCode&amp;) const
 488      * @stable ICU 2.0
 489      */
 490     virtual void transliterate(Replaceable&amp; text, UTransPosition&amp; index,
 491                                UChar32 insertion,
 492                                UErrorCode&amp; status) const;
 493 
 494     /**
 495      * Transliterates the portion of the text buffer that can be
 496      * transliterated unambiguosly.  This is a convenience method; see
 497      * {@link
 498      * #transliterate(Replaceable&amp;, UTransPosition&amp;, const UnicodeString&amp;, UErrorCode&amp;) const }
 499      * for details.
 500      * @param text the buffer holding transliterated and
 501      * untransliterated text
<span class="line-modified"> 502      * @param index an array of three integers.  See {@link #transliterate(Replaceable&amp;, UTransPosition&amp;, const UnicodeString*, UErrorCode&amp;) const }.</span>
 503      * @param status    Output param to filled in with a success or an error.
<span class="line-modified"> 504      * @see #transliterate(Replaceable, int[], String)</span>
 505      * @stable ICU 2.0
 506      */
 507     virtual void transliterate(Replaceable&amp; text, UTransPosition&amp; index,
 508                                UErrorCode&amp; status) const;
 509 
 510     /**
 511      * Finishes any pending transliterations that were waiting for
 512      * more characters.  Clients should call this method as the last
 513      * call after a sequence of one or more calls to
 514      * &lt;code&gt;transliterate()&lt;/code&gt;.
 515      * @param text the buffer holding transliterated and
 516      * untransliterated text.
 517      * @param index the array of indices previously passed to {@link
 518      * #transliterate }
 519      * @stable ICU 2.0
 520      */
 521     virtual void finishTransliteration(Replaceable&amp; text,
 522                                        UTransPosition&amp; index) const;
 523 
 524 private:
</pre>
<hr />
<pre>
 615      * @param pos the indices indicating the start, limit, context
 616      * start, and context limit of the text.
 617      *
 618      * @param incremental if true, assume more text may be inserted at
 619      * &lt;code&gt;pos.limit&lt;/code&gt; and act accordingly.  Otherwise,
 620      * transliterate all text between &lt;code&gt;pos.start&lt;/code&gt; and
 621      * &lt;code&gt;pos.limit&lt;/code&gt; and move &lt;code&gt;pos.start&lt;/code&gt; up to
 622      * &lt;code&gt;pos.limit&lt;/code&gt;.
 623      *
 624      * @see #transliterate
 625      * @stable ICU 2.4
 626      */
 627     virtual void handleTransliterate(Replaceable&amp; text,
 628                                      UTransPosition&amp; pos,
 629                                      UBool incremental) const = 0;
 630 
 631 public:
 632     /**
 633      * Transliterate a substring of text, as specified by index, taking filters
 634      * into account.  This method is for subclasses that need to delegate to
<span class="line-modified"> 635      * another transliterator, such as CompoundTransliterator.</span>
 636      * @param text the text to be transliterated
 637      * @param index the position indices
 638      * @param incremental if TRUE, then assume more characters may be inserted
 639      * at index.limit, and postpone processing to accomodate future incoming
 640      * characters
 641      * @stable ICU 2.4
 642      */
 643     virtual void filteredTransliterate(Replaceable&amp; text,
 644                                        UTransPosition&amp; index,
 645                                        UBool incremental) const;
 646 
 647 private:
 648 
 649     /**
 650      * Top-level transliteration method, handling filtering, incremental and
 651      * non-incremental transliteration, and rollback.  All transliteration
 652      * public API methods eventually call this method with a rollback argument
 653      * of TRUE.  Other entities may call this method but rollback should be
 654      * FALSE.
 655      *
</pre>
<hr />
<pre>
 829                                           UTransDirection dir,
 830                                           UParseError&amp; parseError,
 831                                           UErrorCode&amp; status);
 832 
 833     /**
 834      * Returns a &lt;code&gt;Transliterator&lt;/code&gt; object given its ID.
 835      * The ID must be either a system transliterator ID or a ID registered
 836      * using &lt;code&gt;registerInstance()&lt;/code&gt;.
 837      * @param ID a valid ID, as enumerated by &lt;code&gt;getAvailableIDs()&lt;/code&gt;
 838      * @param dir        either FORWARD or REVERSE.
 839      * @param status     Output param to filled in with a success or an error.
 840      * @return A &lt;code&gt;Transliterator&lt;/code&gt; object with the given ID
 841      * @stable ICU 2.0
 842      */
 843     static Transliterator* U_EXPORT2 createInstance(const UnicodeString&amp; ID,
 844                                           UTransDirection dir,
 845                                           UErrorCode&amp; status);
 846 
 847     /**
 848      * Returns a &lt;code&gt;Transliterator&lt;/code&gt; object constructed from
<span class="line-modified"> 849      * the given rule string.  This will be a RuleBasedTransliterator,</span>
 850      * if the rule string contains only rules, or a
<span class="line-modified"> 851      * CompoundTransliterator, if it contains ID blocks, or a</span>
<span class="line-modified"> 852      * NullTransliterator, if it contains ID blocks which parse as</span>
 853      * empty for the given direction.

 854      * @param ID            the id for the transliterator.
 855      * @param rules         rules, separated by &#39;;&#39;
 856      * @param dir           either FORWARD or REVERSE.
<span class="line-modified"> 857      * @param parseError    Struct to recieve information on position</span>
 858      *                      of error if an error is encountered
 859      * @param status        Output param set to success/failure code.

 860      * @stable ICU 2.0
 861      */
 862     static Transliterator* U_EXPORT2 createFromRules(const UnicodeString&amp; ID,
 863                                            const UnicodeString&amp; rules,
 864                                            UTransDirection dir,
 865                                            UParseError&amp; parseError,
 866                                            UErrorCode&amp; status);
 867 
 868     /**
 869      * Create a rule string that can be passed to createFromRules()
 870      * to recreate this transliterator.
 871      * @param result the string to receive the rules.  Previous
 872      * contents will be deleted.
 873      * @param escapeUnprintable if TRUE then convert unprintable
 874      * character to their hex escape representations, \\uxxxx or
 875      * \\Uxxxxxxxx.  Unprintable characters are those other than
 876      * U+000A, U+0020..U+007E.
 877      * @stable ICU 2.0
 878      */
 879     virtual UnicodeString&amp; toRules(UnicodeString&amp; result,
</pre>
</td>
<td>
<hr />
<pre>
  14 
  15 #include &quot;unicode/utypes.h&quot;
  16 
  17 /**
  18  * \file
  19  * \brief C++ API: Tranforms text from one format to another.
  20  */
  21 
  22 #if !UCONFIG_NO_TRANSLITERATION
  23 
  24 #include &quot;unicode/uobject.h&quot;
  25 #include &quot;unicode/unistr.h&quot;
  26 #include &quot;unicode/parseerr.h&quot;
  27 #include &quot;unicode/utrans.h&quot; // UTransPosition, UTransDirection
  28 #include &quot;unicode/strenum.h&quot;
  29 
  30 U_NAMESPACE_BEGIN
  31 
  32 class UnicodeFilter;
  33 class UnicodeSet;

  34 class TransliteratorParser;
  35 class NormalizationTransliterator;
  36 class TransliteratorIDParser;
  37 
  38 /**
  39  *
  40  * &lt;code&gt;Transliterator&lt;/code&gt; is an abstract class that
  41  * transliterates text from one format to another.  The most common
  42  * kind of transliterator is a script, or alphabet, transliterator.
  43  * For example, a Russian to Latin transliterator changes Russian text
  44  * written in Cyrillic characters to phonetically equivalent Latin
  45  * characters.  It does not &lt;em&gt;translate&lt;/em&gt; Russian to English!
  46  * Transliteration, unlike translation, operates on characters, without
  47  * reference to the meanings of words and sentences.
  48  *
  49  * &lt;p&gt;Although script conversion is its most common use, a
  50  * transliterator can actually perform a more general class of tasks.
  51  * In fact, &lt;code&gt;Transliterator&lt;/code&gt; defines a very general API
  52  * which specifies only that a segment of the input text is replaced
  53  * by new text.  The particulars of this conversion are determined
</pre>
<hr />
<pre>
  59  * retain no information between calls to
  60  * &lt;code&gt;transliterate()&lt;/code&gt;.  (However, this does &lt;em&gt;not&lt;/em&gt;
  61  * mean that threads may share transliterators without synchronizing
  62  * them.  Transliterators are not immutable, so they must be
  63  * synchronized when shared between threads.)  This might seem to
  64  * limit the complexity of the transliteration operation.  In
  65  * practice, subclasses perform complex transliterations by delaying
  66  * the replacement of text until it is known that no other
  67  * replacements are possible.  In other words, although the
  68  * &lt;code&gt;Transliterator&lt;/code&gt; objects are stateless, the source text
  69  * itself embodies all the needed information, and delayed operation
  70  * allows arbitrary complexity.
  71  *
  72  * &lt;p&gt;&lt;b&gt;Batch transliteration&lt;/b&gt;
  73  *
  74  * &lt;p&gt;The simplest way to perform transliteration is all at once, on a
  75  * string of existing text.  This is referred to as &lt;em&gt;batch&lt;/em&gt;
  76  * transliteration.  For example, given a string &lt;code&gt;input&lt;/code&gt;
  77  * and a transliterator &lt;code&gt;t&lt;/code&gt;, the call
  78  *
<span class="line-modified">  79  *     String result = t.transliterate(input);</span>

  80  *
  81  * will transliterate it and return the result.  Other methods allow
  82  * the client to specify a substring to be transliterated and to use
  83  * {@link Replaceable } objects instead of strings, in order to
  84  * preserve out-of-band information (such as text styles).
  85  *
  86  * &lt;p&gt;&lt;b&gt;Keyboard transliteration&lt;/b&gt;
  87  *
  88  * &lt;p&gt;Somewhat more involved is &lt;em&gt;keyboard&lt;/em&gt;, or incremental
  89  * transliteration.  This is the transliteration of text that is
  90  * arriving from some source (typically the user&#39;s keyboard) one
  91  * character at a time, or in some other piecemeal fashion.
  92  *
  93  * &lt;p&gt;In keyboard transliteration, a &lt;code&gt;Replaceable&lt;/code&gt; buffer
  94  * stores the text.  As text is inserted, as much as possible is
  95  * transliterated on the fly.  This means a GUI that displays the
  96  * contents of the buffer may show text being modified as each new
  97  * character arrives.
  98  *
<span class="line-modified">  99  * &lt;p&gt;Consider the simple rule-based Transliterator:</span>
<span class="line-modified"> 100  * &lt;pre&gt;</span>
<span class="line-modified"> 101  *     th&gt;{theta}</span>
<span class="line-modified"> 102  *     t&gt;{tau}</span>
<span class="line-modified"> 103  * &lt;/pre&gt;</span>

 104  *
 105  * When the user types &#39;t&#39;, nothing will happen, since the
 106  * transliterator is waiting to see if the next character is &#39;h&#39;.  To
 107  * remedy this, we introduce the notion of a cursor, marked by a &#39;|&#39;
 108  * in the output string:
<span class="line-modified"> 109  * &lt;pre&gt;</span>
<span class="line-modified"> 110  *     t&gt;|{tau}</span>
<span class="line-modified"> 111  *     {tau}h&gt;{theta}</span>
<span class="line-modified"> 112  * &lt;/pre&gt;</span>

 113  *
 114  * Now when the user types &#39;t&#39;, tau appears, and if the next character
 115  * is &#39;h&#39;, the tau changes to a theta.  This is accomplished by
 116  * maintaining a cursor position (independent of the insertion point,
 117  * and invisible in the GUI) across calls to
 118  * &lt;code&gt;transliterate()&lt;/code&gt;.  Typically, the cursor will
 119  * be coincident with the insertion point, but in a case like the one
 120  * above, it will precede the insertion point.
 121  *
 122  * &lt;p&gt;Keyboard transliteration methods maintain a set of three indices
 123  * that are updated with each call to
 124  * &lt;code&gt;transliterate()&lt;/code&gt;, including the cursor, start,
 125  * and limit.  Since these indices are changed by the method, they are
 126  * passed in an &lt;code&gt;int[]&lt;/code&gt; array. The &lt;code&gt;START&lt;/code&gt; index
 127  * marks the beginning of the substring that the transliterator will
 128  * look at.  It is advanced as text becomes committed (but it is not
 129  * the committed index; that&#39;s the &lt;code&gt;CURSOR&lt;/code&gt;).  The
 130  * &lt;code&gt;CURSOR&lt;/code&gt; index, described above, marks the point at
 131  * which the transliterator last stopped, either because it reached
 132  * the end, or because it required more characters to disambiguate
 133  * between possible inputs.  The &lt;code&gt;CURSOR&lt;/code&gt; can also be
<span class="line-modified"> 134  * explicitly set by rules in a rule-based Transliterator.</span>
 135  * Any characters before the &lt;code&gt;CURSOR&lt;/code&gt; index are frozen;
 136  * future keyboard transliteration calls within this input sequence
 137  * will not change them.  New text is inserted at the
 138  * &lt;code&gt;LIMIT&lt;/code&gt; index, which marks the end of the substring that
 139  * the transliterator looks at.
 140  *
 141  * &lt;p&gt;Because keyboard transliteration assumes that more characters
 142  * are to arrive, it is conservative in its operation.  It only
 143  * transliterates when it can do so unambiguously.  Otherwise it waits
 144  * for more characters to arrive.  When the client code knows that no
 145  * more characters are forthcoming, perhaps because the user has
 146  * performed some input termination operation, then it should call
 147  * &lt;code&gt;finishTransliteration()&lt;/code&gt; to complete any
 148  * pending transliterations.
 149  *
 150  * &lt;p&gt;&lt;b&gt;Inverses&lt;/b&gt;
 151  *
 152  * &lt;p&gt;Pairs of transliterators may be inverses of one another.  For
 153  * example, if transliterator &lt;b&gt;A&lt;/b&gt; transliterates characters by
 154  * incrementing their Unicode value (so &quot;abc&quot; -&gt; &quot;def&quot;), and
</pre>
<hr />
<pre>
 216  * &lt;code&gt;registerInstance()&lt;/code&gt; at run time.  A registered instance
 217  * acts a template; future calls to {@link #createInstance } with the ID
 218  * of the registered object return clones of that object.  Thus any
 219  * object passed to &lt;tt&gt;registerInstance()&lt;/tt&gt; must implement
 220  * &lt;tt&gt;clone()&lt;/tt&gt; propertly.  To register a transliterator subclass
 221  * without instantiating it (until it is needed), users may call
 222  * {@link #registerFactory }.  In this case, the objects are
 223  * instantiated by invoking the zero-argument public constructor of
 224  * the class.
 225  *
 226  * &lt;p&gt;&lt;b&gt;Subclassing&lt;/b&gt;
 227  *
 228  * Subclasses must implement the abstract method
 229  * &lt;code&gt;handleTransliterate()&lt;/code&gt;.  &lt;p&gt;Subclasses should override
 230  * the &lt;code&gt;transliterate()&lt;/code&gt; method taking a
 231  * &lt;code&gt;Replaceable&lt;/code&gt; and the &lt;code&gt;transliterate()&lt;/code&gt;
 232  * method taking a &lt;code&gt;String&lt;/code&gt; and &lt;code&gt;StringBuffer&lt;/code&gt;
 233  * if the performance of these methods can be improved over the
 234  * performance obtained by the default implementations in this class.
 235  *
<span class="line-added"> 236  * &lt;p&gt;&lt;b&gt;Rule syntax&lt;/b&gt;</span>
<span class="line-added"> 237  *</span>
<span class="line-added"> 238  * &lt;p&gt;A set of rules determines how to perform translations.</span>
<span class="line-added"> 239  * Rules within a rule set are separated by semicolons (&#39;;&#39;).</span>
<span class="line-added"> 240  * To include a literal semicolon, prefix it with a backslash (&#39;\&#39;).</span>
<span class="line-added"> 241  * Unicode Pattern_White_Space is ignored.</span>
<span class="line-added"> 242  * If the first non-blank character on a line is &#39;#&#39;,</span>
<span class="line-added"> 243  * the entire line is ignored as a comment.</span>
<span class="line-added"> 244  *</span>
<span class="line-added"> 245  * &lt;p&gt;Each set of rules consists of two groups, one forward, and one</span>
<span class="line-added"> 246  * reverse. This is a convention that is not enforced; rules for one</span>
<span class="line-added"> 247  * direction may be omitted, with the result that translations in</span>
<span class="line-added"> 248  * that direction will not modify the source text. In addition,</span>
<span class="line-added"> 249  * bidirectional forward-reverse rules may be specified for</span>
<span class="line-added"> 250  * symmetrical transformations.</span>
<span class="line-added"> 251  *</span>
<span class="line-added"> 252  * &lt;p&gt;Note: Another description of the Transliterator rule syntax is available in</span>
<span class="line-added"> 253  * &lt;a href=&quot;https://www.unicode.org/reports/tr35/tr35-general.html#Transform_Rules_Syntax&quot;&gt;section</span>
<span class="line-added"> 254  * Transform Rules Syntax of UTS #35: Unicode LDML&lt;/a&gt;.</span>
<span class="line-added"> 255  * The rules are shown there using arrow symbols ← and → and ↔.</span>
<span class="line-added"> 256  * ICU supports both those and the equivalent ASCII symbols &amp;lt; and &amp;gt; and &amp;lt;&amp;gt;.</span>
<span class="line-added"> 257  *</span>
<span class="line-added"> 258  * &lt;p&gt;Rule statements take one of the following forms:</span>
<span class="line-added"> 259  *</span>
<span class="line-added"> 260  * &lt;dl&gt;</span>
<span class="line-added"> 261  *     &lt;dt&gt;&lt;code&gt;$alefmadda=\\u0622;&lt;/code&gt;&lt;/dt&gt;</span>
<span class="line-added"> 262  *     &lt;dd&gt;&lt;strong&gt;Variable definition.&lt;/strong&gt; The name on the</span>
<span class="line-added"> 263  *         left is assigned the text on the right. In this example,</span>
<span class="line-added"> 264  *         after this statement, instances of the left hand name,</span>
<span class="line-added"> 265  *         &amp;quot;&lt;code&gt;$alefmadda&lt;/code&gt;&amp;quot;, will be replaced by</span>
<span class="line-added"> 266  *         the Unicode character U+0622. Variable names must begin</span>
<span class="line-added"> 267  *         with a letter and consist only of letters, digits, and</span>
<span class="line-added"> 268  *         underscores. Case is significant. Duplicate names cause</span>
<span class="line-added"> 269  *         an exception to be thrown, that is, variables cannot be</span>
<span class="line-added"> 270  *         redefined. The right hand side may contain well-formed</span>
<span class="line-added"> 271  *         text of any length, including no text at all (&amp;quot;&lt;code&gt;$empty=;&lt;/code&gt;&amp;quot;).</span>
<span class="line-added"> 272  *         The right hand side may contain embedded &lt;code&gt;UnicodeSet&lt;/code&gt;</span>
<span class="line-added"> 273  *         patterns, for example, &amp;quot;&lt;code&gt;$softvowel=[eiyEIY]&lt;/code&gt;&amp;quot;.&lt;/dd&gt;</span>
<span class="line-added"> 274  *     &lt;dt&gt;&lt;code&gt;ai&amp;gt;$alefmadda;&lt;/code&gt;&lt;/dt&gt;</span>
<span class="line-added"> 275  *     &lt;dd&gt;&lt;strong&gt;Forward translation rule.&lt;/strong&gt; This rule</span>
<span class="line-added"> 276  *         states that the string on the left will be changed to the</span>
<span class="line-added"> 277  *         string on the right when performing forward</span>
<span class="line-added"> 278  *         transliteration.&lt;/dd&gt;</span>
<span class="line-added"> 279  *     &lt;dt&gt;&lt;code&gt;ai&amp;lt;$alefmadda;&lt;/code&gt;&lt;/dt&gt;</span>
<span class="line-added"> 280  *     &lt;dd&gt;&lt;strong&gt;Reverse translation rule.&lt;/strong&gt; This rule</span>
<span class="line-added"> 281  *         states that the string on the right will be changed to</span>
<span class="line-added"> 282  *         the string on the left when performing reverse</span>
<span class="line-added"> 283  *         transliteration.&lt;/dd&gt;</span>
<span class="line-added"> 284  * &lt;/dl&gt;</span>
<span class="line-added"> 285  *</span>
<span class="line-added"> 286  * &lt;dl&gt;</span>
<span class="line-added"> 287  *     &lt;dt&gt;&lt;code&gt;ai&amp;lt;&amp;gt;$alefmadda;&lt;/code&gt;&lt;/dt&gt;</span>
<span class="line-added"> 288  *     &lt;dd&gt;&lt;strong&gt;Bidirectional translation rule.&lt;/strong&gt; This</span>
<span class="line-added"> 289  *         rule states that the string on the right will be changed</span>
<span class="line-added"> 290  *         to the string on the left when performing forward</span>
<span class="line-added"> 291  *         transliteration, and vice versa when performing reverse</span>
<span class="line-added"> 292  *         transliteration.&lt;/dd&gt;</span>
<span class="line-added"> 293  * &lt;/dl&gt;</span>
<span class="line-added"> 294  *</span>
<span class="line-added"> 295  * &lt;p&gt;Translation rules consist of a &lt;em&gt;match pattern&lt;/em&gt; and an &lt;em&gt;output</span>
<span class="line-added"> 296  * string&lt;/em&gt;. The match pattern consists of literal characters,</span>
<span class="line-added"> 297  * optionally preceded by context, and optionally followed by</span>
<span class="line-added"> 298  * context. Context characters, like literal pattern characters,</span>
<span class="line-added"> 299  * must be matched in the text being transliterated. However, unlike</span>
<span class="line-added"> 300  * literal pattern characters, they are not replaced by the output</span>
<span class="line-added"> 301  * text. For example, the pattern &amp;quot;&lt;code&gt;abc{def}&lt;/code&gt;&amp;quot;</span>
<span class="line-added"> 302  * indicates the characters &amp;quot;&lt;code&gt;def&lt;/code&gt;&amp;quot; must be</span>
<span class="line-added"> 303  * preceded by &amp;quot;&lt;code&gt;abc&lt;/code&gt;&amp;quot; for a successful match.</span>
<span class="line-added"> 304  * If there is a successful match, &amp;quot;&lt;code&gt;def&lt;/code&gt;&amp;quot; will</span>
<span class="line-added"> 305  * be replaced, but not &amp;quot;&lt;code&gt;abc&lt;/code&gt;&amp;quot;. The final &#39;&lt;code&gt;}&lt;/code&gt;&#39;</span>
<span class="line-added"> 306  * is optional, so &amp;quot;&lt;code&gt;abc{def&lt;/code&gt;&amp;quot; is equivalent to</span>
<span class="line-added"> 307  * &amp;quot;&lt;code&gt;abc{def}&lt;/code&gt;&amp;quot;. Another example is &amp;quot;&lt;code&gt;{123}456&lt;/code&gt;&amp;quot;</span>
<span class="line-added"> 308  * (or &amp;quot;&lt;code&gt;123}456&lt;/code&gt;&amp;quot;) in which the literal</span>
<span class="line-added"> 309  * pattern &amp;quot;&lt;code&gt;123&lt;/code&gt;&amp;quot; must be followed by &amp;quot;&lt;code&gt;456&lt;/code&gt;&amp;quot;.</span>
<span class="line-added"> 310  *</span>
<span class="line-added"> 311  * &lt;p&gt;The output string of a forward or reverse rule consists of</span>
<span class="line-added"> 312  * characters to replace the literal pattern characters. If the</span>
<span class="line-added"> 313  * output string contains the character &#39;&lt;code&gt;|&lt;/code&gt;&#39;, this is</span>
<span class="line-added"> 314  * taken to indicate the location of the &lt;em&gt;cursor&lt;/em&gt; after</span>
<span class="line-added"> 315  * replacement. The cursor is the point in the text at which the</span>
<span class="line-added"> 316  * next replacement, if any, will be applied. The cursor is usually</span>
<span class="line-added"> 317  * placed within the replacement text; however, it can actually be</span>
<span class="line-added"> 318  * placed into the precending or following context by using the</span>
<span class="line-added"> 319  * special character &#39;@&#39;. Examples:</span>
<span class="line-added"> 320  *</span>
<span class="line-added"> 321  * &lt;pre&gt;</span>
<span class="line-added"> 322  *     a {foo} z &amp;gt; | @ bar; # foo -&amp;gt; bar, move cursor before a</span>
<span class="line-added"> 323  *     {foo} xyz &amp;gt; bar @@|; #&amp;nbsp;foo -&amp;gt; bar, cursor between y and z</span>
<span class="line-added"> 324  * &lt;/pre&gt;</span>
<span class="line-added"> 325  *</span>
<span class="line-added"> 326  * &lt;p&gt;&lt;b&gt;UnicodeSet&lt;/b&gt;</span>
<span class="line-added"> 327  *</span>
<span class="line-added"> 328  * &lt;p&gt;&lt;code&gt;UnicodeSet&lt;/code&gt; patterns may appear anywhere that</span>
<span class="line-added"> 329  * makes sense. They may appear in variable definitions.</span>
<span class="line-added"> 330  * Contrariwise, &lt;code&gt;UnicodeSet&lt;/code&gt; patterns may themselves</span>
<span class="line-added"> 331  * contain variable references, such as &amp;quot;&lt;code&gt;$a=[a-z];$not_a=[^$a]&lt;/code&gt;&amp;quot;,</span>
<span class="line-added"> 332  * or &amp;quot;&lt;code&gt;$range=a-z;$ll=[$range]&lt;/code&gt;&amp;quot;.</span>
<span class="line-added"> 333  *</span>
<span class="line-added"> 334  * &lt;p&gt;&lt;code&gt;UnicodeSet&lt;/code&gt; patterns may also be embedded directly</span>
<span class="line-added"> 335  * into rule strings. Thus, the following two rules are equivalent:</span>
<span class="line-added"> 336  *</span>
<span class="line-added"> 337  * &lt;pre&gt;</span>
<span class="line-added"> 338  *     $vowel=[aeiou]; $vowel&amp;gt;&#39;*&#39;; # One way to do this</span>
<span class="line-added"> 339  *     [aeiou]&amp;gt;&#39;*&#39;; # Another way</span>
<span class="line-added"> 340  * &lt;/pre&gt;</span>
<span class="line-added"> 341  *</span>
<span class="line-added"> 342  * &lt;p&gt;See {@link UnicodeSet} for more documentation and examples.</span>
<span class="line-added"> 343  *</span>
<span class="line-added"> 344  * &lt;p&gt;&lt;b&gt;Segments&lt;/b&gt;</span>
<span class="line-added"> 345  *</span>
<span class="line-added"> 346  * &lt;p&gt;Segments of the input string can be matched and copied to the</span>
<span class="line-added"> 347  * output string. This makes certain sets of rules simpler and more</span>
<span class="line-added"> 348  * general, and makes reordering possible. For example:</span>
<span class="line-added"> 349  *</span>
<span class="line-added"> 350  * &lt;pre&gt;</span>
<span class="line-added"> 351  *     ([a-z]) &amp;gt; $1 $1; # double lowercase letters</span>
<span class="line-added"> 352  *     ([:Lu:]) ([:Ll:]) &amp;gt; $2 $1; # reverse order of Lu-Ll pairs</span>
<span class="line-added"> 353  * &lt;/pre&gt;</span>
<span class="line-added"> 354  *</span>
<span class="line-added"> 355  * &lt;p&gt;The segment of the input string to be copied is delimited by</span>
<span class="line-added"> 356  * &amp;quot;&lt;code&gt;(&lt;/code&gt;&amp;quot; and &amp;quot;&lt;code&gt;)&lt;/code&gt;&amp;quot;. Up to</span>
<span class="line-added"> 357  * nine segments may be defined. Segments may not overlap. In the</span>
<span class="line-added"> 358  * output string, &amp;quot;&lt;code&gt;$1&lt;/code&gt;&amp;quot; through &amp;quot;&lt;code&gt;$9&lt;/code&gt;&amp;quot;</span>
<span class="line-added"> 359  * represent the input string segments, in left-to-right order of</span>
<span class="line-added"> 360  * definition.</span>
<span class="line-added"> 361  *</span>
<span class="line-added"> 362  * &lt;p&gt;&lt;b&gt;Anchors&lt;/b&gt;</span>
<span class="line-added"> 363  *</span>
<span class="line-added"> 364  * &lt;p&gt;Patterns can be anchored to the beginning or the end of the text. This is done with the</span>
<span class="line-added"> 365  * special characters &#39;&lt;code&gt;^&lt;/code&gt;&#39; and &#39;&lt;code&gt;$&lt;/code&gt;&#39;. For example:</span>
<span class="line-added"> 366  *</span>
<span class="line-added"> 367  * &lt;pre&gt;</span>
<span class="line-added"> 368  *   ^ a&amp;nbsp;&amp;nbsp; &amp;gt; &#39;BEG_A&#39;; &amp;nbsp;&amp;nbsp;# match &#39;a&#39; at start of text</span>
<span class="line-added"> 369  *   &amp;nbsp; a&amp;nbsp;&amp;nbsp; &amp;gt; &#39;A&#39;; # match other instances of &#39;a&#39;</span>
<span class="line-added"> 370  *   &amp;nbsp; z $ &amp;gt; &#39;END_Z&#39;; &amp;nbsp;&amp;nbsp;# match &#39;z&#39; at end of text</span>
<span class="line-added"> 371  *   &amp;nbsp; z&amp;nbsp;&amp;nbsp; &amp;gt; &#39;Z&#39;;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; # match other instances of &#39;z&#39;</span>
<span class="line-added"> 372  * &lt;/pre&gt;</span>
<span class="line-added"> 373  *</span>
<span class="line-added"> 374  * &lt;p&gt;It is also possible to match the beginning or the end of the text using a &lt;code&gt;UnicodeSet&lt;/code&gt;.</span>
<span class="line-added"> 375  * This is done by including a virtual anchor character &#39;&lt;code&gt;$&lt;/code&gt;&#39; at the end of the</span>
<span class="line-added"> 376  * set pattern. Although this is usually the match chafacter for the end anchor, the set will</span>
<span class="line-added"> 377  * match either the beginning or the end of the text, depending on its placement. For</span>
<span class="line-added"> 378  * example:</span>
<span class="line-added"> 379  *</span>
<span class="line-added"> 380  * &lt;pre&gt;</span>
<span class="line-added"> 381  *   $x = [a-z$]; &amp;nbsp;&amp;nbsp;# match &#39;a&#39; through &#39;z&#39; OR anchor</span>
<span class="line-added"> 382  *   $x 1&amp;nbsp;&amp;nbsp;&amp;nbsp; &amp;gt; 2;&amp;nbsp;&amp;nbsp; # match &#39;1&#39; after a-z or at the start</span>
<span class="line-added"> 383  *   &amp;nbsp;&amp;nbsp; 3 $x &amp;gt; 4; &amp;nbsp;&amp;nbsp;# match &#39;3&#39; before a-z or at the end</span>
<span class="line-added"> 384  * &lt;/pre&gt;</span>
<span class="line-added"> 385  *</span>
<span class="line-added"> 386  * &lt;p&gt;&lt;b&gt;Example&lt;/b&gt;</span>
<span class="line-added"> 387  *</span>
<span class="line-added"> 388  * &lt;p&gt;The following example rules illustrate many of the features of</span>
<span class="line-added"> 389  * the rule language.</span>
<span class="line-added"> 390  *</span>
<span class="line-added"> 391  * &lt;table border=&quot;0&quot; cellpadding=&quot;4&quot;&gt;</span>
<span class="line-added"> 392  *     &lt;tr&gt;</span>
<span class="line-added"> 393  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;Rule 1.&lt;/td&gt;</span>
<span class="line-added"> 394  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;abc{def}&amp;gt;x|y&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 395  *     &lt;/tr&gt;</span>
<span class="line-added"> 396  *     &lt;tr&gt;</span>
<span class="line-added"> 397  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;Rule 2.&lt;/td&gt;</span>
<span class="line-added"> 398  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;xyz&amp;gt;r&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 399  *     &lt;/tr&gt;</span>
<span class="line-added"> 400  *     &lt;tr&gt;</span>
<span class="line-added"> 401  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;Rule 3.&lt;/td&gt;</span>
<span class="line-added"> 402  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;yz&amp;gt;q&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 403  *     &lt;/tr&gt;</span>
<span class="line-added"> 404  * &lt;/table&gt;</span>
<span class="line-added"> 405  *</span>
<span class="line-added"> 406  * &lt;p&gt;Applying these rules to the string &amp;quot;&lt;code&gt;adefabcdefz&lt;/code&gt;&amp;quot;</span>
<span class="line-added"> 407  * yields the following results:</span>
<span class="line-added"> 408  *</span>
<span class="line-added"> 409  * &lt;table border=&quot;0&quot; cellpadding=&quot;4&quot;&gt;</span>
<span class="line-added"> 410  *     &lt;tr&gt;</span>
<span class="line-added"> 411  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;|adefabcdefz&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 412  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;Initial state, no rules match. Advance</span>
<span class="line-added"> 413  *         cursor.&lt;/td&gt;</span>
<span class="line-added"> 414  *     &lt;/tr&gt;</span>
<span class="line-added"> 415  *     &lt;tr&gt;</span>
<span class="line-added"> 416  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;a|defabcdefz&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 417  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;Still no match. Rule 1 does not match</span>
<span class="line-added"> 418  *         because the preceding context is not present.&lt;/td&gt;</span>
<span class="line-added"> 419  *     &lt;/tr&gt;</span>
<span class="line-added"> 420  *     &lt;tr&gt;</span>
<span class="line-added"> 421  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;ad|efabcdefz&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 422  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;Still no match. Keep advancing until</span>
<span class="line-added"> 423  *         there is a match...&lt;/td&gt;</span>
<span class="line-added"> 424  *     &lt;/tr&gt;</span>
<span class="line-added"> 425  *     &lt;tr&gt;</span>
<span class="line-added"> 426  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;ade|fabcdefz&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 427  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;...&lt;/td&gt;</span>
<span class="line-added"> 428  *     &lt;/tr&gt;</span>
<span class="line-added"> 429  *     &lt;tr&gt;</span>
<span class="line-added"> 430  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;adef|abcdefz&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 431  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;...&lt;/td&gt;</span>
<span class="line-added"> 432  *     &lt;/tr&gt;</span>
<span class="line-added"> 433  *     &lt;tr&gt;</span>
<span class="line-added"> 434  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;adefa|bcdefz&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 435  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;...&lt;/td&gt;</span>
<span class="line-added"> 436  *     &lt;/tr&gt;</span>
<span class="line-added"> 437  *     &lt;tr&gt;</span>
<span class="line-added"> 438  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;adefab|cdefz&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 439  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;...&lt;/td&gt;</span>
<span class="line-added"> 440  *     &lt;/tr&gt;</span>
<span class="line-added"> 441  *     &lt;tr&gt;</span>
<span class="line-added"> 442  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;adefabc|defz&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 443  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;Rule 1 matches; replace &amp;quot;&lt;code&gt;def&lt;/code&gt;&amp;quot;</span>
<span class="line-added"> 444  *         with &amp;quot;&lt;code&gt;xy&lt;/code&gt;&amp;quot; and back up the cursor</span>
<span class="line-added"> 445  *         to before the &#39;&lt;code&gt;y&lt;/code&gt;&#39;.&lt;/td&gt;</span>
<span class="line-added"> 446  *     &lt;/tr&gt;</span>
<span class="line-added"> 447  *     &lt;tr&gt;</span>
<span class="line-added"> 448  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;adefabcx|yz&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 449  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;Although &amp;quot;&lt;code&gt;xyz&lt;/code&gt;&amp;quot; is</span>
<span class="line-added"> 450  *         present, rule 2 does not match because the cursor is</span>
<span class="line-added"> 451  *         before the &#39;&lt;code&gt;y&lt;/code&gt;&#39;, not before the &#39;&lt;code&gt;x&lt;/code&gt;&#39;.</span>
<span class="line-added"> 452  *         Rule 3 does match. Replace &amp;quot;&lt;code&gt;yz&lt;/code&gt;&amp;quot;</span>
<span class="line-added"> 453  *         with &amp;quot;&lt;code&gt;q&lt;/code&gt;&amp;quot;.&lt;/td&gt;</span>
<span class="line-added"> 454  *     &lt;/tr&gt;</span>
<span class="line-added"> 455  *     &lt;tr&gt;</span>
<span class="line-added"> 456  *         &lt;td style=&quot;vertical-align: top; write-space: nowrap;&quot;&gt;&lt;code&gt;adefabcxq|&lt;/code&gt;&lt;/td&gt;</span>
<span class="line-added"> 457  *         &lt;td style=&quot;vertical-align: top;&quot;&gt;The cursor is at the end;</span>
<span class="line-added"> 458  *         transliteration is complete.&lt;/td&gt;</span>
<span class="line-added"> 459  *     &lt;/tr&gt;</span>
<span class="line-added"> 460  * &lt;/table&gt;</span>
<span class="line-added"> 461  *</span>
<span class="line-added"> 462  * &lt;p&gt;The order of rules is significant. If multiple rules may match</span>
<span class="line-added"> 463  * at some point, the first matching rule is applied.</span>
<span class="line-added"> 464  *</span>
<span class="line-added"> 465  * &lt;p&gt;Forward and reverse rules may have an empty output string.</span>
<span class="line-added"> 466  * Otherwise, an empty left or right hand side of any statement is a</span>
<span class="line-added"> 467  * syntax error.</span>
<span class="line-added"> 468  *</span>
<span class="line-added"> 469  * &lt;p&gt;Single quotes are used to quote any character other than a</span>
<span class="line-added"> 470  * digit or letter. To specify a single quote itself, inside or</span>
<span class="line-added"> 471  * outside of quotes, use two single quotes in a row. For example,</span>
<span class="line-added"> 472  * the rule &amp;quot;&lt;code&gt;&#39;&amp;gt;&#39;&amp;gt;o&#39;&#39;clock&lt;/code&gt;&amp;quot; changes the</span>
<span class="line-added"> 473  * string &amp;quot;&lt;code&gt;&amp;gt;&lt;/code&gt;&amp;quot; to the string &amp;quot;&lt;code&gt;o&#39;clock&lt;/code&gt;&amp;quot;.</span>
<span class="line-added"> 474  *</span>
<span class="line-added"> 475  * &lt;p&gt;&lt;b&gt;Notes&lt;/b&gt;</span>
<span class="line-added"> 476  *</span>
<span class="line-added"> 477  * &lt;p&gt;While a Transliterator is being built from rules, it checks that</span>
<span class="line-added"> 478  * the rules are added in proper order. For example, if the rule</span>
<span class="line-added"> 479  * &amp;quot;a&amp;gt;x&amp;quot; is followed by the rule &amp;quot;ab&amp;gt;y&amp;quot;,</span>
<span class="line-added"> 480  * then the second rule will throw an exception. The reason is that</span>
<span class="line-added"> 481  * the second rule can never be triggered, since the first rule</span>
<span class="line-added"> 482  * always matches anything it matches. In other words, the first</span>
<span class="line-added"> 483  * rule &lt;em&gt;masks&lt;/em&gt; the second rule.</span>
<span class="line-added"> 484  *</span>
 485  * @author Alan Liu
 486  * @stable ICU 2.0
 487  */
 488 class U_I18N_API Transliterator : public UObject {
 489 
 490 private:
 491 
 492     /**
 493      * Programmatic name, e.g., &quot;Latin-Arabic&quot;.
 494      */
 495     UnicodeString ID;
 496 
 497     /**
 498      * This transliterator&#39;s filter.  Any character for which
 499      * &lt;tt&gt;filter.contains()&lt;/tt&gt; returns &lt;tt&gt;false&lt;/tt&gt; will not be
 500      * altered by this transliterator.  If &lt;tt&gt;filter&lt;/tt&gt; is
 501      * &lt;tt&gt;null&lt;/tt&gt; then no filtering is applied.
 502      */
 503     UnicodeFilter* filter;
 504 
</pre>
<hr />
<pre>
 727      * @param index an array of three integers.
 728      * @param insertion text to be inserted and possibly
 729      * transliterated into the translation buffer at
 730      * &lt;code&gt;index.limit&lt;/code&gt;.
 731      * @param status    Output param to filled in with a success or an error.
 732      * @see #transliterate(Replaceable&amp;, UTransPosition&amp;, const UnicodeString&amp;, UErrorCode&amp;) const
 733      * @stable ICU 2.0
 734      */
 735     virtual void transliterate(Replaceable&amp; text, UTransPosition&amp; index,
 736                                UChar32 insertion,
 737                                UErrorCode&amp; status) const;
 738 
 739     /**
 740      * Transliterates the portion of the text buffer that can be
 741      * transliterated unambiguosly.  This is a convenience method; see
 742      * {@link
 743      * #transliterate(Replaceable&amp;, UTransPosition&amp;, const UnicodeString&amp;, UErrorCode&amp;) const }
 744      * for details.
 745      * @param text the buffer holding transliterated and
 746      * untransliterated text
<span class="line-modified"> 747      * @param index an array of three integers.</span>
 748      * @param status    Output param to filled in with a success or an error.
<span class="line-modified"> 749      * @see #transliterate(Replaceable&amp;, UTransPosition&amp;, const UnicodeString&amp;, UErrorCode &amp;) const</span>
 750      * @stable ICU 2.0
 751      */
 752     virtual void transliterate(Replaceable&amp; text, UTransPosition&amp; index,
 753                                UErrorCode&amp; status) const;
 754 
 755     /**
 756      * Finishes any pending transliterations that were waiting for
 757      * more characters.  Clients should call this method as the last
 758      * call after a sequence of one or more calls to
 759      * &lt;code&gt;transliterate()&lt;/code&gt;.
 760      * @param text the buffer holding transliterated and
 761      * untransliterated text.
 762      * @param index the array of indices previously passed to {@link
 763      * #transliterate }
 764      * @stable ICU 2.0
 765      */
 766     virtual void finishTransliteration(Replaceable&amp; text,
 767                                        UTransPosition&amp; index) const;
 768 
 769 private:
</pre>
<hr />
<pre>
 860      * @param pos the indices indicating the start, limit, context
 861      * start, and context limit of the text.
 862      *
 863      * @param incremental if true, assume more text may be inserted at
 864      * &lt;code&gt;pos.limit&lt;/code&gt; and act accordingly.  Otherwise,
 865      * transliterate all text between &lt;code&gt;pos.start&lt;/code&gt; and
 866      * &lt;code&gt;pos.limit&lt;/code&gt; and move &lt;code&gt;pos.start&lt;/code&gt; up to
 867      * &lt;code&gt;pos.limit&lt;/code&gt;.
 868      *
 869      * @see #transliterate
 870      * @stable ICU 2.4
 871      */
 872     virtual void handleTransliterate(Replaceable&amp; text,
 873                                      UTransPosition&amp; pos,
 874                                      UBool incremental) const = 0;
 875 
 876 public:
 877     /**
 878      * Transliterate a substring of text, as specified by index, taking filters
 879      * into account.  This method is for subclasses that need to delegate to
<span class="line-modified"> 880      * another transliterator.</span>
 881      * @param text the text to be transliterated
 882      * @param index the position indices
 883      * @param incremental if TRUE, then assume more characters may be inserted
 884      * at index.limit, and postpone processing to accomodate future incoming
 885      * characters
 886      * @stable ICU 2.4
 887      */
 888     virtual void filteredTransliterate(Replaceable&amp; text,
 889                                        UTransPosition&amp; index,
 890                                        UBool incremental) const;
 891 
 892 private:
 893 
 894     /**
 895      * Top-level transliteration method, handling filtering, incremental and
 896      * non-incremental transliteration, and rollback.  All transliteration
 897      * public API methods eventually call this method with a rollback argument
 898      * of TRUE.  Other entities may call this method but rollback should be
 899      * FALSE.
 900      *
</pre>
<hr />
<pre>
1074                                           UTransDirection dir,
1075                                           UParseError&amp; parseError,
1076                                           UErrorCode&amp; status);
1077 
1078     /**
1079      * Returns a &lt;code&gt;Transliterator&lt;/code&gt; object given its ID.
1080      * The ID must be either a system transliterator ID or a ID registered
1081      * using &lt;code&gt;registerInstance()&lt;/code&gt;.
1082      * @param ID a valid ID, as enumerated by &lt;code&gt;getAvailableIDs()&lt;/code&gt;
1083      * @param dir        either FORWARD or REVERSE.
1084      * @param status     Output param to filled in with a success or an error.
1085      * @return A &lt;code&gt;Transliterator&lt;/code&gt; object with the given ID
1086      * @stable ICU 2.0
1087      */
1088     static Transliterator* U_EXPORT2 createInstance(const UnicodeString&amp; ID,
1089                                           UTransDirection dir,
1090                                           UErrorCode&amp; status);
1091 
1092     /**
1093      * Returns a &lt;code&gt;Transliterator&lt;/code&gt; object constructed from
<span class="line-modified">1094      * the given rule string.  This will be a rule-based Transliterator,</span>
1095      * if the rule string contains only rules, or a
<span class="line-modified">1096      * compound Transliterator, if it contains ID blocks, or a</span>
<span class="line-modified">1097      * null Transliterator, if it contains ID blocks which parse as</span>
1098      * empty for the given direction.
<span class="line-added">1099      *</span>
1100      * @param ID            the id for the transliterator.
1101      * @param rules         rules, separated by &#39;;&#39;
1102      * @param dir           either FORWARD or REVERSE.
<span class="line-modified">1103      * @param parseError    Struct to receive information on position</span>
1104      *                      of error if an error is encountered
1105      * @param status        Output param set to success/failure code.
<span class="line-added">1106      * @return a newly created Transliterator</span>
1107      * @stable ICU 2.0
1108      */
1109     static Transliterator* U_EXPORT2 createFromRules(const UnicodeString&amp; ID,
1110                                            const UnicodeString&amp; rules,
1111                                            UTransDirection dir,
1112                                            UParseError&amp; parseError,
1113                                            UErrorCode&amp; status);
1114 
1115     /**
1116      * Create a rule string that can be passed to createFromRules()
1117      * to recreate this transliterator.
1118      * @param result the string to receive the rules.  Previous
1119      * contents will be deleted.
1120      * @param escapeUnprintable if TRUE then convert unprintable
1121      * character to their hex escape representations, \\uxxxx or
1122      * \\Uxxxxxxxx.  Unprintable characters are those other than
1123      * U+000A, U+0020..U+007E.
1124      * @stable ICU 2.0
1125      */
1126     virtual UnicodeString&amp; toRules(UnicodeString&amp; result,
</pre>
</td>
</tr>
</table>
<center><a href="timezone.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="tzfmt.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>