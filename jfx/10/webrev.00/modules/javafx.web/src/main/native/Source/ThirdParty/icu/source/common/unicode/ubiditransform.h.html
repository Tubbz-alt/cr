<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.web/src/main/native/Source/ThirdParty/icu/source/common/unicode/ubiditransform.h</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2 ******************************************************************************
  3 *
  4 * Â© 2016 and later: Unicode, Inc. and others.
  5 * License &amp; terms of use: http://www.unicode.org/copyright.html
  6 *
  7 ******************************************************************************
  8 *   file name:  ubiditransform.h
  9 *   encoding:   UTF-8
 10 *   tab size:   8 (not used)
 11 *   indentation:4
 12 *
 13 *   created on: 2016jul24
 14 *   created by: Lina Kemmel
 15 *
 16 */
 17 
 18 #ifndef UBIDITRANSFORM_H
 19 #define UBIDITRANSFORM_H
 20 
 21 #include &quot;unicode/utypes.h&quot;
 22 #include &quot;unicode/ubidi.h&quot;
 23 #include &quot;unicode/uchar.h&quot;
 24 #include &quot;unicode/localpointer.h&quot;
 25 
 26 /**
 27  * \file
 28  * \brief Bidi Transformations
 29  */
 30 
 31 /**
 32  * `UBiDiOrder` indicates the order of text.
 33  *
 34  * This bidi transformation engine supports all possible combinations (4 in
 35  * total) of input and output text order:
 36  *
 37  *   - &lt;logical input, visual output&gt;: unless the output direction is RTL, this
 38  *     corresponds to a normal operation of the Bidi algorithm as described in the
 39  *     Unicode Technical Report and implemented by `UBiDi` when the
 40  *     reordering mode is set to `UBIDI_REORDER_DEFAULT`. Visual RTL
 41  *     mode is not supported by `UBiDi` and is accomplished through
 42  *     reversing a visual LTR string,
 43  *
 44  *   - &lt;visual input, logical output&gt;: unless the input direction is RTL, this
 45  *     corresponds to an &quot;inverse bidi algorithm&quot; in `UBiDi` with the
 46  *     reordering mode set to `UBIDI_REORDER_INVERSE_LIKE_DIRECT`.
 47  *     Visual RTL mode is not not supported by `UBiDi` and is
 48  *     accomplished through reversing a visual LTR string,
 49  *
 50  *   - &lt;logical input, logical output&gt;: if the input and output base directions
 51  *     mismatch, this corresponds to the `UBiDi` implementation with the
 52  *     reordering mode set to `UBIDI_REORDER_RUNS_ONLY`; and if the
 53  *     input and output base directions are identical, the transformation engine
 54  *     will only handle character mirroring and Arabic shaping operations without
 55  *     reordering,
 56  *
 57  *   - &lt;visual input, visual output&gt;: this reordering mode is not supported by
 58  *     the `UBiDi` engine; it implies character mirroring, Arabic
 59  *     shaping, and - if the input/output base directions mismatch -  string
 60  *     reverse operations.
 61  * @see ubidi_setInverse
 62  * @see ubidi_setReorderingMode
 63  * @see UBIDI_REORDER_DEFAULT
 64  * @see UBIDI_REORDER_INVERSE_LIKE_DIRECT
 65  * @see UBIDI_REORDER_RUNS_ONLY
 66  * @stable ICU 58
 67  */
 68 typedef enum {
 69     /** 0: Constant indicating a logical order.
 70       * This is the default for input text.
 71       * @stable ICU 58
 72       */
 73     UBIDI_LOGICAL = 0,
 74     /** 1: Constant indicating a visual order.
 75       * This is a default for output text.
 76       * @stable ICU 58
 77       */
 78     UBIDI_VISUAL
 79 } UBiDiOrder;
 80 
 81 /**
 82  * &lt;code&gt;UBiDiMirroring&lt;/code&gt; indicates whether or not characters with the
 83  * &quot;mirrored&quot; property in RTL runs should be replaced with their mirror-image
 84  * counterparts.
 85  * @see UBIDI_DO_MIRRORING
 86  * @see ubidi_setReorderingOptions
 87  * @see ubidi_writeReordered
 88  * @see ubidi_writeReverse
 89  * @stable ICU 58
 90  */
 91 typedef enum {
 92     /** 0: Constant indicating that character mirroring should not be
 93       * performed.
 94       * This is the default.
 95       * @stable ICU 58
 96       */
 97     UBIDI_MIRRORING_OFF = 0,
 98     /** 1: Constant indicating that character mirroring should be performed.
 99       * This corresponds to calling &lt;code&gt;ubidi_writeReordered&lt;/code&gt; or
100       * &lt;code&gt;ubidi_writeReverse&lt;/code&gt; with the
101       * &lt;code&gt;UBIDI_DO_MIRRORING&lt;/code&gt; option bit set.
102       * @stable ICU 58
103       */
104     UBIDI_MIRRORING_ON
105 } UBiDiMirroring;
106 
107 /**
108  * Forward declaration of the &lt;code&gt;UBiDiTransform&lt;/code&gt; structure that stores
109  * information used by the layout transformation engine.
110  * @stable ICU 58
111  */
112 typedef struct UBiDiTransform UBiDiTransform;
113 
114 /**
115  * Performs transformation of text from the bidi layout defined by the input
116  * ordering scheme to the bidi layout defined by the output ordering scheme,
117  * and applies character mirroring and Arabic shaping operations.&lt;p&gt;
118  * In terms of &lt;code&gt;UBiDi&lt;/code&gt;, such a transformation implies:
119  * &lt;ul&gt;
120  * &lt;li&gt;calling &lt;code&gt;ubidi_setReorderingMode&lt;/code&gt; as needed (when the
121  * reordering mode is other than normal),&lt;/li&gt;
122  * &lt;li&gt;calling &lt;code&gt;ubidi_setInverse&lt;/code&gt; as needed (when text should be
123  * transformed from a visual to a logical form),&lt;/li&gt;
124  * &lt;li&gt;resolving embedding levels of each character in the input text by
125  * calling &lt;code&gt;ubidi_setPara&lt;/code&gt;,&lt;/li&gt;
126  * &lt;li&gt;reordering the characters based on the computed embedding levels, also
127  * performing character mirroring as needed, and streaming the result to the
128  * output, by calling &lt;code&gt;ubidi_writeReordered&lt;/code&gt;,&lt;/li&gt;
129  * &lt;li&gt;performing Arabic digit and letter shaping on the output text by calling
130  * &lt;code&gt;u_shapeArabic&lt;/code&gt;.&lt;/li&gt;
131  * &lt;/ul&gt;
132  * An &quot;ordering scheme&quot; encompasses the base direction and the order of text,
133  * and these characteristics must be defined by the caller for both input and
134  * output explicitly .&lt;p&gt;
135  * There are 36 possible combinations of &lt;input, output&gt; ordering schemes,
136  * which are partially supported by &lt;code&gt;UBiDi&lt;/code&gt; already. Examples of the
137  * currently supported combinations:
138  * &lt;ul&gt;
139  * &lt;li&gt;&lt;Logical LTR, Visual LTR&gt;: this is equivalent to calling
140  * &lt;code&gt;ubidi_setPara&lt;/code&gt; with &lt;code&gt;paraLevel == UBIDI_LTR&lt;/code&gt;,&lt;/li&gt;
141  * &lt;li&gt;&lt;Logical RTL, Visual LTR&gt;: this is equivalent to calling
142  * &lt;code&gt;ubidi_setPara&lt;/code&gt; with &lt;code&gt;paraLevel == UBIDI_RTL&lt;/code&gt;,&lt;/li&gt;
143  * &lt;li&gt;&lt;Logical Default (&quot;Auto&quot;) LTR, Visual LTR&gt;: this is equivalent to
144  * calling &lt;code&gt;ubidi_setPara&lt;/code&gt; with
145  * &lt;code&gt;paraLevel == UBIDI_DEFAULT_LTR&lt;/code&gt;,&lt;/li&gt;
146  * &lt;li&gt;&lt;Logical Default (&quot;Auto&quot;) RTL, Visual LTR&gt;: this is equivalent to
147  * calling &lt;code&gt;ubidi_setPara&lt;/code&gt; with
148  * &lt;code&gt;paraLevel == UBIDI_DEFAULT_RTL&lt;/code&gt;,&lt;/li&gt;
149  * &lt;li&gt;&lt;Visual LTR, Logical LTR&gt;: this is equivalent to
150  * calling &lt;code&gt;ubidi_setInverse(UBiDi*, TRUE)&lt;/code&gt; and then
151  * &lt;code&gt;ubidi_setPara&lt;/code&gt; with &lt;code&gt;paraLevel == UBIDI_LTR&lt;/code&gt;,&lt;/li&gt;
152  * &lt;li&gt;&lt;Visual LTR, Logical RTL&gt;: this is equivalent to
153  * calling &lt;code&gt;ubidi_setInverse(UBiDi*, TRUE)&lt;/code&gt; and then
154  * &lt;code&gt;ubidi_setPara&lt;/code&gt; with &lt;code&gt;paraLevel == UBIDI_RTL&lt;/code&gt;.&lt;/li&gt;
155  * &lt;/ul&gt;
156  * All combinations that involve the Visual RTL scheme are unsupported by
157  * &lt;code&gt;UBiDi&lt;/code&gt;, for instance:
158  * &lt;ul&gt;
159  * &lt;li&gt;&lt;Logical LTR, Visual RTL&gt;,&lt;/li&gt;
160  * &lt;li&gt;&lt;Visual RTL, Logical RTL&gt;.&lt;/li&gt;
161  * &lt;/ul&gt;
162  * &lt;p&gt;Example of usage of the transformation engine:&lt;br&gt;
163  * &lt;pre&gt;
164  * \code
165  * UChar text1[] = {&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, 0x0625, &#39;1&#39;, 0};
166  * UChar text2[] = {&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, 0x0625, &#39;1&#39;, 0};
167  * UErrorCode errorCode = U_ZERO_ERROR;
168  * // Run a transformation.
169  * ubiditransform_transform(pBidiTransform,
170  *          text1, -1, text2, -1,
171  *          UBIDI_LTR, UBIDI_VISUAL,
172  *          UBIDI_RTL, UBIDI_LOGICAL,
173  *          UBIDI_MIRRORING_OFF,
174  *          U_SHAPE_DIGITS_AN2EN | U_SHAPE_DIGIT_TYPE_AN_EXTENDED,
175  *          &amp;errorCode);
176  * // Do something with text2.
177  *  text2[4] = &#39;2&#39;;
178  * // Run a reverse transformation.
179  * ubiditransform_transform(pBidiTransform,
180  *          text2, -1, text1, -1,
181  *          UBIDI_RTL, UBIDI_LOGICAL,
182  *          UBIDI_LTR, UBIDI_VISUAL,
183  *          UBIDI_MIRRORING_OFF,
184  *          U_SHAPE_DIGITS_EN2AN | U_SHAPE_DIGIT_TYPE_AN_EXTENDED,
185  *          &amp;errorCode);
186  *\endcode
187  * &lt;/pre&gt;
188  * &lt;/p&gt;
189  *
190  * @param pBiDiTransform A pointer to a &lt;code&gt;UBiDiTransform&lt;/code&gt; object
191  *        allocated with &lt;code&gt;ubiditransform_open()&lt;/code&gt; or
192  *        &lt;code&gt;NULL&lt;/code&gt;.&lt;p&gt;
193  *        This object serves for one-time setup to amortize initialization
194  *        overheads. Use of this object is not thread-safe. All other threads
195  *        should allocate a new &lt;code&gt;UBiDiTransform&lt;/code&gt; object by calling
196  *        &lt;code&gt;ubiditransform_open()&lt;/code&gt; before using it. Alternatively,
197  *        a caller can set this parameter to &lt;code&gt;NULL&lt;/code&gt;, in which case
198  *        the object will be allocated by the engine on the fly.&lt;/p&gt;
199  * @param src A pointer to the text that the Bidi layout transformations will
200  *        be performed on.
201  *        &lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; the text must be (at least)
202  *        &lt;code&gt;srcLength&lt;/code&gt; long.&lt;/p&gt;
203  * @param srcLength The length of the text, in number of UChars. If
204  *        &lt;code&gt;length == -1&lt;/code&gt; then the text must be zero-terminated.
205  * @param dest A pointer to where the processed text is to be copied.
206  * @param destSize The size of the &lt;code&gt;dest&lt;/code&gt; buffer, in number of
207  *        UChars. If the &lt;code&gt;U_SHAPE_LETTERS_UNSHAPE&lt;/code&gt; option is set,
208  *        then the destination length could be as large as
209  *        &lt;code&gt;srcLength * 2&lt;/code&gt;. Otherwise, the destination length will
210  *        not exceed &lt;code&gt;srcLength&lt;/code&gt;. If the caller reserves the last
211  *        position for zero-termination, it should be excluded from
212  *        &lt;code&gt;destSize&lt;/code&gt;.
213  *        &lt;p&gt;&lt;code&gt;destSize == -1&lt;/code&gt; is allowed and makes sense when
214  *        &lt;code&gt;dest&lt;/code&gt; was holds some meaningful value, e.g. that of
215  *        &lt;code&gt;src&lt;/code&gt;. In this case &lt;code&gt;dest&lt;/code&gt; must be
216  *        zero-terminated.&lt;/p&gt;
217  * @param inParaLevel A base embedding level of the input as defined in
218  *        &lt;code&gt;ubidi_setPara&lt;/code&gt; documentation for the
219  *        &lt;code&gt;paraLevel&lt;/code&gt; parameter.
220  * @param inOrder An order of the input, which can be one of the
221  *        &lt;code&gt;UBiDiOrder&lt;/code&gt; values.
222  * @param outParaLevel A base embedding level of the output as defined in
223  *        &lt;code&gt;ubidi_setPara&lt;/code&gt; documentation for the
224  *        &lt;code&gt;paraLevel&lt;/code&gt; parameter.
225  * @param outOrder An order of the output, which can be one of the
226  *        &lt;code&gt;UBiDiOrder&lt;/code&gt; values.
227  * @param doMirroring Indicates whether or not to perform character mirroring,
228  *        and can accept one of the &lt;code&gt;UBiDiMirroring&lt;/code&gt; values.
229  * @param shapingOptions Arabic digit and letter shaping options defined in the
230  *        ushape.h documentation.
231  *        &lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Direction indicator options are computed by
232  *        the transformation engine based on the effective ordering schemes, so
233  *        user-defined direction indicators will be ignored.&lt;/p&gt;
234  * @param pErrorCode A pointer to an error code value.
235  *
236  * @return The destination length, i.e. the number of UChars written to
237  *         &lt;code&gt;dest&lt;/code&gt;. If the transformation fails, the return value
238  *         will be 0 (and the error code will be written to
239  *         &lt;code&gt;pErrorCode&lt;/code&gt;).
240  *
241  * @see UBiDiLevel
242  * @see UBiDiOrder
243  * @see UBiDiMirroring
244  * @see ubidi_setPara
245  * @see u_shapeArabic
246  * @stable ICU 58
247  */
248 U_STABLE uint32_t U_EXPORT2
249 ubiditransform_transform(UBiDiTransform *pBiDiTransform,
250             const UChar *src, int32_t srcLength,
251             UChar *dest, int32_t destSize,
252             UBiDiLevel inParaLevel, UBiDiOrder inOrder,
253             UBiDiLevel outParaLevel, UBiDiOrder outOrder,
254             UBiDiMirroring doMirroring, uint32_t shapingOptions,
255             UErrorCode *pErrorCode);
256 
257 /**
258  * Allocates a &lt;code&gt;UBiDiTransform&lt;/code&gt; object. This object can be reused,
259  * e.g. with different ordering schemes, mirroring or shaping options.&lt;p&gt;
260  * &lt;strong&gt;Note:&lt;/strong&gt;The object can only be reused in the same thread.
261  * All other threads should allocate a new &lt;code&gt;UBiDiTransform&lt;/code&gt; object
262  * before using it.&lt;p&gt;
263  * Example of usage:&lt;p&gt;
264  * &lt;pre&gt;
265  * \code
266  * UErrorCode errorCode = U_ZERO_ERROR;
267  * // Open a new UBiDiTransform.
268  * UBiDiTransform* transform = ubiditransform_open(&amp;errorCode);
269  * // Run a transformation.
270  * ubiditransform_transform(transform,
271  *          text1, -1, text2, -1,
272  *          UBIDI_RTL, UBIDI_LOGICAL,
273  *          UBIDI_LTR, UBIDI_VISUAL,
274  *          UBIDI_MIRRORING_ON,
275  *          U_SHAPE_DIGITS_EN2AN,
276  *          &amp;errorCode);
277  * // Do something with the output text and invoke another transformation using
278  * //   that text as input.
279  * ubiditransform_transform(transform,
280  *          text2, -1, text3, -1,
281  *          UBIDI_LTR, UBIDI_VISUAL,
282  *          UBIDI_RTL, UBIDI_VISUAL,
283  *          UBIDI_MIRRORING_ON,
284  *          0, &amp;errorCode);
285  *\endcode
286  * &lt;/pre&gt;
287  * &lt;p&gt;
288  * The &lt;code&gt;UBiDiTransform&lt;/code&gt; object must be deallocated by calling
289  * &lt;code&gt;ubiditransform_close()&lt;/code&gt;.
290  *
291  * @return An empty &lt;code&gt;UBiDiTransform&lt;/code&gt; object.
292  * @stable ICU 58
293  */
294 U_STABLE UBiDiTransform* U_EXPORT2
295 ubiditransform_open(UErrorCode *pErrorCode);
296 
297 /**
298  * Deallocates the given &lt;code&gt;UBiDiTransform&lt;/code&gt; object.
299  * @stable ICU 58
300  */
301 U_STABLE void U_EXPORT2
302 ubiditransform_close(UBiDiTransform *pBidiTransform);
303 
304 #if U_SHOW_CPLUSPLUS_API
305 
306 U_NAMESPACE_BEGIN
307 
308 /**
309  * \class LocalUBiDiTransformPointer
310  * &quot;Smart pointer&quot; class, closes a UBiDiTransform via ubiditransform_close().
311  * For most methods see the LocalPointerBase base class.
312  *
313  * @see LocalPointerBase
314  * @see LocalPointer
315  * @stable ICU 58
316  */
317 U_DEFINE_LOCAL_OPEN_POINTER(LocalUBiDiTransformPointer, UBiDiTransform, ubiditransform_close);
318 
319 U_NAMESPACE_END
320 
321 #endif
322 
323 #endif
    </pre>
  </body>
</html>