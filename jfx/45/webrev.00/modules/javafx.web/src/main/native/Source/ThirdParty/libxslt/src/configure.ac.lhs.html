<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.web/src/main/native/Source/ThirdParty/libxslt/src/configure.ac</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 dnl Process this file with autoconf to produce a configuration script.
  2 AC_PREREQ(2.63)
  3 
  4 m4_define([MAJOR_VERSION], [1])
  5 m4_define([MINOR_VERSION], [1])
<a name="1" id="anc1"></a><span class="line-modified">  6 m4_define([MICRO_VERSION], [33])</span>
  7 
  8 AC_INIT([libxslt], [MAJOR_VERSION.MINOR_VERSION.MICRO_VERSION])
  9 AC_CONFIG_SRCDIR([libxslt/xslt.c])
 10 AC_CONFIG_HEADERS(config.h)
 11 AC_CANONICAL_HOST
 12 AC_USE_SYSTEM_EXTENSIONS
 13 
 14 dnl
 15 dnl libxslt is the main part of the package
 16 dnl libexslt is an extension
 17 dnl
 18 LIBXSLT_MAJOR_VERSION=MAJOR_VERSION
 19 LIBXSLT_MINOR_VERSION=MINOR_VERSION
 20 LIBXSLT_MICRO_VERSION=MICRO_VERSION
 21 LIBEXSLT_MAJOR_VERSION=0
 22 LIBEXSLT_MINOR_VERSION=8
 23 LIBEXSLT_MICRO_VERSION=20
 24 LIBXML_REQUIRED_VERSION=2.6.27
 25 
 26 
 27 LIBXSLT_VERSION=$LIBXSLT_MAJOR_VERSION.$LIBXSLT_MINOR_VERSION.$LIBXSLT_MICRO_VERSION
 28 LIBXSLT_VERSION_INFO=`expr $LIBXSLT_MAJOR_VERSION + $LIBXSLT_MINOR_VERSION`:$LIBXSLT_MICRO_VERSION:$LIBXSLT_MINOR_VERSION
 29 
 30 LIBXSLT_VERSION_NUMBER=`expr $LIBXSLT_MAJOR_VERSION \* 10000 + $LIBXSLT_MINOR_VERSION \* 100 + $LIBXSLT_MICRO_VERSION`
 31 LIBXSLT_MAJOR_MINOR_VERSION=$LIBXSLT_MAJOR_VERSION.$LIBXSLT_MINOR_VERSION
 32 
 33 if test -f CVS/Entries; then
 34   extra=`grep ChangeLog CVS/Entries | grep -v LIBXSLT | sed -e s\%/ChangeLog/1\.%% -e s\%/.*$%%`
 35   echo extra=$extra
 36   if test &quot;$extra&quot; != &quot;&quot;
 37   then
 38       LIBXSLT_VERSION_EXTRA=&quot;-CVS$extra&quot;
 39   fi
 40 else if test -d .svn ; then
 41   extra=`svn info | grep Revision | sed &#39;s+Revision: ++&#39;`
 42   echo extra=$extra
 43   if test &quot;$extra&quot; != &quot;&quot;
 44   then
 45       LIBXSLT_VERSION_EXTRA=&quot;-SVN$extra&quot;
 46   fi
 47 else if test -d .git ; then
 48   extra=`git describe | sed &#39;s+LIBXSLT[[0-9.]]*-++&#39;`
 49   echo extra=$extra
 50   if test &quot;$extra&quot; != &quot;&quot;
 51   then
 52       LIBXSLT_VERSION_EXTRA=&quot;-GIT$extra&quot;
 53   fi
 54 fi
 55 fi
 56 fi
 57 
 58 AC_SUBST(LIBXSLT_MAJOR_VERSION)
 59 AC_SUBST(LIBXSLT_MINOR_VERSION)
 60 AC_SUBST(LIBXSLT_MICRO_VERSION)
 61 AC_SUBST(LIBXSLT_VERSION)
 62 AC_SUBST(LIBXSLT_VERSION_INFO)
 63 AC_SUBST(LIBXSLT_VERSION_NUMBER)
 64 AC_SUBST(LIBXSLT_VERSION_EXTRA)
 65 AC_SUBST(LIBXSLT_MAJOR_MINOR_VERSION)
 66 
 67 dnl
 68 dnl libexslt is an extension library
 69 dnl
 70 
 71 LIBEXSLT_VERSION=$LIBEXSLT_MAJOR_VERSION.$LIBEXSLT_MINOR_VERSION.$LIBEXSLT_MICRO_VERSION
 72 LIBEXSLT_VERSION_INFO=`expr $LIBEXSLT_MAJOR_VERSION + $LIBEXSLT_MINOR_VERSION`:$LIBEXSLT_MICRO_VERSION:$LIBEXSLT_MINOR_VERSION
 73 
 74 LIBEXSLT_VERSION_NUMBER=`expr $LIBEXSLT_MAJOR_VERSION \* 10000 + $LIBEXSLT_MINOR_VERSION \* 100 + $LIBEXSLT_MICRO_VERSION`
 75 
 76 if test -f CVS/Entries; then
 77   LIBEXSLT_VERSION_EXTRA=-CVS`grep ChangeLog CVS/Entries | sed -e s\%/ChangeLog/1\.%% -e s\%/.*$%%`
 78 fi
 79 
 80 AC_SUBST(LIBEXSLT_MAJOR_VERSION)
 81 AC_SUBST(LIBEXSLT_MINOR_VERSION)
 82 AC_SUBST(LIBEXSLT_MICRO_VERSION)
 83 AC_SUBST(LIBEXSLT_VERSION)
 84 AC_SUBST(LIBEXSLT_VERSION_INFO)
 85 AC_SUBST(LIBEXSLT_VERSION_NUMBER)
 86 AC_SUBST(LIBEXSLT_VERSION_EXTRA)
 87 
 88 AM_INIT_AUTOMAKE([foreign])
 89 
 90 # AM_MAINTAINER_MODE
 91 
 92 # Support silent build rules, requires at least automake-1.11. Disable
 93 # by either passing --disable-silent-rules to configure or passing V=1
 94 # to make
 95 m4_ifdef([AM_SILENT_RULES], [AM_SILENT_RULES([yes])])
 96 
 97 dnl
 98 dnl Specific dir for HTML output ?
 99 dnl
100 
101 AC_ARG_WITH(html-dir, AS_HELP_STRING([--with-html-dir=path],
102             [path to base html directory, default $datadir/doc/html]),
103             [HTML_DIR=$withval], [HTML_DIR=&#39;$(datadir)/doc&#39;])
104 
105 AC_ARG_WITH(html-subdir, AS_HELP_STRING([--with-html-subdir=path],
106             [directory used under html-dir, default $PACKAGE-$VERSION/html]),
107             [test &quot;x$withval&quot; != &quot;x&quot; &amp;&amp; HTML_DIR=&quot;$HTML_DIR/$withval&quot;],
108             [HTML_DIR=&quot;$HTML_DIR/\$(PACKAGE)-\$(VERSION)/html&quot;])
109 
110 AC_SUBST(HTML_DIR)
111 
112 dnl
113 dnl Check the environment
114 dnl
115 
116 AC_PROG_CC
117 AC_PROG_INSTALL
118 AC_PROG_CPP
119 AC_PATH_PROG(XMLLINT, xmllint, /usr/bin/xmllint)
120 AC_PATH_PROG(XSLTPROC, xsltproc, /usr/bin/xsltproc)
121 PKG_PROG_PKG_CONFIG
122 
123 AC_HEADER_STDC
124 
125 LT_INIT(win32-dll)
126 
127 
128 AC_CHECK_HEADERS(sys/types.h sys/time.h stdlib.h unistd.h string.h)
129 
130 dnl
131 dnl if the system support linker version scripts for symbol versioning
132 dnl then add it
133 dnl
134 AC_MSG_CHECKING([how to pass version script to the linker ($LD)])
135 VERSION_SCRIPT_FLAGS=none
136 if $LD --help 2&gt;&amp;1 | grep &quot;version-script&quot; &gt;/dev/null 2&gt;/dev/null; then
137     VERSION_SCRIPT_FLAGS=-Wl,--version-script=
138 elif $LD --help 2&gt;&amp;1 | grep &quot;M mapfile&quot; &gt;/dev/null 2&gt;/dev/null; then
139     VERSION_SCRIPT_FLAGS=&quot;-Wl,-M -Wl,&quot;
140 fi
141 AC_MSG_RESULT([$VERSION_SCRIPT_FLAGS])
142 AC_SUBST(VERSION_SCRIPT_FLAGS)
143 AM_CONDITIONAL([USE_VERSION_SCRIPT], [test &quot;$VERSION_SCRIPT_FLAGS&quot; != none])
144 
145 dnl Look for pthread.h, needed for testThreads
146 case $host in
147   *-mingw*) ;;
148   *)
149 THREAD_LIBS=&quot;&quot;
150 AC_CHECK_HEADER(pthread.h,
151     AC_CHECK_LIB(pthread, pthread_join,[
152        AC_DEFINE([HAVE_LIBPTHREAD], [], [Define if pthread library is there (-lpthread)])
153        AC_DEFINE([HAVE_PTHREAD_H], [], [Define if &lt;pthread.h&gt; is there])
154        THREAD_LIBS=&quot;-lpthread&quot;]))
155   ;;
156 esac
157 
158 AC_SUBST(THREAD_LIBS)
159 
160 dnl
161 dnl Detect supported locale
162 dnl
163 
164 AC_CHECK_HEADERS([locale.h xlocale.h])
165 AC_CHECK_FUNCS([strxfrm_l])
166 
167 dnl
168 dnl Math detection
169 dnl
170 
<a name="2" id="anc2"></a><span class="line-modified">171 AC_CHECK_HEADERS(ieeefp.h nan.h math.h fp_class.h float.h ansidecl.h)</span>
172 AC_CHECK_HEADERS(sys/timeb.h time.h sys/stat.h sys/select.h stdarg.h)
173 AC_CHECK_HEADERS(errno.h)
174 AC_CHECK_FUNCS(stat _stat)
175 AC_CHECK_FUNC(pow, , AC_CHECK_LIB(m, pow,
176   [M_LIBS=&quot;-lm&quot;; AC_DEFINE([HAVE_POW],[], [Define if pow is there])]))
177 
178 AC_CHECK_FUNC(floor, , AC_CHECK_LIB(m, floor,
179   [M_LIBS=&quot;-lm&quot;; AC_DEFINE([HAVE_FLOOR],[], [Define if floor is there])]))
180 
181 AC_CHECK_FUNC(fabs, , AC_CHECK_LIB(m, fabs,
182   [M_LIBS=&quot;-lm&quot;; AC_DEFINE([HAVE_FABS],[], [Define if fabs is there])]))
183 
184 
185 AC_CHECK_FUNCS(gettimeofday)
186 AC_CHECK_FUNCS(localtime localtime_r time gmtime gmtime_r ftime)
187 
188 dnl Checking the standard string functions availability
189 AC_CHECK_FUNCS(printf sprintf fprintf snprintf vfprintf vsprintf vsnprintf sscanf,,
190                NEED_TRIO=1)
191 
192 dnl Checking for POSIX timers
193 AC_CHECK_FUNCS(clock_gettime, [], [
194   AC_CHECK_LIB(rt, clock_gettime, [
195     AC_DEFINE(HAVE_CLOCK_GETTIME, 1)
196     EXTRA_LIBS=&quot;$EXTRA_LIBS -lrt&quot;
197   ])
198 ])
199 
200 dnl
201 dnl Check for trio string functions
202 dnl
203 
204 if test &quot;${NEED_TRIO}&quot; = &quot;1&quot; ; then
205     echo Reusing trio library for string functions
206     WITH_TRIO=1
207 else    
208     WITH_TRIO=0
209 fi
210 AC_SUBST(WITH_TRIO)
211 
212 dnl
213 dnl Some packages need to be checked against version numbers so we
214 dnl define a function here for later use
215 dnl
216 AC_DEFUN([VERSION_TO_NUMBER],
217 [`$1 | sed -e &#39;s/libxml //&#39; | awk &#39;BEGIN { FS = &quot;.&quot;; } { printf &quot;%d&quot;, ([$]1 * 1000 + [$]2) * 1000 + [$]3;}&#39;`])
218 
219 dnl
220 dnl Perl is just needed for generating some data for XSLtmark
221 dnl
222 
223 AC_CHECK_PROG(PERL, perl, perl, false)
224 AM_CONDITIONAL(WITH_PERL, test &quot;$PERL&quot; != &quot;false&quot;)
225 
226 dnl
227 dnl check for python
228 dnl
229 
230 PYTHON_VERSION=
231 PYTHON_INCLUDES=
232 PYTHON_SITE_PACKAGES=
233 pythondir=
234 AC_ARG_WITH(python, [  --with-python[=DIR]    Build Python bindings if found])
235 if test &quot;$with_python&quot; != &quot;no&quot; ; then
236     if test -x &quot;$with_python/bin/python&quot;
237     then
238         echo Found python in $with_python/bin/python
239         PYTHON=&quot;$with_python/bin/python&quot;
240     else
241 	if test -x &quot;$with_python&quot;
242 	then
243 	    echo Found python in $with_python
244 	    PYTHON=&quot;$with_python&quot;
245 	else
246             if test -x &quot;$PYTHON&quot;
247             then
248                 echo Found python in environment PYTHON=$PYTHON
249                 with_python=`$PYTHON -c &quot;import sys; print sys.exec_prefix&quot;`
250 	    else
251 	        AC_PATH_PROG(PYTHON, python python2.4 python2.3 python2.2 python2.1 python2.0 python1.6 python1.5)
252 	    fi
253 	fi
254     fi
255     if test &quot;$PYTHON&quot; != &quot;&quot;
256     then
257         echo &quot;PYTHON is pointing at $PYTHON&quot;
258         PYTHON_VERSION=`$PYTHON -c &quot;import sys; print sys.version[[0:3]]&quot;`
259 	echo Found Python version $PYTHON_VERSION
260 	LIBXML2_PYTHON=`$PYTHON -c &quot;try : import libxml2 ; print 1
261 except: print 0&quot;`
262 	if test &quot;$LIBXML2_PYTHON&quot; = &quot;1&quot;
263 	then
264 	    echo Found libxml2-python module
265 	else
266 	    echo Warning: Missing libxml2-python
267 	fi
268     fi
269     if test &quot;$PYTHON_VERSION&quot; != &quot;&quot;
270     then
271 	if test -r $with_python/include/python$PYTHON_VERSION/Python.h -a \
272 	   -d $with_python/lib/python$PYTHON_VERSION/site-packages
273 	then
274 	    PYTHON_INCLUDES=$with_python/include/python$PYTHON_VERSION
275 	    PYTHON_SITE_PACKAGES=&#39;$(libdir)/python$(PYTHON_VERSION)/site-packages&#39;
276 	else
277 	    if test -r $prefix/include/python$PYTHON_VERSION/Python.h
278 	    then
279 	        PYTHON_INCLUDES=$prefix/include/python$PYTHON_VERSION
280 		PYTHON_SITE_PACKAGES=&#39;$(libdir)/python$(PYTHON_VERSION)/site-packages&#39;
281 	    else
282 		if test -r /usr/include/python$PYTHON_VERSION/Python.h
283 		then
284 		    PYTHON_INCLUDES=/usr/include/python$PYTHON_VERSION
285 		    PYTHON_SITE_PACKAGES=&#39;$(libdir)/python$(PYTHON_VERSION)/site-packages&#39;
286 		else
287 		    echo could not find python$PYTHON_VERSION/Python.h
288 		fi
289 	    fi
290 	    if test ! -d &quot;$PYTHON_SITE_PACKAGES&quot;
291 	    then
292 		    PYTHON_SITE_PACKAGES=`$PYTHON -c &quot;from distutils import sysconfig; print sysconfig.get_python_lib()&quot;`
293 	    fi
294 	fi
295         PYTHON_LIBS=`python$PYTHON_VERSION-config --libs`
296     fi
297     if test &quot;$with_python&quot; != &quot;&quot;
298     then
299         pythondir=&#39;$(PYTHON_SITE_PACKAGES)&#39;
300     else
301         pythondir=&#39;$(libdir)/python$(PYTHON_VERSION)/site-packages&#39;
302     fi
303 fi
304 AM_CONDITIONAL(WITH_PYTHON, test &quot;$PYTHON_INCLUDES&quot; != &quot;&quot;)
305 if test &quot;$PYTHON_INCLUDES&quot; != &quot;&quot;
306 then
307     PYTHON_SUBDIR=python
308 else
309     PYTHON_SUBDIR=
310 fi
311 AC_SUBST(pythondir)
312 AC_SUBST(PYTHON_SUBDIR)
313 AC_SUBST(PYTHON_LIBS)
314 
315 AC_ARG_WITH(crypto, [  --with-crypto           Add crypto support to exslt (on)])
316 WITH_CRYPTO=0
317 CRYPTO_TESTDIR=
318 if test &quot;$with_crypto&quot; = &quot;no&quot; ; then
319     echo Disabling crypto support
320     LIBGCRYPT_CFLAGS=&quot;&quot;
321     LIBGCRYPT_LIBS=&quot;&quot;
322 else
323 case $host in
324   *-mingw*)
325     dnl Use only native crypto-API for mingw* hosts
326     dnl TODO: to implement --with-crypto=foo to allow switch between
327     dnl crypto libraries
328     WITH_CRYPTO=1
329     CRYPTO_TESTDIR=crypto
330     ;;
331   *)
332     AC_PATH_TOOL(LIBGCRYPT_CONFIG, libgcrypt-config, no)
333     if test &quot;$LIBGCRYPT_CONFIG&quot; != &quot;no&quot; ; then
334       LIBGCRYPT_VERSION=`$LIBGCRYPT_CONFIG --version`
335       if test VERSION_TO_NUMBER(echo $LIBGCRYPT_VERSION) -lt VERSION_TO_NUMBER(echo &quot;1.1.42&quot;)
336       then
337         LIBGCRYPT_CFLAGS=&quot;&quot;
338         LIBGCRYPT_LIBS=&quot;&quot;
339         echo &#39;gcrypt library version &lt; 1.1.42 - Crypto extensions will not be available.&#39;
340       else
341         LIBGCRYPT_CFLAGS=`$LIBGCRYPT_CONFIG $libgcrypt_config_args --cflags`
342         LIBGCRYPT_LIBS=`$LIBGCRYPT_CONFIG $libgcrypt_config_args --libs`
343         AC_DEFINE(HAVE_GCRYPT, 1, [Define if gcrypt library is available.])
344         echo &#39;Crypto extensions will be available.&#39;
345         WITH_CRYPTO=1
346         CRYPTO_TESTDIR=crypto
347       fi
348     else
349       LIBGCRYPT_CFLAGS=&quot;&quot;
350       LIBGCRYPT_LIBS=&quot;&quot;
351       echo &#39;Crypto extensions will not be available. Install libgcrypt and reconfigure to make available.&#39;
352     fi
353 esac
354 fi
355 AC_SUBST(WITH_CRYPTO)
356 AC_SUBST(CRYPTO_TESTDIR)
357 AC_SUBST(LIBGCRYPT_CFLAGS)
358 AC_SUBST(LIBGCRYPT_LIBS)
359 
360 dnl
361 dnl Debug for DV (-Wunreachable-code)
362 dnl
363 if [[ &quot;${LOGNAME}&quot; = &quot;veillard&quot; -a &quot;`pwd`&quot; = &quot;/u/veillard/XSLT&quot; ]] || \
364    [[ &quot;${LOGNAME}&quot; = &quot;bill&quot; -a &quot;`pwd`&quot; = &quot;/home/bill/gnomesvn/libxslt&quot; ]]
365    then
366     if test &quot;${with_mem_debug}&quot; = &quot;&quot; ;
367     then
368 	with_mem_debug=&quot;yes&quot;
369     fi
370     CFLAGS=&quot;-Wall -g -O -ansi -pedantic -W -Wunused -Wimplicit -Wreturn-type -Wswitch -Wcomment -Wtrigraphs -Wformat=2 -Wmissing-format-attribute -Wchar-subscripts -Wuninitialized -Wparentheses -Wshadow -Wpointer-arith -Wcast-align -Wwrite-strings -Waggregate-return -Wstrict-prototypes -Wmissing-prototypes -Wnested-externs -Winline &quot;
371 fi
372 
373 AC_ARG_WITH(debug, [  --with-debug            Add the debugging code (on)])
374 if test &quot;$with_debug&quot; = &quot;no&quot; ; then
375     echo Disabling debug support
376     WITH_XSLT_DEBUG=0
377 else    
378     WITH_XSLT_DEBUG=1
379 fi
380 AC_SUBST(WITH_XSLT_DEBUG)
381 
382 AC_ARG_WITH(mem_debug, [  --with-mem-debug        Add the memory debugging module (off)])
383 if test &quot;$with_mem_debug&quot; = &quot;yes&quot; ; then
384     echo Enabling memory debug support
385     WITH_MEM_DEBUG=1
386 else    
387     WITH_MEM_DEBUG=0
388 fi
389 AC_SUBST(WITH_MEM_DEBUG)
390 
391 dnl 
392 dnl Is debugger support requested
393 dnl
394 AC_ARG_WITH(debugger, [  --with-debugger        Add the debugging support (on)])
395 if test &quot;$with_debugger&quot; = &quot;no&quot; ; then
396     echo Disabling debugger
397     WITH_DEBUGGER=0
398 else
399     echo Enabling debugger
400     WITH_DEBUGGER=1
401     AC_DEFINE([WITH_DEBUGGER],[], [Define if debugging support is enabled])
402 fi
403 AC_SUBST(WITH_DEBUGGER)
404 
<a name="3" id="anc3"></a>













405 dnl
406 dnl The following new parameters were added to offer
407 dnl the ability to specify the location of the libxml
408 dnl library during linking and compilation.
409 dnl
410 dnl original work - Mathieu Lacage 30/03/2000
411 dnl some tweaking - David Härdeman 30/10/2001
412 dnl
413 
414 LIBXML_CONFIG_PREFIX=&quot;&quot;
415 LIBXML_SRC=&quot;&quot;
416 
417 AC_ARG_WITH(libxml-prefix,
418         [  --with-libxml-prefix=[PFX]		Specify location of libxml config],
419 	LIBXML_CONFIG_PREFIX=$withval
420 )
421         
422 AC_ARG_WITH(libxml-include-prefix,
423         [  --with-libxml-include-prefix=[PFX]	Specify location of libxml headers],
424         LIBXML_CFLAGS=&quot;-I$withval&quot;
425 )
426 
427 AC_ARG_WITH(libxml-libs-prefix,
428         [  --with-libxml-libs-prefix=[PFX]	Specify location of libxml libs],
429         LIBXML_LIBS=&quot;-L$withval&quot;
430 )
431 
432 AC_ARG_WITH(libxml-src,
433 	[  --with-libxml-src=[DIR]              For libxml thats not installed yet (sets all three above)],
434 	LIBXML_SRC=&quot;$withval&quot;
435 )
436 AC_SUBST(LIBXML_SRC)
437 
438 dnl
439 dnl where is xml2-config
440 dnl
441 
442 AC_SUBST(LIBXML_REQUIRED_VERSION)
443 if test &quot;x$LIBXML_CONFIG_PREFIX&quot; != &quot;x&quot;
444 then
445 	AC_PATH_TOOL([XML_CONFIG], [xml2-config], [false], [${LIBXML_CONFIG_PREFIX}/bin])
446 else
447 	AC_PATH_TOOL([XML_CONFIG], [xml2-config], [false])
448 fi
449 
450 dnl
451 dnl imported from libxml2, c.f. #77827 
452 dnl
453 if test &quot;${GCC}&quot; != &quot;yes&quot; ; then
454     case &quot;${host}&quot; in
455           *-*-hpux* )
456 	       CFLAGS=&quot;${CFLAGS} -Wp,-H30000&quot;
457 	       ;;
458           *-dec-osf* )
459                CFLAGS=&quot;${CFLAGS} -ieee&quot;
460                ;;
461     esac
462 else
<a name="4" id="anc4"></a><span class="line-modified">463     CFLAGS=&quot;${CFLAGS} -Wall -Wformat=2 -Wmissing-format-attribute&quot;</span>
464     case &quot;${host}&quot; in
465           alpha*-*-linux* )
466 	       CFLAGS=&quot;${CFLAGS} -mieee&quot;
467 	       ;;
468 	  alpha*-*-osf* )
469 	       CFLAGS=&quot;${CFLAGS} -mieee&quot;
470 	       ;;
471     esac
472 fi
473 
<a name="5" id="anc5"></a>


















474 dnl
475 dnl Override other variables if LIBXML_SRC is set
476 dnl
477 
<a name="6" id="anc6"></a><span class="line-modified">478 if test &quot;x$LIBXML_SRC&quot; != &quot;x&quot;</span>
<span class="line-modified">479 then</span>
<span class="line-modified">480 	CWD=`pwd`</span>
<span class="line-modified">481 	if cd $LIBXML_SRC</span>
<span class="line-modified">482 	then</span>
<span class="line-modified">483 		LIBXML_SRC=`pwd`</span>
<span class="line-modified">484 		XML_CONFIG=&quot;${LIBXML_SRC}/xml2-config&quot;</span>
<span class="line-modified">485 		LIBXML_CFLAGS=&quot;-I${LIBXML_SRC}/include&quot;</span>
<span class="line-modified">486 		LIBXML_LIBS=&quot;-L${LIBXML_SRC} `$XML_CONFIG --libs`&quot;</span>
<span class="line-modified">487                 WITH_MODULES=&quot;`$XML_CONFIG --modules`&quot;</span>
<span class="line-modified">488 		cd $CWD</span>
<span class="line-modified">489 	else</span>
<span class="line-modified">490 		AC_MSG_ERROR([libxml source dir not found (${LIBXML_SRC}), typo?])</span>
<span class="line-modified">491 	fi</span>


492 fi
493 
494 dnl
495 dnl Try pkg-config first if nothing is set
496 dnl
497 
<a name="7" id="anc7"></a><span class="line-modified">498 if test &quot;x$LIBXML_CONFIG_PREFIX&quot; = &quot;x&quot; -a &quot;x$LIBXML_LIBS&quot; = &quot;x&quot;</span>
<span class="line-modified">499 then</span>
<span class="line-modified">500 	PKG_CHECK_MODULES([LIBXML], [libxml-2.0 &gt;= $LIBXML_REQUIRED_VERSION], [</span>
<span class="line-modified">501 		WITH_MODULES=&quot;`$PKG_CONFIG --variable=modules libxml-2.0`&quot;</span>
<span class="line-modified">502 	], [ ])</span>




503 fi
504 
505 dnl
506 dnl make sure xml2-config is executable,
507 dnl test version and init our variables
508 dnl
509 
510 if test &quot;x$LIBXML_LIBS&quot; = &quot;x&quot; &amp;&amp; ${XML_CONFIG} --libs print &gt; /dev/null 2&gt;&amp;1
511 then
<a name="8" id="anc8"></a><span class="line-modified">512         AC_MSG_CHECKING(for libxml libraries &gt;= $LIBXML_REQUIRED_VERSION)</span>
<span class="line-modified">513 	XMLVERS=`$XML_CONFIG --version`</span>
<span class="line-modified">514 	if test VERSION_TO_NUMBER(echo $XMLVERS) -ge VERSION_TO_NUMBER(echo $LIBXML_REQUIRED_VERSION)</span>
<span class="line-modified">515 	then</span>
<span class="line-modified">516 		AC_MSG_RESULT($XMLVERS found)</span>
<span class="line-modified">517 	else</span>
<span class="line-modified">518 		AC_MSG_ERROR(Version $XMLVERS found. You need at least libxml2 $LIBXML_REQUIRED_VERSION for this version of libxslt)</span>
<span class="line-modified">519 	fi</span>
<span class="line-modified">520 	LIBXML_LIBS=&quot;`$XML_CONFIG --libs`&quot;</span>




521 	LIBXML_CFLAGS=&quot;`$XML_CONFIG --cflags`&quot;
522         WITH_MODULES=&quot;`$XML_CONFIG --modules`&quot;
523 fi
524 
525 if test &quot;x$LIBXML_LIBS&quot; = &quot;x&quot;
526 then
527 	AC_MSG_ERROR([Could not find libxml2 anywhere, check ftp://xmlsoft.org/.])
528 fi
529 
530 
531 AC_SUBST(CFLAGS)
532 AC_SUBST(CPPFLAGS)
533 AC_SUBST(LDFLAGS)
534 
535 AC_ARG_WITH(plugins,
536 [  --with-plugins          Add plugin extension support (on)])
537 if test &quot;$with_plugins&quot; = &quot;&quot;
538 then
539     with_plugins=yes
540 fi
541 
542 AC_MSG_CHECKING([whether shared libraries will be built (required for plugins)])
<a name="9" id="anc9"></a><span class="line-modified">543 if test &quot;$enable_shared&quot; = &quot;no&quot; -a &quot;$with_plugins&quot; = &quot;yes&quot;; then</span>
544 	 AC_MSG_RESULT(no)
545 	 AC_MSG_WARN([Disabling plugin support.])
546 	 AC_MSG_WARN([Plugins require that shared libraries be built.])
547 	 with_plugins=no
548 else
549 	 AC_MSG_RESULT(yes)
550 fi
551 
552 if test &quot;$with_plugins&quot; = &quot;yes&quot; ; then
553   AC_MSG_CHECKING([libxml2 module support])
554   if test &quot;${WITH_MODULES}&quot; = &quot;1&quot;; then
555     AC_MSG_RESULT(yes)
556   else
557     AC_MSG_RESULT(no)
558     WITH_MODULES=&quot;0&quot;
559   fi
560 else
561   WITH_MODULES=&quot;0&quot;
562 fi
563 
564 AC_SUBST(WITH_MODULES)
565 AM_CONDITIONAL(WITH_MODULES, test &quot;$WITH_MODULES&quot; = &quot;1&quot;)
566 
567 dnl
568 dnl setup default module path
569 dnl
570 expanded_libdir=$(
571     test &quot;x$prefix&quot; = xNONE &amp;&amp; prefix=&quot;$ac_default_prefix&quot;
572     test &quot;x$exec_prefix&quot; = xNONE &amp;&amp; exec_prefix=&quot;$prefix&quot;
573     while test &quot;$libdir_old&quot; != &quot;$libdir&quot;; do
574       libdir_old=&quot;$libdir&quot;
575       eval libdir=&quot;$libdir&quot;
576     done
577     echo &quot;$libdir&quot;
578 )
579 LIBXSLT_DEFAULT_PLUGINS_PATH=&quot;$expanded_libdir/libxslt-plugins&quot;
580 AC_SUBST(LIBXSLT_DEFAULT_PLUGINS_PATH)
581 
<a name="10" id="anc10"></a><span class="line-removed">582 WIN32_EXTRA_LIBADD=</span>
<span class="line-removed">583 WIN32_EXTRA_LDFLAGS=</span>
584 case &quot;$host&quot; in
<a name="11" id="anc11"></a><span class="line-modified">585  *-*-cygwin*)</span>
<span class="line-modified">586  WIN32_EXTRA_LDFLAGS=&quot;-no-undefined&quot;</span>
<span class="line-removed">587  ;;</span>
<span class="line-removed">588  *-*-mingw*)</span>
<span class="line-removed">589  WIN32_EXTRA_LIBADD=&quot;-lwsock32&quot;</span>
<span class="line-removed">590  WIN32_EXTRA_LDFLAGS=&quot;-no-undefined&quot;</span>
<span class="line-removed">591  AC_DEFINE([_WINSOCKAPI_],1,[Using the Win32 Socket implementation])</span>
<span class="line-removed">592  AC_DEFINE([snprintf],[_snprintf],[Win32 Std C name mangling work-around])</span>
<span class="line-removed">593  AC_DEFINE([vsnprintf],[_vsnprintf],[Win32 Std C name mangling work-around])</span>
594  ;;
595 esac
<a name="12" id="anc12"></a><span class="line-removed">596 AC_SUBST(WIN32_EXTRA_LIBADD)</span>
<span class="line-removed">597 AC_SUBST(WIN32_EXTRA_LDFLAGS)</span>
598 
599 
600 AC_SUBST(XSLTPROCDV)
601 AC_SUBST(PYTHONSODV)
602 AC_SUBST(XML_CONFIG)
603 AC_SUBST(LIBXML_LIBS)
604 AC_SUBST(LIBXML_CFLAGS)
605 AC_SUBST(PYTHON)
606 AC_SUBST(PYTHON_VERSION)
607 AC_SUBST(PYTHON_INCLUDES)
608 AC_SUBST(PYTHON_SITE_PACKAGES)
609 
610 XSLT_LIBDIR=&#39;-L${libdir}&#39;
611 XSLT_INCLUDEDIR=&#39;-I${includedir}&#39;
<a name="13" id="anc13"></a><span class="line-modified">612 XSLT_LIBS=&quot;-lxslt $LIBXML_LIBS $M_LIBS&quot;</span>

613 AC_SUBST(XSLT_LIBDIR)
614 AC_SUBST(XSLT_INCLUDEDIR)
615 AC_SUBST(XSLT_LIBS)
<a name="14" id="anc14"></a>
616 
617 EXSLT_LIBDIR=&#39;-L${libdir}&#39;
618 EXSLT_INCLUDEDIR=&#39;-I${includedir}&#39;
<a name="15" id="anc15"></a><span class="line-modified">619 EXSLT_LIBS=&quot;-lexslt $XSLT_LIBS $LIBGCRYPT_LIBS&quot;</span>

620 AC_SUBST(EXSLT_LIBDIR)
621 AC_SUBST(EXSLT_INCLUDEDIR)
622 AC_SUBST(EXSLT_LIBS)
<a name="16" id="anc16"></a>
623 
624 AC_SUBST(EXTRA_LIBS)
625 
626 AC_SUBST(M_LIBS)
627 
628 dnl for the spec file
629 RELDATE=`date +&#39;%a %b %e %Y&#39;`
630 AC_SUBST(RELDATE)
631 
632 rm -f COPYING.LIB COPYING 2&gt;/dev/null &amp;&amp; $LN_S $srcdir/Copyright COPYING
633 
634 
635 AC_CONFIG_FILES([
636 Makefile
637 libxslt.pc
638 libexslt.pc
639 libxslt/Makefile
640 libxslt/xsltconfig.h
641 libxslt/xsltwin32config.h
642 libexslt/Makefile
643 libexslt/exsltconfig.h
644 xsltproc/Makefile
645 python/Makefile
646 python/tests/Makefile
647 tests/Makefile
648 tests/docs/Makefile
649 tests/REC1/Makefile
650 tests/REC2/Makefile
651 tests/REC/Makefile
652 tests/general/Makefile
653 tests/reports/Makefile
654 tests/extensions/Makefile
655 tests/namespaces/Makefile
656 tests/keys/Makefile
657 tests/numbers/Makefile
658 tests/documents/Makefile
659 tests/xmlspec/Makefile
660 tests/multiple/Makefile
661 tests/xinclude/Makefile
662 tests/XSLTMark/Makefile
663 tests/docbook/Makefile
664 tests/exslt/Makefile
665 tests/exslt/common/Makefile
666 tests/exslt/functions/Makefile
667 tests/exslt/math/Makefile
668 tests/exslt/saxon/Makefile
669 tests/exslt/sets/Makefile
670 tests/exslt/strings/Makefile
671 tests/exslt/date/Makefile
672 tests/exslt/dynamic/Makefile
673 tests/exslt/crypto/Makefile
674 tests/plugins/Makefile
<a name="17" id="anc17"></a>
675 doc/Makefile
676 xslt-config
677 libxslt.spec
678 ])
<a name="18" id="anc18"></a>

679 
680 AC_OUTPUT
<a name="19" id="anc19"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="19" type="hidden" />
</body>
</html>