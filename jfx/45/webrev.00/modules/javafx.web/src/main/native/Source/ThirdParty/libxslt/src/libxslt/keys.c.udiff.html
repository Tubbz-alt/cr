<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.web/src/main/native/Source/ThirdParty/libxslt/src/libxslt/keys.c</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="functions.c.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="libxslt.syms.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/ThirdParty/libxslt/src/libxslt/keys.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -239,26 +239,28 @@</span>
   *
   * Returns the byte after the predicate or -1 in case of error
   */
  static int
  skipPredicate(const xmlChar *cur, int end) {
<span class="udiff-line-added">+     int level = 0;</span>
<span class="udiff-line-added">+ </span>
      if ((cur == NULL) || (end &lt; 0)) return(-1);
      if (cur[end] != &#39;[&#39;) return(end);
      end++;
      while (cur[end] != 0) {
          if ((cur[end] == &#39;\&#39;&#39;) || (cur[end] == &#39;&quot;&#39;)) {
          end = skipString(cur, end);
          if (end &lt;= 0)
              return(-1);
          continue;
      } else if (cur[end] == &#39;[&#39;) {
<span class="udiff-line-modified-removed">-         end = skipPredicate(cur, end);</span>
<span class="udiff-line-modified-removed">-         if (end &lt;= 0)</span>
<span class="udiff-line-modified-removed">-             return(-1);</span>
<span class="udiff-line-modified-removed">-         continue;</span>
<span class="udiff-line-modified-removed">-     } else if (cur[end] == &#39;]&#39;)</span>
<span class="udiff-line-modified-removed">-         return(end + 1);</span>
<span class="udiff-line-modified-added">+             level += 1;</span>
<span class="udiff-line-modified-added">+     } else if (cur[end] == &#39;]&#39;) {</span>
<span class="udiff-line-modified-added">+             if (level == 0)</span>
<span class="udiff-line-modified-added">+             return(end + 1);</span>
<span class="udiff-line-modified-added">+             level -= 1;</span>
<span class="udiff-line-modified-added">+         }</span>
      end++;
      }
      return(-1);
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -627,10 +629,11 @@</span>
      xsltKeyTablePtr table;
      xmlNodePtr oldInst, cur;
      xmlNodePtr oldContextNode;
      xsltDocumentPtr oldDocInfo;
      int oldXPPos, oldXPSize;
<span class="udiff-line-added">+     xmlNodePtr oldXPNode;</span>
      xmlDocPtr oldXPDoc;
      int oldXPNsNr;
      xmlNsPtr *oldXPNamespaces;
      xmlXPathContextPtr xpctxt;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -665,10 +668,11 @@</span>
      */
      oldInst = ctxt-&gt;inst;
      oldDocInfo = ctxt-&gt;document;
      oldContextNode = ctxt-&gt;node;
  
<span class="udiff-line-added">+     oldXPNode = xpctxt-&gt;node;</span>
      oldXPDoc = xpctxt-&gt;doc;
      oldXPPos = xpctxt-&gt;proximityPosition;
      oldXPSize = xpctxt-&gt;contextSize;
      oldXPNsNr = xpctxt-&gt;nsNr;
      oldXPNamespaces = xpctxt-&gt;namespaces;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -863,10 +867,11 @@</span>
  error:
      ctxt-&gt;keyInitLevel--;
      /*
      * Restore context state.
      */
<span class="udiff-line-added">+     xpctxt-&gt;node = oldXPNode;</span>
      xpctxt-&gt;doc = oldXPDoc;
      xpctxt-&gt;nsNr = oldXPNsNr;
      xpctxt-&gt;namespaces = oldXPNamespaces;
      xpctxt-&gt;proximityPosition = oldXPPos;
      xpctxt-&gt;contextSize = oldXPSize;
</pre>
<center><a href="functions.c.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="libxslt.syms.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>