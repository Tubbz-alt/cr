<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.graphics/src/main/native-glass/gtk/glass_window.cpp</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>modules/javafx.graphics/src/main/native-glass/gtk/glass_window.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 557                     jChars,
 558                     glassModifier);
 559             CHECK_JNI_EXCEPTION(mainEnv)
 560         }
 561     }
 562 }
 563 
 564 void WindowContextBase::paint(void* data, jint width, jint height) {
 565 #if GTK_CHECK_VERSION(3, 0, 0)
 566     cairo_region_t *region = gdk_window_get_clip_region(gdk_window);
 567 #if GTK_CHECK_VERSION(3, 22, 0)
 568     GdkDrawingContext *dcontext = gdk_window_begin_draw_frame(gdk_window, region);
 569     cairo_t *context = gdk_drawing_context_get_cairo_context(dcontext);
 570 #else
 571     gdk_window_begin_paint_region(gdk_window, region);
 572     cairo_t* context = gdk_cairo_create(gdk_window);
 573 #endif
 574 #else
 575     cairo_t* context = gdk_cairo_create(gdk_window);
 576 #endif






 577     cairo_surface_t* cairo_surface;
 578     cairo_surface = cairo_image_surface_create_for_data(
 579             (unsigned char*)data,
 580             CAIRO_FORMAT_ARGB32,
 581             width, height, width * 4);
 582 
 583     applyShapeMask(data, width, height);
<span class="line-removed"> 584 #ifdef GLASS_GTK3</span>
<span class="line-removed"> 585     if (bg_color.is_set) {</span>
<span class="line-removed"> 586         cairo_set_source_rgb(context, bg_color.red, bg_color.green, bg_color.blue);</span>
<span class="line-removed"> 587     }</span>
<span class="line-removed"> 588 #endif</span>
 589     cairo_set_source_surface(context, cairo_surface, 0, 0);
<span class="line-modified"> 590     cairo_set_operator(context, CAIRO_OPERATOR_SOURCE);</span>
 591     cairo_paint(context);
 592 
 593 #if GTK_CHECK_VERSION(3, 0, 0)
 594 #if GTK_CHECK_VERSION(3, 22, 0)
 595     gdk_window_end_draw_frame(gdk_window, dcontext);
 596     cairo_region_destroy(region);
 597 #else
 598     gdk_window_end_paint(gdk_window);
 599     cairo_region_destroy(region);
 600     cairo_destroy(context);
 601 #endif
 602 #else
 603     cairo_destroy(context);
 604 #endif
 605 
 606     cairo_surface_destroy(cairo_surface);
 607 }
 608 
 609 void WindowContextBase::add_child(WindowContextTop* child) {
 610     children.insert(child);
</pre>
</td>
<td>
<hr />
<pre>
 557                     jChars,
 558                     glassModifier);
 559             CHECK_JNI_EXCEPTION(mainEnv)
 560         }
 561     }
 562 }
 563 
 564 void WindowContextBase::paint(void* data, jint width, jint height) {
 565 #if GTK_CHECK_VERSION(3, 0, 0)
 566     cairo_region_t *region = gdk_window_get_clip_region(gdk_window);
 567 #if GTK_CHECK_VERSION(3, 22, 0)
 568     GdkDrawingContext *dcontext = gdk_window_begin_draw_frame(gdk_window, region);
 569     cairo_t *context = gdk_drawing_context_get_cairo_context(dcontext);
 570 #else
 571     gdk_window_begin_paint_region(gdk_window, region);
 572     cairo_t* context = gdk_cairo_create(gdk_window);
 573 #endif
 574 #else
 575     cairo_t* context = gdk_cairo_create(gdk_window);
 576 #endif
<span class="line-added"> 577     if (bg_color.is_set) {</span>
<span class="line-added"> 578         cairo_set_source_rgb(context, bg_color.red, bg_color.green, bg_color.blue);</span>
<span class="line-added"> 579         cairo_set_operator(context, CAIRO_OPERATOR_SOURCE);</span>
<span class="line-added"> 580         cairo_paint(context);</span>
<span class="line-added"> 581     }</span>
<span class="line-added"> 582 </span>
 583     cairo_surface_t* cairo_surface;
 584     cairo_surface = cairo_image_surface_create_for_data(
 585             (unsigned char*)data,
 586             CAIRO_FORMAT_ARGB32,
 587             width, height, width * 4);
 588 
 589     applyShapeMask(data, width, height);





 590     cairo_set_source_surface(context, cairo_surface, 0, 0);
<span class="line-modified"> 591     cairo_set_operator(context, CAIRO_OPERATOR_ATOP);</span>
 592     cairo_paint(context);
 593 
 594 #if GTK_CHECK_VERSION(3, 0, 0)
 595 #if GTK_CHECK_VERSION(3, 22, 0)
 596     gdk_window_end_draw_frame(gdk_window, dcontext);
 597     cairo_region_destroy(region);
 598 #else
 599     gdk_window_end_paint(gdk_window);
 600     cairo_region_destroy(region);
 601     cairo_destroy(context);
 602 #endif
 603 #else
 604     cairo_destroy(context);
 605 #endif
 606 
 607     cairo_surface_destroy(cairo_surface);
 608 }
 609 
 610 void WindowContextBase::add_child(WindowContextTop* child) {
 611     children.insert(child);
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>