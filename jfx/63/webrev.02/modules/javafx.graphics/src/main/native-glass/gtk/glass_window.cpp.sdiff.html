<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.graphics/src/main/native-glass/gtk/glass_window.cpp</title>
    <link rel="stylesheet" href="../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>modules/javafx.graphics/src/main/native-glass/gtk/glass_window.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
1033             updateWindowConstraints = true;
1034             if (!frame_extents_initialized &amp;&amp; !is_null_extents()) {
1035                 frame_extents_initialized = true;
1036                 set_bounds(0, 0, false, false,
1037                     requested_bounds.width, requested_bounds.height,
1038                     requested_bounds.client_width, requested_bounds.client_height
1039                 );
1040             }
1041         }
1042     } else {
1043         x = event-&gt;x;
1044         y = event-&gt;y;
1045         w = event-&gt;width;
1046         h = event-&gt;height;
1047     }
1048 
1049     if (size_assigned &amp;&amp; w &lt;= 1 &amp;&amp; h &lt;= 1 &amp;&amp; (geometry.final_width.value &gt; 1 ||
1050                                              geometry.final_height.value &gt; 1)) {
1051         // skip artifact
1052         return;









1053     }
1054 
<span class="line-removed">1055     geometry.final_width.value = w;</span>
<span class="line-removed">1056     geometry.final_width.type = BOUNDSTYPE_CONTENT;</span>
<span class="line-removed">1057     geometry.final_height.value = h;</span>
<span class="line-removed">1058     geometry.final_height.type = BOUNDSTYPE_CONTENT;</span>
1059     geometry_set_window_x(&amp;geometry, x);
1060     geometry_set_window_y(&amp;geometry, y);
1061 
1062     if (jview) {
1063         mainEnv-&gt;CallVoidMethod(jview, jViewNotifyResize,
1064                 event-&gt;width,
1065                 event-&gt;height);
1066         CHECK_JNI_EXCEPTION(mainEnv)
1067         mainEnv-&gt;CallVoidMethod(jview, jViewNotifyView,
1068                 com_sun_glass_events_ViewEvent_MOVE);
1069         CHECK_JNI_EXCEPTION(mainEnv)
1070     }
1071     if (jwindow) {
1072         mainEnv-&gt;CallVoidMethod(jwindow, jWindowNotifyResize,
1073                 (is_maximized)
1074                     ? com_sun_glass_events_WindowEvent_MAXIMIZE
1075                     : com_sun_glass_events_WindowEvent_RESIZE,
1076                 geometry.current_width,
1077                 geometry.current_height);
1078         CHECK_JNI_EXCEPTION(mainEnv)
</pre>
<hr />
<pre>
1264     }
1265 
1266     if (windowChangesMask &amp; (CWWidth | CWHeight)) {
1267         gint newWidth, newHeight;
1268         gtk_window_get_size(GTK_WINDOW(gtk_widget), &amp;newWidth, &amp;newHeight);
1269 
1270         if (windowChangesMask &amp; CWWidth) {
1271             newWidth = windowChanges-&gt;width;
1272         }
1273         if (windowChangesMask &amp; CWHeight) {
1274             newHeight = windowChanges-&gt;height;
1275         }
1276 
1277         if (!resizable.value) {
1278             GdkGeometry geom;
1279             GdkWindowHints hints = (GdkWindowHints)(GDK_HINT_MIN_SIZE | GDK_HINT_MAX_SIZE);
1280             geom.min_width = geom.max_width = newWidth;
1281             geom.min_height = geom.max_height = newHeight;
1282             gtk_window_set_geometry_hints(GTK_WINDOW(gtk_widget), NULL, &amp;geom, hints);
1283         }

1284         gtk_window_resize(GTK_WINDOW(gtk_widget), newWidth, newHeight);
1285 
1286         //JDK-8193502: Moved here from WindowContextBase::set_view because set_view is called
1287         //first and the size is not set yet. This also guarantees that the size will be correct
1288         //see: gtk_window_get_size doc for more context.
1289         if (jview) {
1290             mainEnv-&gt;CallVoidMethod(jview, jViewNotifyResize, newWidth, newHeight);
1291             CHECK_JNI_EXCEPTION(mainEnv);
1292         }
1293     }
1294 }
1295 
1296 void WindowContextTop::applyShapeMask(void* data, uint width, uint height)
1297 {
1298     if (frame_type != TRANSPARENT) {
1299         return;
1300     }
1301 
1302     glass_window_apply_shape_mask(gtk_widget_get_window(gtk_widget), data, width, height);
1303 }
</pre>
</td>
<td>
<hr />
<pre>
1033             updateWindowConstraints = true;
1034             if (!frame_extents_initialized &amp;&amp; !is_null_extents()) {
1035                 frame_extents_initialized = true;
1036                 set_bounds(0, 0, false, false,
1037                     requested_bounds.width, requested_bounds.height,
1038                     requested_bounds.client_width, requested_bounds.client_height
1039                 );
1040             }
1041         }
1042     } else {
1043         x = event-&gt;x;
1044         y = event-&gt;y;
1045         w = event-&gt;width;
1046         h = event-&gt;height;
1047     }
1048 
1049     if (size_assigned &amp;&amp; w &lt;= 1 &amp;&amp; h &lt;= 1 &amp;&amp; (geometry.final_width.value &gt; 1 ||
1050                                              geometry.final_height.value &gt; 1)) {
1051         // skip artifact
1052         return;
<span class="line-added">1053 </span>
<span class="line-added">1054     }</span>
<span class="line-added">1055 </span>
<span class="line-added">1056     // JDK-8232811: to avoid conflicting events, update the geometry only after window pops.</span>
<span class="line-added">1057     if (map_received) {</span>
<span class="line-added">1058         geometry.final_width.value = w;</span>
<span class="line-added">1059         geometry.final_width.type = BOUNDSTYPE_CONTENT;</span>
<span class="line-added">1060         geometry.final_height.value = h;</span>
<span class="line-added">1061         geometry.final_height.type = BOUNDSTYPE_CONTENT;</span>
1062     }
1063 




1064     geometry_set_window_x(&amp;geometry, x);
1065     geometry_set_window_y(&amp;geometry, y);
1066 
1067     if (jview) {
1068         mainEnv-&gt;CallVoidMethod(jview, jViewNotifyResize,
1069                 event-&gt;width,
1070                 event-&gt;height);
1071         CHECK_JNI_EXCEPTION(mainEnv)
1072         mainEnv-&gt;CallVoidMethod(jview, jViewNotifyView,
1073                 com_sun_glass_events_ViewEvent_MOVE);
1074         CHECK_JNI_EXCEPTION(mainEnv)
1075     }
1076     if (jwindow) {
1077         mainEnv-&gt;CallVoidMethod(jwindow, jWindowNotifyResize,
1078                 (is_maximized)
1079                     ? com_sun_glass_events_WindowEvent_MAXIMIZE
1080                     : com_sun_glass_events_WindowEvent_RESIZE,
1081                 geometry.current_width,
1082                 geometry.current_height);
1083         CHECK_JNI_EXCEPTION(mainEnv)
</pre>
<hr />
<pre>
1269     }
1270 
1271     if (windowChangesMask &amp; (CWWidth | CWHeight)) {
1272         gint newWidth, newHeight;
1273         gtk_window_get_size(GTK_WINDOW(gtk_widget), &amp;newWidth, &amp;newHeight);
1274 
1275         if (windowChangesMask &amp; CWWidth) {
1276             newWidth = windowChanges-&gt;width;
1277         }
1278         if (windowChangesMask &amp; CWHeight) {
1279             newHeight = windowChanges-&gt;height;
1280         }
1281 
1282         if (!resizable.value) {
1283             GdkGeometry geom;
1284             GdkWindowHints hints = (GdkWindowHints)(GDK_HINT_MIN_SIZE | GDK_HINT_MAX_SIZE);
1285             geom.min_width = geom.max_width = newWidth;
1286             geom.min_height = geom.max_height = newHeight;
1287             gtk_window_set_geometry_hints(GTK_WINDOW(gtk_widget), NULL, &amp;geom, hints);
1288         }
<span class="line-added">1289 </span>
1290         gtk_window_resize(GTK_WINDOW(gtk_widget), newWidth, newHeight);
1291 
1292         //JDK-8193502: Moved here from WindowContextBase::set_view because set_view is called
1293         //first and the size is not set yet. This also guarantees that the size will be correct
1294         //see: gtk_window_get_size doc for more context.
1295         if (jview) {
1296             mainEnv-&gt;CallVoidMethod(jview, jViewNotifyResize, newWidth, newHeight);
1297             CHECK_JNI_EXCEPTION(mainEnv);
1298         }
1299     }
1300 }
1301 
1302 void WindowContextTop::applyShapeMask(void* data, uint width, uint height)
1303 {
1304     if (frame_type != TRANSPARENT) {
1305         return;
1306     }
1307 
1308     glass_window_apply_shape_mask(gtk_widget_get_window(gtk_widget), data, width, height);
1309 }
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>