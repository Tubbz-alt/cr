<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/gpattern.c</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="goption.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gpattern.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/gpattern.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -78,12 +78,12 @@</span>
  
  
  /* --- functions --- */
  static inline gboolean
  g_pattern_ph_match (const gchar *match_pattern,
<span class="udiff-line-modified-removed">-             const gchar *match_string,</span>
<span class="udiff-line-modified-removed">-             gboolean    *wildcard_reached_p)</span>
<span class="udiff-line-modified-added">+         const gchar *match_string,</span>
<span class="udiff-line-modified-added">+         gboolean    *wildcard_reached_p)</span>
  {
    const gchar *pattern, *string;
    gchar ch;
  
    pattern = match_pattern;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -92,64 +92,64 @@</span>
    ch = *pattern;
    pattern++;
    while (ch)
      {
        switch (ch)
<span class="udiff-line-added">+   {</span>
<span class="udiff-line-added">+   case &#39;?&#39;:</span>
<span class="udiff-line-added">+     if (!*string)</span>
<span class="udiff-line-added">+       return FALSE;</span>
<span class="udiff-line-added">+     string = g_utf8_next_char (string);</span>
<span class="udiff-line-added">+     break;</span>
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   case &#39;*&#39;:</span>
<span class="udiff-line-added">+     *wildcard_reached_p = TRUE;</span>
<span class="udiff-line-added">+     do</span>
<span class="udiff-line-added">+       {</span>
<span class="udiff-line-added">+         ch = *pattern;</span>
<span class="udiff-line-added">+         pattern++;</span>
<span class="udiff-line-added">+         if (ch == &#39;?&#39;)</span>
      {
<span class="udiff-line-removed">-     case &#39;?&#39;:</span>
        if (!*string)
          return FALSE;
        string = g_utf8_next_char (string);
<span class="udiff-line-modified-removed">-       break;</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-     case &#39;*&#39;:</span>
<span class="udiff-line-modified-removed">-       *wildcard_reached_p = TRUE;</span>
<span class="udiff-line-modified-removed">-       do</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           ch = *pattern;</span>
<span class="udiff-line-removed">-           pattern++;</span>
<span class="udiff-line-removed">-           if (ch == &#39;?&#39;)</span>
<span class="udiff-line-removed">-         {</span>
<span class="udiff-line-removed">-           if (!*string)</span>
<span class="udiff-line-removed">-             return FALSE;</span>
<span class="udiff-line-removed">-           string = g_utf8_next_char (string);</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-       while (ch == &#39;*&#39; || ch == &#39;?&#39;);</span>
<span class="udiff-line-removed">-       if (!ch)</span>
<span class="udiff-line-removed">-         return TRUE;</span>
<span class="udiff-line-removed">-       do</span>
<span class="udiff-line-removed">-         {</span>
<span class="udiff-line-modified-added">+     }</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     while (ch == &#39;*&#39; || ch == &#39;?&#39;);</span>
<span class="udiff-line-modified-added">+     if (!ch)</span>
<span class="udiff-line-modified-added">+       return TRUE;</span>
<span class="udiff-line-modified-added">+     do</span>
<span class="udiff-line-modified-added">+       {</span>
                gboolean next_wildcard_reached = FALSE;
<span class="udiff-line-modified-removed">-           while (ch != *string)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           if (!*string)</span>
<span class="udiff-line-modified-removed">-             return FALSE;</span>
<span class="udiff-line-modified-removed">-           string = g_utf8_next_char (string);</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-           string++;</span>
<span class="udiff-line-modified-removed">-           if (g_pattern_ph_match (pattern, string, &amp;next_wildcard_reached))</span>
<span class="udiff-line-modified-removed">-         return TRUE;</span>
<span class="udiff-line-modified-added">+         while (ch != *string)</span>
<span class="udiff-line-modified-added">+     {</span>
<span class="udiff-line-modified-added">+       if (!*string)</span>
<span class="udiff-line-modified-added">+         return FALSE;</span>
<span class="udiff-line-modified-added">+       string = g_utf8_next_char (string);</span>
<span class="udiff-line-modified-added">+     }</span>
<span class="udiff-line-modified-added">+         string++;</span>
<span class="udiff-line-modified-added">+         if (g_pattern_ph_match (pattern, string, &amp;next_wildcard_reached))</span>
<span class="udiff-line-modified-added">+     return TRUE;</span>
                if (next_wildcard_reached)
                  /* the forthcoming pattern substring up to the next wildcard has
                   * been matched, but a mismatch occoured for the rest of the
                   * pattern, following the next wildcard.
                   * there&#39;s no need to advance the current match position any
                   * further if the rest pattern will not match.
                   */
<span class="udiff-line-modified-removed">-         return FALSE;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       while (*string);</span>
<span class="udiff-line-modified-removed">-       break;</span>
<span class="udiff-line-modified-added">+     return FALSE;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     while (*string);</span>
<span class="udiff-line-modified-added">+     break;</span>
  
<span class="udiff-line-modified-removed">-     default:</span>
<span class="udiff-line-modified-removed">-       if (ch == *string)</span>
<span class="udiff-line-modified-removed">-         string++;</span>
<span class="udiff-line-modified-removed">-       else</span>
<span class="udiff-line-modified-removed">-         return FALSE;</span>
<span class="udiff-line-modified-removed">-       break;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   default:</span>
<span class="udiff-line-modified-added">+     if (ch == *string)</span>
<span class="udiff-line-modified-added">+       string++;</span>
<span class="udiff-line-modified-added">+     else</span>
<span class="udiff-line-modified-added">+       return FALSE;</span>
<span class="udiff-line-modified-added">+     break;</span>
<span class="udiff-line-modified-added">+   }</span>
  
        ch = *pattern;
        pattern++;
      }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -184,13 +184,13 @@</span>
   *
   * Returns: %TRUE if @string matches @pspec
   **/
  gboolean
  g_pattern_match (GPatternSpec *pspec,
<span class="udiff-line-modified-removed">-          guint         string_length,</span>
<span class="udiff-line-modified-removed">-          const gchar  *string,</span>
<span class="udiff-line-modified-removed">-          const gchar  *string_reversed)</span>
<span class="udiff-line-modified-added">+      guint         string_length,</span>
<span class="udiff-line-modified-added">+      const gchar  *string,</span>
<span class="udiff-line-modified-added">+      const gchar  *string_reversed)</span>
  {
    g_return_val_if_fail (pspec != NULL, FALSE);
    g_return_val_if_fail (string != NULL, FALSE);
  
    if (string_length &lt; pspec-&gt;min_length ||
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -202,32 +202,32 @@</span>
        gboolean dummy;
      case G_MATCH_ALL:
        return g_pattern_ph_match (pspec-&gt;pattern, string, &amp;dummy);
      case G_MATCH_ALL_TAIL:
        if (string_reversed)
<span class="udiff-line-modified-removed">-     return g_pattern_ph_match (pspec-&gt;pattern, string_reversed, &amp;dummy);</span>
<span class="udiff-line-modified-added">+   return g_pattern_ph_match (pspec-&gt;pattern, string_reversed, &amp;dummy);</span>
        else
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-added">+   {</span>
            gboolean result;
            gchar *tmp;
<span class="udiff-line-modified-removed">-       tmp = g_utf8_strreverse (string, string_length);</span>
<span class="udiff-line-modified-removed">-       result = g_pattern_ph_match (pspec-&gt;pattern, tmp, &amp;dummy);</span>
<span class="udiff-line-modified-removed">-       g_free (tmp);</span>
<span class="udiff-line-modified-removed">-       return result;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+     tmp = g_utf8_strreverse (string, string_length);</span>
<span class="udiff-line-modified-added">+     result = g_pattern_ph_match (pspec-&gt;pattern, tmp, &amp;dummy);</span>
<span class="udiff-line-modified-added">+     g_free (tmp);</span>
<span class="udiff-line-modified-added">+     return result;</span>
<span class="udiff-line-modified-added">+   }</span>
      case G_MATCH_HEAD:
        if (pspec-&gt;pattern_length == string_length)
<span class="udiff-line-modified-removed">-     return strcmp (pspec-&gt;pattern, string) == 0;</span>
<span class="udiff-line-modified-added">+   return strcmp (pspec-&gt;pattern, string) == 0;</span>
        else if (pspec-&gt;pattern_length)
<span class="udiff-line-modified-removed">-     return strncmp (pspec-&gt;pattern, string, pspec-&gt;pattern_length) == 0;</span>
<span class="udiff-line-modified-added">+   return strncmp (pspec-&gt;pattern, string, pspec-&gt;pattern_length) == 0;</span>
        else
<span class="udiff-line-modified-removed">-     return TRUE;</span>
<span class="udiff-line-modified-added">+   return TRUE;</span>
      case G_MATCH_TAIL:
        if (pspec-&gt;pattern_length)
          return strcmp (pspec-&gt;pattern, string + (string_length - pspec-&gt;pattern_length)) == 0;
        else
<span class="udiff-line-modified-removed">-     return TRUE;</span>
<span class="udiff-line-modified-added">+   return TRUE;</span>
      case G_MATCH_EXACT:
        if (pspec-&gt;pattern_length != string_length)
          return FALSE;
        else
          return strcmp (pspec-&gt;pattern, string) == 0;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -267,39 +267,39 @@</span>
    pspec-&gt;pattern = g_new (gchar, pspec-&gt;pattern_length + 1);
    d = pspec-&gt;pattern;
    for (i = 0, s = pattern; *s != 0; s++)
      {
        switch (*s)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-     case &#39;*&#39;:</span>
<span class="udiff-line-modified-removed">-       if (follows_wildcard) /* compress multiple wildcards */</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           pspec-&gt;pattern_length--;</span>
<span class="udiff-line-modified-removed">-           continue;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-       follows_wildcard = TRUE;</span>
<span class="udiff-line-removed">-       if (hw_pos &lt; 0)</span>
<span class="udiff-line-removed">-         hw_pos = i;</span>
<span class="udiff-line-removed">-       tw_pos = i;</span>
<span class="udiff-line-removed">-       break;</span>
<span class="udiff-line-removed">-     case &#39;?&#39;:</span>
<span class="udiff-line-removed">-       pending_jokers++;</span>
<span class="udiff-line-removed">-       pspec-&gt;min_length++;</span>
<span class="udiff-line-removed">-       pspec-&gt;max_length += 4; /* maximum UTF-8 character length */</span>
<span class="udiff-line-removed">-       continue;</span>
<span class="udiff-line-removed">-     default:</span>
<span class="udiff-line-removed">-       for (; pending_jokers; pending_jokers--, i++) {</span>
<span class="udiff-line-removed">-         *d++ = &#39;?&#39;;</span>
<span class="udiff-line-removed">-         if (hj_pos &lt; 0)</span>
<span class="udiff-line-removed">-          hj_pos = i;</span>
<span class="udiff-line-removed">-         tj_pos = i;</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+   case &#39;*&#39;:</span>
<span class="udiff-line-modified-added">+     if (follows_wildcard) /* compress multiple wildcards */</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         pspec-&gt;pattern_length--;</span>
<span class="udiff-line-modified-added">+         continue;</span>
        }
<span class="udiff-line-modified-removed">-       follows_wildcard = FALSE;</span>
<span class="udiff-line-modified-removed">-       pspec-&gt;min_length++;</span>
<span class="udiff-line-modified-removed">-       pspec-&gt;max_length++;</span>
<span class="udiff-line-modified-removed">-       break;</span>
<span class="udiff-line-modified-added">+     follows_wildcard = TRUE;</span>
<span class="udiff-line-modified-added">+     if (hw_pos &lt; 0)</span>
<span class="udiff-line-modified-added">+       hw_pos = i;</span>
<span class="udiff-line-modified-added">+     tw_pos = i;</span>
<span class="udiff-line-added">+     break;</span>
<span class="udiff-line-added">+   case &#39;?&#39;:</span>
<span class="udiff-line-added">+     pending_jokers++;</span>
<span class="udiff-line-added">+     pspec-&gt;min_length++;</span>
<span class="udiff-line-added">+     pspec-&gt;max_length += 4; /* maximum UTF-8 character length */</span>
<span class="udiff-line-added">+     continue;</span>
<span class="udiff-line-added">+   default:</span>
<span class="udiff-line-added">+     for (; pending_jokers; pending_jokers--, i++) {</span>
<span class="udiff-line-added">+       *d++ = &#39;?&#39;;</span>
<span class="udiff-line-added">+         if (hj_pos &lt; 0)</span>
<span class="udiff-line-added">+        hj_pos = i;</span>
<span class="udiff-line-added">+       tj_pos = i;</span>
      }
<span class="udiff-line-added">+     follows_wildcard = FALSE;</span>
<span class="udiff-line-added">+     pspec-&gt;min_length++;</span>
<span class="udiff-line-added">+     pspec-&gt;max_length++;</span>
<span class="udiff-line-added">+     break;</span>
<span class="udiff-line-added">+   }</span>
        *d++ = *s;
        i++;
      }
    for (; pending_jokers; pending_jokers--) {
      *d++ = &#39;?&#39;;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -316,28 +316,28 @@</span>
  
    /* special case sole head/tail wildcard or exact matches */
    if (!seen_joker &amp;&amp; !more_wildcards)
      {
        if (pspec-&gt;pattern[0] == &#39;*&#39;)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       pspec-&gt;match_type = G_MATCH_TAIL;</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     pspec-&gt;match_type = G_MATCH_TAIL;</span>
            memmove (pspec-&gt;pattern, pspec-&gt;pattern + 1, --pspec-&gt;pattern_length);
<span class="udiff-line-modified-removed">-       pspec-&gt;pattern[pspec-&gt;pattern_length] = 0;</span>
<span class="udiff-line-modified-removed">-       return pspec;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+     pspec-&gt;pattern[pspec-&gt;pattern_length] = 0;</span>
<span class="udiff-line-modified-added">+     return pspec;</span>
<span class="udiff-line-modified-added">+   }</span>
        if (pspec-&gt;pattern_length &gt; 0 &amp;&amp;
<span class="udiff-line-modified-removed">-       pspec-&gt;pattern[pspec-&gt;pattern_length - 1] == &#39;*&#39;)</span>
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       pspec-&gt;match_type = G_MATCH_HEAD;</span>
<span class="udiff-line-modified-removed">-       pspec-&gt;pattern[--pspec-&gt;pattern_length] = 0;</span>
<span class="udiff-line-modified-removed">-       return pspec;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+     pspec-&gt;pattern[pspec-&gt;pattern_length - 1] == &#39;*&#39;)</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     pspec-&gt;match_type = G_MATCH_HEAD;</span>
<span class="udiff-line-modified-added">+     pspec-&gt;pattern[--pspec-&gt;pattern_length] = 0;</span>
<span class="udiff-line-modified-added">+     return pspec;</span>
<span class="udiff-line-modified-added">+   }</span>
        if (!seen_wildcard)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       pspec-&gt;match_type = G_MATCH_EXACT;</span>
<span class="udiff-line-modified-removed">-       return pspec;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     pspec-&gt;match_type = G_MATCH_EXACT;</span>
<span class="udiff-line-modified-added">+     return pspec;</span>
<span class="udiff-line-modified-added">+   }</span>
      }
  
    /* now just need to distinguish between head or tail match start */
    tw_pos = pspec-&gt;pattern_length - 1 - tw_pos;  /* last pos to tail distance */
    tj_pos = pspec-&gt;pattern_length - 1 - tj_pos;  /* last pos to tail distance */
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -378,18 +378,18 @@</span>
   *
   * Returns: Whether the compiled patterns are equal
   **/
  gboolean
  g_pattern_spec_equal (GPatternSpec *pspec1,
<span class="udiff-line-modified-removed">-               GPatternSpec *pspec2)</span>
<span class="udiff-line-modified-added">+           GPatternSpec *pspec2)</span>
  {
    g_return_val_if_fail (pspec1 != NULL, FALSE);
    g_return_val_if_fail (pspec2 != NULL, FALSE);
  
    return (pspec1-&gt;pattern_length == pspec2-&gt;pattern_length &amp;&amp;
<span class="udiff-line-modified-removed">-       pspec1-&gt;match_type == pspec2-&gt;match_type &amp;&amp;</span>
<span class="udiff-line-modified-removed">-       strcmp (pspec1-&gt;pattern, pspec2-&gt;pattern) == 0);</span>
<span class="udiff-line-modified-added">+     pspec1-&gt;match_type == pspec2-&gt;match_type &amp;&amp;</span>
<span class="udiff-line-modified-added">+     strcmp (pspec1-&gt;pattern, pspec2-&gt;pattern) == 0);</span>
  }
  
  /**
   * g_pattern_match_string:
   * @pspec: a #GPatternSpec
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -401,11 +401,11 @@</span>
   *
   * Returns: %TRUE if @string matches @pspec
   **/
  gboolean
  g_pattern_match_string (GPatternSpec *pspec,
<span class="udiff-line-modified-removed">-             const gchar  *string)</span>
<span class="udiff-line-modified-added">+       const gchar  *string)</span>
  {
    g_return_val_if_fail (pspec != NULL, FALSE);
    g_return_val_if_fail (string != NULL, FALSE);
  
    return g_pattern_match (pspec, strlen (string), string, NULL);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -423,11 +423,11 @@</span>
   *
   * Returns: %TRUE if @string matches @pspec
   **/
  gboolean
  g_pattern_match_simple (const gchar *pattern,
<span class="udiff-line-modified-removed">-             const gchar *string)</span>
<span class="udiff-line-modified-added">+       const gchar *string)</span>
  {
    GPatternSpec *pspec;
    gboolean ergo;
  
    g_return_val_if_fail (pattern != NULL, FALSE);
</pre>
<center><a href="goption.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gpattern.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>