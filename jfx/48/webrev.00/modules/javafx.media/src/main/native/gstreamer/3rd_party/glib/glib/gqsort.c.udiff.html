<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/gqsort.c</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="gprintfint.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gqsort.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/gqsort.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -87,103 +87,103 @@</span>
  
    switch (p-&gt;var)
      {
      case 0:
        while (n1 &gt; 0 &amp;&amp; n2 &gt; 0)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       if ((*cmp) (b1, b2, arg) &lt;= 0)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           *(guint32 *) tmp = *(guint32 *) b1;</span>
<span class="udiff-line-modified-removed">-           b1 += sizeof (guint32);</span>
<span class="udiff-line-modified-removed">-           --n1;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       else</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           *(guint32 *) tmp = *(guint32 *) b2;</span>
<span class="udiff-line-modified-removed">-           b2 += sizeof (guint32);</span>
<span class="udiff-line-modified-removed">-           --n2;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       tmp += sizeof (guint32);</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     if ((*cmp) (b1, b2, arg) &lt;= 0)</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         *(guint32 *) tmp = *(guint32 *) b1;</span>
<span class="udiff-line-modified-added">+         b1 += sizeof (guint32);</span>
<span class="udiff-line-modified-added">+         --n1;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     else</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         *(guint32 *) tmp = *(guint32 *) b2;</span>
<span class="udiff-line-modified-added">+         b2 += sizeof (guint32);</span>
<span class="udiff-line-modified-added">+         --n2;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     tmp += sizeof (guint32);</span>
<span class="udiff-line-modified-added">+   }</span>
        break;
      case 1:
        while (n1 &gt; 0 &amp;&amp; n2 &gt; 0)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       if ((*cmp) (b1, b2, arg) &lt;= 0)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           *(guint64 *) tmp = *(guint64 *) b1;</span>
<span class="udiff-line-modified-removed">-           b1 += sizeof (guint64);</span>
<span class="udiff-line-modified-removed">-           --n1;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       else</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           *(guint64 *) tmp = *(guint64 *) b2;</span>
<span class="udiff-line-modified-removed">-           b2 += sizeof (guint64);</span>
<span class="udiff-line-modified-removed">-           --n2;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       tmp += sizeof (guint64);</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     if ((*cmp) (b1, b2, arg) &lt;= 0)</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         *(guint64 *) tmp = *(guint64 *) b1;</span>
<span class="udiff-line-modified-added">+         b1 += sizeof (guint64);</span>
<span class="udiff-line-modified-added">+         --n1;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     else</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         *(guint64 *) tmp = *(guint64 *) b2;</span>
<span class="udiff-line-modified-added">+         b2 += sizeof (guint64);</span>
<span class="udiff-line-modified-added">+         --n2;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     tmp += sizeof (guint64);</span>
<span class="udiff-line-modified-added">+   }</span>
        break;
      case 2:
        while (n1 &gt; 0 &amp;&amp; n2 &gt; 0)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       unsigned long *tmpl = (unsigned long *) tmp;</span>
<span class="udiff-line-modified-removed">-       unsigned long *bl;</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     unsigned long *tmpl = (unsigned long *) tmp;</span>
<span class="udiff-line-modified-added">+     unsigned long *bl;</span>
  
<span class="udiff-line-modified-removed">-       tmp += s;</span>
<span class="udiff-line-modified-removed">-       if ((*cmp) (b1, b2, arg) &lt;= 0)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           bl = (unsigned long *) b1;</span>
<span class="udiff-line-modified-removed">-           b1 += s;</span>
<span class="udiff-line-modified-removed">-           --n1;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       else</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           bl = (unsigned long *) b2;</span>
<span class="udiff-line-modified-removed">-           b2 += s;</span>
<span class="udiff-line-modified-removed">-           --n2;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       while (tmpl &lt; (unsigned long *) tmp)</span>
<span class="udiff-line-modified-removed">-         *tmpl++ = *bl++;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+     tmp += s;</span>
<span class="udiff-line-modified-added">+     if ((*cmp) (b1, b2, arg) &lt;= 0)</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         bl = (unsigned long *) b1;</span>
<span class="udiff-line-modified-added">+         b1 += s;</span>
<span class="udiff-line-modified-added">+         --n1;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     else</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         bl = (unsigned long *) b2;</span>
<span class="udiff-line-modified-added">+         b2 += s;</span>
<span class="udiff-line-modified-added">+         --n2;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     while (tmpl &lt; (unsigned long *) tmp)</span>
<span class="udiff-line-modified-added">+       *tmpl++ = *bl++;</span>
<span class="udiff-line-modified-added">+   }</span>
        break;
      case 3:
        while (n1 &gt; 0 &amp;&amp; n2 &gt; 0)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       if ((*cmp) (*(const void **) b1, *(const void **) b2, arg) &lt;= 0)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           *(void **) tmp = *(void **) b1;</span>
<span class="udiff-line-modified-removed">-           b1 += sizeof (void *);</span>
<span class="udiff-line-modified-removed">-           --n1;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       else</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           *(void **) tmp = *(void **) b2;</span>
<span class="udiff-line-modified-removed">-           b2 += sizeof (void *);</span>
<span class="udiff-line-modified-removed">-           --n2;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       tmp += sizeof (void *);</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     if ((*cmp) (*(const void **) b1, *(const void **) b2, arg) &lt;= 0)</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         *(void **) tmp = *(void **) b1;</span>
<span class="udiff-line-modified-added">+         b1 += sizeof (void *);</span>
<span class="udiff-line-modified-added">+         --n1;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     else</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         *(void **) tmp = *(void **) b2;</span>
<span class="udiff-line-modified-added">+         b2 += sizeof (void *);</span>
<span class="udiff-line-modified-added">+         --n2;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     tmp += sizeof (void *);</span>
<span class="udiff-line-modified-added">+   }</span>
        break;
      default:
        while (n1 &gt; 0 &amp;&amp; n2 &gt; 0)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       if ((*cmp) (b1, b2, arg) &lt;= 0)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           memcpy (tmp, b1, s);</span>
<span class="udiff-line-modified-removed">-           tmp += s;</span>
<span class="udiff-line-modified-removed">-           b1 += s;</span>
<span class="udiff-line-modified-removed">-           --n1;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       else</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           memcpy (tmp, b2, s);</span>
<span class="udiff-line-modified-removed">-           tmp += s;</span>
<span class="udiff-line-modified-removed">-           b2 += s;</span>
<span class="udiff-line-modified-removed">-           --n2;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     if ((*cmp) (b1, b2, arg) &lt;= 0)</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         memcpy (tmp, b1, s);</span>
<span class="udiff-line-modified-added">+         tmp += s;</span>
<span class="udiff-line-modified-added">+         b1 += s;</span>
<span class="udiff-line-modified-added">+         --n1;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     else</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         memcpy (tmp, b2, s);</span>
<span class="udiff-line-modified-added">+         tmp += s;</span>
<span class="udiff-line-modified-added">+         b2 += s;</span>
<span class="udiff-line-modified-added">+         --n2;</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+   }</span>
        break;
      }
  
    if (n1 &gt; 0)
      memcpy (tmp, b1, n1 * s);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -226,57 +226,57 @@</span>
        void *tmp_storage = (void *) (tp + n);
        char *kp;
        size_t i;
  
        while ((void *) t &lt; tmp_storage)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       *t++ = ip;</span>
<span class="udiff-line-modified-removed">-       ip += s;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     *t++ = ip;</span>
<span class="udiff-line-modified-added">+     ip += s;</span>
<span class="udiff-line-modified-added">+   }</span>
        p.s = sizeof (void *);
        p.var = 3;
        msort_with_tmp (&amp;p, p.t + n * sizeof (void *), n);
  
        /* tp[0] .. tp[n - 1] is now sorted, copy around entries of
<span class="udiff-line-modified-removed">-      the original array.  Knuth vol. 3 (2nd ed.) exercise 5.2-10.  */</span>
<span class="udiff-line-modified-added">+    the original array.  Knuth vol. 3 (2nd ed.) exercise 5.2-10.  */</span>
        for (i = 0, ip = (char *) b; i &lt; n; i++, ip += s)
<span class="udiff-line-modified-removed">-     if ((kp = tp[i]) != ip)</span>
<span class="udiff-line-modified-removed">-       {</span>
<span class="udiff-line-modified-removed">-         size_t j = i;</span>
<span class="udiff-line-modified-removed">-         char *jp = ip;</span>
<span class="udiff-line-modified-removed">-         memcpy (tmp_storage, ip, s);</span>
<span class="udiff-line-modified-added">+   if ((kp = tp[i]) != ip)</span>
<span class="udiff-line-modified-added">+     {</span>
<span class="udiff-line-modified-added">+       size_t j = i;</span>
<span class="udiff-line-modified-added">+       char *jp = ip;</span>
<span class="udiff-line-modified-added">+       memcpy (tmp_storage, ip, s);</span>
  
<span class="udiff-line-modified-removed">-         do</span>
<span class="udiff-line-modified-removed">-           {</span>
<span class="udiff-line-modified-removed">-         size_t k = (kp - (char *) b) / s;</span>
<span class="udiff-line-modified-removed">-         tp[j] = jp;</span>
<span class="udiff-line-modified-removed">-         memcpy (jp, kp, s);</span>
<span class="udiff-line-modified-removed">-         j = k;</span>
<span class="udiff-line-modified-removed">-         jp = kp;</span>
<span class="udiff-line-modified-removed">-         kp = tp[k];</span>
<span class="udiff-line-modified-removed">-           }</span>
<span class="udiff-line-modified-removed">-         while (kp != ip);</span>
<span class="udiff-line-modified-added">+       do</span>
<span class="udiff-line-modified-added">+         {</span>
<span class="udiff-line-modified-added">+     size_t k = (kp - (char *) b) / s;</span>
<span class="udiff-line-modified-added">+     tp[j] = jp;</span>
<span class="udiff-line-modified-added">+     memcpy (jp, kp, s);</span>
<span class="udiff-line-modified-added">+     j = k;</span>
<span class="udiff-line-modified-added">+     jp = kp;</span>
<span class="udiff-line-modified-added">+     kp = tp[k];</span>
<span class="udiff-line-modified-added">+         }</span>
<span class="udiff-line-modified-added">+       while (kp != ip);</span>
  
<span class="udiff-line-modified-removed">-         tp[j] = jp;</span>
<span class="udiff-line-modified-removed">-         memcpy (jp, tmp_storage, s);</span>
<span class="udiff-line-modified-removed">-       }</span>
<span class="udiff-line-modified-added">+       tp[j] = jp;</span>
<span class="udiff-line-modified-added">+       memcpy (jp, tmp_storage, s);</span>
<span class="udiff-line-modified-added">+     }</span>
      }
    else
      {
        if ((s &amp; (sizeof (guint32) - 1)) == 0
<span class="udiff-line-modified-removed">-       &amp;&amp; ((char *) b - (char *) 0) % ALIGNOF_GUINT32 == 0)</span>
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       if (s == sizeof (guint32))</span>
<span class="udiff-line-modified-removed">-         p.var = 0;</span>
<span class="udiff-line-modified-removed">-       else if (s == sizeof (guint64)</span>
<span class="udiff-line-modified-removed">-            &amp;&amp; ((char *) b - (char *) 0) % ALIGNOF_GUINT64 == 0)</span>
<span class="udiff-line-modified-removed">-         p.var = 1;</span>
<span class="udiff-line-modified-removed">-       else if ((s &amp; (sizeof (unsigned long) - 1)) == 0</span>
<span class="udiff-line-modified-removed">-            &amp;&amp; ((char *) b - (char *) 0)</span>
<span class="udiff-line-modified-removed">-               % ALIGNOF_UNSIGNED_LONG == 0)</span>
<span class="udiff-line-modified-removed">-         p.var = 2;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+     &amp;&amp; ((char *) b - (char *) 0) % ALIGNOF_GUINT32 == 0)</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     if (s == sizeof (guint32))</span>
<span class="udiff-line-modified-added">+       p.var = 0;</span>
<span class="udiff-line-modified-added">+     else if (s == sizeof (guint64)</span>
<span class="udiff-line-modified-added">+        &amp;&amp; ((char *) b - (char *) 0) % ALIGNOF_GUINT64 == 0)</span>
<span class="udiff-line-modified-added">+       p.var = 1;</span>
<span class="udiff-line-modified-added">+     else if ((s &amp; (sizeof (unsigned long) - 1)) == 0</span>
<span class="udiff-line-modified-added">+        &amp;&amp; ((char *) b - (char *) 0)</span>
<span class="udiff-line-modified-added">+           % ALIGNOF_UNSIGNED_LONG == 0)</span>
<span class="udiff-line-modified-added">+       p.var = 2;</span>
<span class="udiff-line-modified-added">+   }</span>
        msort_with_tmp (&amp;p, b, n);
      }
    g_free (tmp);
  }
  
</pre>
<center><a href="gprintfint.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gqsort.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>