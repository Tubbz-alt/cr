<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/build/win32/dirent/dirent.c</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../../osx/glibconfig.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="dirent.h.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/build/win32/dirent/dirent.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -26,31 +26,31 @@</span>
  #include &lt;windows.h&gt; /* for GetFileAttributes */
  
  #include &lt;tchar.h&gt;
  
  #ifdef _UNICODE
<span class="udiff-line-modified-removed">- #define _tdirent    _wdirent</span>
<span class="udiff-line-modified-removed">- #define _TDIR       _WDIR</span>
<span class="udiff-line-modified-removed">- #define _topendir   _wopendir</span>
<span class="udiff-line-modified-added">+ #define _tdirent  _wdirent</span>
<span class="udiff-line-modified-added">+ #define _TDIR     _WDIR</span>
<span class="udiff-line-modified-added">+ #define _topendir _wopendir</span>
  #define _tclosedir  _wclosedir
<span class="udiff-line-modified-removed">- #define _treaddir   _wreaddir</span>
<span class="udiff-line-modified-added">+ #define _treaddir _wreaddir</span>
  #define _trewinddir _wrewinddir
<span class="udiff-line-modified-removed">- #define _ttelldir   _wtelldir</span>
<span class="udiff-line-modified-removed">- #define _tseekdir   _wseekdir</span>
<span class="udiff-line-modified-added">+ #define _ttelldir _wtelldir</span>
<span class="udiff-line-modified-added">+ #define _tseekdir _wseekdir</span>
  #else
<span class="udiff-line-modified-removed">- #define _tdirent    dirent</span>
<span class="udiff-line-modified-removed">- #define _TDIR       DIR</span>
<span class="udiff-line-modified-removed">- #define _topendir   opendir</span>
<span class="udiff-line-modified-added">+ #define _tdirent  dirent</span>
<span class="udiff-line-modified-added">+ #define _TDIR     DIR</span>
<span class="udiff-line-modified-added">+ #define _topendir opendir</span>
  #define _tclosedir  closedir
<span class="udiff-line-modified-removed">- #define _treaddir   readdir</span>
<span class="udiff-line-modified-added">+ #define _treaddir readdir</span>
  #define _trewinddir rewinddir
<span class="udiff-line-modified-removed">- #define _ttelldir   telldir</span>
<span class="udiff-line-modified-removed">- #define _tseekdir   seekdir</span>
<span class="udiff-line-modified-added">+ #define _ttelldir telldir</span>
<span class="udiff-line-modified-added">+ #define _tseekdir seekdir</span>
  #endif
  
  #define SUFFIX  _T(&quot;*&quot;)
<span class="udiff-line-modified-removed">- #define SLASH   _T(&quot;\\&quot;)</span>
<span class="udiff-line-modified-added">+ #define SLASH _T(&quot;\\&quot;)</span>
  
  
  /*
   * opendir
   *
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -97,11 +97,11 @@</span>
    _tfullpath (szFullPath, szPath, MAX_PATH);
  
    /* Allocate enough space to store DIR structure and the complete
     * directory path given. */
    nd = (_TDIR *) malloc (sizeof (_TDIR) + (_tcslen(szFullPath) + _tcslen (SLASH) +
<span class="udiff-line-modified-removed">-              _tcslen(SUFFIX) + 1) * sizeof(_TCHAR));</span>
<span class="udiff-line-modified-added">+        _tcslen(SUFFIX) + 1) * sizeof(_TCHAR));</span>
  
    if (!nd)
      {
        /* Error, out of memory. */
        errno = ENOMEM;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -170,41 +170,41 @@</span>
        /* We haven&#39;t started the search yet. */
        /* Start the search */
        dirp-&gt;dd_handle = _tfindfirst (dirp-&gt;dd_name, &amp;(dirp-&gt;dd_dta));
  
        if (dirp-&gt;dd_handle == -1)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       /* Whoops! Seems there are no files in that</span>
<span class="udiff-line-modified-removed">-        * directory. */</span>
<span class="udiff-line-modified-removed">-       dirp-&gt;dd_stat = -1;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     /* Whoops! Seems there are no files in that</span>
<span class="udiff-line-modified-added">+      * directory. */</span>
<span class="udiff-line-modified-added">+     dirp-&gt;dd_stat = -1;</span>
<span class="udiff-line-modified-added">+   }</span>
        else
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       dirp-&gt;dd_stat = 1;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     dirp-&gt;dd_stat = 1;</span>
<span class="udiff-line-modified-added">+   }</span>
      }
    else
      {
        /* Get the next search entry. */
        if (_tfindnext (dirp-&gt;dd_handle, &amp;(dirp-&gt;dd_dta)))
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       /* We are off the end or otherwise error.</span>
<span class="udiff-line-modified-removed">-          _findnext sets errno to ENOENT if no more file</span>
<span class="udiff-line-modified-removed">-          Undo this. */</span>
<span class="udiff-line-modified-removed">-       DWORD winerr = GetLastError();</span>
<span class="udiff-line-modified-removed">-       if (winerr == ERROR_NO_MORE_FILES)</span>
<span class="udiff-line-modified-removed">-         errno = 0;</span>
<span class="udiff-line-modified-removed">-       _findclose (dirp-&gt;dd_handle);</span>
<span class="udiff-line-modified-removed">-       dirp-&gt;dd_handle = -1;</span>
<span class="udiff-line-modified-removed">-       dirp-&gt;dd_stat = -1;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     /* We are off the end or otherwise error.</span>
<span class="udiff-line-modified-added">+        _findnext sets errno to ENOENT if no more file</span>
<span class="udiff-line-modified-added">+        Undo this. */</span>
<span class="udiff-line-modified-added">+     DWORD winerr = GetLastError();</span>
<span class="udiff-line-modified-added">+     if (winerr == ERROR_NO_MORE_FILES)</span>
<span class="udiff-line-modified-added">+       errno = 0;</span>
<span class="udiff-line-modified-added">+     _findclose (dirp-&gt;dd_handle);</span>
<span class="udiff-line-modified-added">+     dirp-&gt;dd_handle = -1;</span>
<span class="udiff-line-modified-added">+     dirp-&gt;dd_stat = -1;</span>
<span class="udiff-line-modified-added">+   }</span>
        else
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       /* Update the status to indicate the correct</span>
<span class="udiff-line-modified-removed">-        * number. */</span>
<span class="udiff-line-modified-removed">-       dirp-&gt;dd_stat++;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     /* Update the status to indicate the correct</span>
<span class="udiff-line-modified-added">+      * number. */</span>
<span class="udiff-line-modified-added">+     dirp-&gt;dd_stat++;</span>
<span class="udiff-line-modified-added">+   }</span>
      }
  
    if (dirp-&gt;dd_stat &gt; 0)
      {
        /* Successfully got an entry. Everything about the file is
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -322,20 +322,20 @@</span>
      }
    else if (lPos == -1)
      {
        /* Seek past end. */
        if (dirp-&gt;dd_handle != -1)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       _findclose (dirp-&gt;dd_handle);</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     _findclose (dirp-&gt;dd_handle);</span>
<span class="udiff-line-modified-added">+   }</span>
        dirp-&gt;dd_handle = -1;
        dirp-&gt;dd_stat = -1;
      }
    else
      {
        /* Rewind and read forward to the appropriate index. */
        _trewinddir (dirp);
  
        while ((dirp-&gt;dd_stat &lt; lPos) &amp;&amp; _treaddir (dirp))
<span class="udiff-line-modified-removed">-     ;</span>
<span class="udiff-line-modified-added">+   ;</span>
      }
  }
</pre>
<center><a href="../../osx/glibconfig.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="dirent.h.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>