<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gstreamer/gst/gststreams.c</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="gststreamcollection.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gststreams.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gstreamer/gst/gststreams.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 38  * Any element that can introduce new streams in a pipeline should create the
 39  * appropriate #GstStream object, and can convey that object via the
 40  * %GST_EVENT_STREAM_START event and/or the #GstStreamCollection.
 41  *
 42  * Elements that do not modify the nature of the stream can add extra information
 43  * on it (such as enrich the #GstCaps, or #GstTagList). This is typically done
 44  * by parsing elements.
 45  *
 46  * Since: 1.10
 47  */
 48 
 49 #include &quot;gst_private.h&quot;
 50 
 51 #include &quot;gstenumtypes.h&quot;
 52 #include &quot;gstevent.h&quot;
 53 #include &quot;gststreams.h&quot;
 54 
 55 GST_DEBUG_CATEGORY_STATIC (streams_debug);
 56 #define GST_CAT_DEFAULT streams_debug
 57 
<span class="line-removed"> 58 #define GST_STREAM_GET_PRIVATE(obj)  \</span>
<span class="line-removed"> 59    (G_TYPE_INSTANCE_GET_PRIVATE ((obj), GST_TYPE_STREAM, GstStreamPrivate))</span>
<span class="line-removed"> 60 </span>
 61 struct _GstStreamPrivate
 62 {
 63   GstStreamFlags flags;
 64   GstStreamType type;
 65   GstTagList *tags;
 66   GstCaps *caps;
 67 };
 68 
 69 /* stream signals and properties */
 70 enum
 71 {
 72   LAST_SIGNAL
 73 };
 74 
 75 enum
 76 {
 77   PROP_0,
 78   PROP_STREAM_ID,
 79   PROP_STREAM_FLAGS,
 80   PROP_STREAM_TYPE,
 81   PROP_TAGS,
 82   PROP_CAPS,
 83   PROP_LAST
 84 };
 85 
 86 static GParamSpec *gst_stream_pspecs[PROP_LAST] = { 0 };
 87 
 88 #if 0
 89 static guint gst_stream_signals[LAST_SIGNAL] = { 0 };
 90 #endif
 91 
 92 static void gst_stream_finalize (GObject * object);
 93 
 94 static void gst_stream_set_property (GObject * object, guint prop_id,
 95     const GValue * value, GParamSpec * pspec);
 96 static void gst_stream_get_property (GObject * object, guint prop_id,
 97     GValue * value, GParamSpec * pspec);
 98 
<span class="line-modified"> 99 #define _do_init                \</span>
100 { \
101   GST_DEBUG_CATEGORY_INIT (streams_debug, &quot;streams&quot;, GST_DEBUG_BOLD, \
102       &quot;debugging info for the stream and stream collection objects&quot;); \
103   \
104 }
105 
106 #define gst_stream_parent_class parent_class
<span class="line-modified">107 G_DEFINE_TYPE_WITH_CODE (GstStream, gst_stream, GST_TYPE_OBJECT, _do_init);</span>

108 
109 static void
110 gst_stream_class_init (GstStreamClass * klass)
111 {
112   GObjectClass *gobject_class;
113 
114   gobject_class = (GObjectClass *) klass;
115 
<span class="line-removed">116   g_type_class_add_private (klass, sizeof (GstStreamPrivate));</span>
<span class="line-removed">117 </span>
118   gobject_class-&gt;set_property = gst_stream_set_property;
119   gobject_class-&gt;get_property = gst_stream_get_property;
120 
121   /**
122    * GstStream:stream-id:
123    *
124    * The unique identifier of the #GstStream. Can only be set at construction
125    * time.
126    */
127   g_object_class_install_property (gobject_class, PROP_STREAM_ID,
128       g_param_spec_string (&quot;stream-id&quot;, &quot;Stream ID&quot;,
129           &quot;The stream ID of the stream&quot;,
130           NULL,
131           G_PARAM_READWRITE | G_PARAM_CONSTRUCT_ONLY | G_PARAM_STATIC_STRINGS));
132 
133   /**
134    * GstStream:flags:
135    *
136    * The #GstStreamFlags of the #GstStream. Can only be set at construction time.
137    **/
</pre>
<hr />
<pre>
167   g_object_class_install_property (gobject_class, PROP_CAPS,
168       gst_stream_pspecs[PROP_CAPS]);
169 
170   /**
171    * GstStream:tags:
172    *
173    * The #GstTagList of the #GstStream.
174    **/
175   gst_stream_pspecs[PROP_TAGS] =
176       g_param_spec_boxed (&quot;tags&quot;, &quot;Tags&quot;, &quot;The tags of the stream&quot;,
177       GST_TYPE_TAG_LIST, G_PARAM_READWRITE | G_PARAM_STATIC_STRINGS);
178   g_object_class_install_property (gobject_class, PROP_TAGS,
179       gst_stream_pspecs[PROP_TAGS]);
180 
181   gobject_class-&gt;finalize = gst_stream_finalize;
182 }
183 
184 static void
185 gst_stream_init (GstStream * stream)
186 {
<span class="line-modified">187   stream-&gt;priv = GST_STREAM_GET_PRIVATE (stream);</span>
188   stream-&gt;priv-&gt;type = GST_STREAM_TYPE_UNKNOWN;
189 }
190 
191 static void
192 gst_stream_finalize (GObject * object)
193 {
194   GstStream *stream = GST_STREAM_CAST (object);
195 
196   gst_mini_object_replace ((GstMiniObject **) &amp; stream-&gt;priv-&gt;tags,
197       (GstMiniObject *) NULL);
198   gst_caps_replace (&amp;stream-&gt;priv-&gt;caps, NULL);
199   g_free ((gchar *) stream-&gt;stream_id);
200 
201   G_OBJECT_CLASS (parent_class)-&gt;finalize (object);
202 }
203 
204 /**
205  * gst_stream_new:
206  * @stream_id: (allow-none): the id for the new stream. If %NULL,
207  * a new one will be automatically generated
</pre>
<hr />
<pre>
217  * Since: 1.10
218  */
219 GstStream *
220 gst_stream_new (const gchar * stream_id, GstCaps * caps, GstStreamType type,
221     GstStreamFlags flags)
222 {
223   GstStream *stream;
224 
225   stream = g_object_new (GST_TYPE_STREAM, &quot;stream-id&quot;, stream_id, &quot;caps&quot;, caps,
226       &quot;stream-type&quot;, type, &quot;stream-flags&quot;, flags, NULL);
227 
228   /* Clear floating flag */
229   gst_object_ref_sink (stream);
230 
231   return stream;
232 }
233 
234 static void
235 gst_stream_set_stream_id (GstStream * stream, const gchar * stream_id)
236 {


237   GST_OBJECT_LOCK (stream);
238   g_assert (stream-&gt;stream_id == NULL);
239   if (stream_id)
240     stream-&gt;stream_id = g_strdup (stream_id);
241   else {
<span class="line-modified">242     /* Create a randoom stream_id if NULL */</span>
243     GST_FIXME_OBJECT (stream, &quot;Creating random stream-id, consider &quot;
244         &quot;implementing a deterministic way of creating a stream-id&quot;);
245     stream-&gt;stream_id =
246         g_strdup_printf (&quot;%08x%08x%08x%08x&quot;, g_random_int (), g_random_int (),
247         g_random_int (), g_random_int ());
248   }
249 
250   GST_OBJECT_UNLOCK (stream);
251 }
252 
253 /**
254  * gst_stream_get_stream_id:
255  * @stream: a #GstStream
256  *
257  * Returns the stream ID of @stream.
258  *
259  * Returns: (transfer none) (nullable): the stream ID of @stream. Only valid
260  * during the lifetime of @stream.
261  *
262  * Since: 1.10
263  */
264 const gchar *
265 gst_stream_get_stream_id (GstStream * stream)
266 {


267   return stream-&gt;stream_id;
268 }
269 
270 /**
271  * gst_stream_set_stream_flags:
272  * @stream: a #GstStream
273  * @flags: the flags to set on @stream
274  *
275  * Set the @flags for the @stream.
276  *
277  * Since: 1.10
278  */
279 void
280 gst_stream_set_stream_flags (GstStream * stream, GstStreamFlags flags)
281 {


282   GST_OBJECT_LOCK (stream);
283   stream-&gt;priv-&gt;flags = flags;
284   GST_OBJECT_UNLOCK (stream);
285 
286   g_object_notify_by_pspec (G_OBJECT (stream),
287       gst_stream_pspecs[PROP_STREAM_FLAGS]);
288 }
289 
290 /**
291  * gst_stream_get_stream_flags:
292  * @stream: a #GstStream
293  *
294  * Retrieve the current stream flags for @stream
295  *
296  * Returns: The #GstStreamFlags for @stream
297  *
298  * Since: 1.10
299  */
300 GstStreamFlags
301 gst_stream_get_stream_flags (GstStream * stream)
302 {
303   GstStreamFlags res;
304 


305   GST_OBJECT_LOCK (stream);
306   res = stream-&gt;priv-&gt;flags;
307   GST_OBJECT_UNLOCK (stream);
308 
309   return res;
310 }
311 
312 /**
313  * gst_stream_set_stream_type:
314  * @stream: a #GstStream
315  * @stream_type: the type to set on @stream
316  *
317  * Set the stream type of @stream
318  *
319  * Since: 1.10
320  */
321 void
322 gst_stream_set_stream_type (GstStream * stream, GstStreamType stream_type)
323 {


324   GST_OBJECT_LOCK (stream);
325   stream-&gt;priv-&gt;type = stream_type;
326   GST_OBJECT_UNLOCK (stream);
327 
328   g_object_notify_by_pspec (G_OBJECT (stream),
329       gst_stream_pspecs[PROP_STREAM_TYPE]);
330 }
331 
332 /**
333  * gst_stream_get_stream_type:
334  * @stream: a #GstStream
335  *
336  * Retrieve the stream type for @stream
337  *
338  * Returns: The #GstStreamType for @stream
339  *
340  * Since: 1.10
341  */
342 GstStreamType
343 gst_stream_get_stream_type (GstStream * stream)
344 {
345   GstStreamType res;
346 


347   GST_OBJECT_LOCK (stream);
348   res = stream-&gt;priv-&gt;type;
349   GST_OBJECT_UNLOCK (stream);
350 
351   return res;
352 }
353 
354 /**
355  * gst_stream_set_tags:
356  * @stream: a #GstStream
357  * @tags: (transfer none) (allow-none): a #GstTagList
358  *
359  * Set the tags for the #GstStream
360  *
361  * Since: 1.10
362  */
363 void
364 gst_stream_set_tags (GstStream * stream, GstTagList * tags)
365 {
366   gboolean notify = FALSE;
367 


368   GST_OBJECT_LOCK (stream);
369   if (stream-&gt;priv-&gt;tags == NULL || tags == NULL
370       || !gst_tag_list_is_equal (stream-&gt;priv-&gt;tags, tags)) {
371     gst_mini_object_replace ((GstMiniObject **) &amp; stream-&gt;priv-&gt;tags,
372         (GstMiniObject *) tags);
373     notify = TRUE;
374   }
375   GST_OBJECT_UNLOCK (stream);
376 
377   if (notify)
378     g_object_notify_by_pspec (G_OBJECT (stream), gst_stream_pspecs[PROP_TAGS]);
379 }
380 
381 /**
382  * gst_stream_get_tags:
383  * @stream: a #GstStream
384  *
385  * Retrieve the tags for @stream, if any
386  *
387  * Returns: (transfer full) (nullable): The #GstTagList for @stream
388  *
389  * Since: 1.10
390  */
391 GstTagList *
392 gst_stream_get_tags (GstStream * stream)
393 {
394   GstTagList *res = NULL;
395 


396   GST_OBJECT_LOCK (stream);
397   if (stream-&gt;priv-&gt;tags)
398     res = gst_tag_list_ref (stream-&gt;priv-&gt;tags);
399   GST_OBJECT_UNLOCK (stream);
400 
401   return res;
402 }
403 
404 /**
405  * gst_stream_set_caps:
406  * @stream: a #GstStream
407  * @caps: (transfer none) (allow-none): a #GstCaps
408  *
409  * Set the caps for the #GstStream
410  *
411  * Since: 1.10
412  */
413 void
414 gst_stream_set_caps (GstStream * stream, GstCaps * caps)
415 {
416   gboolean notify = FALSE;
417 


418   GST_OBJECT_LOCK (stream);
419   if (stream-&gt;priv-&gt;caps == NULL || (caps
420           &amp;&amp; !gst_caps_is_equal (stream-&gt;priv-&gt;caps, caps))) {
421     gst_caps_replace (&amp;stream-&gt;priv-&gt;caps, caps);
422     notify = TRUE;
423   }
424   GST_OBJECT_UNLOCK (stream);
425 
426   if (notify)
427     g_object_notify_by_pspec (G_OBJECT (stream), gst_stream_pspecs[PROP_CAPS]);
428 }
429 
430 
431 /**
432  * gst_stream_get_caps:
433  * @stream: a #GstStream
434  *
435  * Retrieve the caps for @stream, if any
436  *
437  * Returns: (transfer full) (nullable): The #GstCaps for @stream
438  *
439  * Since: 1.10
440  */
441 GstCaps *
442 gst_stream_get_caps (GstStream * stream)
443 {
444   GstCaps *res = NULL;
445 


446   GST_OBJECT_LOCK (stream);
447   if (stream-&gt;priv-&gt;caps)
448     res = gst_caps_ref (stream-&gt;priv-&gt;caps);
449   GST_OBJECT_UNLOCK (stream);
450 
451   return res;
452 }
453 
454 static void
455 gst_stream_set_property (GObject * object, guint prop_id,
456     const GValue * value, GParamSpec * pspec)
457 {
458   GstStream *stream;
459 
460   stream = GST_STREAM_CAST (object);
461 
462   switch (prop_id) {
463     case PROP_STREAM_ID:
464       gst_stream_set_stream_id (stream, g_value_get_string (value));
465       break;
</pre>
</td>
<td>
<hr />
<pre>
 38  * Any element that can introduce new streams in a pipeline should create the
 39  * appropriate #GstStream object, and can convey that object via the
 40  * %GST_EVENT_STREAM_START event and/or the #GstStreamCollection.
 41  *
 42  * Elements that do not modify the nature of the stream can add extra information
 43  * on it (such as enrich the #GstCaps, or #GstTagList). This is typically done
 44  * by parsing elements.
 45  *
 46  * Since: 1.10
 47  */
 48 
 49 #include &quot;gst_private.h&quot;
 50 
 51 #include &quot;gstenumtypes.h&quot;
 52 #include &quot;gstevent.h&quot;
 53 #include &quot;gststreams.h&quot;
 54 
 55 GST_DEBUG_CATEGORY_STATIC (streams_debug);
 56 #define GST_CAT_DEFAULT streams_debug
 57 



 58 struct _GstStreamPrivate
 59 {
 60   GstStreamFlags flags;
 61   GstStreamType type;
 62   GstTagList *tags;
 63   GstCaps *caps;
 64 };
 65 
 66 /* stream signals and properties */
 67 enum
 68 {
 69   LAST_SIGNAL
 70 };
 71 
 72 enum
 73 {
 74   PROP_0,
 75   PROP_STREAM_ID,
 76   PROP_STREAM_FLAGS,
 77   PROP_STREAM_TYPE,
 78   PROP_TAGS,
 79   PROP_CAPS,
 80   PROP_LAST
 81 };
 82 
 83 static GParamSpec *gst_stream_pspecs[PROP_LAST] = { 0 };
 84 
 85 #if 0
 86 static guint gst_stream_signals[LAST_SIGNAL] = { 0 };
 87 #endif
 88 
 89 static void gst_stream_finalize (GObject * object);
 90 
 91 static void gst_stream_set_property (GObject * object, guint prop_id,
 92     const GValue * value, GParamSpec * pspec);
 93 static void gst_stream_get_property (GObject * object, guint prop_id,
 94     GValue * value, GParamSpec * pspec);
 95 
<span class="line-modified"> 96 #define _do_init        \</span>
 97 { \
 98   GST_DEBUG_CATEGORY_INIT (streams_debug, &quot;streams&quot;, GST_DEBUG_BOLD, \
 99       &quot;debugging info for the stream and stream collection objects&quot;); \
100   \
101 }
102 
103 #define gst_stream_parent_class parent_class
<span class="line-modified">104 G_DEFINE_TYPE_WITH_CODE (GstStream, gst_stream, GST_TYPE_OBJECT,</span>
<span class="line-added">105     G_ADD_PRIVATE (GstStream) _do_init);</span>
106 
107 static void
108 gst_stream_class_init (GstStreamClass * klass)
109 {
110   GObjectClass *gobject_class;
111 
112   gobject_class = (GObjectClass *) klass;
113 


114   gobject_class-&gt;set_property = gst_stream_set_property;
115   gobject_class-&gt;get_property = gst_stream_get_property;
116 
117   /**
118    * GstStream:stream-id:
119    *
120    * The unique identifier of the #GstStream. Can only be set at construction
121    * time.
122    */
123   g_object_class_install_property (gobject_class, PROP_STREAM_ID,
124       g_param_spec_string (&quot;stream-id&quot;, &quot;Stream ID&quot;,
125           &quot;The stream ID of the stream&quot;,
126           NULL,
127           G_PARAM_READWRITE | G_PARAM_CONSTRUCT_ONLY | G_PARAM_STATIC_STRINGS));
128 
129   /**
130    * GstStream:flags:
131    *
132    * The #GstStreamFlags of the #GstStream. Can only be set at construction time.
133    **/
</pre>
<hr />
<pre>
163   g_object_class_install_property (gobject_class, PROP_CAPS,
164       gst_stream_pspecs[PROP_CAPS]);
165 
166   /**
167    * GstStream:tags:
168    *
169    * The #GstTagList of the #GstStream.
170    **/
171   gst_stream_pspecs[PROP_TAGS] =
172       g_param_spec_boxed (&quot;tags&quot;, &quot;Tags&quot;, &quot;The tags of the stream&quot;,
173       GST_TYPE_TAG_LIST, G_PARAM_READWRITE | G_PARAM_STATIC_STRINGS);
174   g_object_class_install_property (gobject_class, PROP_TAGS,
175       gst_stream_pspecs[PROP_TAGS]);
176 
177   gobject_class-&gt;finalize = gst_stream_finalize;
178 }
179 
180 static void
181 gst_stream_init (GstStream * stream)
182 {
<span class="line-modified">183   stream-&gt;priv = gst_stream_get_instance_private (stream);</span>
184   stream-&gt;priv-&gt;type = GST_STREAM_TYPE_UNKNOWN;
185 }
186 
187 static void
188 gst_stream_finalize (GObject * object)
189 {
190   GstStream *stream = GST_STREAM_CAST (object);
191 
192   gst_mini_object_replace ((GstMiniObject **) &amp; stream-&gt;priv-&gt;tags,
193       (GstMiniObject *) NULL);
194   gst_caps_replace (&amp;stream-&gt;priv-&gt;caps, NULL);
195   g_free ((gchar *) stream-&gt;stream_id);
196 
197   G_OBJECT_CLASS (parent_class)-&gt;finalize (object);
198 }
199 
200 /**
201  * gst_stream_new:
202  * @stream_id: (allow-none): the id for the new stream. If %NULL,
203  * a new one will be automatically generated
</pre>
<hr />
<pre>
213  * Since: 1.10
214  */
215 GstStream *
216 gst_stream_new (const gchar * stream_id, GstCaps * caps, GstStreamType type,
217     GstStreamFlags flags)
218 {
219   GstStream *stream;
220 
221   stream = g_object_new (GST_TYPE_STREAM, &quot;stream-id&quot;, stream_id, &quot;caps&quot;, caps,
222       &quot;stream-type&quot;, type, &quot;stream-flags&quot;, flags, NULL);
223 
224   /* Clear floating flag */
225   gst_object_ref_sink (stream);
226 
227   return stream;
228 }
229 
230 static void
231 gst_stream_set_stream_id (GstStream * stream, const gchar * stream_id)
232 {
<span class="line-added">233   g_return_if_fail (GST_IS_STREAM (stream));</span>
<span class="line-added">234 </span>
235   GST_OBJECT_LOCK (stream);
236   g_assert (stream-&gt;stream_id == NULL);
237   if (stream_id)
238     stream-&gt;stream_id = g_strdup (stream_id);
239   else {
<span class="line-modified">240     /* Create a random stream_id if NULL */</span>
241     GST_FIXME_OBJECT (stream, &quot;Creating random stream-id, consider &quot;
242         &quot;implementing a deterministic way of creating a stream-id&quot;);
243     stream-&gt;stream_id =
244         g_strdup_printf (&quot;%08x%08x%08x%08x&quot;, g_random_int (), g_random_int (),
245         g_random_int (), g_random_int ());
246   }
247 
248   GST_OBJECT_UNLOCK (stream);
249 }
250 
251 /**
252  * gst_stream_get_stream_id:
253  * @stream: a #GstStream
254  *
255  * Returns the stream ID of @stream.
256  *
257  * Returns: (transfer none) (nullable): the stream ID of @stream. Only valid
258  * during the lifetime of @stream.
259  *
260  * Since: 1.10
261  */
262 const gchar *
263 gst_stream_get_stream_id (GstStream * stream)
264 {
<span class="line-added">265   g_return_val_if_fail (GST_IS_STREAM (stream), NULL);</span>
<span class="line-added">266 </span>
267   return stream-&gt;stream_id;
268 }
269 
270 /**
271  * gst_stream_set_stream_flags:
272  * @stream: a #GstStream
273  * @flags: the flags to set on @stream
274  *
275  * Set the @flags for the @stream.
276  *
277  * Since: 1.10
278  */
279 void
280 gst_stream_set_stream_flags (GstStream * stream, GstStreamFlags flags)
281 {
<span class="line-added">282   g_return_if_fail (GST_IS_STREAM (stream));</span>
<span class="line-added">283 </span>
284   GST_OBJECT_LOCK (stream);
285   stream-&gt;priv-&gt;flags = flags;
286   GST_OBJECT_UNLOCK (stream);
287 
288   g_object_notify_by_pspec (G_OBJECT (stream),
289       gst_stream_pspecs[PROP_STREAM_FLAGS]);
290 }
291 
292 /**
293  * gst_stream_get_stream_flags:
294  * @stream: a #GstStream
295  *
296  * Retrieve the current stream flags for @stream
297  *
298  * Returns: The #GstStreamFlags for @stream
299  *
300  * Since: 1.10
301  */
302 GstStreamFlags
303 gst_stream_get_stream_flags (GstStream * stream)
304 {
305   GstStreamFlags res;
306 
<span class="line-added">307   g_return_val_if_fail (GST_IS_STREAM (stream), GST_STREAM_FLAG_NONE);</span>
<span class="line-added">308 </span>
309   GST_OBJECT_LOCK (stream);
310   res = stream-&gt;priv-&gt;flags;
311   GST_OBJECT_UNLOCK (stream);
312 
313   return res;
314 }
315 
316 /**
317  * gst_stream_set_stream_type:
318  * @stream: a #GstStream
319  * @stream_type: the type to set on @stream
320  *
321  * Set the stream type of @stream
322  *
323  * Since: 1.10
324  */
325 void
326 gst_stream_set_stream_type (GstStream * stream, GstStreamType stream_type)
327 {
<span class="line-added">328   g_return_if_fail (GST_IS_STREAM (stream));</span>
<span class="line-added">329 </span>
330   GST_OBJECT_LOCK (stream);
331   stream-&gt;priv-&gt;type = stream_type;
332   GST_OBJECT_UNLOCK (stream);
333 
334   g_object_notify_by_pspec (G_OBJECT (stream),
335       gst_stream_pspecs[PROP_STREAM_TYPE]);
336 }
337 
338 /**
339  * gst_stream_get_stream_type:
340  * @stream: a #GstStream
341  *
342  * Retrieve the stream type for @stream
343  *
344  * Returns: The #GstStreamType for @stream
345  *
346  * Since: 1.10
347  */
348 GstStreamType
349 gst_stream_get_stream_type (GstStream * stream)
350 {
351   GstStreamType res;
352 
<span class="line-added">353   g_return_val_if_fail (GST_IS_STREAM (stream), GST_STREAM_TYPE_UNKNOWN);</span>
<span class="line-added">354 </span>
355   GST_OBJECT_LOCK (stream);
356   res = stream-&gt;priv-&gt;type;
357   GST_OBJECT_UNLOCK (stream);
358 
359   return res;
360 }
361 
362 /**
363  * gst_stream_set_tags:
364  * @stream: a #GstStream
365  * @tags: (transfer none) (allow-none): a #GstTagList
366  *
367  * Set the tags for the #GstStream
368  *
369  * Since: 1.10
370  */
371 void
372 gst_stream_set_tags (GstStream * stream, GstTagList * tags)
373 {
374   gboolean notify = FALSE;
375 
<span class="line-added">376   g_return_if_fail (GST_IS_STREAM (stream));</span>
<span class="line-added">377 </span>
378   GST_OBJECT_LOCK (stream);
379   if (stream-&gt;priv-&gt;tags == NULL || tags == NULL
380       || !gst_tag_list_is_equal (stream-&gt;priv-&gt;tags, tags)) {
381     gst_mini_object_replace ((GstMiniObject **) &amp; stream-&gt;priv-&gt;tags,
382         (GstMiniObject *) tags);
383     notify = TRUE;
384   }
385   GST_OBJECT_UNLOCK (stream);
386 
387   if (notify)
388     g_object_notify_by_pspec (G_OBJECT (stream), gst_stream_pspecs[PROP_TAGS]);
389 }
390 
391 /**
392  * gst_stream_get_tags:
393  * @stream: a #GstStream
394  *
395  * Retrieve the tags for @stream, if any
396  *
397  * Returns: (transfer full) (nullable): The #GstTagList for @stream
398  *
399  * Since: 1.10
400  */
401 GstTagList *
402 gst_stream_get_tags (GstStream * stream)
403 {
404   GstTagList *res = NULL;
405 
<span class="line-added">406   g_return_val_if_fail (GST_IS_STREAM (stream), NULL);</span>
<span class="line-added">407 </span>
408   GST_OBJECT_LOCK (stream);
409   if (stream-&gt;priv-&gt;tags)
410     res = gst_tag_list_ref (stream-&gt;priv-&gt;tags);
411   GST_OBJECT_UNLOCK (stream);
412 
413   return res;
414 }
415 
416 /**
417  * gst_stream_set_caps:
418  * @stream: a #GstStream
419  * @caps: (transfer none) (allow-none): a #GstCaps
420  *
421  * Set the caps for the #GstStream
422  *
423  * Since: 1.10
424  */
425 void
426 gst_stream_set_caps (GstStream * stream, GstCaps * caps)
427 {
428   gboolean notify = FALSE;
429 
<span class="line-added">430   g_return_if_fail (GST_IS_STREAM (stream));</span>
<span class="line-added">431 </span>
432   GST_OBJECT_LOCK (stream);
433   if (stream-&gt;priv-&gt;caps == NULL || (caps
434           &amp;&amp; !gst_caps_is_equal (stream-&gt;priv-&gt;caps, caps))) {
435     gst_caps_replace (&amp;stream-&gt;priv-&gt;caps, caps);
436     notify = TRUE;
437   }
438   GST_OBJECT_UNLOCK (stream);
439 
440   if (notify)
441     g_object_notify_by_pspec (G_OBJECT (stream), gst_stream_pspecs[PROP_CAPS]);
442 }
443 
444 
445 /**
446  * gst_stream_get_caps:
447  * @stream: a #GstStream
448  *
449  * Retrieve the caps for @stream, if any
450  *
451  * Returns: (transfer full) (nullable): The #GstCaps for @stream
452  *
453  * Since: 1.10
454  */
455 GstCaps *
456 gst_stream_get_caps (GstStream * stream)
457 {
458   GstCaps *res = NULL;
459 
<span class="line-added">460   g_return_val_if_fail (GST_IS_STREAM (stream), NULL);</span>
<span class="line-added">461 </span>
462   GST_OBJECT_LOCK (stream);
463   if (stream-&gt;priv-&gt;caps)
464     res = gst_caps_ref (stream-&gt;priv-&gt;caps);
465   GST_OBJECT_UNLOCK (stream);
466 
467   return res;
468 }
469 
470 static void
471 gst_stream_set_property (GObject * object, guint prop_id,
472     const GValue * value, GParamSpec * pspec)
473 {
474   GstStream *stream;
475 
476   stream = GST_STREAM_CAST (object);
477 
478   switch (prop_id) {
479     case PROP_STREAM_ID:
480       gst_stream_set_stream_id (stream, g_value_get_string (value));
481       break;
</pre>
</td>
</tr>
</table>
<center><a href="gststreamcollection.c.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gststreams.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>