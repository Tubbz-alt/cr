<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gst-plugins-base/gst-libs/gst/audio/audio-format.c</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="audio-converter.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="audio-format.h.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gst-plugins-base/gst-libs/gst/audio/audio-format.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 99 # define audio_orc_pack_s16be audio_orc_pack_s16
100 # define audio_orc_pack_u16le audio_orc_pack_u16_swap
101 # define audio_orc_pack_u16be audio_orc_pack_u16
102 # define audio_orc_pack_s24_32le audio_orc_pack_s24_32_swap
103 # define audio_orc_pack_s24_32be audio_orc_pack_s24_32
104 # define audio_orc_pack_u24_32le audio_orc_pack_u24_32_swap
105 # define audio_orc_pack_u24_32be audio_orc_pack_u24_32
106 # define audio_orc_pack_s32le audio_orc_pack_s32_swap
107 # define audio_orc_pack_s32be audio_orc_pack_s32
108 # define audio_orc_pack_u32le audio_orc_pack_u32_swap
109 # define audio_orc_pack_u32be audio_orc_pack_u32
110 # define audio_orc_pack_f32le audio_orc_pack_f32_swap
111 # define audio_orc_pack_f32be audio_orc_pack_f32
112 # define audio_orc_pack_f64le audio_orc_pack_f64_swap
113 # define audio_orc_pack_f64be audio_orc_pack_f64
114 #endif
115 
116 #define MAKE_ORC_PACK_UNPACK(fmt,fmt_t)                         \
117 static void unpack_ ##fmt (const GstAudioFormatInfo *info,      \
118     GstAudioPackFlags flags, gpointer dest,                     \
<span class="line-modified">119     const gpointer data, gint length) {                         \</span>
120   if (flags &amp; GST_AUDIO_PACK_FLAG_TRUNCATE_RANGE)               \
121     audio_orc_unpack_ ##fmt_t (dest, data, length);             \
122   else                                                          \
123     audio_orc_unpack_ ##fmt (dest, data, length);               \
124 }                                                               \
125 static void pack_ ##fmt (const GstAudioFormatInfo *info,        \
<span class="line-modified">126     GstAudioPackFlags flags, const gpointer src,                \</span>
127     gpointer data, gint length) {                               \
128   audio_orc_pack_ ##fmt (data, src, length);                    \
129 }
130 
131 #define PACK_S8 GST_AUDIO_FORMAT_S32, unpack_s8, pack_s8
132 MAKE_ORC_PACK_UNPACK (s8, s8_trunc)
133 #define PACK_U8 GST_AUDIO_FORMAT_S32, unpack_u8, pack_u8
134     MAKE_ORC_PACK_UNPACK (u8, u8_trunc)
135 #define PACK_S16LE GST_AUDIO_FORMAT_S32, unpack_s16le, pack_s16le
136     MAKE_ORC_PACK_UNPACK (s16le, s16le_trunc)
137 #define PACK_S16BE GST_AUDIO_FORMAT_S32, unpack_s16be, pack_s16be
138     MAKE_ORC_PACK_UNPACK (s16be, s16be_trunc)
139 #define PACK_U16LE GST_AUDIO_FORMAT_S32, unpack_u16le, pack_u16le
140     MAKE_ORC_PACK_UNPACK (u16le, u16le_trunc)
141 #define PACK_U16BE GST_AUDIO_FORMAT_S32, unpack_u16be, pack_u16be
142     MAKE_ORC_PACK_UNPACK (u16be, u16be_trunc)
143 #define PACK_S24_32LE GST_AUDIO_FORMAT_S32, unpack_s24_32le, pack_s24_32le
144     MAKE_ORC_PACK_UNPACK (s24_32le, s24_32le)
145 #define PACK_S24_32BE GST_AUDIO_FORMAT_S32, unpack_s24_32be, pack_s24_32be
146     MAKE_ORC_PACK_UNPACK (s24_32be, s24_32be)
</pre>
<hr />
<pre>
148     MAKE_ORC_PACK_UNPACK (u24_32le, u24_32le)
149 #define PACK_U24_32BE GST_AUDIO_FORMAT_S32, unpack_u24_32be, pack_u24_32be
150     MAKE_ORC_PACK_UNPACK (u24_32be, u24_32be)
151 #define PACK_S32LE GST_AUDIO_FORMAT_S32, unpack_s32le, pack_s32le
152     MAKE_ORC_PACK_UNPACK (s32le, s32le)
153 #define PACK_S32BE GST_AUDIO_FORMAT_S32, unpack_s32be, pack_s32be
154     MAKE_ORC_PACK_UNPACK (s32be, s32be)
155 #define PACK_U32LE GST_AUDIO_FORMAT_S32, unpack_u32le, pack_u32le
156     MAKE_ORC_PACK_UNPACK (u32le, u32le)
157 #define PACK_U32BE GST_AUDIO_FORMAT_S32, unpack_u32be, pack_u32be
158     MAKE_ORC_PACK_UNPACK (u32be, u32be)
159 #define SIGNED  (1U&lt;&lt;31)
160 /* pack from signed integer 32 to integer */
161 #define WRITE24_TO_LE(p,v) p[0] = v &amp; 0xff; p[1] = (v &gt;&gt; 8) &amp; 0xff; p[2] = (v &gt;&gt; 16) &amp; 0xff
162 #define WRITE24_TO_BE(p,v) p[2] = v &amp; 0xff; p[1] = (v &gt;&gt; 8) &amp; 0xff; p[0] = (v &gt;&gt; 16) &amp; 0xff
163 #define READ24_FROM_LE(p) (p[0] | (p[1] &lt;&lt; 8) | (p[2] &lt;&lt; 16))
164 #define READ24_FROM_BE(p) (p[2] | (p[1] &lt;&lt; 8) | (p[0] &lt;&lt; 16))
165 #define MAKE_PACK_UNPACK(name, stride, sign, scale, READ_FUNC, WRITE_FUNC)     \
166 static void unpack_ ##name (const GstAudioFormatInfo *info,             \
167     GstAudioPackFlags flags, gpointer dest,                             \
<span class="line-modified">168     const gpointer data, gint length)                                   \</span>
169 {                                                                       \
170   guint32 *d = dest;                                                    \
<span class="line-modified">171   guint8 *s = data;                                                     \</span>
172   for (;length; length--) {                                             \
173     *d++ = (((gint32) READ_FUNC (s)) &lt;&lt; scale) ^ (sign);                \
174     s += stride;                                                        \
175   }                                                                     \
176 }                                                                       \
177 static void pack_ ##name (const GstAudioFormatInfo *info,               \
<span class="line-modified">178     GstAudioPackFlags flags, const gpointer src,                        \</span>
179     gpointer data, gint length)                                         \
180 {                                                                       \
181   gint32 tmp;                                                           \
<span class="line-modified">182   guint32 *s = src;                                                     \</span>
183   guint8 *d = data;                                                     \
184   for (;length; length--) {                                             \
185     tmp = (*s++ ^ (sign)) &gt;&gt; scale;                                     \
186     WRITE_FUNC (d, tmp);                                                \
187     d += stride;                                                        \
188   }                                                                     \
189 }
190 #define PACK_S24LE GST_AUDIO_FORMAT_S32, unpack_s24le, pack_s24le
191     MAKE_PACK_UNPACK (s24le, 3, 0, 8, READ24_FROM_LE, WRITE24_TO_LE)
192 #define PACK_U24LE GST_AUDIO_FORMAT_S32, unpack_u24le, pack_u24le
193     MAKE_PACK_UNPACK (u24le, 3, SIGNED, 8, READ24_FROM_LE, WRITE24_TO_LE)
194 #define PACK_S24BE GST_AUDIO_FORMAT_S32, unpack_s24be, pack_s24be
195     MAKE_PACK_UNPACK (s24be, 3, 0, 8, READ24_FROM_BE, WRITE24_TO_BE)
196 #define PACK_U24BE GST_AUDIO_FORMAT_S32, unpack_u24be, pack_u24be
197     MAKE_PACK_UNPACK (u24be, 3, SIGNED, 8, READ24_FROM_BE, WRITE24_TO_BE)
198 #define PACK_S20LE GST_AUDIO_FORMAT_S32, unpack_s20le, pack_s20le
199     MAKE_PACK_UNPACK (s20le, 3, 0, 12, READ24_FROM_LE, WRITE24_TO_LE)
200 #define PACK_U20LE GST_AUDIO_FORMAT_S32, unpack_u20le, pack_u20le
201     MAKE_PACK_UNPACK (u20le, 3, SIGNED, 12, READ24_FROM_LE, WRITE24_TO_LE)
202 #define PACK_S20BE GST_AUDIO_FORMAT_S32, unpack_s20be, pack_s20be
</pre>
</td>
<td>
<hr />
<pre>
 99 # define audio_orc_pack_s16be audio_orc_pack_s16
100 # define audio_orc_pack_u16le audio_orc_pack_u16_swap
101 # define audio_orc_pack_u16be audio_orc_pack_u16
102 # define audio_orc_pack_s24_32le audio_orc_pack_s24_32_swap
103 # define audio_orc_pack_s24_32be audio_orc_pack_s24_32
104 # define audio_orc_pack_u24_32le audio_orc_pack_u24_32_swap
105 # define audio_orc_pack_u24_32be audio_orc_pack_u24_32
106 # define audio_orc_pack_s32le audio_orc_pack_s32_swap
107 # define audio_orc_pack_s32be audio_orc_pack_s32
108 # define audio_orc_pack_u32le audio_orc_pack_u32_swap
109 # define audio_orc_pack_u32be audio_orc_pack_u32
110 # define audio_orc_pack_f32le audio_orc_pack_f32_swap
111 # define audio_orc_pack_f32be audio_orc_pack_f32
112 # define audio_orc_pack_f64le audio_orc_pack_f64_swap
113 # define audio_orc_pack_f64be audio_orc_pack_f64
114 #endif
115 
116 #define MAKE_ORC_PACK_UNPACK(fmt,fmt_t)                         \
117 static void unpack_ ##fmt (const GstAudioFormatInfo *info,      \
118     GstAudioPackFlags flags, gpointer dest,                     \
<span class="line-modified">119     gconstpointer data, gint length) {                          \</span>
120   if (flags &amp; GST_AUDIO_PACK_FLAG_TRUNCATE_RANGE)               \
121     audio_orc_unpack_ ##fmt_t (dest, data, length);             \
122   else                                                          \
123     audio_orc_unpack_ ##fmt (dest, data, length);               \
124 }                                                               \
125 static void pack_ ##fmt (const GstAudioFormatInfo *info,        \
<span class="line-modified">126     GstAudioPackFlags flags, gconstpointer src,                 \</span>
127     gpointer data, gint length) {                               \
128   audio_orc_pack_ ##fmt (data, src, length);                    \
129 }
130 
131 #define PACK_S8 GST_AUDIO_FORMAT_S32, unpack_s8, pack_s8
132 MAKE_ORC_PACK_UNPACK (s8, s8_trunc)
133 #define PACK_U8 GST_AUDIO_FORMAT_S32, unpack_u8, pack_u8
134     MAKE_ORC_PACK_UNPACK (u8, u8_trunc)
135 #define PACK_S16LE GST_AUDIO_FORMAT_S32, unpack_s16le, pack_s16le
136     MAKE_ORC_PACK_UNPACK (s16le, s16le_trunc)
137 #define PACK_S16BE GST_AUDIO_FORMAT_S32, unpack_s16be, pack_s16be
138     MAKE_ORC_PACK_UNPACK (s16be, s16be_trunc)
139 #define PACK_U16LE GST_AUDIO_FORMAT_S32, unpack_u16le, pack_u16le
140     MAKE_ORC_PACK_UNPACK (u16le, u16le_trunc)
141 #define PACK_U16BE GST_AUDIO_FORMAT_S32, unpack_u16be, pack_u16be
142     MAKE_ORC_PACK_UNPACK (u16be, u16be_trunc)
143 #define PACK_S24_32LE GST_AUDIO_FORMAT_S32, unpack_s24_32le, pack_s24_32le
144     MAKE_ORC_PACK_UNPACK (s24_32le, s24_32le)
145 #define PACK_S24_32BE GST_AUDIO_FORMAT_S32, unpack_s24_32be, pack_s24_32be
146     MAKE_ORC_PACK_UNPACK (s24_32be, s24_32be)
</pre>
<hr />
<pre>
148     MAKE_ORC_PACK_UNPACK (u24_32le, u24_32le)
149 #define PACK_U24_32BE GST_AUDIO_FORMAT_S32, unpack_u24_32be, pack_u24_32be
150     MAKE_ORC_PACK_UNPACK (u24_32be, u24_32be)
151 #define PACK_S32LE GST_AUDIO_FORMAT_S32, unpack_s32le, pack_s32le
152     MAKE_ORC_PACK_UNPACK (s32le, s32le)
153 #define PACK_S32BE GST_AUDIO_FORMAT_S32, unpack_s32be, pack_s32be
154     MAKE_ORC_PACK_UNPACK (s32be, s32be)
155 #define PACK_U32LE GST_AUDIO_FORMAT_S32, unpack_u32le, pack_u32le
156     MAKE_ORC_PACK_UNPACK (u32le, u32le)
157 #define PACK_U32BE GST_AUDIO_FORMAT_S32, unpack_u32be, pack_u32be
158     MAKE_ORC_PACK_UNPACK (u32be, u32be)
159 #define SIGNED  (1U&lt;&lt;31)
160 /* pack from signed integer 32 to integer */
161 #define WRITE24_TO_LE(p,v) p[0] = v &amp; 0xff; p[1] = (v &gt;&gt; 8) &amp; 0xff; p[2] = (v &gt;&gt; 16) &amp; 0xff
162 #define WRITE24_TO_BE(p,v) p[2] = v &amp; 0xff; p[1] = (v &gt;&gt; 8) &amp; 0xff; p[0] = (v &gt;&gt; 16) &amp; 0xff
163 #define READ24_FROM_LE(p) (p[0] | (p[1] &lt;&lt; 8) | (p[2] &lt;&lt; 16))
164 #define READ24_FROM_BE(p) (p[2] | (p[1] &lt;&lt; 8) | (p[0] &lt;&lt; 16))
165 #define MAKE_PACK_UNPACK(name, stride, sign, scale, READ_FUNC, WRITE_FUNC)     \
166 static void unpack_ ##name (const GstAudioFormatInfo *info,             \
167     GstAudioPackFlags flags, gpointer dest,                             \
<span class="line-modified">168     gconstpointer data, gint length)                                    \</span>
169 {                                                                       \
170   guint32 *d = dest;                                                    \
<span class="line-modified">171   const guint8 *s = data;                                               \</span>
172   for (;length; length--) {                                             \
173     *d++ = (((gint32) READ_FUNC (s)) &lt;&lt; scale) ^ (sign);                \
174     s += stride;                                                        \
175   }                                                                     \
176 }                                                                       \
177 static void pack_ ##name (const GstAudioFormatInfo *info,               \
<span class="line-modified">178     GstAudioPackFlags flags, gconstpointer src,                         \</span>
179     gpointer data, gint length)                                         \
180 {                                                                       \
181   gint32 tmp;                                                           \
<span class="line-modified">182   const guint32 *s = src;                                               \</span>
183   guint8 *d = data;                                                     \
184   for (;length; length--) {                                             \
185     tmp = (*s++ ^ (sign)) &gt;&gt; scale;                                     \
186     WRITE_FUNC (d, tmp);                                                \
187     d += stride;                                                        \
188   }                                                                     \
189 }
190 #define PACK_S24LE GST_AUDIO_FORMAT_S32, unpack_s24le, pack_s24le
191     MAKE_PACK_UNPACK (s24le, 3, 0, 8, READ24_FROM_LE, WRITE24_TO_LE)
192 #define PACK_U24LE GST_AUDIO_FORMAT_S32, unpack_u24le, pack_u24le
193     MAKE_PACK_UNPACK (u24le, 3, SIGNED, 8, READ24_FROM_LE, WRITE24_TO_LE)
194 #define PACK_S24BE GST_AUDIO_FORMAT_S32, unpack_s24be, pack_s24be
195     MAKE_PACK_UNPACK (s24be, 3, 0, 8, READ24_FROM_BE, WRITE24_TO_BE)
196 #define PACK_U24BE GST_AUDIO_FORMAT_S32, unpack_u24be, pack_u24be
197     MAKE_PACK_UNPACK (u24be, 3, SIGNED, 8, READ24_FROM_BE, WRITE24_TO_BE)
198 #define PACK_S20LE GST_AUDIO_FORMAT_S32, unpack_s20le, pack_s20le
199     MAKE_PACK_UNPACK (s20le, 3, 0, 12, READ24_FROM_LE, WRITE24_TO_LE)
200 #define PACK_U20LE GST_AUDIO_FORMAT_S32, unpack_u20le, pack_u20le
201     MAKE_PACK_UNPACK (u20le, 3, SIGNED, 12, READ24_FROM_LE, WRITE24_TO_LE)
202 #define PACK_S20BE GST_AUDIO_FORMAT_S32, unpack_s20be, pack_s20be
</pre>
</td>
</tr>
</table>
<center><a href="audio-converter.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../../index.html" target="_top">index</a> <a href="audio-format.h.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>