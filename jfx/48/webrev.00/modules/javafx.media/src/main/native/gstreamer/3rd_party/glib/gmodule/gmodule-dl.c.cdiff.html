<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/gmodule/gmodule-dl.c</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../glib/win_iconv.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gmodule-dyld.c.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/gmodule/gmodule-dl.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 34,36 ***</span>
  
  /* dlerror() is not implemented on all systems
   */
  #ifndef G_MODULE_HAVE_DLERROR
  #  ifdef __NetBSD__
<span class="line-modified">! #    define dlerror()   g_strerror (errno)</span>
  #  else /* !__NetBSD__ */
  /* could we rely on errno&#39;s state here? */
<span class="line-modified">! #    define dlerror()   &quot;unknown dl-error&quot;</span>
  #  endif /* !__NetBSD__ */
  #endif  /* G_MODULE_HAVE_DLERROR */
  
  /* some flags are missing on some systems, so we provide
   * harmless defaults.
   * The Perl sources say, RTLD_LAZY needs to be defined as (1),
   * at least for Solaris 1.
   *
   * Mandatory:
   * RTLD_LAZY   - resolve undefined symbols as code from the dynamic library
<span class="line-modified">!  *       is executed.</span>
   * RTLD_NOW    - resolve all undefined symbols before dlopen returns, and fail
<span class="line-modified">!  *       if this cannot be done.</span>
   * Optionally:
   * RTLD_GLOBAL - the external symbols defined in the library will be made
<span class="line-modified">!  *       available to subsequently loaded libraries.</span>
   */
  #ifndef HAVE_RTLD_LAZY
<span class="line-modified">! #define RTLD_LAZY   1</span>
  #endif  /* RTLD_LAZY */
  #ifndef HAVE_RTLD_NOW
<span class="line-modified">! #define RTLD_NOW    0</span>
  #endif  /* RTLD_NOW */
  /* some systems (OSF1 V5.0) have broken RTLD_GLOBAL linkage */
  #ifdef G_MODULE_BROKEN_RTLD_GLOBAL
  #undef  RTLD_GLOBAL
  #undef  HAVE_RTLD_GLOBAL
<span class="line-new-header">--- 34,36 ---</span>
  
  /* dlerror() is not implemented on all systems
   */
  #ifndef G_MODULE_HAVE_DLERROR
  #  ifdef __NetBSD__
<span class="line-modified">! #    define dlerror() g_strerror (errno)</span>
  #  else /* !__NetBSD__ */
  /* could we rely on errno&#39;s state here? */
<span class="line-modified">! #    define dlerror() &quot;unknown dl-error&quot;</span>
  #  endif /* !__NetBSD__ */
  #endif  /* G_MODULE_HAVE_DLERROR */
  
  /* some flags are missing on some systems, so we provide
   * harmless defaults.
   * The Perl sources say, RTLD_LAZY needs to be defined as (1),
   * at least for Solaris 1.
   *
   * Mandatory:
   * RTLD_LAZY   - resolve undefined symbols as code from the dynamic library
<span class="line-modified">!  *     is executed.</span>
   * RTLD_NOW    - resolve all undefined symbols before dlopen returns, and fail
<span class="line-modified">!  *     if this cannot be done.</span>
   * Optionally:
   * RTLD_GLOBAL - the external symbols defined in the library will be made
<span class="line-modified">!  *     available to subsequently loaded libraries.</span>
   */
  #ifndef HAVE_RTLD_LAZY
<span class="line-modified">! #define RTLD_LAZY 1</span>
  #endif  /* RTLD_LAZY */
  #ifndef HAVE_RTLD_NOW
<span class="line-modified">! #define RTLD_NOW  0</span>
  #endif  /* RTLD_NOW */
  /* some systems (OSF1 V5.0) have broken RTLD_GLOBAL linkage */
  #ifdef G_MODULE_BROKEN_RTLD_GLOBAL
  #undef  RTLD_GLOBAL
  #undef  HAVE_RTLD_GLOBAL
</pre>
<hr />
<pre>
<span class="line-old-header">*** 88,17 ***</span>
    return msg;
  }
  
  static gpointer
  _g_module_open (const gchar *file_name,
<span class="line-modified">!         gboolean     bind_lazy,</span>
<span class="line-modified">!         gboolean     bind_local)</span>
  {
    gpointer handle;
  
    handle = dlopen (file_name,
<span class="line-modified">!            (bind_local ? 0 : RTLD_GLOBAL) | (bind_lazy ? RTLD_LAZY : RTLD_NOW));</span>
    if (!handle)
      g_module_set_error (fetch_dlerror (TRUE));
  
    return handle;
  }
<span class="line-new-header">--- 88,17 ---</span>
    return msg;
  }
  
  static gpointer
  _g_module_open (const gchar *file_name,
<span class="line-modified">!     gboolean     bind_lazy,</span>
<span class="line-modified">!     gboolean     bind_local)</span>
  {
    gpointer handle;
  
    handle = dlopen (file_name,
<span class="line-modified">!        (bind_local ? 0 : RTLD_GLOBAL) | (bind_lazy ? RTLD_LAZY : RTLD_NOW));</span>
    if (!handle)
      g_module_set_error (fetch_dlerror (TRUE));
  
    return handle;
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 130,11 ***</span>
    return handle;
  }
  
  static void
  _g_module_close (gpointer handle,
<span class="line-modified">!          gboolean is_unref)</span>
  {
    /* are there any systems out there that have dlopen()/dlclose()
     * without a reference count implementation?
     *
     * See above for the Android special case
<span class="line-new-header">--- 130,11 ---</span>
    return handle;
  }
  
  static void
  _g_module_close (gpointer handle,
<span class="line-modified">!      gboolean is_unref)</span>
  {
    /* are there any systems out there that have dlopen()/dlclose()
     * without a reference count implementation?
     *
     * See above for the Android special case
</pre>
<hr />
<pre>
<span class="line-old-header">*** 146,17 ***</span>
  #endif
  
    if (is_unref)
      {
        if (dlclose (handle) != 0)
<span class="line-modified">!     g_module_set_error (fetch_dlerror (TRUE));</span>
      }
  }
  
  static gpointer
  _g_module_symbol (gpointer     handle,
<span class="line-modified">!           const gchar *symbol_name)</span>
  {
    gpointer p;
    gchar *msg;
  
    fetch_dlerror (FALSE);
<span class="line-new-header">--- 146,17 ---</span>
  #endif
  
    if (is_unref)
      {
        if (dlclose (handle) != 0)
<span class="line-modified">!   g_module_set_error (fetch_dlerror (TRUE));</span>
      }
  }
  
  static gpointer
  _g_module_symbol (gpointer     handle,
<span class="line-modified">!       const gchar *symbol_name)</span>
  {
    gpointer p;
    gchar *msg;
  
    fetch_dlerror (FALSE);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 168,11 ***</span>
    return p;
  }
  
  static gchar*
  _g_module_build_path (const gchar *directory,
<span class="line-modified">!               const gchar *module_name)</span>
  {
    if (directory &amp;&amp; *directory) {
      if (strncmp (module_name, &quot;lib&quot;, 3) == 0)
        return g_strconcat (directory, &quot;/&quot;, module_name, NULL);
      else
<span class="line-new-header">--- 168,11 ---</span>
    return p;
  }
  
  static gchar*
  _g_module_build_path (const gchar *directory,
<span class="line-modified">!           const gchar *module_name)</span>
  {
    if (directory &amp;&amp; *directory) {
      if (strncmp (module_name, &quot;lib&quot;, 3) == 0)
        return g_strconcat (directory, &quot;/&quot;, module_name, NULL);
      else
</pre>
<center><a href="../glib/win_iconv.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gmodule-dyld.c.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>