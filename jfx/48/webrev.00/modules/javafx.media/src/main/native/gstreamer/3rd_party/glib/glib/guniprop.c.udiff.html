<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Udiff modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/guniprop.c</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="gunidecomp.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gurifuncs.c.udiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/guniprop.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-new-header">@@ -35,10 +35,17 @@</span>
  #include &quot;gunicodeprivate.h&quot;
  #ifdef G_OS_WIN32
  #include &quot;gwin32.h&quot;
  #endif
  
<span class="udiff-line-added">+ #define G_UNICHAR_FULLWIDTH_A 0xff21</span>
<span class="udiff-line-added">+ #define G_UNICHAR_FULLWIDTH_I 0xff29</span>
<span class="udiff-line-added">+ #define G_UNICHAR_FULLWIDTH_J 0xff2a</span>
<span class="udiff-line-added">+ #define G_UNICHAR_FULLWIDTH_F 0xff26</span>
<span class="udiff-line-added">+ #define G_UNICHAR_FULLWIDTH_a 0xff41</span>
<span class="udiff-line-added">+ #define G_UNICHAR_FULLWIDTH_f 0xff46</span>
<span class="udiff-line-added">+ </span>
  #define ATTR_TABLE(Page) (((Page) &lt;= G_UNICODE_LAST_PAGE_PART1) \
                            ? attr_table_part1[Page] \
                            : attr_table_part2[(Page) - 0xe00])
  
  #define ATTTABLE(Page, Char) \
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -65,36 +72,36 @@</span>
  #define IS(Type, Class) (((guint)1 &lt;&lt; (Type)) &amp; (Class))
  #define OR(Type, Rest)  (((guint)1 &lt;&lt; (Type)) | (Rest))
  
  
  
<span class="udiff-line-modified-removed">- #define ISALPHA(Type)   IS ((Type),             \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_LOWERCASE_LETTER, \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_UPPERCASE_LETTER, \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_TITLECASE_LETTER, \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_MODIFIER_LETTER,  \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_OTHER_LETTER,     0))))))</span>
<span class="udiff-line-modified-added">+ #define ISALPHA(Type) IS ((Type),       \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_LOWERCASE_LETTER, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_UPPERCASE_LETTER, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_TITLECASE_LETTER, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_MODIFIER_LETTER,  \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_OTHER_LETTER,   0))))))</span>
  
<span class="udiff-line-modified-removed">- #define ISALDIGIT(Type) IS ((Type),             \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_DECIMAL_NUMBER,   \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_LETTER_NUMBER,    \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_OTHER_NUMBER,     \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_LOWERCASE_LETTER, \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_UPPERCASE_LETTER, \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_TITLECASE_LETTER, \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_MODIFIER_LETTER,  \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_OTHER_LETTER,     0)))))))))</span>
<span class="udiff-line-modified-added">+ #define ISALDIGIT(Type) IS ((Type),       \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_DECIMAL_NUMBER, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_LETTER_NUMBER,  \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_OTHER_NUMBER,   \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_LOWERCASE_LETTER, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_UPPERCASE_LETTER, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_TITLECASE_LETTER, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_MODIFIER_LETTER,  \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_OTHER_LETTER,   0)))))))))</span>
  
<span class="udiff-line-modified-removed">- #define ISMARK(Type)    IS ((Type),             \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_NON_SPACING_MARK, \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_SPACING_MARK, \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_ENCLOSING_MARK,   0))))</span>
<span class="udiff-line-modified-added">+ #define ISMARK(Type)  IS ((Type),       \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_NON_SPACING_MARK, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_SPACING_MARK, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_ENCLOSING_MARK, 0))))</span>
  
<span class="udiff-line-modified-removed">- #define ISZEROWIDTHTYPE(Type)   IS ((Type),         \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_NON_SPACING_MARK, \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_ENCLOSING_MARK,   \</span>
<span class="udiff-line-modified-removed">-                 OR (G_UNICODE_FORMAT,       0))))</span>
<span class="udiff-line-modified-added">+ #define ISZEROWIDTHTYPE(Type) IS ((Type),     \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_NON_SPACING_MARK, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_ENCLOSING_MARK, \</span>
<span class="udiff-line-modified-added">+           OR (G_UNICODE_FORMAT,   0))))</span>
  
  /**
   * g_unichar_isalnum:
   * @c: a Unicode character
   *
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -174,16 +181,16 @@</span>
   **/
  gboolean
  g_unichar_isgraph (gunichar c)
  {
    return !IS (TYPE(c),
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_CONTROL,</span>
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_FORMAT,</span>
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_UNASSIGNED,</span>
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_SURROGATE,</span>
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_SPACE_SEPARATOR,</span>
<span class="udiff-line-modified-removed">-          0))))));</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_CONTROL,</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_FORMAT,</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_UNASSIGNED,</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_SURROGATE,</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_SPACE_SEPARATOR,</span>
<span class="udiff-line-modified-added">+        0))))));</span>
  }
  
  /**
   * g_unichar_islower:
   * @c: a Unicode character
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -214,15 +221,15 @@</span>
   **/
  gboolean
  g_unichar_isprint (gunichar c)
  {
    return !IS (TYPE(c),
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_CONTROL,</span>
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_FORMAT,</span>
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_UNASSIGNED,</span>
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_SURROGATE,</span>
<span class="udiff-line-modified-removed">-          0)))));</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_CONTROL,</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_FORMAT,</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_UNASSIGNED,</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_SURROGATE,</span>
<span class="udiff-line-modified-added">+        0)))));</span>
  }
  
  /**
   * g_unichar_ispunct:
   * @c: a Unicode character
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -235,22 +242,22 @@</span>
   **/
  gboolean
  g_unichar_ispunct (gunichar c)
  {
    return IS (TYPE(c),
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_CONNECT_PUNCTUATION,</span>
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_DASH_PUNCTUATION,</span>
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_CLOSE_PUNCTUATION,</span>
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_FINAL_PUNCTUATION,</span>
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_INITIAL_PUNCTUATION,</span>
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_OTHER_PUNCTUATION,</span>
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_OPEN_PUNCTUATION,</span>
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_CURRENCY_SYMBOL,</span>
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_MODIFIER_SYMBOL,</span>
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_MATH_SYMBOL,</span>
<span class="udiff-line-modified-removed">-          OR (G_UNICODE_OTHER_SYMBOL,</span>
<span class="udiff-line-modified-removed">-         0)))))))))))) ? TRUE : FALSE;</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_CONNECT_PUNCTUATION,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_DASH_PUNCTUATION,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_CLOSE_PUNCTUATION,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_FINAL_PUNCTUATION,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_INITIAL_PUNCTUATION,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_OTHER_PUNCTUATION,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_OPEN_PUNCTUATION,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_CURRENCY_SYMBOL,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_MODIFIER_SYMBOL,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_MATH_SYMBOL,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_OTHER_SYMBOL,</span>
<span class="udiff-line-modified-added">+       0)))))))))))) ? TRUE : FALSE;</span>
  }
  
  /**
   * g_unichar_isspace:
   * @c: a Unicode character
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -278,15 +285,15 @@</span>
        return TRUE;
        break;
  
      default:
        {
<span class="udiff-line-modified-removed">-     return IS (TYPE(c),</span>
<span class="udiff-line-modified-removed">-                OR (G_UNICODE_SPACE_SEPARATOR,</span>
<span class="udiff-line-modified-removed">-                OR (G_UNICODE_LINE_SEPARATOR,</span>
<span class="udiff-line-modified-added">+   return IS (TYPE(c),</span>
<span class="udiff-line-modified-added">+              OR (G_UNICODE_SPACE_SEPARATOR,</span>
<span class="udiff-line-modified-added">+              OR (G_UNICODE_LINE_SEPARATOR,</span>
                     OR (G_UNICODE_PARAGRAPH_SEPARATOR,
<span class="udiff-line-modified-removed">-           0)))) ? TRUE : FALSE;</span>
<span class="udiff-line-modified-added">+       0)))) ? TRUE : FALSE;</span>
        }
        break;
      }
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -360,13 +367,15 @@</span>
   * Returns: %TRUE if the character is a hexadecimal digit
   **/
  gboolean
  g_unichar_isxdigit (gunichar c)
  {
<span class="udiff-line-modified-removed">-   return ((c &gt;= &#39;a&#39; &amp;&amp; c &lt;= &#39;f&#39;)</span>
<span class="udiff-line-modified-removed">-       || (c &gt;= &#39;A&#39; &amp;&amp; c &lt;= &#39;F&#39;)</span>
<span class="udiff-line-modified-removed">-       || (TYPE (c) == G_UNICODE_DECIMAL_NUMBER));</span>
<span class="udiff-line-modified-added">+   return ((c &gt;= &#39;a&#39; &amp;&amp; c &lt;= &#39;f&#39;) ||</span>
<span class="udiff-line-modified-added">+           (c &gt;= &#39;A&#39; &amp;&amp; c &lt;= &#39;F&#39;) ||</span>
<span class="udiff-line-modified-added">+           (c &gt;= G_UNICHAR_FULLWIDTH_a &amp;&amp; c &lt;= G_UNICHAR_FULLWIDTH_f) ||</span>
<span class="udiff-line-added">+           (c &gt;= G_UNICHAR_FULLWIDTH_A &amp;&amp; c &lt;= G_UNICHAR_FULLWIDTH_F) ||</span>
<span class="udiff-line-added">+           (TYPE (c) == G_UNICODE_DECIMAL_NUMBER));</span>
  }
  
  /**
   * g_unichar_isdefined:
   * @c: a Unicode character
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -378,13 +387,13 @@</span>
   **/
  gboolean
  g_unichar_isdefined (gunichar c)
  {
    return !IS (TYPE(c),
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_UNASSIGNED,</span>
<span class="udiff-line-modified-removed">-           OR (G_UNICODE_SURROGATE,</span>
<span class="udiff-line-modified-removed">-          0)));</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_UNASSIGNED,</span>
<span class="udiff-line-modified-added">+         OR (G_UNICODE_SURROGATE,</span>
<span class="udiff-line-modified-added">+        0)));</span>
  }
  
  /**
   * g_unichar_iszerowidth:
   * @c: a Unicode character
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -411,11 +420,11 @@</span>
  
    if (G_UNLIKELY (ISZEROWIDTHTYPE (TYPE (c))))
      return TRUE;
  
    if (G_UNLIKELY ((c &gt;= 0x1160 &amp;&amp; c &lt; 0x1200) ||
<span class="udiff-line-modified-removed">-           c == 0x200B))</span>
<span class="udiff-line-modified-added">+       c == 0x200B))</span>
      return TRUE;
  
    return FALSE;
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -444,15 +453,15 @@</span>
    int mid = saved_mid;
  
    do
      {
        if (ch &lt; g_unicode_width_table_wide[mid].start)
<span class="udiff-line-modified-removed">-     upper = mid - 1;</span>
<span class="udiff-line-modified-added">+   upper = mid - 1;</span>
        else if (ch &gt; g_unicode_width_table_wide[mid].end)
<span class="udiff-line-modified-removed">-     lower = mid + 1;</span>
<span class="udiff-line-modified-added">+   lower = mid + 1;</span>
        else
<span class="udiff-line-modified-removed">-     return TRUE;</span>
<span class="udiff-line-modified-added">+   return TRUE;</span>
  
        mid = (lower + upper) / 2;
      }
    while (lower &lt;= upper);
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -470,11 +479,11 @@</span>
   **/
  gboolean
  g_unichar_iswide (gunichar c)
  {
    if (c &lt; g_unicode_width_table_wide[0].start)
<span class="udiff-line-modified-removed">-   return FALSE;</span>
<span class="udiff-line-modified-added">+     return FALSE;</span>
    else
      return g_unichar_iswide_bsearch (c);
  }
  
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -510,11 +519,11 @@</span>
  
    if (bsearch (GUINT_TO_POINTER (c),
                 g_unicode_width_table_ambiguous,
                 G_N_ELEMENTS (g_unicode_width_table_ambiguous),
                 sizeof g_unicode_width_table_ambiguous[0],
<span class="udiff-line-modified-removed">-            interval_compare))</span>
<span class="udiff-line-modified-added">+          interval_compare))</span>
      return TRUE;
  
    return FALSE;
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -524,39 +533,39 @@</span>
   * @c: a Unicode character
   *
   * Converts a character to uppercase.
   *
   * Returns: the result of converting @c to uppercase.
<span class="udiff-line-modified-removed">-  *               If @c is not an lowercase or titlecase character,</span>
<span class="udiff-line-modified-added">+  *               If @c is not a lowercase or titlecase character,</span>
   *               or has no upper case equivalent @c is returned unchanged.
   **/
  gunichar
  g_unichar_toupper (gunichar c)
  {
    int t = TYPE (c);
    if (t == G_UNICODE_LOWERCASE_LETTER)
      {
        gunichar val = ATTTABLE (c &gt;&gt; 8, c &amp; 0xff);
        if (val &gt;= 0x1000000)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       const gchar *p = special_case_table + val - 0x1000000;</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     const gchar *p = special_case_table + val - 0x1000000;</span>
            val = g_utf8_get_char (p);
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   }</span>
        /* Some lowercase letters, e.g., U+000AA, FEMININE ORDINAL INDICATOR,
         * do not have an uppercase equivalent, in which case val will be
         * zero.
         */
        return val ? val : c;
      }
    else if (t == G_UNICODE_TITLECASE_LETTER)
      {
        unsigned int i;
        for (i = 0; i &lt; G_N_ELEMENTS (title_table); ++i)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       if (title_table[i][0] == c)</span>
<span class="udiff-line-modified-removed">-         return title_table[i][1] ? title_table[i][1] : c;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     if (title_table[i][0] == c)</span>
<span class="udiff-line-modified-added">+       return title_table[i][1] ? title_table[i][1] : c;</span>
<span class="udiff-line-modified-added">+   }</span>
      }
    return c;
  }
  
  /**
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -575,29 +584,29 @@</span>
    int t = TYPE (c);
    if (t == G_UNICODE_UPPERCASE_LETTER)
      {
        gunichar val = ATTTABLE (c &gt;&gt; 8, c &amp; 0xff);
        if (val &gt;= 0x1000000)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       const gchar *p = special_case_table + val - 0x1000000;</span>
<span class="udiff-line-modified-removed">-       return g_utf8_get_char (p);</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     const gchar *p = special_case_table + val - 0x1000000;</span>
<span class="udiff-line-modified-added">+     return g_utf8_get_char (p);</span>
<span class="udiff-line-modified-added">+   }</span>
        else
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       /* Not all uppercase letters are guaranteed to have a lowercase</span>
<span class="udiff-line-modified-removed">-        * equivalent.  If this is the case, val will be zero. */</span>
<span class="udiff-line-modified-removed">-       return val ? val : c;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     /* Not all uppercase letters are guaranteed to have a lowercase</span>
<span class="udiff-line-modified-added">+      * equivalent.  If this is the case, val will be zero. */</span>
<span class="udiff-line-modified-added">+     return val ? val : c;</span>
<span class="udiff-line-modified-added">+   }</span>
      }
    else if (t == G_UNICODE_TITLECASE_LETTER)
      {
        unsigned int i;
        for (i = 0; i &lt; G_N_ELEMENTS (title_table); ++i)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       if (title_table[i][0] == c)</span>
<span class="udiff-line-modified-removed">-         return title_table[i][2];</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     if (title_table[i][0] == c)</span>
<span class="udiff-line-modified-added">+       return title_table[i][2];</span>
<span class="udiff-line-modified-added">+   }</span>
      }
    return c;
  }
  
  /**
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -612,15 +621,21 @@</span>
   **/
  gunichar
  g_unichar_totitle (gunichar c)
  {
    unsigned int i;
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   /* We handle U+0000 explicitely because some elements in</span>
<span class="udiff-line-added">+    * title_table[i][1] may be null. */</span>
<span class="udiff-line-added">+   if (c == 0)</span>
<span class="udiff-line-added">+     return c;</span>
<span class="udiff-line-added">+ </span>
    for (i = 0; i &lt; G_N_ELEMENTS (title_table); ++i)
      {
        if (title_table[i][0] == c || title_table[i][1] == c
<span class="udiff-line-modified-removed">-       || title_table[i][2] == c)</span>
<span class="udiff-line-modified-removed">-     return title_table[i][0];</span>
<span class="udiff-line-modified-added">+     || title_table[i][2] == c)</span>
<span class="udiff-line-modified-added">+   return title_table[i][0];</span>
      }
  
    if (TYPE (c) == G_UNICODE_LOWERCASE_LETTER)
      return g_unichar_toupper (c);
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -660,10 +675,14 @@</span>
  {
    if (c &gt;= &#39;A&#39; &amp;&amp; c &lt;= &#39;F&#39;)
      return c - &#39;A&#39; + 10;
    if (c &gt;= &#39;a&#39; &amp;&amp; c &lt;= &#39;f&#39;)
      return c - &#39;a&#39; + 10;
<span class="udiff-line-added">+   if (c &gt;= G_UNICHAR_FULLWIDTH_A &amp;&amp; c &lt;= G_UNICHAR_FULLWIDTH_F)</span>
<span class="udiff-line-added">+     return c - G_UNICHAR_FULLWIDTH_A + 10;</span>
<span class="udiff-line-added">+   if (c &gt;= G_UNICHAR_FULLWIDTH_a &amp;&amp; c &lt;= G_UNICHAR_FULLWIDTH_f)</span>
<span class="udiff-line-added">+     return c - G_UNICHAR_FULLWIDTH_a + 10;</span>
    if (TYPE (c) == G_UNICODE_DECIMAL_NUMBER)
      return ATTTABLE (c &gt;&gt; 8, c &amp; 0xff);
    return -1;
  }
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -710,56 +729,56 @@</span>
  
    switch (locale[0])
      {
     case &#39;a&#39;:
        if (locale[1] == &#39;z&#39;)
<span class="udiff-line-modified-removed">-     return LOCALE_TURKIC;</span>
<span class="udiff-line-modified-added">+   return LOCALE_TURKIC;</span>
        break;
      case &#39;l&#39;:
        if (locale[1] == &#39;t&#39;)
<span class="udiff-line-modified-removed">-     return LOCALE_LITHUANIAN;</span>
<span class="udiff-line-modified-added">+   return LOCALE_LITHUANIAN;</span>
        break;
      case &#39;t&#39;:
        if (locale[1] == &#39;r&#39;)
<span class="udiff-line-modified-removed">-     return LOCALE_TURKIC;</span>
<span class="udiff-line-modified-added">+   return LOCALE_TURKIC;</span>
        break;
      }
  
    return LOCALE_NORMAL;
  }
  
  static gint
  output_marks (const char **p_inout,
<span class="udiff-line-modified-removed">-           char        *out_buffer,</span>
<span class="udiff-line-modified-removed">-           gboolean     remove_dot)</span>
<span class="udiff-line-modified-added">+         char        *out_buffer,</span>
<span class="udiff-line-modified-added">+         gboolean     remove_dot)</span>
  {
    const char *p = *p_inout;
    gint len = 0;
  
    while (*p)
      {
        gunichar c = g_utf8_get_char (p);
  
        if (ISMARK (TYPE (c)))
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       if (!remove_dot || c != 0x307 /* COMBINING DOT ABOVE */)</span>
<span class="udiff-line-modified-removed">-         len += g_unichar_to_utf8 (c, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-modified-removed">-       p = g_utf8_next_char (p);</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     if (!remove_dot || c != 0x307 /* COMBINING DOT ABOVE */)</span>
<span class="udiff-line-modified-added">+       len += g_unichar_to_utf8 (c, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-modified-added">+     p = g_utf8_next_char (p);</span>
<span class="udiff-line-modified-added">+   }</span>
        else
<span class="udiff-line-modified-removed">-     break;</span>
<span class="udiff-line-modified-added">+   break;</span>
      }
  
    *p_inout = p;
    return len;
  }
  
  static gint
  output_special_case (gchar *out_buffer,
<span class="udiff-line-modified-removed">-              int    offset,</span>
<span class="udiff-line-modified-removed">-              int    type,</span>
<span class="udiff-line-modified-removed">-              int    which)</span>
<span class="udiff-line-modified-added">+          int    offset,</span>
<span class="udiff-line-modified-added">+          int    type,</span>
<span class="udiff-line-modified-added">+          int    which)</span>
  {
    const gchar *p = special_case_table + offset;
    gint len;
  
    if (type != G_UNICODE_TITLECASE_LETTER)
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -775,13 +794,13 @@</span>
    return len;
  }
  
  static gsize
  real_toupper (const gchar *str,
<span class="udiff-line-modified-removed">-           gssize       max_len,</span>
<span class="udiff-line-modified-removed">-           gchar       *out_buffer,</span>
<span class="udiff-line-modified-removed">-           LocaleType   locale_type)</span>
<span class="udiff-line-modified-added">+         gssize       max_len,</span>
<span class="udiff-line-modified-added">+         gchar       *out_buffer,</span>
<span class="udiff-line-modified-added">+         LocaleType   locale_type)</span>
  {
    const gchar *p = str;
    const char *last = NULL;
    gsize len = 0;
    gboolean last_was_i = FALSE;
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -794,98 +813,98 @@</span>
  
        last = p;
        p = g_utf8_next_char (p);
  
        if (locale_type == LOCALE_LITHUANIAN)
<span class="udiff-line-added">+   {</span>
<span class="udiff-line-added">+     if (c == &#39;i&#39;)</span>
<span class="udiff-line-added">+       last_was_i = TRUE;</span>
<span class="udiff-line-added">+     else</span>
<span class="udiff-line-added">+       {</span>
<span class="udiff-line-added">+         if (last_was_i)</span>
      {
<span class="udiff-line-modified-removed">-       if (c == &#39;i&#39;)</span>
<span class="udiff-line-modified-removed">-         last_was_i = TRUE;</span>
<span class="udiff-line-modified-removed">-       else</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           if (last_was_i)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-removed">-           /* Nasty, need to remove any dot above. Though</span>
<span class="udiff-line-removed">-            * I think only E WITH DOT ABOVE occurs in practice</span>
<span class="udiff-line-removed">-            * which could simplify this considerably.</span>
<span class="udiff-line-removed">-            */</span>
<span class="udiff-line-removed">-           gsize decomp_len, i;</span>
<span class="udiff-line-removed">-           gunichar decomp[G_UNICHAR_MAX_DECOMPOSITION_LENGTH];</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-           decomp_len = g_unichar_fully_decompose (c, FALSE, decomp, G_N_ELEMENTS (decomp));</span>
<span class="udiff-line-removed">-           for (i=0; i &lt; decomp_len; i++)</span>
<span class="udiff-line-removed">-             {</span>
<span class="udiff-line-removed">-               if (decomp[i] != 0x307 /* COMBINING DOT ABOVE */)</span>
<span class="udiff-line-removed">-             len += g_unichar_to_utf8 (g_unichar_toupper (decomp[i]), out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-           len += output_marks (&amp;p, out_buffer ? out_buffer + len : NULL, TRUE);</span>
<span class="udiff-line-modified-added">+       /* Nasty, need to remove any dot above. Though</span>
<span class="udiff-line-modified-added">+        * I think only E WITH DOT ABOVE occurs in practice</span>
<span class="udiff-line-modified-added">+        * which could simplify this considerably.</span>
<span class="udiff-line-modified-added">+        */</span>
<span class="udiff-line-modified-added">+       gsize decomp_len, i;</span>
<span class="udiff-line-modified-added">+       gunichar decomp[G_UNICHAR_MAX_DECOMPOSITION_LENGTH];</span>
  
<span class="udiff-line-modified-removed">-           continue;</span>
<span class="udiff-line-modified-added">+       decomp_len = g_unichar_fully_decompose (c, FALSE, decomp, G_N_ELEMENTS (decomp));</span>
<span class="udiff-line-added">+       for (i=0; i &lt; decomp_len; i++)</span>
<span class="udiff-line-added">+         {</span>
<span class="udiff-line-added">+           if (decomp[i] != 0x307 /* COMBINING DOT ABOVE */)</span>
<span class="udiff-line-added">+       len += g_unichar_to_utf8 (g_unichar_toupper (decomp[i]), out_buffer ? out_buffer + len : NULL);</span>
          }
  
<span class="udiff-line-modified-removed">-           if (!ISMARK (t))</span>
<span class="udiff-line-modified-removed">-         last_was_i = FALSE;</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-added">+       len += output_marks (&amp;p, out_buffer ? out_buffer + len : NULL, TRUE);</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+       continue;</span>
      }
  
<span class="udiff-line-added">+         if (!ISMARK (t))</span>
<span class="udiff-line-added">+     last_was_i = FALSE;</span>
<span class="udiff-line-added">+       }</span>
<span class="udiff-line-added">+   }</span>
<span class="udiff-line-added">+ </span>
        if (locale_type == LOCALE_TURKIC &amp;&amp; c == &#39;i&#39;)
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       /* i =&gt; LATIN CAPITAL LETTER I WITH DOT ABOVE */</span>
<span class="udiff-line-modified-removed">-       len += g_unichar_to_utf8 (0x130, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     /* i =&gt; LATIN CAPITAL LETTER I WITH DOT ABOVE */</span>
<span class="udiff-line-modified-added">+     len += g_unichar_to_utf8 (0x130, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-modified-added">+   }</span>
        else if (c == 0x0345) /* COMBINING GREEK YPOGEGRAMMENI */
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       /* Nasty, need to move it after other combining marks .. this would go away if</span>
<span class="udiff-line-modified-removed">-        * we normalized first.</span>
<span class="udiff-line-modified-removed">-        */</span>
<span class="udiff-line-modified-removed">-       len += output_marks (&amp;p, out_buffer ? out_buffer + len : NULL, FALSE);</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-       /* And output as GREEK CAPITAL LETTER IOTA */</span>
<span class="udiff-line-modified-removed">-       len += g_unichar_to_utf8 (0x399, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     /* Nasty, need to move it after other combining marks .. this would go away if</span>
<span class="udiff-line-modified-added">+      * we normalized first.</span>
<span class="udiff-line-modified-added">+      */</span>
<span class="udiff-line-modified-added">+     len += output_marks (&amp;p, out_buffer ? out_buffer + len : NULL, FALSE);</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+     /* And output as GREEK CAPITAL LETTER IOTA */</span>
<span class="udiff-line-modified-added">+     len += g_unichar_to_utf8 (0x399, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-modified-added">+   }</span>
        else if (IS (t,
<span class="udiff-line-modified-removed">-            OR (G_UNICODE_LOWERCASE_LETTER,</span>
<span class="udiff-line-modified-removed">-            OR (G_UNICODE_TITLECASE_LETTER,</span>
<span class="udiff-line-modified-removed">-           0))))</span>
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       val = ATTTABLE (c &gt;&gt; 8, c &amp; 0xff);</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_LOWERCASE_LETTER,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_TITLECASE_LETTER,</span>
<span class="udiff-line-modified-added">+       0))))</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     val = ATTTABLE (c &gt;&gt; 8, c &amp; 0xff);</span>
  
<span class="udiff-line-modified-removed">-       if (val &gt;= 0x1000000)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           len += output_special_case (out_buffer ? out_buffer + len : NULL, val - 0x1000000, t,</span>
<span class="udiff-line-modified-removed">-                       t == G_UNICODE_LOWERCASE_LETTER ? 0 : 1);</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       else</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           if (t == G_UNICODE_TITLECASE_LETTER)</span>
<span class="udiff-line-modified-added">+     if (val &gt;= 0x1000000)</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         len += output_special_case (out_buffer ? out_buffer + len : NULL, val - 0x1000000, t,</span>
<span class="udiff-line-modified-added">+             t == G_UNICODE_LOWERCASE_LETTER ? 0 : 1);</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     else</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         if (t == G_UNICODE_TITLECASE_LETTER)</span>
<span class="udiff-line-added">+     {</span>
<span class="udiff-line-added">+       unsigned int i;</span>
<span class="udiff-line-added">+       for (i = 0; i &lt; G_N_ELEMENTS (title_table); ++i)</span>
          {
<span class="udiff-line-modified-removed">-           unsigned int i;</span>
<span class="udiff-line-modified-removed">-           for (i = 0; i &lt; G_N_ELEMENTS (title_table); ++i)</span>
<span class="udiff-line-modified-removed">-             {</span>
<span class="udiff-line-modified-removed">-               if (title_table[i][0] == c)</span>
<span class="udiff-line-modified-removed">-             {</span>
<span class="udiff-line-removed">-               val = title_table[i][1];</span>
<span class="udiff-line-removed">-               break;</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-           /* Some lowercase letters, e.g., U+000AA, FEMININE ORDINAL INDICATOR,</span>
<span class="udiff-line-removed">-            * do not have an uppercase equivalent, in which case val will be</span>
<span class="udiff-line-removed">-            * zero. */</span>
<span class="udiff-line-removed">-           len += g_unichar_to_utf8 (val ? val : c, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-modified-added">+           if (title_table[i][0] == c)</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         val = title_table[i][1];</span>
<span class="udiff-line-modified-added">+         break;</span>
<span class="udiff-line-modified-added">+       }</span>
          }
      }
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         /* Some lowercase letters, e.g., U+000AA, FEMININE ORDINAL INDICATOR,</span>
<span class="udiff-line-added">+          * do not have an uppercase equivalent, in which case val will be</span>
<span class="udiff-line-added">+          * zero. */</span>
<span class="udiff-line-added">+         len += g_unichar_to_utf8 (val ? val : c, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-added">+       }</span>
<span class="udiff-line-added">+   }</span>
        else
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       gsize char_len = g_utf8_skip[*(guchar *)last];</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     gsize char_len = g_utf8_skip[*(guchar *)last];</span>
  
<span class="udiff-line-modified-removed">-       if (out_buffer)</span>
<span class="udiff-line-modified-removed">-         memcpy (out_buffer + len, last, char_len);</span>
<span class="udiff-line-modified-added">+     if (out_buffer)</span>
<span class="udiff-line-modified-added">+       memcpy (out_buffer + len, last, char_len);</span>
  
<span class="udiff-line-modified-removed">-       len += char_len;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+     len += char_len;</span>
<span class="udiff-line-modified-added">+   }</span>
  
      }
  
    return len;
  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -904,11 +923,11 @@</span>
   * Returns: a newly allocated string, with all characters
   *    converted to uppercase.
   **/
  gchar *
  g_utf8_strup (const gchar *str,
<span class="udiff-line-modified-removed">-           gssize       len)</span>
<span class="udiff-line-modified-added">+         gssize       len)</span>
  {
    gsize result_len;
    LocaleType locale_type;
    gchar *result;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -962,13 +981,13 @@</span>
    return FALSE;
  }
  
  static gsize
  real_tolower (const gchar *str,
<span class="udiff-line-modified-removed">-           gssize       max_len,</span>
<span class="udiff-line-modified-removed">-           gchar       *out_buffer,</span>
<span class="udiff-line-modified-removed">-           LocaleType   locale_type)</span>
<span class="udiff-line-modified-added">+         gssize       max_len,</span>
<span class="udiff-line-modified-added">+         gchar       *out_buffer,</span>
<span class="udiff-line-modified-added">+         LocaleType   locale_type)</span>
  {
    const gchar *p = str;
    const char *last = NULL;
    gsize len = 0;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -979,12 +998,13 @@</span>
        gunichar val;
  
        last = p;
        p = g_utf8_next_char (p);
  
<span class="udiff-line-modified-removed">-       if (locale_type == LOCALE_TURKIC &amp;&amp; c == &#39;I&#39;)</span>
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-added">+       if (locale_type == LOCALE_TURKIC &amp;&amp; (c == &#39;I&#39; ||</span>
<span class="udiff-line-modified-added">+                                            c == G_UNICHAR_FULLWIDTH_I))</span>
<span class="udiff-line-added">+   {</span>
            if (g_utf8_get_char (p) == 0x0307)
              {
                /* I + COMBINING DOT ABOVE =&gt; i (U+0069) */
                len += g_unichar_to_utf8 (0x0069, out_buffer ? out_buffer + len : NULL);
                p = g_utf8_next_char (p);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1015,79 +1035,80 @@</span>
                len += g_unichar_to_utf8 (0x0303, out_buffer ? out_buffer + len : NULL);
                break;
              }
          }
        else if (locale_type == LOCALE_LITHUANIAN &amp;&amp;
<span class="udiff-line-modified-removed">-                (c == &#39;I&#39; || c == &#39;J&#39; || c == 0x012e) &amp;&amp;</span>
<span class="udiff-line-modified-added">+                (c == &#39;I&#39; || c == G_UNICHAR_FULLWIDTH_I ||</span>
<span class="udiff-line-added">+                 c == &#39;J&#39; || c == G_UNICHAR_FULLWIDTH_J || c == 0x012e) &amp;&amp;</span>
                 has_more_above (p))
          {
            len += g_unichar_to_utf8 (g_unichar_tolower (c), out_buffer ? out_buffer + len : NULL);
            len += g_unichar_to_utf8 (0x0307, out_buffer ? out_buffer + len : NULL);
          }
        else if (c == 0x03A3) /* GREEK CAPITAL LETTER SIGMA */
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       if ((max_len &lt; 0 || p &lt; str + max_len) &amp;&amp; *p)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           gunichar next_c = g_utf8_get_char (p);</span>
<span class="udiff-line-modified-removed">-           int next_type = TYPE(next_c);</span>
<span class="udiff-line-modified-removed">- </span>
<span class="udiff-line-modified-removed">-           /* SIGMA mapps differently depending on whether it is</span>
<span class="udiff-line-modified-removed">-            * final or not. The following simplified test would</span>
<span class="udiff-line-modified-removed">-            * fail in the case of combining marks following the</span>
<span class="udiff-line-modified-removed">-            * sigma, but I don&#39;t think that occurs in real text.</span>
<span class="udiff-line-modified-removed">-            * The test here matches that in ICU.</span>
<span class="udiff-line-modified-removed">-            */</span>
<span class="udiff-line-modified-removed">-           if (ISALPHA (next_type)) /* Lu,Ll,Lt,Lm,Lo */</span>
<span class="udiff-line-modified-removed">-         val = 0x3c3;    /* GREEK SMALL SIGMA */</span>
<span class="udiff-line-modified-removed">-           else</span>
<span class="udiff-line-modified-removed">-         val = 0x3c2;    /* GREEK SMALL FINAL SIGMA */</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       else</span>
<span class="udiff-line-modified-removed">-         val = 0x3c2;    /* GREEK SMALL FINAL SIGMA */</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     if ((max_len &lt; 0 || p &lt; str + max_len) &amp;&amp; *p)</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         gunichar next_c = g_utf8_get_char (p);</span>
<span class="udiff-line-modified-added">+         int next_type = TYPE(next_c);</span>
<span class="udiff-line-modified-added">+ </span>
<span class="udiff-line-modified-added">+         /* SIGMA mapps differently depending on whether it is</span>
<span class="udiff-line-modified-added">+          * final or not. The following simplified test would</span>
<span class="udiff-line-modified-added">+          * fail in the case of combining marks following the</span>
<span class="udiff-line-modified-added">+          * sigma, but I don&#39;t think that occurs in real text.</span>
<span class="udiff-line-modified-added">+          * The test here matches that in ICU.</span>
<span class="udiff-line-modified-added">+          */</span>
<span class="udiff-line-modified-added">+         if (ISALPHA (next_type)) /* Lu,Ll,Lt,Lm,Lo */</span>
<span class="udiff-line-modified-added">+     val = 0x3c3;  /* GREEK SMALL SIGMA */</span>
<span class="udiff-line-modified-added">+         else</span>
<span class="udiff-line-modified-added">+     val = 0x3c2;  /* GREEK SMALL FINAL SIGMA */</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     else</span>
<span class="udiff-line-modified-added">+       val = 0x3c2;  /* GREEK SMALL FINAL SIGMA */</span>
  
<span class="udiff-line-modified-removed">-       len += g_unichar_to_utf8 (val, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+     len += g_unichar_to_utf8 (val, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-modified-added">+   }</span>
        else if (IS (t,
<span class="udiff-line-modified-removed">-            OR (G_UNICODE_UPPERCASE_LETTER,</span>
<span class="udiff-line-modified-removed">-            OR (G_UNICODE_TITLECASE_LETTER,</span>
<span class="udiff-line-modified-removed">-           0))))</span>
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       val = ATTTABLE (c &gt;&gt; 8, c &amp; 0xff);</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_UPPERCASE_LETTER,</span>
<span class="udiff-line-modified-added">+        OR (G_UNICODE_TITLECASE_LETTER,</span>
<span class="udiff-line-modified-added">+       0))))</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     val = ATTTABLE (c &gt;&gt; 8, c &amp; 0xff);</span>
  
<span class="udiff-line-modified-removed">-       if (val &gt;= 0x1000000)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           len += output_special_case (out_buffer ? out_buffer + len : NULL, val - 0x1000000, t, 0);</span>
<span class="udiff-line-modified-removed">-         }</span>
<span class="udiff-line-modified-removed">-       else</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-modified-removed">-           if (t == G_UNICODE_TITLECASE_LETTER)</span>
<span class="udiff-line-modified-added">+     if (val &gt;= 0x1000000)</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         len += output_special_case (out_buffer ? out_buffer + len : NULL, val - 0x1000000, t, 0);</span>
<span class="udiff-line-modified-added">+       }</span>
<span class="udiff-line-modified-added">+     else</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         if (t == G_UNICODE_TITLECASE_LETTER)</span>
<span class="udiff-line-added">+     {</span>
<span class="udiff-line-added">+       unsigned int i;</span>
<span class="udiff-line-added">+       for (i = 0; i &lt; G_N_ELEMENTS (title_table); ++i)</span>
          {
<span class="udiff-line-modified-removed">-           unsigned int i;</span>
<span class="udiff-line-modified-removed">-           for (i = 0; i &lt; G_N_ELEMENTS (title_table); ++i)</span>
<span class="udiff-line-modified-removed">-             {</span>
<span class="udiff-line-modified-removed">-               if (title_table[i][0] == c)</span>
<span class="udiff-line-modified-removed">-             {</span>
<span class="udiff-line-removed">-               val = title_table[i][2];</span>
<span class="udiff-line-removed">-               break;</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-             }</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">- </span>
<span class="udiff-line-removed">-           /* Not all uppercase letters are guaranteed to have a lowercase</span>
<span class="udiff-line-removed">-            * equivalent.  If this is the case, val will be zero. */</span>
<span class="udiff-line-removed">-           len += g_unichar_to_utf8 (val ? val : c, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-modified-added">+           if (title_table[i][0] == c)</span>
<span class="udiff-line-modified-added">+       {</span>
<span class="udiff-line-modified-added">+         val = title_table[i][2];</span>
<span class="udiff-line-modified-added">+         break;</span>
<span class="udiff-line-modified-added">+       }</span>
          }
      }
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+         /* Not all uppercase letters are guaranteed to have a lowercase</span>
<span class="udiff-line-added">+          * equivalent.  If this is the case, val will be zero. */</span>
<span class="udiff-line-added">+         len += g_unichar_to_utf8 (val ? val : c, out_buffer ? out_buffer + len : NULL);</span>
<span class="udiff-line-added">+       }</span>
<span class="udiff-line-added">+   }</span>
        else
<span class="udiff-line-modified-removed">-     {</span>
<span class="udiff-line-modified-removed">-       gsize char_len = g_utf8_skip[*(guchar *)last];</span>
<span class="udiff-line-modified-added">+   {</span>
<span class="udiff-line-modified-added">+     gsize char_len = g_utf8_skip[*(guchar *)last];</span>
  
<span class="udiff-line-modified-removed">-       if (out_buffer)</span>
<span class="udiff-line-modified-removed">-         memcpy (out_buffer + len, last, char_len);</span>
<span class="udiff-line-modified-added">+     if (out_buffer)</span>
<span class="udiff-line-modified-added">+       memcpy (out_buffer + len, last, char_len);</span>
  
<span class="udiff-line-modified-removed">-       len += char_len;</span>
<span class="udiff-line-modified-removed">-     }</span>
<span class="udiff-line-modified-added">+     len += char_len;</span>
<span class="udiff-line-modified-added">+   }</span>
  
      }
  
    return len;
  }
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1105,11 +1126,11 @@</span>
   * Returns: a newly allocated string, with all characters
   *    converted to lowercase.
   **/
  gchar *
  g_utf8_strdown (const gchar *str,
<span class="udiff-line-modified-removed">-         gssize       len)</span>
<span class="udiff-line-modified-added">+     gssize       len)</span>
  {
    gsize result_len;
    LocaleType locale_type;
    gchar *result;
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1152,11 +1173,11 @@</span>
   * Returns: a newly allocated string, that is a
   *   case independent form of @str.
   **/
  gchar *
  g_utf8_casefold (const gchar *str,
<span class="udiff-line-modified-removed">-          gssize       len)</span>
<span class="udiff-line-modified-added">+      gssize       len)</span>
  {
    GString *result;
    const char *p;
  
    g_return_val_if_fail (str != NULL, NULL);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1170,27 +1191,27 @@</span>
        int start = 0;
        int end = G_N_ELEMENTS (casefold_table);
  
        if (ch &gt;= casefold_table[start].ch &amp;&amp;
            ch &lt;= casefold_table[end - 1].ch)
<span class="udiff-line-added">+   {</span>
<span class="udiff-line-added">+     while (TRUE)</span>
<span class="udiff-line-added">+       {</span>
<span class="udiff-line-added">+         int half = (start + end) / 2;</span>
<span class="udiff-line-added">+         if (ch == casefold_table[half].ch)</span>
      {
<span class="udiff-line-modified-removed">-       while (TRUE)</span>
<span class="udiff-line-modified-removed">-         {</span>
<span class="udiff-line-removed">-           int half = (start + end) / 2;</span>
<span class="udiff-line-removed">-           if (ch == casefold_table[half].ch)</span>
<span class="udiff-line-removed">-         {</span>
<span class="udiff-line-removed">-           g_string_append (result, casefold_table[half].data);</span>
<span class="udiff-line-removed">-           goto next;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-removed">-           else if (half == start)</span>
<span class="udiff-line-removed">-         break;</span>
<span class="udiff-line-removed">-           else if (ch &gt; casefold_table[half].ch)</span>
<span class="udiff-line-removed">-         start = half;</span>
<span class="udiff-line-removed">-           else</span>
<span class="udiff-line-removed">-         end = half;</span>
<span class="udiff-line-removed">-         }</span>
<span class="udiff-line-modified-added">+       g_string_append (result, casefold_table[half].data);</span>
<span class="udiff-line-modified-added">+       goto next;</span>
      }
<span class="udiff-line-added">+         else if (half == start)</span>
<span class="udiff-line-added">+     break;</span>
<span class="udiff-line-added">+         else if (ch &gt; casefold_table[half].ch)</span>
<span class="udiff-line-added">+     start = half;</span>
<span class="udiff-line-added">+         else</span>
<span class="udiff-line-added">+     end = half;</span>
<span class="udiff-line-added">+       }</span>
<span class="udiff-line-added">+   }</span>
  
        g_string_append_unichar (result, g_unichar_tolower (ch));
  
      next:
        p = g_utf8_next_char (p);
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1247,15 +1268,15 @@</span>
  
  
    do
      {
        if (ch &lt; g_script_table[mid].start)
<span class="udiff-line-modified-removed">-     upper = mid - 1;</span>
<span class="udiff-line-modified-added">+   upper = mid - 1;</span>
        else if (ch &gt;= g_script_table[mid].start + g_script_table[mid].chars)
<span class="udiff-line-modified-removed">-     lower = mid + 1;</span>
<span class="udiff-line-modified-added">+   lower = mid + 1;</span>
        else
<span class="udiff-line-modified-removed">-     return g_script_table[saved_mid = mid].script;</span>
<span class="udiff-line-modified-added">+   return g_script_table[saved_mid = mid].script;</span>
  
        mid = (lower + upper) / 2;
      }
    while (lower &lt;= upper);
  
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1419,11 +1440,11 @@</span>
      PACK (&#39;G&#39;,&#39;r&#39;,&#39;a&#39;,&#39;n&#39;), /* G_UNICODE_SCRIPT_GRANTHA */
      PACK (&#39;K&#39;,&#39;h&#39;,&#39;o&#39;,&#39;j&#39;), /* G_UNICODE_SCRIPT_KHOJKI*/
      PACK (&#39;S&#39;,&#39;i&#39;,&#39;n&#39;,&#39;d&#39;), /* G_UNICODE_SCRIPT_KHUDAWADI */
      PACK (&#39;L&#39;,&#39;i&#39;,&#39;n&#39;,&#39;a&#39;), /* G_UNICODE_SCRIPT_LINEAR_A */
      PACK (&#39;M&#39;,&#39;a&#39;,&#39;h&#39;,&#39;j&#39;), /* G_UNICODE_SCRIPT_MAHAJANI */
<span class="udiff-line-modified-removed">-     PACK (&#39;M&#39;,&#39;a&#39;,&#39;n&#39;,&#39;u&#39;), /* G_UNICODE_SCRIPT_MANICHAEAN */</span>
<span class="udiff-line-modified-added">+     PACK (&#39;M&#39;,&#39;a&#39;,&#39;n&#39;,&#39;i&#39;), /* G_UNICODE_SCRIPT_MANICHAEAN */</span>
      PACK (&#39;M&#39;,&#39;e&#39;,&#39;n&#39;,&#39;d&#39;), /* G_UNICODE_SCRIPT_MENDE_KIKAKUI */
      PACK (&#39;M&#39;,&#39;o&#39;,&#39;d&#39;,&#39;i&#39;), /* G_UNICODE_SCRIPT_MODI */
      PACK (&#39;M&#39;,&#39;r&#39;,&#39;o&#39;,&#39;o&#39;), /* G_UNICODE_SCRIPT_MRO */
      PACK (&#39;N&#39;,&#39;b&#39;,&#39;a&#39;,&#39;t&#39;), /* G_UNICODE_SCRIPT_NABATAEAN */
      PACK (&#39;N&#39;,&#39;a&#39;,&#39;r&#39;,&#39;b&#39;), /* G_UNICODE_SCRIPT_OLD_NORTH_ARABIAN */
</pre>
<hr />
<pre>
<span class="line-new-header">@@ -1464,10 +1485,16 @@</span>
      PACK (&#39;R&#39;,&#39;o&#39;,&#39;h&#39;,&#39;g&#39;), /* G_UNICODE_SCRIPT_HANIFI_ROHINGYA */
      PACK (&#39;M&#39;,&#39;a&#39;,&#39;k&#39;,&#39;a&#39;), /* G_UNICODE_SCRIPT_MAKASAR */
      PACK (&#39;M&#39;,&#39;e&#39;,&#39;d&#39;,&#39;f&#39;), /* G_UNICODE_SCRIPT_MEDEFAIDRIN */
      PACK (&#39;S&#39;,&#39;o&#39;,&#39;g&#39;,&#39;o&#39;), /* G_UNICODE_SCRIPT_OLD_SOGDIAN */
      PACK (&#39;S&#39;,&#39;o&#39;,&#39;g&#39;,&#39;d&#39;), /* G_UNICODE_SCRIPT_SOGDIAN */
<span class="udiff-line-added">+ </span>
<span class="udiff-line-added">+   /* Unicode 12.0 additions */</span>
<span class="udiff-line-added">+     PACK (&#39;E&#39;,&#39;l&#39;,&#39;y&#39;,&#39;m&#39;), /* G_UNICODE_SCRIPT_ELYMAIC */</span>
<span class="udiff-line-added">+     PACK (&#39;N&#39;,&#39;a&#39;,&#39;n&#39;,&#39;d&#39;), /* G_UNICODE_SCRIPT_NANDINAGARI */</span>
<span class="udiff-line-added">+     PACK (&#39;H&#39;,&#39;m&#39;,&#39;n&#39;,&#39;p&#39;), /* G_UNICODE_SCRIPT_NYIAKENG_PUACHUE_HMONG */</span>
<span class="udiff-line-added">+     PACK (&#39;W&#39;,&#39;c&#39;,&#39;h&#39;,&#39;o&#39;), /* G_UNICODE_SCRIPT_WANCHO */</span>
  #undef PACK
  };
  
  /**
   * g_unicode_script_to_iso15924:
</pre>
<center><a href="gunidecomp.h.udiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gurifuncs.c.udiff.html" target="_top">next &gt;</a></center>  </body>
</html>