<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gst-plugins-base/gst-libs/gst/video/video-orc.orc</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 .function video_orc_blend_little
   2 .flags 1d
   3 .dest 4 d guint8
   4 .source 4 s guint8
   5 .temp 4 t
   6 .temp 2 tw
   7 .temp 1 tb
   8 .temp 4 a
   9 .temp 8 d_wide
  10 .temp 8 s_wide
  11 .temp 8 a_wide
  12 .const 4 a_alpha 0x000000ff
  13 
  14 loadl t, s
  15 convlw tw, t
  16 convwb tb, tw
  17 splatbl a, tb
  18 x4 convubw a_wide, a
  19 x4 shruw a_wide, a_wide, 8
  20 x4 convubw s_wide, t
  21 loadl t, d
  22 x4 convubw d_wide, t
  23 x4 subw s_wide, s_wide, d_wide
  24 x4 mullw s_wide, s_wide, a_wide
  25 x4 div255w s_wide, s_wide
  26 x4 addw d_wide, d_wide, s_wide
  27 x4 convwb t, d_wide
  28 orl t, t, a_alpha
  29 storel d, t
  30 
  31 .function video_orc_blend_big
  32 .flags 1d
  33 .dest 4 d guint8
  34 .source 4 s guint8
  35 .temp 4 t
  36 .temp 4 t2
  37 .temp 2 tw
  38 .temp 1 tb
  39 .temp 4 a
  40 .temp 8 d_wide
  41 .temp 8 s_wide
  42 .temp 8 a_wide
  43 .const 4 a_alpha 0xff000000
  44 
  45 loadl t, s
  46 shrul t2, t, 24
  47 convlw tw, t2
  48 convwb tb, tw
  49 splatbl a, tb
  50 x4 convubw a_wide, a
  51 x4 shruw a_wide, a_wide, 8
  52 x4 convubw s_wide, t
  53 loadl t, d
  54 x4 convubw d_wide, t
  55 x4 subw s_wide, s_wide, d_wide
  56 x4 mullw s_wide, s_wide, a_wide
  57 x4 div255w s_wide, s_wide
  58 x4 addw d_wide, d_wide, s_wide
  59 x4 convwb t, d_wide
  60 orl t, t, a_alpha
  61 storel d, t
  62 
  63 .function video_orc_unpack_I420
  64 .dest 4 d guint8
  65 .source 1 y guint8
  66 .source 1 u guint8
  67 .source 1 v guint8
  68 .const 1 c255 255
  69 .temp 2 uv
  70 .temp 2 ay
  71 .temp 1 tu
  72 .temp 1 tv
  73 
  74 loadupdb tu, u
  75 loadupdb tv, v
  76 mergebw uv, tu, tv
  77 mergebw ay, c255, y
  78 mergewl d, ay, uv
  79 
  80 
  81 .function video_orc_pack_I420
  82 .dest 2 y guint8
  83 .dest 1 u guint8
  84 .dest 1 v guint8
  85 .source 8 ayuv guint8
  86 .temp 4 ay
  87 .temp 4 uv
  88 .temp 2 uu
  89 .temp 2 vv
  90 .temp 1 t1
  91 .temp 1 t2
  92 
  93 x2 splitlw uv, ay, ayuv
  94 x2 select1wb y, ay
  95 x2 splitwb vv, uu, uv
  96 select0wb u, uu
  97 select0wb v, vv
  98 
  99 .function video_orc_pack_Y
 100 .dest 1 y guint8
 101 .source 4 ayuv guint8
 102 .temp 2 ay
 103 
 104 select0lw ay, ayuv
 105 select1wb y, ay
 106 
 107 .function video_orc_unpack_YUY2
 108 .dest 8 ayuv guint8
 109 .source 4 yuy2 guint8
 110 .const 2 c255 0xff
 111 .temp 2 yy
 112 .temp 2 uv
 113 .temp 4 ayay
 114 .temp 4 uvuv
 115 
 116 x2 splitwb uv, yy, yuy2
 117 x2 mergebw ayay, c255, yy
 118 mergewl uvuv, uv, uv
 119 x2 mergewl ayuv, ayay, uvuv
 120 
 121 
 122 .function video_orc_pack_YUY2
 123 .dest 4 yuy2 guint8
 124 .source 8 ayuv guint8
 125 .temp 2 yy
 126 .temp 2 uv
 127 .temp 4 ayay
 128 .temp 4 uvuv
 129 
 130 x2 splitlw uvuv, ayay, ayuv
 131 select0lw uv, uvuv
 132 x2 select1wb yy, ayay
 133 x2 mergebw yuy2, yy, uv
 134 
 135 
 136 .function video_orc_pack_UYVY
 137 .dest 4 yuy2 guint8
 138 .source 8 ayuv guint8
 139 .temp 2 yy
 140 .temp 2 uv
 141 .temp 4 ayay
 142 .temp 4 uvuv
 143 
 144 x2 splitlw uvuv, ayay, ayuv
 145 select0lw uv, uvuv
 146 x2 select1wb yy, ayay
 147 x2 mergebw yuy2, uv, yy
 148 
 149 
 150 .function video_orc_unpack_UYVY
 151 .dest 8 ayuv guint8
 152 .source 4 uyvy guint8
 153 .const 2 c255 0xff
 154 .temp 2 yy
 155 .temp 2 uv
 156 .temp 4 ayay
 157 .temp 4 uvuv
 158 
 159 x2 splitwb yy, uv, uyvy
 160 x2 mergebw ayay, c255, yy
 161 mergewl uvuv, uv, uv
 162 x2 mergewl ayuv, ayay, uvuv
 163 
 164 
 165 .function video_orc_pack_VYUY
 166 .dest 4 vyuy guint8
 167 .source 8 ayuv guint8
 168 .temp 2 yy
 169 .temp 2 vu
 170 .temp 4 ayay
 171 .temp 4 uvuv
 172 
 173 x2 splitlw uvuv, ayay, ayuv
 174 select0lw vu, uvuv
 175 x2 select1wb yy, ayay
 176 swapw vu, vu
 177 x2 mergebw vyuy, vu, yy
 178 
 179 
 180 .function video_orc_unpack_VYUY
 181 .dest 8 ayuv guint8
 182 .source 4 vyuy guint8
 183 .const 2 c255 0xff
 184 .temp 2 yy
 185 .temp 2 uv
 186 .temp 4 ayay
 187 .temp 4 uvuv
 188 
 189 x2 splitwb yy, uv, vyuy
 190 swapw uv, uv
 191 x2 mergebw ayay, c255, yy
 192 mergewl uvuv, uv, uv
 193 x2 mergewl ayuv, ayay, uvuv
 194 
 195 
 196 .function video_orc_unpack_YVYU
 197 .dest 8 ayuv guint8
 198 .source 4 uyvy guint8
 199 .const 2 c255 0xff
 200 .temp 2 yy
 201 .temp 2 uv
 202 .temp 4 ayay
 203 .temp 4 uvuv
 204 
 205 x2 splitwb uv, yy, uyvy
 206 swapw uv, uv
 207 x2 mergebw ayay, c255, yy
 208 mergewl uvuv, uv, uv
 209 x2 mergewl ayuv, ayay, uvuv
 210 
 211 
 212 .function video_orc_pack_YVYU
 213 .dest 4 yuy2 guint8
 214 .source 8 ayuv guint8
 215 .temp 2 yy
 216 .temp 2 uv
 217 .temp 4 ayay
 218 .temp 4 uvuv
 219 
 220 x2 splitlw uvuv, ayay, ayuv
 221 select0lw uv, uvuv
 222 x2 select1wb yy, ayay
 223 swapw uv, uv
 224 x2 mergebw yuy2, yy, uv
 225 
 226 
 227 .function video_orc_unpack_YUV9
 228 .dest 8 d guint8
 229 .source 2 y guint8
 230 .source 1 u guint8
 231 .source 1 v guint8
 232 .const 1 c255 255
 233 .temp 2 tuv
 234 .temp 4 ay
 235 .temp 4 uv
 236 .temp 1 tu
 237 .temp 1 tv
 238 
 239 loadupdb tu, u
 240 loadupdb tv, v
 241 mergebw tuv, tu, tv
 242 mergewl uv, tuv, tuv
 243 x2 mergebw ay, c255, y
 244 x2 mergewl d, ay, uv
 245 
 246 
 247 .function video_orc_unpack_Y42B
 248 .dest 8 ayuv guint8
 249 .source 2 yy guint8
 250 .source 1 u guint8
 251 .source 1 v guint8
 252 .const 1 c255 255
 253 .temp 2 uv
 254 .temp 2 ay
 255 .temp 4 uvuv
 256 .temp 4 ayay
 257 
 258 mergebw uv, u, v
 259 x2 mergebw ayay, c255, yy
 260 mergewl uvuv, uv, uv
 261 x2 mergewl ayuv, ayay, uvuv
 262 
 263 .function video_orc_pack_Y42B
 264 .dest 2 y guint8
 265 .dest 1 u guint8
 266 .dest 1 v guint8
 267 .source 8 ayuv guint8
 268 .temp 4 ayay
 269 .temp 4 uvuv
 270 .temp 2 uv
 271 
 272 x2 splitlw uvuv, ayay, ayuv
 273 select0lw uv, uvuv
 274 splitwb v, u, uv
 275 x2 select1wb y, ayay
 276 
 277 
 278 .function video_orc_unpack_Y444
 279 .dest 4 ayuv guint8
 280 .source 1 y guint8
 281 .source 1 u guint8
 282 .source 1 v guint8
 283 .const 1 c255 255
 284 .temp 2 uv
 285 .temp 2 ay
 286 
 287 mergebw uv, u, v
 288 mergebw ay, c255, y
 289 mergewl ayuv, ay, uv
 290 
 291 
 292 .function video_orc_pack_Y444
 293 .dest 1 y guint8
 294 .dest 1 u guint8
 295 .dest 1 v guint8
 296 .source 4 ayuv guint8
 297 .temp 2 ay
 298 .temp 2 uv
 299 
 300 splitlw uv, ay, ayuv
 301 splitwb v, u, uv
 302 select1wb y, ay
 303 
 304 .function video_orc_unpack_GRAY8
 305 .dest 4 ayuv guint8
 306 .source 1 y guint8
 307 .const 1 c255 255
 308 .const 2 c0x8080 0x8080
 309 .temp 2 ay
 310 
 311 mergebw ay, c255, y
 312 mergewl ayuv, ay, c0x8080
 313 
 314 
 315 .function video_orc_pack_GRAY8
 316 .dest 1 y guint8
 317 .source 4 ayuv guint8
 318 .temp 2 ay
 319 
 320 select0lw ay, ayuv
 321 select1wb y, ay
 322 
 323 
 324 .function video_orc_unpack_BGRA
 325 .dest 4 argb guint8
 326 .source 4 bgra guint8
 327 
 328 swapl argb, bgra
 329 
 330 .function video_orc_pack_BGRA
 331 .dest 4 bgra guint8
 332 .source 4 argb guint8
 333 
 334 swapl bgra, argb
 335 
 336 .function video_orc_pack_RGBA_le
 337 .dest 4 rgba guint8
 338 .source 4 argb guint8
 339 .temp 4 a
 340 .temp 4 r
 341 
 342 loadl r, argb
 343 shrul a, r, 8
 344 shll r, r, 24
 345 orl rgba, r, a
 346 
 347 .function video_orc_unpack_RGBA_le
 348 .dest 4 argb guint8
 349 .source 4 rgba guint8
 350 .temp 4 a
 351 .temp 4 r
 352 
 353 loadl r, rgba
 354 shll a, r, 8
 355 shrul r, r, 24
 356 orl argb, r, a
 357 
 358 .function video_orc_pack_RGBA_be
 359 .dest 4 rgba guint8
 360 .source 4 argb guint8
 361 .temp 4 a
 362 .temp 4 r
 363 
 364 loadl r, argb
 365 shrul a, r, 24
 366 shll r, r, 8
 367 orl rgba, r, a
 368 
 369 .function video_orc_unpack_RGBA_be
 370 .dest 4 argb guint8
 371 .source 4 rgba guint8
 372 .temp 4 a
 373 .temp 4 r
 374 
 375 loadl r, rgba
 376 shll a, r, 24
 377 shrul r, r, 8
 378 orl argb, r, a
 379 
 380 
 381 .function video_orc_unpack_ABGR_le
 382 .dest 4 argb guint8
 383 .source 4 abgr guint8
 384 .temp 4 a
 385 .temp 4 r
 386 
 387 swapl r, abgr
 388 shll a, r, 8
 389 shrul r, r, 24
 390 orl argb, r, a
 391 
 392 .function video_orc_pack_ABGR_le
 393 .dest 4 abgr guint8
 394 .source 4 argb guint8
 395 .temp 4 a
 396 .temp 4 r
 397 
 398 swapl r, argb
 399 shll a, r, 8
 400 shrul r, r, 24
 401 orl abgr, r, a
 402 
 403 .function video_orc_unpack_ABGR_be
 404 .dest 4 argb guint8
 405 .source 4 abgr guint8
 406 .temp 4 a
 407 .temp 4 r
 408 
 409 swapl r, abgr
 410 shll a, r, 24
 411 shrul r, r, 8
 412 orl argb, r, a
 413 
 414 .function video_orc_pack_ABGR_be
 415 .dest 4 abgr guint8
 416 .source 4 argb guint8
 417 .temp 4 a
 418 .temp 4 r
 419 
 420 swapl r, argb
 421 shll a, r, 24
 422 shrul r, r, 8
 423 orl abgr, r, a
 424 
 425 
 426 .function video_orc_unpack_NV12
 427 .dest 8 d guint8
 428 .source 2 y guint8
 429 .source 2 uv guint8
 430 .const 1 c255 255
 431 .temp 4 ay
 432 .temp 4 uvuv
 433 
 434 mergewl uvuv, uv, uv
 435 x2 mergebw ay, c255, y
 436 x2 mergewl d, ay, uvuv
 437 
 438 .function video_orc_pack_NV12
 439 .dest 2 y guint8
 440 .dest 2 uv guint8
 441 .source 8 ayuv guint8
 442 .temp 4 ay
 443 .temp 4 uvuv
 444 
 445 x2 splitlw uvuv, ay, ayuv
 446 x2 select1wb y, ay
 447 select0lw uv, uvuv
 448 
 449 .function video_orc_unpack_NV21
 450 .dest 8 d guint8
 451 .source 2 y guint8
 452 .source 2 vu guint8
 453 .const 1 c255 255
 454 .temp 2 uv
 455 .temp 4 ay
 456 .temp 4 uvuv
 457 
 458 swapw uv, vu
 459 mergewl uvuv, uv, uv
 460 x2 mergebw ay, c255, y
 461 x2 mergewl d, ay, uvuv
 462 
 463 
 464 .function video_orc_pack_NV21
 465 .dest 2 y guint8
 466 .dest 2 vu guint8
 467 .source 8 ayuv guint8
 468 .temp 4 ay
 469 .temp 4 uvuv
 470 .temp 2 uv
 471 
 472 x2 splitlw uvuv, ay, ayuv
 473 x2 select1wb y, ay
 474 select0lw uv, uvuv
 475 swapw vu, uv
 476 
 477 .function video_orc_unpack_NV24
 478 .dest 4 d guint8
 479 .source 1 y guint8
 480 .source 2 uv guint8
 481 .const 1 c255 255
 482 .temp 2 ay
 483 
 484 mergebw ay, c255, y
 485 mergewl d, ay, uv
 486 
 487 .function video_orc_pack_NV24
 488 .dest 1 y guint8
 489 .dest 2 uv guint8
 490 .source 4 ayuv guint8
 491 .temp 2 ay
 492 
 493 splitlw uv, ay, ayuv
 494 select1wb y, ay
 495 
 496 .function video_orc_unpack_A420
 497 .dest 4 d guint8
 498 .source 1 y guint8
 499 .source 1 u guint8
 500 .source 1 v guint8
 501 .source 1 a guint8
 502 .temp 2 uv
 503 .temp 2 ay
 504 .temp 1 tu
 505 .temp 1 tv
 506 
 507 loadupdb tu, u
 508 loadupdb tv, v
 509 mergebw uv, tu, tv
 510 mergebw ay, a, y
 511 mergewl d, ay, uv
 512 
 513 .function video_orc_pack_A420
 514 .dest 2 y guint8
 515 .dest 1 u guint8
 516 .dest 1 v guint8
 517 .dest 2 a guint8
 518 .source 8 ayuv guint8
 519 .temp 4 ay
 520 .temp 4 uv
 521 .temp 2 uu
 522 .temp 2 vv
 523 
 524 x2 splitlw uv, ay, ayuv
 525 x2 select1wb y, ay
 526 x2 select0wb a, ay
 527 x2 splitwb vv, uu, uv
 528 select0wb u, uu
 529 select0wb v, vv
 530 
 531 .function video_orc_pack_AY
 532 .dest 1 y guint8
 533 .dest 1 a guint8
 534 .source 4 ayuv guint8
 535 .temp 2 ay
 536 
 537 select0lw ay, ayuv
 538 select1wb y, ay
 539 select0wb a, ay
 540 
 541 
 542 .function video_orc_unpack_VUYA
 543 .dest 4 ayuv guint8
 544 .source 4 vuya guint8
 545 
 546 swapl ayuv, vuya
 547 
 548 
 549 .function video_orc_pack_VUYA
 550 .dest 4 vuya guint8
 551 .source 4 ayuv guint8
 552 
 553 swapl vuya, ayuv
 554 
 555 .function video_orc_unpack_RGB15_le
 556 .dest 4 argb guint32
 557 .source 2 rgb15 guint16
 558 .temp 2 t
 559 .temp 2 r
 560 .temp 2 g
 561 .temp 2 b
 562 .temp 4 ag
 563 .temp 4 rb
 564 
 565 loadw t, rgb15
 566 andw r, t, 0x7c00
 567 andw g, t, 0x03e0
 568 andw b, t, 0x001f
 569 shlw b, b, 5
 570 mulhsw r, r, 0x0210
 571 mulhsw g, g, 0x4200
 572 mulhsw b, b, 0x4200
 573 mergewl ag, 0xff, g
 574 mergewl rb, r, b
 575 shll rb, rb, 8
 576 orl argb, ag, rb
 577 
 578 .function video_orc_unpack_RGB15_be
 579 .dest 4 argb guint32
 580 .source 2 rgb15 guint16
 581 .temp 2 t
 582 .temp 2 r
 583 .temp 2 g
 584 .temp 2 b
 585 .temp 4 ag
 586 .temp 4 rb
 587 
 588 loadw t, rgb15
 589 andw r, t, 0x7c00
 590 andw g, t, 0x03e0
 591 andw b, t, 0x001f
 592 shlw b, b, 5
 593 mulhsw r, r, 0x0210
 594 mulhsw g, g, 0x4200
 595 mulhsw b, b, 0x4200
 596 mergewl ag, 0xff, g
 597 mergewl rb, r, b
 598 shll ag, ag, 8
 599 orl argb, ag, rb
 600 
 601 .function video_orc_unpack_RGB15_le_trunc
 602 .dest 4 argb guint32
 603 .source 2 rgb15 guint16
 604 .temp 2 t
 605 .temp 2 r
 606 .temp 2 g
 607 .temp 2 b
 608 .temp 4 ag
 609 .temp 4 rb
 610 
 611 loadw t, rgb15
 612 andw r, t, 0x7c00
 613 andw g, t, 0x03e0
 614 andw b, t, 0x001f
 615 shruw r, r, 7
 616 shruw g, g, 2
 617 shlw b, b, 3
 618 mergewl ag, 0xff, g
 619 mergewl rb, r, b
 620 shll rb, rb, 8
 621 orl argb, ag, rb
 622 
 623 .function video_orc_unpack_RGB15_be_trunc
 624 .dest 4 argb guint32
 625 .source 2 rgb15 guint16
 626 .temp 2 t
 627 .temp 2 r
 628 .temp 2 g
 629 .temp 2 b
 630 .temp 4 ag
 631 .temp 4 rb
 632 
 633 loadw t, rgb15
 634 andw r, t, 0x7c00
 635 andw g, t, 0x03e0
 636 andw b, t, 0x001f
 637 shruw r, r, 7
 638 shruw g, g, 2
 639 shlw b, b, 3
 640 mergewl ag, 0xff, g
 641 mergewl rb, r, b
 642 shll ag, ag, 8
 643 orl argb, ag, rb
 644 
 645 .function video_orc_pack_RGB15_le
 646 .dest 2 rgb15 guint16
 647 .source 4 argb guint32
 648 .temp 4 t
 649 .temp 4 r
 650 .temp 4 g
 651 .temp 4 b
 652 .temp 4 t2
 653 
 654 loadl t, argb
 655 andl r, t, 0xf800
 656 andl g, t, 0xf80000
 657 andl b, t, 0xf8000000
 658 shrul r, r, 1
 659 shrul g, g, 14
 660 shrul b, b, 27
 661 orl t2, r, g
 662 orl t2, t2, b
 663 select0lw rgb15, t2
 664 
 665 .function video_orc_pack_RGB15_be
 666 .dest 2 rgb15 guint16
 667 .source 4 argb guint32
 668 .temp 4 t
 669 .temp 4 r
 670 .temp 4 g
 671 .temp 4 b
 672 .temp 4 t2
 673 
 674 loadl t, argb
 675 andl r, t, 0xf80000
 676 andl g, t, 0xf800
 677 andl b, t, 0xf8
 678 shrul r, r, 9
 679 shrul g, g, 6
 680 shrul b, b, 3
 681 orl t2, r, g
 682 orl t2, t2, b
 683 select1lw rgb15, t2
 684 
 685 .function video_orc_unpack_BGR15_le
 686 .dest 4 argb guint32
 687 .source 2 bgr15 guint16
 688 .temp 2 t
 689 .temp 2 r
 690 .temp 2 g
 691 .temp 2 b
 692 .temp 4 ag
 693 .temp 4 rb
 694 
 695 loadw t, bgr15
 696 andw b, t, 0x7c00
 697 andw g, t, 0x03e0
 698 andw r, t, 0x001f
 699 shlw r, r, 5
 700 mulhsw b, b, 0x0210
 701 mulhsw g, g, 0x4200
 702 mulhsw r, r, 0x4200
 703 mergewl ag, 0xff, g
 704 mergewl rb, r, b
 705 shll rb, rb, 8
 706 orl argb, ag, rb
 707 
 708 .function video_orc_unpack_BGR15_be
 709 .dest 4 argb guint32
 710 .source 2 bgr15 guint16
 711 .temp 2 t
 712 .temp 2 r
 713 .temp 2 g
 714 .temp 2 b
 715 .temp 4 ag
 716 .temp 4 rb
 717 
 718 loadw t, bgr15
 719 andw b, t, 0x7c00
 720 andw g, t, 0x03e0
 721 andw r, t, 0x001f
 722 shlw r, r, 5
 723 mulhsw b, b, 0x0210
 724 mulhsw g, g, 0x4200
 725 mulhsw r, r, 0x4200
 726 mergewl ag, 0xff, g
 727 mergewl rb, r, b
 728 shll ag, ag, 8
 729 orl argb, ag, rb
 730 
 731 .function video_orc_unpack_BGR15_le_trunc
 732 .dest 4 argb guint32
 733 .source 2 bgr15 guint16
 734 .temp 2 t
 735 .temp 2 r
 736 .temp 2 g
 737 .temp 2 b
 738 .temp 4 ag
 739 .temp 4 rb
 740 
 741 loadw t, bgr15
 742 andw b, t, 0x7c00
 743 andw g, t, 0x03e0
 744 andw r, t, 0x001f
 745 shruw b, b, 7
 746 shruw g, g, 2
 747 shlw r, r, 3
 748 mergewl ag, 0xff, g
 749 mergewl rb, r, b
 750 shll rb, rb, 8
 751 orl argb, ag, rb
 752 
 753 .function video_orc_unpack_BGR15_be_trunc
 754 .dest 4 argb guint32
 755 .source 2 bgr15 guint16
 756 .temp 2 t
 757 .temp 2 r
 758 .temp 2 g
 759 .temp 2 b
 760 .temp 4 ag
 761 .temp 4 rb
 762 
 763 loadw t, bgr15
 764 andw b, t, 0x7c00
 765 andw g, t, 0x03e0
 766 andw r, t, 0x001f
 767 shruw b, b, 7
 768 shruw g, g, 2
 769 shlw r, r, 3
 770 mergewl ag, 0xff, g
 771 mergewl rb, r, b
 772 shll ag, ag, 8
 773 orl argb, ag, rb
 774 
 775 .function video_orc_pack_BGR15_le
 776 .dest 2 rgb15 guint16
 777 .source 4 argb guint32
 778 .temp 4 t
 779 .temp 4 r
 780 .temp 4 g
 781 .temp 4 b
 782 .temp 4 t2
 783 
 784 loadl t, argb
 785 andl r, t, 0xf800
 786 andl g, t, 0xf80000
 787 andl b, t, 0xf8000000
 788 shrul b, b, 17
 789 shrul g, g, 14
 790 shrul r, r, 11
 791 orl t2, r, g
 792 orl t2, t2, b
 793 select0lw rgb15, t2
 794 
 795 .function video_orc_pack_BGR15_be
 796 .dest 2 rgb15 guint16
 797 .source 4 argb guint32
 798 .temp 4 t
 799 .temp 4 r
 800 .temp 4 g
 801 .temp 4 b
 802 .temp 4 t2
 803 
 804 loadl t, argb
 805 andl r, t, 0xf80000
 806 andl g, t, 0xf800
 807 andl b, t, 0xf8
 808 shll b, b, 7
 809 shrul g, g, 6
 810 shrul r, r, 19
 811 orl t2, r, g
 812 orl t2, t2, b
 813 select1lw rgb15, t2
 814 
 815 .function video_orc_unpack_RGB16
 816 .dest 4 argb guint32
 817 .source 2 rgb16 guint16
 818 .temp 2 t
 819 .temp 2 r
 820 .temp 2 g
 821 .temp 2 b
 822 .temp 4 ar
 823 .temp 4 gb
 824 .temp 8 t2
 825 
 826 loadw t, rgb16
 827 andw r, t, 0xf800
 828 andw g, t, 0x07e0
 829 andw b, t, 0x001f
 830 shruw r, r, 6
 831 shlw b, b, 5
 832 mulhsw r, r, 0x4200
 833 mulhsw g, g, 0x2080
 834 mulhsw b, b, 0x4200
 835 mergewl ar, 0xff, r
 836 mergewl gb, g, b
 837 mergelq t2, ar, gb
 838 x4 convsuswb argb, t2
 839 
 840 .function video_orc_unpack_RGB16_trunc
 841 .dest 4 argb guint32
 842 .source 2 rgb16 guint16
 843 .temp 2 t
 844 .temp 2 r
 845 .temp 2 g
 846 .temp 2 b
 847 .temp 4 ar
 848 .temp 4 gb
 849 .temp 8 t2
 850 
 851 loadw t, rgb16
 852 andw r, t, 0xf800
 853 andw g, t, 0x07e0
 854 andw b, t, 0x001f
 855 shruw r, r, 8
 856 shruw g, g, 3
 857 shlw b, b, 3
 858 mergewl ar, 0xff, r
 859 mergewl gb, g, b
 860 mergelq t2, ar, gb
 861 x4 convsuswb argb, t2
 862 
 863 .function video_orc_pack_RGB16_le
 864 .dest 2 rgb15 guint16
 865 .source 4 argb guint32
 866 .temp 4 t
 867 .temp 4 r
 868 .temp 4 g
 869 .temp 4 b
 870 .temp 4 t2
 871 
 872 loadl t, argb
 873 andl r, t, 0xf800
 874 andl g, t, 0xfc0000
 875 andl b, t, 0xf8000000
 876 shrul g, g, 13
 877 shrul b, b, 27
 878 orl t2, r, g
 879 orl t2, t2, b
 880 select0lw rgb15, t2
 881 
 882 .function video_orc_pack_RGB16_be
 883 .dest 2 rgb16 guint16
 884 .source 4 argb guint32
 885 .temp 4 t
 886 .temp 4 r
 887 .temp 4 g
 888 .temp 4 b
 889 .temp 4 t2
 890 
 891 loadl t, argb
 892 andl r, t, 0xf80000
 893 andl g, t, 0xfc00
 894 andl b, t, 0xf8
 895 shrul r, r, 8
 896 shrul g, g, 5
 897 shrul b, b, 3
 898 orl t2, r, g
 899 orl t2, t2, b
 900 select1lw rgb16, t2
 901 
 902 .function video_orc_unpack_BGR16
 903 .dest 4 argb guint32
 904 .source 2 bgr16 guint16
 905 .temp 2 t
 906 .temp 2 r
 907 .temp 2 g
 908 .temp 2 b
 909 .temp 4 ar
 910 .temp 4 gb
 911 .temp 8 t2
 912 
 913 loadw t, bgr16
 914 andw b, t, 0xf800
 915 andw g, t, 0x07e0
 916 andw r, t, 0x001f
 917 shruw b, b, 6
 918 shlw r, r, 5
 919 mulhsw b, b, 0x4200
 920 mulhsw g, g, 0x2080
 921 mulhsw r, r, 0x4200
 922 mergewl ar, 0xff, r
 923 mergewl gb, g, b
 924 mergelq t2, ar, gb
 925 x4 convsuswb argb, t2
 926 
 927 .function video_orc_unpack_BGR16_trunc
 928 .dest 4 argb guint32
 929 .source 2 bgr16 guint16
 930 .temp 2 t
 931 .temp 2 r
 932 .temp 2 g
 933 .temp 2 b
 934 .temp 4 ar
 935 .temp 4 gb
 936 .temp 8 t2
 937 
 938 loadw t, bgr16
 939 andw b, t, 0xf800
 940 andw g, t, 0x07e0
 941 andw r, t, 0x001f
 942 shruw b, b, 8
 943 shruw g, g, 3
 944 shlw r, r, 3
 945 mergewl ar, 0xff, r
 946 mergewl gb, g, b
 947 mergelq t2, ar, gb
 948 x4 convsuswb argb, t2
 949 
 950 .function video_orc_pack_BGR16_le
 951 .dest 2 rgb15 guint16
 952 .source 4 argb guint32
 953 .temp 4 t
 954 .temp 4 r
 955 .temp 4 g
 956 .temp 4 b
 957 .temp 4 t2
 958 
 959 loadl t, argb
 960 andl r, t, 0xf800
 961 andl g, t, 0xfc0000
 962 andl b, t, 0xf8000000
 963 shrul r, r, 11
 964 shrul g, g, 13
 965 shrul b, b, 16
 966 orl t2, r, g
 967 orl t2, t2, b
 968 select0lw rgb15, t2
 969 
 970 .function video_orc_pack_BGR16_be
 971 .dest 2 rgb15 guint16
 972 .source 4 argb guint32
 973 .temp 4 t
 974 .temp 4 r
 975 .temp 4 g
 976 .temp 4 b
 977 .temp 4 t2
 978 
 979 loadl t, argb
 980 andl r, t, 0xf80000
 981 andl g, t, 0xfc00
 982 andl b, t, 0xf8
 983 shll b, b, 8
 984 shrul g, g, 5
 985 shrul r, r, 19
 986 orl t2, r, g
 987 orl t2, t2, b
 988 select1lw rgb15, t2
 989 
 990 .function video_orc_resample_bilinear_u32
 991 .dest 4 d1 guint8
 992 .source 4 s1 guint8
 993 .param 4 p1
 994 .param 4 p2
 995 
 996 ldreslinl d1, s1, p1, p2
 997 
 998 .function video_orc_merge_linear_u8
 999 .dest 1 d1
1000 .source 1 s1
1001 .source 1 s2
1002 .param 1 p1
1003 .temp 2 t1
1004 .temp 2 t2
1005 .temp 1 a
1006 .temp 1 t
1007 
1008 loadb a, s1
1009 convubw t1, s1
1010 convubw t2, s2
1011 subw t2, t2, t1
1012 mullw t2, t2, p1
1013 addw t2, t2, 128
1014 convhwb t, t2
1015 addb d1, t, a
1016 
1017 
1018 .function video_orc_memset_2d
1019 .flags 2d
1020 .dest 1 d1 guint8
1021 .param 1 p1
1022 
1023 storeb d1, p1
1024 
1025 .function video_orc_memcpy_2d
1026 .flags 2d
1027 .dest 1 d1 guint8
1028 .source 1 s1 guint8
1029 
1030 copyb d1, s1
1031 
1032 .function video_orc_convert_u16_to_u8
1033 .source 2 s guint16
1034 .dest 1 d guint8
1035 
1036 convhwb d, s
1037 
1038 .function video_orc_convert_u8_to_u16
1039 .source 1 s guint8
1040 .dest 2 d guint16
1041 
1042 mergebw d, s, s
1043 
1044 .function video_orc_splat_u16
1045 .dest 2 d1 guint8
1046 .param 2 p1
1047 
1048 storew d1, p1
1049 
1050 .function video_orc_splat_u32
1051 .dest 4 d1 guint8
1052 .param 4 p1
1053 
1054 storel d1, p1
1055 
1056 .function video_orc_splat_u64
1057 .dest 8 d1 guint8
1058 .longparam 8 p1
1059 
1060 storeq d1, p1
1061 
1062 .function video_orc_splat2_u64
1063 .dest 8 d1 guint8
1064 .param 4 p1
1065 .temp 4 p
1066 
1067 loadpl p, p1
1068 x4 mergebw d1, p, p
1069 
1070 .function video_orc_convert_I420_UYVY
1071 .dest 4 d1 guint8
1072 .dest 4 d2 guint8
1073 .source 2 y1 guint8
1074 .source 2 y2 guint8
1075 .source 1 u guint8
1076 .source 1 v guint8
1077 .temp 2 uv
1078 
1079 mergebw uv, u, v
1080 x2 mergebw d1, uv, y1
1081 x2 mergebw d2, uv, y2
1082 
1083 
1084 .function video_orc_convert_I420_YUY2
1085 .dest 4 d1 guint8
1086 .dest 4 d2 guint8
1087 .source 2 y1 guint8
1088 .source 2 y2 guint8
1089 .source 1 u guint8
1090 .source 1 v guint8
1091 .temp 2 uv
1092 
1093 mergebw uv, u, v
1094 x2 mergebw d1, y1, uv
1095 x2 mergebw d2, y2, uv
1096 
1097 
1098 
1099 .function video_orc_convert_I420_AYUV
1100 .dest 4 d1 guint8
1101 .dest 4 d2 guint8
1102 .source 1 y1 guint8
1103 .source 1 y2 guint8
1104 .source 1 u guint8
1105 .source 1 v guint8
1106 .param 1 alpha
1107 .temp 2 uv
1108 .temp 2 ay
1109 .temp 1 tu
1110 .temp 1 tv
1111 
1112 loadupdb tu, u
1113 loadupdb tv, v
1114 mergebw uv, tu, tv
1115 mergebw ay, alpha, y1
1116 mergewl d1, ay, uv
1117 mergebw ay, alpha, y2
1118 mergewl d2, ay, uv
1119 
1120 
1121 .function video_orc_convert_YUY2_I420
1122 .dest 2 y1 guint8
1123 .dest 2 y2 guint8
1124 .dest 1 u guint8
1125 .dest 1 v guint8
1126 .source 4 yuv1 guint8
1127 .source 4 yuv2 guint8
1128 .temp 2 t1
1129 .temp 2 t2
1130 .temp 2 ty
1131 
1132 x2 splitwb t1, ty, yuv1
1133 storew y1, ty
1134 x2 splitwb t2, ty, yuv2
1135 storew y2, ty
1136 x2 avgub t1, t1, t2
1137 splitwb v, u, t1
1138 
1139 
1140 .function video_orc_convert_UYVY_YUY2
1141 .flags 2d
1142 .dest 4 yuy2 guint8
1143 .source 4 uyvy guint8
1144 
1145 x2 swapw yuy2, uyvy
1146 
1147 
1148 .function video_orc_planar_chroma_420_422
1149 .flags 2d
1150 .dest 1 d1 guint8
1151 .dest 1 d2 guint8
1152 .source 1 s guint8
1153 
1154 copyb d1, s
1155 copyb d2, s
1156 
1157 
1158 .function video_orc_planar_chroma_420_444
1159 .flags 2d
1160 .dest 2 d1 guint8
1161 .dest 2 d2 guint8
1162 .source 1 s guint8
1163 .temp 2 t
1164 
1165 splatbw t, s
1166 storew d1, t
1167 storew d2, t
1168 
1169 
1170 .function video_orc_planar_chroma_422_444
1171 .flags 2d
1172 .dest 2 d1 guint8
1173 .source 1 s guint8
1174 .temp 2 t
1175 
1176 splatbw t, s
1177 storew d1, t
1178 
1179 
1180 .function video_orc_planar_chroma_444_422
1181 .flags 2d
1182 .dest 1 d guint8
1183 .source 2 s guint8
1184 .temp 1 t1
1185 .temp 1 t2
1186 
1187 splitwb t1, t2, s
1188 avgub d, t1, t2
1189 
1190 
1191 .function video_orc_planar_chroma_444_420
1192 .flags 2d
1193 .dest 1 d guint8
1194 .source 2 s1 guint8
1195 .source 2 s2 guint8
1196 .temp 2 t
1197 .temp 1 t1
1198 .temp 1 t2
1199 
1200 x2 avgub t, s1, s2
1201 splitwb t1, t2, t
1202 avgub d, t1, t2
1203 
1204 
1205 .function video_orc_planar_chroma_422_420
1206 .flags 2d
1207 .dest 1 d guint8
1208 .source 1 s1 guint8
1209 .source 1 s2 guint8
1210 
1211 avgub d, s1, s2
1212 
1213 
1214 .function video_orc_convert_YUY2_AYUV
1215 .flags 2d
1216 .dest 8 ayuv guint8
1217 .source 4 yuy2 guint8
1218 .param 1 alpha
1219 .temp 2 yy
1220 .temp 2 uv
1221 .temp 4 ayay
1222 .temp 4 uvuv
1223 
1224 x2 splitwb uv, yy, yuy2
1225 x2 mergebw ayay, alpha, yy
1226 mergewl uvuv, uv, uv
1227 x2 mergewl ayuv, ayay, uvuv
1228 
1229 
1230 .function video_orc_convert_UYVY_AYUV
1231 .flags 2d
1232 .dest 8 ayuv guint8
1233 .source 4 uyvy guint8
1234 .param 1 alpha
1235 .temp 2 yy
1236 .temp 2 uv
1237 .temp 4 ayay
1238 .temp 4 uvuv
1239 
1240 x2 splitwb yy, uv, uyvy
1241 x2 mergebw ayay, alpha, yy
1242 mergewl uvuv, uv, uv
1243 x2 mergewl ayuv, ayay, uvuv
1244 
1245 
1246 .function video_orc_convert_YUY2_Y42B
1247 .flags 2d
1248 .dest 2 y guint8
1249 .dest 1 u guint8
1250 .dest 1 v guint8
1251 .source 4 yuy2 guint8
1252 .temp 2 uv
1253 
1254 x2 splitwb uv, y, yuy2
1255 splitwb v, u, uv
1256 
1257 
1258 .function video_orc_convert_UYVY_Y42B
1259 .flags 2d
1260 .dest 2 y guint8
1261 .dest 1 u guint8
1262 .dest 1 v guint8
1263 .source 4 uyvy guint8
1264 .temp 2 uv
1265 
1266 x2 splitwb y, uv, uyvy
1267 splitwb v, u, uv
1268 
1269 
1270 .function video_orc_convert_YUY2_Y444
1271 .flags 2d
1272 .dest 2 y guint8
1273 .dest 2 uu guint8
1274 .dest 2 vv guint8
1275 .source 4 yuy2 guint8
1276 .temp 2 uv
1277 .temp 1 u
1278 .temp 1 v
1279 
1280 x2 splitwb uv, y, yuy2
1281 splitwb v, u, uv
1282 splatbw uu, u
1283 splatbw vv, v
1284 
1285 
1286 .function video_orc_convert_UYVY_Y444
1287 .flags 2d
1288 .dest 2 y guint8
1289 .dest 2 uu guint8
1290 .dest 2 vv guint8
1291 .source 4 uyvy guint8
1292 .temp 2 uv
1293 .temp 1 u
1294 .temp 1 v
1295 
1296 x2 splitwb y, uv, uyvy
1297 splitwb v, u, uv
1298 splatbw uu, u
1299 splatbw vv, v
1300 
1301 
1302 .function video_orc_convert_UYVY_I420
1303 .dest 2 y1 guint8
1304 .dest 2 y2 guint8
1305 .dest 1 u guint8
1306 .dest 1 v guint8
1307 .source 4 yuv1 guint8
1308 .source 4 yuv2 guint8
1309 .temp 2 t1
1310 .temp 2 t2
1311 .temp 2 ty
1312 
1313 x2 splitwb ty, t1, yuv1
1314 storew y1, ty
1315 x2 splitwb ty, t2, yuv2
1316 storew y2, ty
1317 x2 avgub t1, t1, t2
1318 splitwb v, u, t1
1319 
1320 
1321 
1322 .function video_orc_convert_AYUV_I420
1323 .flags 2d
1324 .dest 2 y1 guint8
1325 .dest 2 y2 guint8
1326 .dest 1 u guint8
1327 .dest 1 v guint8
1328 .source 8 ayuv1 guint8
1329 .source 8 ayuv2 guint8
1330 .temp 4 ay
1331 .temp 4 uv1
1332 .temp 4 uv2
1333 .temp 4 uv
1334 .temp 2 uu
1335 .temp 2 vv
1336 .temp 1 t1
1337 .temp 1 t2
1338 
1339 x2 splitlw uv1, ay, ayuv1
1340 x2 select1wb y1, ay
1341 x2 splitlw uv2, ay, ayuv2
1342 x2 select1wb y2, ay
1343 x4 avgub uv, uv1, uv2
1344 x2 splitwb vv, uu, uv
1345 splitwb t1, t2, uu
1346 avgub u, t1, t2
1347 splitwb t1, t2, vv
1348 avgub v, t1, t2
1349 
1350 
1351 
1352 .function video_orc_convert_AYUV_YUY2
1353 .flags 2d
1354 .dest 4 yuy2 guint8
1355 .source 8 ayuv guint8
1356 .temp 2 yy
1357 .temp 2 uv1
1358 .temp 2 uv2
1359 .temp 4 ayay
1360 .temp 4 uvuv
1361 
1362 x2 splitlw uvuv, ayay, ayuv
1363 splitlw uv1, uv2, uvuv
1364 x2 avgub uv1, uv1, uv2
1365 x2 select1wb yy, ayay
1366 x2 mergebw yuy2, yy, uv1
1367 
1368 
1369 .function video_orc_convert_AYUV_UYVY
1370 .flags 2d
1371 .dest 4 yuy2 guint8
1372 .source 8 ayuv guint8
1373 .temp 2 yy
1374 .temp 2 uv1
1375 .temp 2 uv2
1376 .temp 4 ayay
1377 .temp 4 uvuv
1378 
1379 x2 splitlw uvuv, ayay, ayuv
1380 splitlw uv1, uv2, uvuv
1381 x2 avgub uv1, uv1, uv2
1382 x2 select1wb yy, ayay
1383 x2 mergebw yuy2, uv1, yy
1384 
1385 
1386 
1387 .function video_orc_convert_AYUV_Y42B
1388 .flags 2d
1389 .dest 2 y guint8
1390 .dest 1 u guint8
1391 .dest 1 v guint8
1392 .source 8 ayuv guint8
1393 .temp 4 ayay
1394 .temp 4 uvuv
1395 .temp 2 uv1
1396 .temp 2 uv2
1397 
1398 x2 splitlw uvuv, ayay, ayuv
1399 splitlw uv1, uv2, uvuv
1400 x2 avgub uv1, uv1, uv2
1401 splitwb v, u, uv1
1402 x2 select1wb y, ayay
1403 
1404 
1405 .function video_orc_convert_AYUV_Y444
1406 .flags 2d
1407 .dest 1 y guint8
1408 .dest 1 u guint8
1409 .dest 1 v guint8
1410 .source 4 ayuv guint8
1411 .temp 2 ay
1412 .temp 2 uv
1413 
1414 splitlw uv, ay, ayuv
1415 splitwb v, u, uv
1416 select1wb y, ay
1417 
1418 
1419 .function video_orc_convert_Y42B_YUY2
1420 .flags 2d
1421 .dest 4 yuy2 guint8
1422 .source 2 y guint8
1423 .source 1 u guint8
1424 .source 1 v guint8
1425 .temp 2 uv
1426 
1427 mergebw uv, u, v
1428 x2 mergebw yuy2, y, uv
1429 
1430 
1431 .function video_orc_convert_Y42B_UYVY
1432 .flags 2d
1433 .dest 4 uyvy guint8
1434 .source 2 y guint8
1435 .source 1 u guint8
1436 .source 1 v guint8
1437 .temp 2 uv
1438 
1439 mergebw uv, u, v
1440 x2 mergebw uyvy, uv, y
1441 
1442 
1443 .function video_orc_convert_Y42B_AYUV
1444 .flags 2d
1445 .dest 8 ayuv guint8
1446 .source 2 yy guint8
1447 .source 1 u guint8
1448 .source 1 v guint8
1449 .param 1 alpha
1450 .temp 2 uv
1451 .temp 2 ay
1452 .temp 4 uvuv
1453 .temp 4 ayay
1454 
1455 mergebw uv, u, v
1456 x2 mergebw ayay, alpha, yy
1457 mergewl uvuv, uv, uv
1458 x2 mergewl ayuv, ayay, uvuv
1459 
1460 
1461 .function video_orc_convert_Y444_YUY2
1462 .flags 2d
1463 .dest 4 yuy2 guint8
1464 .source 2 y guint8
1465 .source 2 u guint8
1466 .source 2 v guint8
1467 .temp 2 uv
1468 .temp 4 uvuv
1469 .temp 2 uv1
1470 .temp 2 uv2
1471 
1472 x2 mergebw uvuv, u, v
1473 splitlw uv1, uv2, uvuv
1474 x2 avgub uv, uv1, uv2
1475 x2 mergebw yuy2, y, uv
1476 
1477 
1478 .function video_orc_convert_Y444_UYVY
1479 .flags 2d
1480 .dest 4 uyvy guint8
1481 .source 2 y guint8
1482 .source 2 u guint8
1483 .source 2 v guint8
1484 .temp 2 uv
1485 .temp 4 uvuv
1486 .temp 2 uv1
1487 .temp 2 uv2
1488 
1489 x2 mergebw uvuv, u, v
1490 splitlw uv1, uv2, uvuv
1491 x2 avgub uv, uv1, uv2
1492 x2 mergebw uyvy, uv, y
1493 
1494 
1495 .function video_orc_convert_Y444_AYUV
1496 .flags 2d
1497 .dest 4 ayuv guint8
1498 .source 1 yy guint8
1499 .source 1 u guint8
1500 .source 1 v guint8
1501 .param 1 alpha
1502 .temp 2 uv
1503 .temp 2 ay
1504 
1505 mergebw uv, u, v
1506 mergebw ay, alpha, yy
1507 mergewl ayuv, ay, uv
1508 
1509 
1510 
1511 .function video_orc_convert_AYUV_ARGB
1512 .flags 2d
1513 .dest 4 argb guint8
1514 .source 4 ayuv guint8
1515 .param 2 p1
1516 .param 2 p2
1517 .param 2 p3
1518 .param 2 p4
1519 .param 2 p5
1520 .temp 1 a
1521 .temp 1 y
1522 .temp 1 u
1523 .temp 1 v
1524 .temp 2 wy
1525 .temp 2 wu
1526 .temp 2 wv
1527 .temp 2 wr
1528 .temp 2 wg
1529 .temp 2 wb
1530 .temp 1 r
1531 .temp 1 g
1532 .temp 1 b
1533 .temp 4 x
1534 .const 1 c128 128
1535 
1536 x4 subb x, ayuv, c128 
1537 splitlw wv, wy, x
1538 splitwb y, a, wy
1539 splitwb v, u, wv
1540 
1541 splatbw wy, y
1542 splatbw wu, u
1543 splatbw wv, v
1544 
1545 mulhsw wy, wy, p1
1546 
1547 mulhsw wr, wv, p2
1548 addw wr, wy, wr
1549 convssswb r, wr
1550 mergebw wr, a, r
1551 
1552 mulhsw wb, wu, p3
1553 addw wb, wy, wb
1554 convssswb b, wb
1555 
1556 mulhsw wg, wu, p4
1557 addw wg, wy, wg
1558 mulhsw wy, wv, p5
1559 addw wg, wg, wy
1560 
1561 convssswb g, wg
1562 
1563 mergebw wb, g, b
1564 mergewl x, wr, wb
1565 x4 addb argb, x, c128
1566 
1567 .function video_orc_convert_AYUV_BGRA
1568 .flags 2d
1569 .dest 4 bgra guint8
1570 .source 4 ayuv guint8
1571 .param 2 p1
1572 .param 2 p2
1573 .param 2 p3
1574 .param 2 p4
1575 .param 2 p5
1576 .temp 1 a
1577 .temp 1 y
1578 .temp 1 u
1579 .temp 1 v
1580 .temp 2 wy
1581 .temp 2 wu
1582 .temp 2 wv
1583 .temp 2 wr
1584 .temp 2 wg
1585 .temp 2 wb
1586 .temp 1 r
1587 .temp 1 g
1588 .temp 1 b
1589 .temp 4 x
1590 .const 1 c128 128
1591 
1592 x4 subb x, ayuv, c128 
1593 splitlw wv, wy, x
1594 splitwb y, a, wy
1595 splitwb v, u, wv
1596 
1597 splatbw wy, y
1598 splatbw wu, u
1599 splatbw wv, v
1600 
1601 mulhsw wy, wy, p1
1602 
1603 mulhsw wr, wv, p2
1604 addw wr, wy, wr
1605 convssswb r, wr
1606 mergebw wr, r, a
1607 
1608 mulhsw wb, wu, p3
1609 addw wb, wy, wb
1610 convssswb b, wb
1611 
1612 mulhsw wg, wu, p4
1613 addw wg, wy, wg
1614 mulhsw wy, wv, p5
1615 addw wg, wg, wy
1616 
1617 convssswb g, wg
1618 
1619 mergebw wb, b, g
1620 mergewl x, wb, wr
1621 x4 addb bgra, x, c128
1622 
1623 
1624 .function video_orc_convert_AYUV_ABGR
1625 .flags 2d
1626 .dest 4 argb guint8
1627 .source 4 ayuv guint8
1628 .param 2 p1
1629 .param 2 p2
1630 .param 2 p3
1631 .param 2 p4
1632 .param 2 p5
1633 .temp 1 a
1634 .temp 1 y
1635 .temp 1 u
1636 .temp 1 v
1637 .temp 2 wy
1638 .temp 2 wu
1639 .temp 2 wv
1640 .temp 2 wr
1641 .temp 2 wg
1642 .temp 2 wb
1643 .temp 1 r
1644 .temp 1 g
1645 .temp 1 b
1646 .temp 4 x
1647 .const 1 c128 128
1648 
1649 x4 subb x, ayuv, c128 
1650 splitlw wv, wy, x
1651 splitwb y, a, wy
1652 splitwb v, u, wv
1653 
1654 splatbw wy, y
1655 splatbw wu, u
1656 splatbw wv, v
1657 
1658 mulhsw wy, wy, p1
1659 
1660 mulhsw wr, wv, p2
1661 addw wr, wy, wr
1662 convssswb r, wr
1663 
1664 mulhsw wb, wu, p3
1665 addw wb, wy, wb
1666 convssswb b, wb
1667 mergebw wb, a, b
1668 
1669 mulhsw wg, wu, p4
1670 addw wg, wy, wg
1671 mulhsw wy, wv, p5
1672 addw wg, wg, wy
1673 
1674 convssswb g, wg
1675 
1676 mergebw wr, g, r
1677 mergewl x, wb, wr
1678 x4 addb argb, x, c128
1679 
1680 .function video_orc_convert_AYUV_RGBA
1681 .flags 2d
1682 .dest 4 argb guint8
1683 .source 4 ayuv guint8
1684 .param 2 p1
1685 .param 2 p2
1686 .param 2 p3
1687 .param 2 p4
1688 .param 2 p5
1689 .temp 1 a
1690 .temp 1 y
1691 .temp 1 u
1692 .temp 1 v
1693 .temp 2 wy
1694 .temp 2 wu
1695 .temp 2 wv
1696 .temp 2 wr
1697 .temp 2 wg
1698 .temp 2 wb
1699 .temp 1 r
1700 .temp 1 g
1701 .temp 1 b
1702 .temp 4 x
1703 .const 1 c128 128
1704 
1705 x4 subb x, ayuv, c128 
1706 splitlw wv, wy, x
1707 splitwb y, a, wy
1708 splitwb v, u, wv
1709 
1710 splatbw wy, y
1711 splatbw wu, u
1712 splatbw wv, v
1713 
1714 mulhsw wy, wy, p1
1715 
1716 mulhsw wr, wv, p2
1717 addw wr, wy, wr
1718 convssswb r, wr
1719 
1720 mulhsw wb, wu, p3
1721 addw wb, wy, wb
1722 convssswb b, wb
1723 mergebw wb, b, a
1724 
1725 mulhsw wg, wu, p4
1726 addw wg, wy, wg
1727 mulhsw wy, wv, p5
1728 addw wg, wg, wy
1729 
1730 convssswb g, wg
1731 
1732 mergebw wr, r, g
1733 mergewl x, wr, wb
1734 x4 addb argb, x, c128
1735 
1736 .function video_orc_convert_I420_BGRA
1737 .dest 4 argb guint8
1738 .source 1 y guint8
1739 .source 1 u guint8
1740 .source 1 v guint8
1741 .param 2 p1
1742 .param 2 p2
1743 .param 2 p3
1744 .param 2 p4
1745 .param 2 p5
1746 .temp 2 wy
1747 .temp 2 wu
1748 .temp 2 wv
1749 .temp 2 wr
1750 .temp 2 wg
1751 .temp 2 wb
1752 .temp 1 r
1753 .temp 1 g
1754 .temp 1 b
1755 .temp 4 x
1756 .const 1 c128 128
1757 .const 4 c4128 128
1758 
1759 subb r, y, c128
1760 splatbw wy, r
1761 loadupdb r, u
1762 subb r, r, c128
1763 splatbw wu, r
1764 loadupdb r, v
1765 subb r, r, c128
1766 splatbw wv, r
1767 
1768 mulhsw wy, wy, p1
1769 
1770 mulhsw wr, wv, p2
1771 addw wr, wy, wr
1772 convssswb r, wr
1773 mergebw wr, r, 127
1774 
1775 mulhsw wb, wu, p3
1776 addw wb, wy, wb
1777 convssswb b, wb
1778 
1779 mulhsw wg, wu, p4
1780 addw wg, wy, wg
1781 mulhsw wy, wv, p5
1782 addw wg, wg, wy
1783 
1784 convssswb g, wg
1785 
1786 mergebw wb, b, g
1787 mergewl x, wb, wr
1788 x4 addb argb, x, c4128
1789 
1790 .function video_orc_convert_I420_ARGB
1791 .dest 4 argb guint8
1792 .source 1 y guint8
1793 .source 1 u guint8
1794 .source 1 v guint8
1795 .param 2 p1
1796 .param 2 p2
1797 .param 2 p3
1798 .param 2 p4
1799 .param 2 p5
1800 .temp 2 wy
1801 .temp 2 wu
1802 .temp 2 wv
1803 .temp 2 wr
1804 .temp 2 wg
1805 .temp 2 wb
1806 .temp 1 r
1807 .temp 1 g
1808 .temp 1 b
1809 .temp 4 x
1810 .const 1 c128 128
1811 .const 4 c4128 128
1812 
1813 subb r, y, c128
1814 splatbw wy, r
1815 loadupdb r, u
1816 subb r, r, c128
1817 splatbw wu, r
1818 loadupdb r, v
1819 subb r, r, c128
1820 splatbw wv, r
1821 
1822 mulhsw wy, wy, p1
1823 
1824 mulhsw wr, wv, p2
1825 addw wr, wy, wr
1826 convssswb r, wr
1827 mergebw wr, 127, r
1828 
1829 mulhsw wb, wu, p3
1830 addw wb, wy, wb
1831 convssswb b, wb
1832 
1833 mulhsw wg, wu, p4
1834 addw wg, wy, wg
1835 mulhsw wy, wv, p5
1836 addw wg, wg, wy
1837 
1838 convssswb g, wg
1839 
1840 mergebw wb, g, b
1841 mergewl x, wr, wb
1842 x4 addb argb, x, c4128
1843 
1844 .function video_orc_matrix8
1845 .backup _custom_video_orc_matrix8
1846 .source 4 argb guint8
1847 .dest 4 ayuv guint8
1848 .longparam 8 p1
1849 .longparam 8 p2
1850 .longparam 8 p3
1851 .longparam 8 p4
1852 .const 1 c128 128
1853 .temp 2 w1
1854 .temp 2 w2
1855 .temp 1 b1
1856 .temp 1 b2
1857 .temp 4 l1
1858 .temp 4 ayuv2
1859 .temp 8 aq
1860 .temp 8 q1
1861 .temp 8 pr1
1862 .temp 8 pr2
1863 .temp 8 pr3
1864 
1865 loadpq pr1, p1
1866 loadpq pr2, p2
1867 loadpq pr3, p3
1868 
1869 x4 subb l1, argb, c128
1870 
1871 select0lw w1, l1
1872 select1lw w2, l1
1873 select0wb b1, w1
1874 select1wb b2, w1
1875 
1876 convubw w1, b1
1877 convuwl l1, w1
1878 x4 mergebw aq, l1, l1
1879 
1880 splatbl l1, b2
1881 mergelq q1, l1, l1
1882 x4 mulhsw q1, q1, pr1
1883 x4 addw aq, aq, q1
1884 
1885 select0wb b1, w2
1886 splatbl l1,b1
1887 mergelq q1, l1, l1
1888 x4 mulhsw q1, q1, pr2
1889 x4 addw aq, aq, q1
1890 
1891 select1wb b2, w2
1892 splatbl l1, b2
1893 mergelq q1, l1, l1
1894 x4 mulhsw q1, q1, pr3
1895 x4 addw aq, aq, q1
1896 
1897 x4 convssswb ayuv2, aq
1898 x4 addb ayuv, ayuv2, c128
1899 
1900 #.function video_orc_resample_h_near_u32
1901 #.source 4 src guint32
1902 #.source 4 idx
1903 #.dest 4 dest guint32
1904 #.temp 4 t
1905 #
1906 #loadidxl t, src, idx
1907 #storel dest, t
1908 
1909 .function video_orc_resample_h_near_u32_lq
1910 .dest 4 d1 guint32
1911 .source 4 s1 guint32
1912 .param 4 p1
1913 .param 4 p2
1914 
1915 ldresnearl d1, s1, p1, p2
1916 
1917 .function video_orc_resample_h_2tap_1u8_lq
1918 .dest 1 d1 guint8
1919 .source 1 s1 guint8
1920 .param 4 p1
1921 .param 4 p2
1922 
1923 ldreslinb d1, s1, p1, p2
1924 
1925 .function video_orc_resample_h_2tap_4u8_lq
1926 .dest 4 d1 guint32
1927 .source 4 s1 guint32
1928 .param 4 p1
1929 .param 4 p2
1930 
1931 ldreslinl d1, s1, p1, p2
1932 
1933 .function video_orc_resample_h_2tap_u8_lq
1934 .source 1 s1 guint8
1935 .source 1 s2 guint8
1936 .source 2 t1 gint16
1937 .source 2 t2 gint16
1938 .dest 1 d guint8
1939 .temp 2 w1
1940 .temp 2 w2
1941 
1942 convubw w1, s1
1943 mullw w1, w1, t1
1944 convubw w2, s2
1945 mullw w2, w2, t2
1946 addw w1, w1, w2
1947 addw w1, w1, 32
1948 shrsw w1, w1, 6
1949 convsuswb d, w1
1950 
1951 .function video_orc_resample_h_2tap_u16
1952 .source 2 s1 guint16
1953 .source 2 s2 guint16
1954 .source 2 t1 gint16
1955 .source 2 t2 gint16
1956 .dest 2 d guint16
1957 .temp 4 w1
1958 .temp 4 w2
1959 .temp 4 tl1
1960 .temp 4 tl2
1961 
1962 convuwl w1, s1
1963 convswl tl1, t1
1964 mulll w1, w1, tl1
1965 convuwl w2, s2
1966 convswl tl2, t2
1967 mulll w2, w2, tl2
1968 addl w1, w1, w2
1969 addl w1, w1, 4096
1970 shrsl w1, w1, 12
1971 convsuslw d, w1
1972 
1973 .function video_orc_resample_v_2tap_u8_lq
1974 .source 1 src1 guint8
1975 .source 1 src2 guint8
1976 .dest 1 dest guint8
1977 .param 2 p1 gint16
1978 .temp 1 t
1979 .temp 2 w1
1980 .temp 2 w2
1981 
1982 convubw w1, src1
1983 convubw w2, src2
1984 subw w2, w2, w1
1985 mullw w2, w2, p1
1986 addw w2, w2, 128
1987 convhwb t, w2
1988 addb dest, t, src1
1989 
1990 .function video_orc_resample_v_2tap_u16
1991 .source 2 src1 guint16
1992 .source 2 src2 guint16
1993 .dest 2 dest guint16
1994 .param 2 p1 gint16
1995 .temp 4 l1
1996 .temp 4 l2
1997 .temp 4 l3
1998 
1999 convuwl l1, src1
2000 convuwl l2, src2
2001 subl l2, l2, l1
2002 convuwl l3, p1
2003 mulll l2, l2, l3
2004 addl l2, l2, 4096
2005 shrsl l2, l2, 12
2006 addl l1, l1, l2
2007 convsuslw dest, l1
2008 
2009 .function video_orc_resample_v_2tap_u8
2010 .source 1 s1 guint8
2011 .source 1 s2 guint8
2012 .dest 1 d1 guint8
2013 .param 2 p1 gint16
2014 .temp 1 t
2015 .temp 2 w1
2016 .temp 2 w2
2017 .temp 4 t1
2018 .temp 4 t2
2019 
2020 convubw w1, s1
2021 convubw w2, s2
2022 subw w2, w2, w1
2023 mulswl t2, w2, p1
2024 addl t2, t2, 4095
2025 shrsl t2, t2, 12
2026 convlw w2, t2
2027 addw w2, w2, w1
2028 convsuswb d1, w2
2029 
2030 .function video_orc_resample_v_4tap_u8_lq
2031 .source 1 s1 guint8
2032 .source 1 s2 guint8
2033 .source 1 s3 guint8
2034 .source 1 s4 guint8
2035 .dest 1 d1 guint8
2036 .param 2 p1 gint16
2037 .param 2 p2 gint16
2038 .param 2 p3 gint16
2039 .param 2 p4 gint16
2040 .temp 2 w1
2041 .temp 2 w2
2042 
2043 convubw w1, s1
2044 mullw w1, w1, p1
2045 convubw w2, s2
2046 mullw w2, w2, p2
2047 addw w1, w1, w2
2048 convubw w2, s3
2049 mullw w2, w2, p3
2050 addw w1, w1, w2
2051 convubw w2, s4
2052 mullw w2, w2, p4
2053 addw w1, w1, w2
2054 addw w1, w1, 32
2055 shrsw w1, w1, 6
2056 convsuswb d1, w1
2057 
2058 .function video_orc_resample_v_4tap_u8
2059 .source 1 s1 guint8
2060 .source 1 s2 guint8
2061 .source 1 s3 guint8
2062 .source 1 s4 guint8
2063 .dest 1 d1 guint8
2064 .param 2 p1 gint16
2065 .param 2 p2 gint16
2066 .param 2 p3 gint16
2067 .param 2 p4 gint16
2068 .temp 2 w1
2069 .temp 2 w2
2070 .temp 4 t1
2071 .temp 4 t2
2072 
2073 convubw w1, s1
2074 mulswl t1, w1, p1
2075 convubw w2, s2
2076 mulswl t2, w2, p2
2077 addl t1, t1, t2
2078 convubw w2, s3
2079 mulswl t2, w2, p3
2080 addl t1, t1, t2
2081 convubw w2, s4
2082 mulswl t2, w2, p4
2083 addl t1, t1, t2
2084 addl t1, t1, 4095
2085 shrsl t1, t1, 12
2086 convsuslw w1, t1
2087 convsuswb d1, w1
2088 
2089 # crashes ORC for now but is potentially faster
2090 #.function video_orc_resample_h_4tap_u8
2091 #.source 1 s1 guint8
2092 #.source 1 s2 guint8
2093 #.source 1 s3 guint8
2094 #.source 1 s4 guint8
2095 #.source 2 t1 gint16
2096 #.source 2 t2 gint16
2097 #.source 2 t3 gint16
2098 #.source 2 t4 gint16
2099 #.dest 1 d1 guint8
2100 #.temp 2 w1
2101 #.temp 2 w2
2102 #.temp 4 l1
2103 #.temp 4 l2
2104 #
2105 #convubw w1, s1
2106 #mulswl l1, w1, t1
2107 #convubw w2, s2
2108 #mulswl l2, w2, t2
2109 #addl l1, l1, l2
2110 #convubw w2, s3
2111 #mulswl l2, w2, t3
2112 #addl l1, l1, l2
2113 #convubw w2, s4
2114 #mulswl l2, w2, t4
2115 #addl l1, l1, l2
2116 #addl l1, l1, 4095
2117 #shrsl l1, l1, 12
2118 #convsuslw w1, l1
2119 #convsuswb d1, w1
2120 
2121 .function video_orc_resample_h_multaps_u8
2122 .source 1 s guint8
2123 .source 2 t gint16
2124 .dest 4 d gint32
2125 .temp 2 w1
2126 
2127 convubw w1, s
2128 mulswl d, w1, t
2129 
2130 .function video_orc_resample_h_muladdtaps_u8
2131 .flags 2d
2132 .source 1 s guint8
2133 .source 2 t gint16
2134 .dest 4 d gint32
2135 .temp 2 w1
2136 .temp 4 t1
2137 
2138 convubw w1, s
2139 mulswl t1, w1, t
2140 addl d, d, t1
2141 
2142 .function video_orc_resample_scaletaps_u8
2143 .source 4 s gint32
2144 .dest 1 d guint8
2145 .temp 2 w1
2146 .temp 4 t1
2147 
2148 addl t1, s, 4095
2149 shrsl t1, t1, 12
2150 convsuslw w1, t1
2151 convsuswb d, w1
2152 
2153 .function video_orc_resample_h_multaps_u8_lq
2154 .source 1 s guint8
2155 .source 2 t gint16
2156 .dest 2 d gint16
2157 .temp 2 w1
2158 
2159 convubw w1, s
2160 mullw d, w1, t
2161 
2162 .function video_orc_resample_h_muladdtaps_u8_lq
2163 .flags 2d
2164 .source 1 s guint8
2165 .source 2 t gint16
2166 .dest 2 d gint16
2167 .temp 2 w1
2168 
2169 convubw w1, s
2170 mullw w1, w1, t
2171 addw d, d, w1
2172 
2173 .function video_orc_resample_h_multaps3_u8_lq
2174 .source 1 s1 guint8
2175 .source 1 s2 guint8
2176 .source 1 s3 guint8
2177 .source 2 t1 gint16
2178 .source 2 t2 gint16
2179 .source 2 t3 gint16
2180 .dest 2 d gint16
2181 .temp 2 w1
2182 .temp 2 w2
2183 
2184 convubw w1, s1
2185 mullw w1, w1, t1
2186 convubw w2, s2
2187 mullw w2, w2, t2
2188 addw w1, w1, w2
2189 convubw w2, s3
2190 mullw w2, w2, t3
2191 addw d, w1, w2
2192 
2193 .function video_orc_resample_h_muladdtaps3_u8_lq
2194 .source 1 s1 guint8
2195 .source 1 s2 guint8
2196 .source 1 s3 guint8
2197 .source 2 t1 gint16
2198 .source 2 t2 gint16
2199 .source 2 t3 gint16
2200 .dest 2 d gint16
2201 .temp 2 w1
2202 .temp 2 w2
2203 
2204 convubw w1, s1
2205 mullw w1, w1, t1
2206 convubw w2, s2
2207 mullw w2, w2, t2
2208 addw w1, w1, w2
2209 convubw w2, s3
2210 mullw w2, w2, t3
2211 addw w1, w1, w2
2212 addw d, d, w1
2213 
2214 .function video_orc_resample_h_muladdscaletaps3_u8_lq
2215 .source 1 s1 guint8
2216 .source 1 s2 guint8
2217 .source 1 s3 guint8
2218 .source 2 t1 gint16
2219 .source 2 t2 gint16
2220 .source 2 t3 gint16
2221 .source 2 temp gint16
2222 .dest 1 d guint8
2223 .temp 2 w1
2224 .temp 2 w2
2225 
2226 convubw w1, s1
2227 mullw w1, w1, t1
2228 convubw w2, s2
2229 mullw w2, w2, t2
2230 addw w1, w1, w2
2231 convubw w2, s3
2232 mullw w2, w2, t3
2233 addw w1, w1, w2
2234 addw w1, w1, temp
2235 addw w1, w1, 32
2236 shrsw w1, w1, 6
2237 convsuswb d, w1
2238 
2239 .function video_orc_resample_scaletaps_u8_lq
2240 .source 2 s gint16
2241 .dest 1 d guint8
2242 .temp 2 w1
2243 
2244 addw w1, s, 32
2245 shrsw w1, w1, 6
2246 convsuswb d, w1
2247 
2248 .function video_orc_resample_h_multaps_u16
2249 .source 2 s guint16
2250 .source 2 t gint16
2251 .dest 4 d gint32
2252 .temp 4 l1
2253 .temp 4 l2
2254 
2255 convuwl l1, s
2256 convswl l2, t
2257 mulll d, l1, l2
2258 
2259 .function video_orc_resample_h_muladdtaps_u16
2260 .flags 2d
2261 .source 2 s guint16
2262 .source 2 t gint16
2263 .dest 4 d gint32
2264 .temp 4 l1
2265 .temp 4 l2
2266 
2267 convuwl l1, s
2268 convswl l2, t
2269 mulll l1, l1, l2
2270 addl d, d, l1
2271 
2272 .function video_orc_resample_scaletaps_u16
2273 .source 4 s gint32
2274 .dest 2 d guint16
2275 .temp 4 t1
2276 
2277 addl t1, s, 4095
2278 shrsl t1, t1, 12
2279 convsuslw d, t1
2280 
2281 .function video_orc_resample_v_multaps_u8
2282 .source 1 s guint8
2283 .param 2 t gint16
2284 .dest 4 d gint32
2285 .temp 2 w1
2286 
2287 convubw w1, s
2288 mulswl d, w1, t
2289 
2290 .function video_orc_resample_v_muladdtaps_u8
2291 .source 1 s guint8
2292 .param 2 t gint16
2293 .dest 4 d gint32
2294 .temp 2 w1
2295 .temp 4 t1
2296 
2297 convubw w1, s
2298 mulswl t1, w1, t
2299 addl d, d, t1
2300 
2301 .function video_orc_resample_v_multaps_u16
2302 .source 2 s guint16
2303 .param 2 t gint16
2304 .dest 4 d gint32
2305 .temp 4 l1
2306 
2307 convuwl l1, s
2308 mulll d, l1, t
2309 
2310 .function video_orc_resample_v_muladdtaps_u16
2311 .source 2 s guint16
2312 .param 2 t gint16
2313 .dest 4 d gint32
2314 .temp 4 t1
2315 .temp 4 t2
2316 
2317 convuwl t1, s
2318 convswl t2, t
2319 mulll t1, t1, t2
2320 addl d, d, t1
2321 
2322 .function video_orc_resample_v_multaps_u8_lq
2323 .source 1 s guint8
2324 .param 2 t gint16
2325 .dest 2 d gint16
2326 .temp 2 w1
2327 
2328 convubw w1, s
2329 mullw d, w1, t
2330 
2331 .function video_orc_resample_v_multaps4_u8_lq
2332 .source 1 s1 guint8
2333 .source 1 s2 guint8
2334 .source 1 s3 guint8
2335 .source 1 s4 guint8
2336 .param 2 t1 gint16
2337 .param 2 t2 gint16
2338 .param 2 t3 gint16
2339 .param 2 t4 gint16
2340 .dest 2 d gint16
2341 .temp 2 w1
2342 .temp 2 w2
2343 
2344 convubw w1, s1
2345 mullw w1, w1, t1
2346 convubw w2, s2
2347 mullw w2, w2, t2
2348 addw w1, w1, w2
2349 convubw w2, s3
2350 mullw w2, w2, t3
2351 addw w1, w1, w2
2352 convubw w2, s4
2353 mullw w2, w2, t4
2354 addw d, w1, w2
2355 
2356 .function video_orc_resample_v_muladdtaps_u8_lq
2357 .source 1 s guint8
2358 .param 2 t gint16
2359 .dest 2 d gint16
2360 .temp 2 w1
2361 
2362 convubw w1, s
2363 mullw w1, w1, t
2364 addw d, d, w1
2365 
2366 .function video_orc_resample_v_muladdtaps4_u8_lq
2367 .source 1 s1 guint8
2368 .source 1 s2 guint8
2369 .source 1 s3 guint8
2370 .source 1 s4 guint8
2371 .param 2 t1 gint16
2372 .param 2 t2 gint16
2373 .param 2 t3 gint16
2374 .param 2 t4 gint16
2375 .dest 2 d gint16
2376 .temp 2 w1
2377 .temp 2 w2
2378 
2379 convubw w1, s1
2380 mullw w1, w1, t1
2381 convubw w2, s2
2382 mullw w2, w2, t2
2383 addw w1, w1, w2
2384 convubw w2, s3
2385 mullw w2, w2, t3
2386 addw w1, w1, w2
2387 convubw w2, s4
2388 mullw w2, w2, t4
2389 addw w1, w1, w2
2390 addw d, d, w1
2391 
2392 .function video_orc_resample_v_muladdscaletaps4_u8_lq
2393 .source 1 s1 guint8
2394 .source 1 s2 guint8
2395 .source 1 s3 guint8
2396 .source 1 s4 guint8
2397 .source 2 temp gint16
2398 .param 2 t1 gint16
2399 .param 2 t2 gint16
2400 .param 2 t3 gint16
2401 .param 2 t4 gint16
2402 .dest 1 d guint8
2403 .temp 2 w1
2404 .temp 2 w2
2405 
2406 convubw w1, s1
2407 mullw w1, w1, t1
2408 convubw w2, s2
2409 mullw w2, w2, t2
2410 addw w1, w1, w2
2411 convubw w2, s3
2412 mullw w2, w2, t3
2413 addw w1, w1, w2
2414 convubw w2, s4
2415 mullw w2, w2, t4
2416 addw w1, w1, w2
2417 addw w1, w1, temp
2418 addw w1, w1, 32
2419 shrsw w1, w1, 6
2420 convsuswb d, w1
2421 
2422 .function video_orc_chroma_down_h2_u8
2423 .source 8 s guint8
2424 .dest 8 d guint8
2425 .temp 4 ayuv1
2426 .temp 4 ayuv2
2427 .temp 2 ay1
2428 .temp 2 uv1
2429 .temp 2 uv2
2430 
2431 splitql ayuv2, ayuv1, s
2432 splitlw uv1, ay1, ayuv1
2433 select1lw uv2, ayuv2
2434 x2 avgub uv1, uv1, uv2
2435 mergewl ayuv1, ay1, uv1
2436 mergelq d, ayuv1, ayuv2
2437 
2438 #.function video_orc_chroma_up_h2_cs_u8
2439 #.source 8 s guint8
2440 #.source 4 s1 guint8
2441 #.dest 8 d guint8
2442 #.temp 4 ayuv1
2443 #.temp 4 ayuv2
2444 #.temp 4 ayuv3
2445 #.temp 2 ay2
2446 #.temp 2 uv2
2447 #.temp 2 uv3
2448 #
2449 #splitql ayuv2, ayuv1, s
2450 #ldresnearl ayuv3, s1, 0x20000, 0x20000
2451 #splitlw uv2, ay2, ayuv2
2452 #select1lw uv3, ayuv3
2453 #x2 avgub uv2, uv2, uv3
2454 #mergewl ayuv2, ay2, uv2
2455 #mergelq d, ayuv1, ayuv2
2456 
2457 .function video_orc_chroma_down_v2_u8
2458 .source 4 s1 guint8
2459 .source 4 s2 guint8
2460 .dest 4 d guint8
2461 .temp 2 ay1
2462 .temp 2 uv1
2463 .temp 2 uv2
2464 
2465 splitlw uv1, ay1, s1
2466 select1lw uv2, s2
2467 x2 avgub uv1, uv1, uv2
2468 mergewl d, ay1, uv1
2469 
2470 .function video_orc_chroma_up_v2_u8
2471 .source 4 s1 guint8
2472 .source 4 s2 guint8
2473 .dest 4 d1 guint8
2474 .dest 4 d2 guint8
2475 .temp 2 ay1
2476 .temp 2 ay2
2477 .temp 2 uv1
2478 .temp 2 uv2
2479 .temp 4 uuvv1
2480 .temp 4 uuvv2
2481 .temp 4 uuvv3
2482 
2483 splitlw uv1, ay1, s1
2484 splitlw uv2, ay2, s2
2485 x2 convubw uuvv1, uv1
2486 x2 convubw uuvv2, uv2
2487 
2488 x2 mullw uuvv3, uuvv1, 3
2489 x2 addw uuvv3, uuvv3, uuvv2
2490 x2 addw uuvv3, uuvv3, 2
2491 x2 shruw uuvv3, uuvv3, 2
2492 x2 convsuswb uv1, uuvv3
2493 mergewl d1, ay1, uv1
2494 
2495 x2 mullw uuvv3, uuvv2, 3
2496 x2 addw uuvv3, uuvv3, uuvv1
2497 x2 addw uuvv3, uuvv3, 2
2498 x2 shruw uuvv3, uuvv3, 2
2499 x2 convsuswb uv2, uuvv3
2500 mergewl d2, ay2, uv2
2501 
2502 .function video_orc_chroma_up_v2_u16
2503 .source 8 s1 guint16
2504 .source 8 s2 guint16
2505 .dest 8 d1 guint16
2506 .dest 8 d2 guint16
2507 .temp 4 ay1
2508 .temp 4 ay2
2509 .temp 4 uv1
2510 .temp 4 uv2
2511 .temp 8 uuvv1
2512 .temp 8 uuvv2
2513 .temp 8 uuvv3
2514 
2515 splitql uv1, ay1, s1
2516 splitql uv2, ay2, s2
2517 x2 convuwl uuvv1, uv1
2518 x2 convuwl uuvv2, uv2
2519 
2520 x2 mulll uuvv3, uuvv1, 3
2521 x2 addl uuvv3, uuvv3, uuvv2
2522 x2 addl uuvv3, uuvv3, 2
2523 x2 shrul uuvv3, uuvv3, 2
2524 x2 convsuslw uv1, uuvv3
2525 mergelq d1, ay1, uv1
2526 
2527 x2 mulll uuvv3, uuvv2, 3
2528 x2 addl uuvv3, uuvv3, uuvv1
2529 x2 addl uuvv3, uuvv3, 2
2530 x2 shrul uuvv3, uuvv3, 2
2531 x2 convsuslw uv2, uuvv3
2532 mergelq d2, ay2, uv2
2533 
2534 .function video_orc_chroma_down_v2_u16
2535 .source 8 s1 guint16
2536 .source 8 s2 guint16
2537 .dest 8 d guint16
2538 .temp 4 ay1
2539 .temp 4 uv1
2540 .temp 4 uv2
2541 
2542 splitql uv1, ay1, s1
2543 select1ql uv2, s2
2544 x2 avguw uv1, uv1, uv2
2545 mergelq d, ay1, uv1
2546 
2547 
2548 .function video_orc_chroma_down_v4_u8
2549 .source 4 s1 guint8
2550 .source 4 s2 guint8
2551 .source 4 s3 guint8
2552 .source 4 s4 guint8
2553 .dest 4 d guint8
2554 .temp 2 ay1
2555 .temp 2 uv1
2556 .temp 4 uuvv1
2557 .temp 4 uuvv2
2558 .temp 4 uuvv3
2559 
2560 splitlw uv1, ay1, s1
2561 x2 convubw uuvv1, uv1
2562 select1lw uv1, s4
2563 x2 convubw uuvv2, uv1
2564 x2 addw uuvv3, uuvv1, uuvv2
2565 select1lw uv1, s2
2566 x2 convubw uuvv1, uv1
2567 select1lw uv1, s3
2568 x2 convubw uuvv2, uv1
2569 x2 addw uuvv1, uuvv1, uuvv2
2570 x2 shlw uuvv2, uuvv1, 1
2571 x2 addw uuvv1, uuvv1, uuvv2
2572 x2 addw uuvv3, uuvv3, uuvv1
2573 x2 addw uuvv3, uuvv3, 4
2574 x2 shruw uuvv3, uuvv3, 3
2575 x2 convsuswb uv1, uuvv3
2576 mergewl d, ay1, uv1
2577 
2578 .function video_orc_chroma_down_v4_u16
2579 .source 8 s1 guint16
2580 .source 8 s2 guint16
2581 .source 8 s3 guint16
2582 .source 8 s4 guint16
2583 .dest 8 d guint16
2584 .temp 4 ay1
2585 .temp 4 uv1
2586 .temp 8 uuvv1
2587 .temp 8 uuvv2
2588 .temp 8 uuvv3
2589 
2590 splitql uv1, ay1, s1
2591 x2 convuwl uuvv1, uv1
2592 select1ql uv1, s4
2593 x2 convuwl uuvv2, uv1
2594 x2 addl uuvv3, uuvv1, uuvv2
2595 select1ql uv1, s2
2596 x2 convuwl uuvv1, uv1
2597 select1ql uv1, s3
2598 x2 convuwl uuvv2, uv1
2599 x2 addl uuvv1, uuvv1, uuvv2
2600 x2 shll uuvv2, uuvv1, 1
2601 x2 addl uuvv1, uuvv1, uuvv2
2602 x2 addl uuvv3, uuvv3, uuvv1
2603 x2 addl uuvv3, uuvv3, 4
2604 x2 shrul uuvv3, uuvv3, 3
2605 x2 convsuslw uv1, uuvv3
2606 mergelq d, ay1, uv1
2607 
2608 .function video_orc_dither_none_4u8_mask
2609 .dest 4 p guint8
2610 .param 4 masks
2611 .temp 4 m
2612 
2613 loadpl m, masks
2614 x4 andnb p, m, p
2615 
2616 .function video_orc_dither_none_4u16_mask
2617 .dest 8 p guint16
2618 .longparam 8 masks
2619 .temp 8 m
2620 
2621 loadpq m, masks
2622 x4 andnw p, m, p
2623 
2624 .function video_orc_dither_verterr_4u8_mask
2625 .dest 4 p guint8
2626 .dest 8 e guint16
2627 .longparam 8 masks
2628 .temp 8 m
2629 .temp 8 t1
2630 
2631 loadpq m, masks
2632 x4 convubw t1, p
2633 x4 addw t1, e, t1
2634 x4 andw e, m, t1
2635 x4 andnw t1, m, t1
2636 x4 convsuswb p, t1
2637 
2638 .function video_orc_dither_fs_muladd_u8
2639 .dest 2 e guint16
2640 .temp 2 t1
2641 .temp 2 t2
2642 
2643 loadoffw t2, e, 4
2644 mullw t2, t2, 5
2645 addw t1, t2, e
2646 loadoffw t2, e, 8
2647 mullw t2, t2, 3
2648 addw e, t1, t2
2649 
2650 # due to error propagation we should disable
2651 # loop_shift for this function and only work on
2652 # 4 pixels at a time.
2653 #.function video_orc_dither_fs_add_4u8_mask
2654 #.flags no-unroll
2655 #.dest 4 d guint8
2656 #.dest 8 e1 guint16
2657 #.dest 8 e2 guint16
2658 #.longparam 8 masks
2659 #.temp 8 p
2660 #.temp 8 t1
2661 #.temp 8 t2
2662 #
2663 #x4 mullw t1, e1, 7
2664 #x4 addw t1, t1, e2
2665 #x4 shruw t1, t1, 4
2666 #x4 convubw p, d
2667 #x4 addw t1, t1, p
2668 #x4 andnw p, masks, t1
2669 #x4 convsuswb d, p
2670 #x4 andw e2, t1, masks
2671 
2672 .function video_orc_dither_ordered_u8
2673 .source 1 e guint8
2674 .dest 1 d guint8
2675 
2676 addusb d, d, e
2677 
2678 .function video_orc_dither_ordered_4u8_mask
2679 .source 8 e1 guint16
2680 .dest 4 d guint8
2681 .longparam 8 masks
2682 .temp 8 p
2683 .temp 8 m
2684 
2685 loadpq m, masks
2686 x4 convubw p, d
2687 x4 addw p, p, e1
2688 x4 andnw p, m, p
2689 x4 convsuswb d, p
2690 
2691 .function video_orc_dither_ordered_4u16_mask
2692 .source 8 e1 guint16
2693 .dest 8 d guint16
2694 .longparam 8 masks
2695 .temp 8 p
2696 .temp 8 m
2697 
2698 loadpq m, masks
2699 x4 addusw p, d, e1
2700 x4 andnw d, m, p
2701 
2702 .function video_orc_convert_UYVY_GRAY8
2703 .flags 2d
2704 .dest 1 d guint8
2705 .source 2 s
2706 .temp 1 t1
2707 .temp 2 t2
2708 
2709 loadw t2, s
2710 convhwb t1, t2
2711 storeb d, t1
    </pre>
  </body>
</html>