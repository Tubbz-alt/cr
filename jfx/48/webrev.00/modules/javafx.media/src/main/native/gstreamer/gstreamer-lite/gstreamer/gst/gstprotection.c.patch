diff a/modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gstreamer/gst/gstprotection.c b/modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gstreamer/gst/gstprotection.c
--- a/modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gstreamer/gst/gstprotection.c
+++ b/modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gstreamer/gst/gstprotection.c
@@ -213,11 +213,11 @@
 gchar **
 gst_protection_filter_systems_by_available_decryptors (const gchar **
     system_identifiers)
 {
   GList *decryptors, *walk;
-  gchar **retval;
+  gchar **retval = NULL;
   guint i = 0, decryptors_number;
 
   decryptors =
       gst_element_factory_list_get_elements (GST_ELEMENT_FACTORY_TYPE_DECRYPTOR,
       GST_RANK_MARGINAL);
@@ -225,11 +225,11 @@
   decryptors_number = g_list_length (decryptors);
 
   GST_TRACE ("found %u decrytors", decryptors_number);
 
   if (decryptors_number == 0)
-    return NULL;
+    goto beach;
 
   retval = g_new (gchar *, decryptors_number + 1);
 
   for (walk = decryptors; walk; walk = g_list_next (walk)) {
     GstElementFactory *fact = (GstElementFactory *) walk->data;
@@ -248,10 +248,11 @@
   if (retval[0] == NULL) {
     g_free (retval);
     retval = NULL;
   }
 
+beach:
   gst_plugin_feature_list_free (decryptors);
 
   return retval;
 }
 
