<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/gvariant.c</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="gvariant-serialiser.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gvariant.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/gvariant.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1,8 ***</span>
  /*
<span class="line-modified">!  * Copyright � 2007, 2008 Ryan Lortie</span>
<span class="line-modified">!  * Copyright � 2010 Codethink Limited</span>
   *
   * This library is free software; you can redistribute it and/or
   * modify it under the terms of the GNU Lesser General Public
   * License as published by the Free Software Foundation; either
   * version 2.1 of the License, or (at your option) any later version.
<span class="line-new-header">--- 1,8 ---</span>
  /*
<span class="line-modified">!  * Copyright (C) 2007, 2008 Ryan Lortie</span>
<span class="line-modified">!  * Copyright (C) 2010 Codethink Limited</span>
   *
   * This library is free software; you can redistribute it and/or
   * modify it under the terms of the GNU Lesser General Public
   * License as published by the Free Software Foundation; either
   * version 2.1 of the License, or (at your option) any later version.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 224,11 ***</span>
   *
   * This means that in total, for our &quot;a{sv}&quot; example, 91 bytes of
   * type information would be allocated.
   *
   * The type information cache, additionally, uses a #GHashTable to
<span class="line-modified">!  * store and lookup the cached items and stores a pointer to this</span>
   * hash table in static storage.  The hash table is freed when there
   * are zero items in the type cache.
   *
   * Although these sizes may seem large it is important to remember
   * that a program will probably only have a very small number of
<span class="line-new-header">--- 224,11 ---</span>
   *
   * This means that in total, for our &quot;a{sv}&quot; example, 91 bytes of
   * type information would be allocated.
   *
   * The type information cache, additionally, uses a #GHashTable to
<span class="line-modified">!  * store and look up the cached items and stores a pointer to this</span>
   * hash table in static storage.  The hash table is freed when there
   * are zero items in the type cache.
   *
   * Although these sizes may seem large it is important to remember
   * that a program will probably only have a very small number of
</pre>
<hr />
<pre>
<span class="line-old-header">*** 305,10 ***</span>
<span class="line-new-header">--- 305,15 ---</span>
   * @size: the size of @data
   *
   * Constructs a new trusted #GVariant instance from the provided data.
   * This is used to implement g_variant_new_* for all the basic types.
   *
<span class="line-added">+  * Note: @data must be backed by memory that is aligned appropriately for the</span>
<span class="line-added">+  * @type being loaded. Otherwise this function will internally create a copy of</span>
<span class="line-added">+  * the memory (since GLib 2.60) or (in older versions) fail and exit the</span>
<span class="line-added">+  * process.</span>
<span class="line-added">+  *</span>
   * Returns: a new floating #GVariant
   */
  static GVariant *
  g_variant_new_from_trusted (const GVariantType *type,
                              gconstpointer       data,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 419,11 ***</span>
   *
   * Since: 2.24
   **/
  /**
   * g_variant_get_int16:
<span class="line-modified">!  * @value: a int16 #GVariant instance</span>
   *
   * Returns the 16-bit signed integer value of @value.
   *
   * It is an error to call this function with a @value of any type
   * other than %G_VARIANT_TYPE_INT16.
<span class="line-new-header">--- 424,11 ---</span>
   *
   * Since: 2.24
   **/
  /**
   * g_variant_get_int16:
<span class="line-modified">!  * @value: an int16 #GVariant instance</span>
   *
   * Returns the 16-bit signed integer value of @value.
   *
   * It is an error to call this function with a @value of any type
   * other than %G_VARIANT_TYPE_INT16.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 469,11 ***</span>
   *
   * Since: 2.24
   **/
  /**
   * g_variant_get_int32:
<span class="line-modified">!  * @value: a int32 #GVariant instance</span>
   *
   * Returns the 32-bit signed integer value of @value.
   *
   * It is an error to call this function with a @value of any type
   * other than %G_VARIANT_TYPE_INT32.
<span class="line-new-header">--- 474,11 ---</span>
   *
   * Since: 2.24
   **/
  /**
   * g_variant_get_int32:
<span class="line-modified">!  * @value: an int32 #GVariant instance</span>
   *
   * Returns the 32-bit signed integer value of @value.
   *
   * It is an error to call this function with a @value of any type
   * other than %G_VARIANT_TYPE_INT32.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 519,11 ***</span>
   *
   * Since: 2.24
   **/
  /**
   * g_variant_get_int64:
<span class="line-modified">!  * @value: a int64 #GVariant instance</span>
   *
   * Returns the 64-bit signed integer value of @value.
   *
   * It is an error to call this function with a @value of any type
   * other than %G_VARIANT_TYPE_INT64.
<span class="line-new-header">--- 524,11 ---</span>
   *
   * Since: 2.24
   **/
  /**
   * g_variant_get_int64:
<span class="line-modified">!  * @value: an int64 #GVariant instance</span>
   *
   * Returns the 64-bit signed integer value of @value.
   *
   * It is an error to call this function with a @value of any type
   * other than %G_VARIANT_TYPE_INT64.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 935,11 ***</span>
  }
  
  /**
   * g_variant_lookup: (skip)
   * @dictionary: a dictionary #GVariant
<span class="line-modified">!  * @key: the key to lookup in the dictionary</span>
   * @format_string: a GVariant format string
   * @...: the arguments to unpack the value into
   *
   * Looks up a value in a dictionary #GVariant.
   *
<span class="line-new-header">--- 940,11 ---</span>
  }
  
  /**
   * g_variant_lookup: (skip)
   * @dictionary: a dictionary #GVariant
<span class="line-modified">!  * @key: the key to look up in the dictionary</span>
   * @format_string: a GVariant format string
   * @...: the arguments to unpack the value into
   *
   * Looks up a value in a dictionary #GVariant.
   *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 993,11 ***</span>
  }
  
  /**
   * g_variant_lookup_value:
   * @dictionary: a dictionary #GVariant
<span class="line-modified">!  * @key: the key to lookup in the dictionary</span>
   * @expected_type: (nullable): a #GVariantType, or %NULL
   *
   * Looks up a value in a dictionary #GVariant.
   *
   * This function works with dictionaries of the type a{s*} (and equally
<span class="line-new-header">--- 998,11 ---</span>
  }
  
  /**
   * g_variant_lookup_value:
   * @dictionary: a dictionary #GVariant
<span class="line-modified">!  * @key: the key to look up in the dictionary</span>
   * @expected_type: (nullable): a #GVariantType, or %NULL
   *
   * Looks up a value in a dictionary #GVariant.
   *
   * This function works with dictionaries of the type a{s*} (and equally
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1006,11 ***</span>
   *
   * In the event that @dictionary has the type a{sv}, the @expected_type
   * string specifies what type of value is expected to be inside of the
   * variant. If the value inside the variant has a different type then
   * %NULL is returned. In the event that @dictionary has a value type other
<span class="line-modified">!  * than v then @expected_type must directly match the key type and it is</span>
   * used to unpack the value directly or an error occurs.
   *
   * In either case, if @key is not found in @dictionary, %NULL is returned.
   *
   * If the key is found and the value has the correct type, it is
<span class="line-new-header">--- 1011,11 ---</span>
   *
   * In the event that @dictionary has the type a{sv}, the @expected_type
   * string specifies what type of value is expected to be inside of the
   * variant. If the value inside the variant has a different type then
   * %NULL is returned. In the event that @dictionary has a value type other
<span class="line-modified">!  * than v then @expected_type must directly match the value type and it is</span>
   * used to unpack the value directly or an error occurs.
   *
   * In either case, if @key is not found in @dictionary, %NULL is returned.
   *
   * If the key is found and the value has the correct type, it is
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1545,23 ***</span>
  GVariant *
  g_variant_new_strv (const gchar * const *strv,
                      gssize               length)
  {
    GVariant **strings;
<span class="line-modified">!   gsize i;</span>
  
    g_return_val_if_fail (length == 0 || strv != NULL, NULL);
  
    if (length &lt; 0)
      length = g_strv_length ((gchar **) strv);
  
<span class="line-modified">!   strings = g_new (GVariant *, length);</span>
<span class="line-modified">!   for (i = 0; i &lt; length; i++)</span>
      strings[i] = g_variant_ref_sink (g_variant_new_string (strv[i]));
  
    return g_variant_new_from_children (G_VARIANT_TYPE_STRING_ARRAY,
<span class="line-modified">!                                       strings, length, TRUE);</span>
  }
  
  /**
   * g_variant_get_strv:
   * @value: an array of strings #GVariant
<span class="line-new-header">--- 1550,24 ---</span>
  GVariant *
  g_variant_new_strv (const gchar * const *strv,
                      gssize               length)
  {
    GVariant **strings;
<span class="line-modified">!   gsize i, length_unsigned;</span>
  
    g_return_val_if_fail (length == 0 || strv != NULL, NULL);
  
    if (length &lt; 0)
      length = g_strv_length ((gchar **) strv);
<span class="line-added">+   length_unsigned = length;</span>
  
<span class="line-modified">!   strings = g_new (GVariant *, length_unsigned);</span>
<span class="line-modified">!   for (i = 0; i &lt; length_unsigned; i++)</span>
      strings[i] = g_variant_ref_sink (g_variant_new_string (strv[i]));
  
    return g_variant_new_from_children (G_VARIANT_TYPE_STRING_ARRAY,
<span class="line-modified">!                                       strings, length_unsigned, TRUE);</span>
  }
  
  /**
   * g_variant_get_strv:
   * @value: an array of strings #GVariant
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1681,23 ***</span>
  GVariant *
  g_variant_new_objv (const gchar * const *strv,
                      gssize               length)
  {
    GVariant **strings;
<span class="line-modified">!   gsize i;</span>
  
    g_return_val_if_fail (length == 0 || strv != NULL, NULL);
  
    if (length &lt; 0)
      length = g_strv_length ((gchar **) strv);
  
<span class="line-modified">!   strings = g_new (GVariant *, length);</span>
<span class="line-modified">!   for (i = 0; i &lt; length; i++)</span>
      strings[i] = g_variant_ref_sink (g_variant_new_object_path (strv[i]));
  
    return g_variant_new_from_children (G_VARIANT_TYPE_OBJECT_PATH_ARRAY,
<span class="line-modified">!                                       strings, length, TRUE);</span>
  }
  
  /**
   * g_variant_get_objv:
   * @value: an array of object paths #GVariant
<span class="line-new-header">--- 1687,24 ---</span>
  GVariant *
  g_variant_new_objv (const gchar * const *strv,
                      gssize               length)
  {
    GVariant **strings;
<span class="line-modified">!   gsize i, length_unsigned;</span>
  
    g_return_val_if_fail (length == 0 || strv != NULL, NULL);
  
    if (length &lt; 0)
      length = g_strv_length ((gchar **) strv);
<span class="line-added">+   length_unsigned = length;</span>
  
<span class="line-modified">!   strings = g_new (GVariant *, length_unsigned);</span>
<span class="line-modified">!   for (i = 0; i &lt; length_unsigned; i++)</span>
      strings[i] = g_variant_ref_sink (g_variant_new_object_path (strv[i]));
  
    return g_variant_new_from_children (G_VARIANT_TYPE_OBJECT_PATH_ARRAY,
<span class="line-modified">!                                       strings, length_unsigned, TRUE);</span>
  }
  
  /**
   * g_variant_get_objv:
   * @value: an array of object paths #GVariant
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1921,23 ***</span>
  GVariant *
  g_variant_new_bytestring_array (const gchar * const *strv,
                                  gssize               length)
  {
    GVariant **strings;
<span class="line-modified">!   gsize i;</span>
  
    g_return_val_if_fail (length == 0 || strv != NULL, NULL);
  
    if (length &lt; 0)
      length = g_strv_length ((gchar **) strv);
  
<span class="line-modified">!   strings = g_new (GVariant *, length);</span>
<span class="line-modified">!   for (i = 0; i &lt; length; i++)</span>
      strings[i] = g_variant_ref_sink (g_variant_new_bytestring (strv[i]));
  
    return g_variant_new_from_children (G_VARIANT_TYPE_BYTESTRING_ARRAY,
<span class="line-modified">!                                       strings, length, TRUE);</span>
  }
  
  /**
   * g_variant_get_bytestring_array:
   * @value: an array of array of bytes #GVariant (&#39;aay&#39;)
<span class="line-new-header">--- 1928,24 ---</span>
  GVariant *
  g_variant_new_bytestring_array (const gchar * const *strv,
                                  gssize               length)
  {
    GVariant **strings;
<span class="line-modified">!   gsize i, length_unsigned;</span>
  
    g_return_val_if_fail (length == 0 || strv != NULL, NULL);
  
    if (length &lt; 0)
      length = g_strv_length ((gchar **) strv);
<span class="line-added">+   length_unsigned = length;</span>
  
<span class="line-modified">!   strings = g_new (GVariant *, length_unsigned);</span>
<span class="line-modified">!   for (i = 0; i &lt; length_unsigned; i++)</span>
      strings[i] = g_variant_ref_sink (g_variant_new_bytestring (strv[i]));
  
    return g_variant_new_from_children (G_VARIANT_TYPE_BYTESTRING_ARRAY,
<span class="line-modified">!                                       strings, length_unsigned, TRUE);</span>
  }
  
  /**
   * g_variant_get_bytestring_array:
   * @value: an array of array of bytes #GVariant (&#39;aay&#39;)
</pre>
<hr />
<pre>
<span class="line-old-header">*** 2277,11 ***</span>
              }
  
            else
              {
                /* fall through and handle normally... */
<span class="line-modified">!         }</span>
          }
  
        /*
         * if the first two characters are &#39;a{&#39; then it&#39;s an array of
         * dictionary entries (ie: a dictionary) so we print that
<span class="line-new-header">--- 2285,11 ---</span>
              }
  
            else
              {
                /* fall through and handle normally... */
<span class="line-modified">!             }</span>
          }
  
        /*
         * if the first two characters are &#39;a{&#39; then it&#39;s an array of
         * dictionary entries (ie: a dictionary) so we print that
</pre>
<hr />
<pre>
<span class="line-old-header">*** 3955,11 ***</span>
  }
  
  /**
   * g_variant_dict_lookup:
   * @dict: a #GVariantDict
<span class="line-modified">!  * @key: the key to lookup in the dictionary</span>
   * @format_string: a GVariant format string
   * @...: the arguments to unpack the value into
   *
   * Looks up a value in a #GVariantDict.
   *
<span class="line-new-header">--- 3963,11 ---</span>
  }
  
  /**
   * g_variant_dict_lookup:
   * @dict: a #GVariantDict
<span class="line-modified">!  * @key: the key to look up in the dictionary</span>
   * @format_string: a GVariant format string
   * @...: the arguments to unpack the value into
   *
   * Looks up a value in a #GVariantDict.
   *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 4002,11 ***</span>
  }
  
  /**
   * g_variant_dict_lookup_value:
   * @dict: a #GVariantDict
<span class="line-modified">!  * @key: the key to lookup in the dictionary</span>
   * @expected_type: (nullable): a #GVariantType, or %NULL
   *
   * Looks up a value in a #GVariantDict.
   *
   * If @key is not found in @dictionary, %NULL is returned.
<span class="line-new-header">--- 4010,11 ---</span>
  }
  
  /**
   * g_variant_dict_lookup_value:
   * @dict: a #GVariantDict
<span class="line-modified">!  * @key: the key to look up in the dictionary</span>
   * @expected_type: (nullable): a #GVariantType, or %NULL
   *
   * Looks up a value in a #GVariantDict.
   *
   * If @key is not found in @dictionary, %NULL is returned.
</pre>
<hr />
<pre>
<span class="line-old-header">*** 4042,11 ***</span>
  }
  
  /**
   * g_variant_dict_contains:
   * @dict: a #GVariantDict
<span class="line-modified">!  * @key: the key to lookup in the dictionary</span>
   *
   * Checks if @key exists in @dict.
   *
   * Returns: %TRUE if @key is in @dict
   *
<span class="line-new-header">--- 4050,11 ---</span>
  }
  
  /**
   * g_variant_dict_contains:
   * @dict: a #GVariantDict
<span class="line-modified">!  * @key: the key to look up in the dictionary</span>
   *
   * Checks if @key exists in @dict.
   *
   * Returns: %TRUE if @key is in @dict
   *
</pre>
<hr />
<pre>
<span class="line-old-header">*** 4331,11 ***</span>
        else
          {
            if (c == &#39;@&#39;)
              c = next_char ();
  
<span class="line-modified">!           /* ISO/IEC 9899:1999 (C99) �7.21.5.2:</span>
             *    The terminating null character is considered to be
             *    part of the string.
             */
            if (c != &#39;\0&#39; &amp;&amp; strchr (&quot;bynqiuxthdsog?&quot;, c) == NULL)
              return FALSE;
<span class="line-new-header">--- 4339,11 ---</span>
        else
          {
            if (c == &#39;@&#39;)
              c = next_char ();
  
<span class="line-modified">!           /* ISO/IEC 9899:1999 (C99) 7.21.5.2:</span>
             *    The terminating null character is considered to be
             *    part of the string.
             */
            if (c != &#39;\0&#39; &amp;&amp; strchr (&quot;bynqiuxthdsog?&quot;, c) == NULL)
              return FALSE;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 4683,11 ***</span>
        if (g_str_has_suffix (str, &quot;y&quot;))
          {
            if (str[2] != &#39;a&#39;) /* &#39;^a&amp;ay&#39;, &#39;^ay&#39; */
              g_free (ptr);
            else if (str[1] == &#39;a&#39;) /* &#39;^aay&#39; */
<span class="line-modified">!         g_strfreev (ptr);</span>
            break; /* &#39;^&amp;ay&#39; */
          }
        else if (str[2] != &#39;&amp;&#39;) /* &#39;^as&#39;, &#39;^ao&#39; */
          g_strfreev (ptr);
        else                      /* &#39;^a&amp;s&#39;, &#39;^a&amp;o&#39; */
<span class="line-new-header">--- 4691,11 ---</span>
        if (g_str_has_suffix (str, &quot;y&quot;))
          {
            if (str[2] != &#39;a&#39;) /* &#39;^a&amp;ay&#39;, &#39;^ay&#39; */
              g_free (ptr);
            else if (str[1] == &#39;a&#39;) /* &#39;^aay&#39; */
<span class="line-modified">!             g_strfreev (ptr);</span>
            break; /* &#39;^&amp;ay&#39; */
          }
        else if (str[2] != &#39;&amp;&#39;) /* &#39;^as&#39;, &#39;^ao&#39; */
          g_strfreev (ptr);
        else                      /* &#39;^a&amp;s&#39;, &#39;^a&amp;o&#39; */
</pre>
<hr />
<pre>
<span class="line-old-header">*** 6007,10 ***</span>
<span class="line-new-header">--- 6015,15 ---</span>
   *
   * @notify will be called with @user_data when @data is no longer
   * needed.  The exact time of this call is unspecified and might even be
   * before this function returns.
   *
<span class="line-added">+  * Note: @data must be backed by memory that is aligned appropriately for the</span>
<span class="line-added">+  * @type being loaded. Otherwise this function will internally create a copy of</span>
<span class="line-added">+  * the memory (since GLib 2.60) or (in older versions) fail and exit the</span>
<span class="line-added">+  * process.</span>
<span class="line-added">+  *</span>
   * Returns: (transfer none): a new floating #GVariant of type @type
   *
   * Since: 2.24
   **/
  GVariant *
</pre>
<center><a href="gvariant-serialiser.h.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="gvariant.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>