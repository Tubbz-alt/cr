<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gst-plugins-base/gst-libs/gst/video/video-chroma.c</title>
    <link rel="stylesheet" href="../../../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>   1 /* GStreamer
   2  * Copyright (C) 2013 Wim Taymans &lt;wim.taymans@gmail.com&gt;
   3  *
   4  * This library is free software; you can redistribute it and/or
   5  * modify it under the terms of the GNU Library General Public
   6  * License as published by the Free Software Foundation; either
   7  * version 2 of the License, or (at your option) any later version.
   8  *
   9  * This library is distributed in the hope that it will be useful,
  10  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  11  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
  12  * Library General Public License for more details.
  13  *
  14  * You should have received a copy of the GNU Library General Public
  15  * License along with this library; if not, write to the
  16  * Free Software Foundation, Inc., 51 Franklin St, Fifth Floor,
  17  * Boston, MA 02110-1301, USA.
  18  */
  19 
  20 #ifdef HAVE_CONFIG_H
  21 #  include &quot;config.h&quot;
  22 #endif
  23 
  24 #include &lt;string.h&gt;
  25 #include &lt;stdio.h&gt;
  26 
  27 #ifndef GSTREAMER_LITE
  28 #include &quot;video-orc.h&quot;
  29 #else // GSTREAMER_LITE
  30 #include &quot;video-orc-dist.h&quot;
  31 #endif // GSTREAMER_LITE
  32 #include &quot;video-format.h&quot;
  33 
  34 
  35 /**
  36  * SECTION:gstvideochroma
  37  * @title: GstVideoChromaResample
  38  * @short_description: Functions and utility object for operating on chroma video planes
  39  *
  40  * The functions gst_video_chroma_from_string() and gst_video_chroma_to_string() convert
  41  * between #GstVideoChromaSite and string descriptions.
  42  *
  43  * #GstVideoChromaResample is a utility object for resampling chroma planes
  44  * and converting between different chroma sampling sitings.
  45  *
  46  */
  47 
  48 #ifndef GST_DISABLE_GST_DEBUG
  49 #define GST_CAT_DEFAULT ensure_debug_category()
  50 static GstDebugCategory *
  51 ensure_debug_category (void)
  52 {
  53   static gsize cat_gonce = 0;
  54 
  55   if (g_once_init_enter (&amp;cat_gonce)) {
  56     gsize cat_done;
  57 
  58     cat_done = (gsize) _gst_debug_category_new (&quot;video-chroma&quot;, 0,
  59         &quot;video-chroma object&quot;);
  60 
  61     g_once_init_leave (&amp;cat_gonce, cat_done);
  62   }
  63 
  64   return (GstDebugCategory *) cat_gonce;
  65 }
  66 #else
  67 #define ensure_debug_category() /* NOOP */
  68 #endif /* GST_DISABLE_GST_DEBUG */
  69 
  70 typedef struct
  71 {
  72   const gchar *name;
  73   GstVideoChromaSite site;
  74 } ChromaSiteInfo;
  75 
  76 static const ChromaSiteInfo chromasite[] = {
  77   {&quot;jpeg&quot;, GST_VIDEO_CHROMA_SITE_JPEG},
  78   {&quot;mpeg2&quot;, GST_VIDEO_CHROMA_SITE_MPEG2},
  79   {&quot;dv&quot;, GST_VIDEO_CHROMA_SITE_DV}
  80 };
  81 
  82 /**
  83  * gst_video_chroma_from_string:
  84  * @s: a chromasite string
  85  *
  86  * Convert @s to a #GstVideoChromaSite
  87  *
  88  * Returns: a #GstVideoChromaSite or %GST_VIDEO_CHROMA_SITE_UNKNOWN when @s does
  89  * not contain a valid chroma description.
  90  */
  91 GstVideoChromaSite
  92 gst_video_chroma_from_string (const gchar * s)
  93 {
  94   gint i;
  95   for (i = 0; i &lt; G_N_ELEMENTS (chromasite); i++) {
  96     if (g_str_equal (chromasite[i].name, s))
  97       return chromasite[i].site;
  98   }
  99   return GST_VIDEO_CHROMA_SITE_UNKNOWN;
 100 }
 101 
 102 /**
 103  * gst_video_chroma_to_string:
 104  * @site: a #GstVideoChromaSite
 105  *
 106  * Converts @site to its string representation.
 107  *
 108  * Returns: a string describing @site.
 109  */
 110 const gchar *
 111 gst_video_chroma_to_string (GstVideoChromaSite site)
 112 {
 113   gint i;
 114   for (i = 0; i &lt; G_N_ELEMENTS (chromasite); i++) {
 115     if (chromasite[i].site == site)
 116       return chromasite[i].name;
 117   }
 118   return NULL;
 119 }
 120 
 121 struct _GstVideoChromaResample
 122 {
 123   GstVideoChromaMethod method;
 124   GstVideoChromaSite site;
 125   GstVideoChromaFlags flags;
 126   GstVideoFormat format;
 127   gint h_factor, v_factor;
 128   guint n_lines;
 129   gint offset;
 130   void (*h_resample) (GstVideoChromaResample * resample, gpointer pixels,
 131       gint width);
 132   void (*v_resample) (GstVideoChromaResample * resample, gpointer lines[],
 133       gint width);
 134 };
 135 
 136 #define PR(i)          (p[2 + 4 * (i)])
 137 #define PB(i)          (p[3 + 4 * (i)])
 138 
 139 #define PR0(i)         (l0[2 + 4 * (i)])
 140 #define PR1(i)         (l1[2 + 4 * (i)])
 141 #define PR2(i)         (l2[2 + 4 * (i)])
 142 #define PR3(i)         (l3[2 + 4 * (i)])
 143 #define PB0(i)         (l0[3 + 4 * (i)])
 144 #define PB1(i)         (l1[3 + 4 * (i)])
 145 #define PB2(i)         (l2[3 + 4 * (i)])
 146 #define PB3(i)         (l3[3 + 4 * (i)])
 147 
 148 #define FILT_1_1(a,b)          ((a) + (b) + 1) &gt;&gt; 1
 149 #define FILT_1_3_3_1(a,b,c,d)  ((a) + 3*((b)+(c)) + (d) + 4) &gt;&gt; 3
 150 
 151 #define FILT_3_1(a,b)          (3*(a) + (b) + 2) &gt;&gt; 2
 152 #define FILT_1_3(a,b)          ((a) + 3*(b) + 2) &gt;&gt; 2
 153 #define FILT_1_2_1(a,b,c)      ((a) + 2*(b) + (c) + 2) &gt;&gt; 2
 154 
 155 #define FILT_7_1(a,b)          (7*(a) + 1*(b) + 4) &gt;&gt; 3
 156 #define FILT_1_7(a,b)          (1*(a) + 7*(b) + 4) &gt;&gt; 3
 157 
 158 #define FILT_5_3(a,b)          (5*(a) + 3*(b) + 4) &gt;&gt; 3
 159 #define FILT_3_5(a,b)          (3*(a) + 5*(b) + 4) &gt;&gt; 3
 160 
 161 #define FILT_10_3_2_1(a,b,c,d)      (10*(a) + 3*(b) + 2*(c) + (d) + 8) &gt;&gt; 16
 162 #define FILT_1_2_3_10(a,b,c,d)      ((a) + 2*(b) + 3*(c) + 10*(d) + 8) &gt;&gt; 16
 163 #define FILT_1_2_3_4_3_2_1(a,b,c,d,e,f,g) ((a) + 2*((b)+(f)) + 3*((c)+(e)) + 4*(d) + (g) + 8) &gt;&gt; 16
 164 
 165 /* 2x horizontal upsampling without cositing
 166  *
 167  * +----------    a
 168  * | +------ (3*a +   b + 2) &gt;&gt; 2
 169  * | | +---- (  a + 3*b + 2) &gt;&gt; 2
 170  * v v v
 171  * O-O-O-O-
 172  *  x   x
 173  *  a   b
 174  */
 175 #define MAKE_UPSAMPLE_H2(name,type)                                     \
 176 static void                                                             \
 177 video_chroma_up_h2_##name (GstVideoChromaResample *resample,            \
 178     gpointer pixels, gint width)                                        \
 179 {                                                                       \
 180   type *p = pixels;                                                     \
 181   gint i;                                                               \
 182   type tr0, tr1;                                                        \
 183   type tb0, tb1;                                                        \
 184                                                                         \
 185   tr1 = PR(0);                                                          \
 186   tb1 = PB(0);                                                          \
 187   for (i = 1; i &lt; width - 1; i += 2) {                                  \
 188     tr0 = tr1, tr1 = PR(i+1);                                           \
 189     tb0 = tb1, tb1 = PB(i+1);                                           \
 190                                                                         \
 191     PR(i) = FILT_3_1 (tr0, tr1);                                        \
 192     PB(i) = FILT_3_1 (tb0, tb1);                                        \
 193     PR(i+1) = FILT_1_3 (tr0, tr1);                                      \
 194     PB(i+1) = FILT_1_3 (tb0, tb1);                                      \
 195   }                                                                     \
 196 }
 197 
 198 /* 2x vertical upsampling without cositing
 199  *
 200  *   O--O--O-  &lt;---- a
 201  * a x  x  x
 202  *   O--O--O-  &lt;---- (3*a +   b + 2) &gt;&gt; 2
 203  *   O--O--O-  &lt;-----(  a + 3*b + 2) &gt;&gt; 2
 204  * b x  x  x
 205  *   O--O--O-  &lt;---- b
 206  */
 207 #define MAKE_UPSAMPLE_V2(name,type)                                     \
 208 static void                                                             \
 209 video_chroma_up_v2_##name (GstVideoChromaResample *resample,            \
 210     gpointer lines[], gint width)                                       \
 211 {                                                                       \
 212   type *l0 = lines[0];                                                  \
 213   type *l1 = lines[1];                                                  \
 214                                                                         \
 215   if (resample-&gt;h_resample) {                                           \
 216     resample-&gt;h_resample (resample, l0, width);                         \
 217     if (l0 != l1)                                                       \
 218       resample-&gt;h_resample (resample, l1, width);                       \
 219   }                                                                     \
 220   if (l0 != l1) {                                                       \
<a name="1" id="anc1"></a><span class="line-modified"> 221     type *d0 = l0;                          \</span>
<span class="line-modified"> 222     type *d1 = l1;                          \</span>
 223     video_orc_chroma_up_v2_##name (d0, d1, l0, l1, width);              \
 224   }                                                                     \
 225 }
 226 /* 2x vertical upsampling interlaced without cositing
 227  *
 228  *   even           odd
 229  *
 230  *   O--O--O--------------- &lt;---  a
 231  * a x  x  x
 232  *   --------------O--O--O- &lt;---  c
 233  *   O--O--O--------------- &lt;--- (5*a + 3*b + 4) &gt;&gt; 3
 234  * c               x  x  x
 235  *   --------------O--O--O- &lt;--- (7*c +   d + 4) &gt;&gt; 3
 236  *   O--O--O--------------- &lt;--- (  a + 7*b + 4) &gt;&gt; 3
 237  * b x  x  x
 238  *   --------------O--O--O- &lt;--- (3*c + 5*d + 4) &gt;&gt; 3
 239  *   O--O--O---------------
 240  * d               x  x  x
 241  *   --------------O--O--O-
 242  */
 243 #define MAKE_UPSAMPLE_VI2(name,type)                                    \
 244 static void                                                             \
 245 video_chroma_up_vi2_##name (GstVideoChromaResample *resample,           \
 246     gpointer lines[], gint width)                                       \
 247 {                                                                       \
 248   gint i;                                                               \
 249   type *l0 = lines[0];                                                  \
 250   type *l1 = lines[1];                                                  \
 251   type *l2 = lines[2];                                                  \
 252   type *l3 = lines[3];                                                  \
 253   type tr0, tr1, tr2, tr3;                                              \
 254   type tb0, tb1, tb2, tb3;                                              \
 255                                                                         \
 256   if (resample-&gt;h_resample) {                                           \
 257     if (l0 != l1) {                                                     \
 258       resample-&gt;h_resample (resample, l0, width);                       \
 259       resample-&gt;h_resample (resample, l1, width);                       \
 260     }                                                                   \
 261     if (l2 != l3) {                                                     \
 262       resample-&gt;h_resample (resample, l2, width);                       \
 263       resample-&gt;h_resample (resample, l3, width);                       \
 264     }                                                                   \
 265   }                                                                     \
 266   if (l0 != l1 &amp;&amp; l2 != l3) {                                           \
 267     for (i = 0; i &lt; width; i++) {                                       \
 268       tr0 = PR0(i), tr2 = PR2(i);                                       \
 269       tb0 = PB0(i), tb2 = PB2(i);                                       \
 270       tr1 = PR1(i), tr3 = PR3(i);                                       \
 271       tb1 = PB1(i), tb3 = PB3(i);                                       \
 272                                                                         \
 273       PR0(i) = FILT_5_3 (tr0, tr2);                                     \
 274       PB0(i) = FILT_5_3 (tb0, tb2);                                     \
 275       PR1(i) = FILT_7_1 (tr1, tr3);                                     \
 276       PB1(i) = FILT_7_1 (tb1, tb3);                                     \
 277       PR2(i) = FILT_1_7 (tr0, tr2);                                     \
 278       PB2(i) = FILT_1_7 (tb0, tb2);                                     \
 279       PR3(i) = FILT_3_5 (tr1, tr3);                                     \
 280       PB3(i) = FILT_3_5 (tb1, tb3);                                     \
 281     }                                                                   \
 282   }                                                                     \
 283 }
 284 
 285 /* 2x horizontal downsampling without cositing
 286  *
 287  *  +------ (a + b+ 1) &gt;&gt; 1
 288  *  |
 289  *  v
 290  * -O---O--
 291  * x x x x
 292  * a b c d
 293  */
 294 #define MAKE_DOWNSAMPLE_H2_ORC(name,type)                               \
 295 static void                                                             \
 296 video_chroma_down_h2_##name (GstVideoChromaResample *resample,          \
 297     gpointer pixels, gint width)                                        \
 298 {                                                                       \
 299   type *p = pixels;                                                     \
<a name="2" id="anc2"></a><span class="line-modified"> 300   type *d = p;                              \</span>
 301                                                                         \
 302   video_orc_chroma_down_h2_##name (d, p, width / 2);                    \
 303 }
 304 
 305 #define MAKE_DOWNSAMPLE_H2(name,type)                                   \
 306 static void                                                             \
 307 video_chroma_down_h2_##name (GstVideoChromaResample *resample,          \
 308     gpointer pixels, gint width)                                        \
 309 {                                                                       \
 310   type *p = pixels;                                                     \
 311   gint i;                                                               \
 312                                                                         \
 313   for (i = 0; i &lt; width - 1; i += 2) {                                  \
 314     type tr0 = PR(i), tr1 = PR(i+1);                                    \
 315     type tb0 = PB(i), tb1 = PB(i+1);                                    \
 316                                                                         \
 317     PR(i) = FILT_1_1 (tr0, tr1);                                        \
 318     PB(i) = FILT_1_1 (tb0, tb1);                                        \
 319   }                                                                     \
 320 }
 321 /* 2x vertical downsampling without cositing
 322  *
 323  * a x--x--x-
 324  *   O  O  O &lt;---- (a + b + 1) &gt;&gt; 1
 325  * b x--x--x-
 326  * c x--x--x-
 327  *   O  O  O
 328  * d x--x--x-
 329  */
 330 #define MAKE_DOWNSAMPLE_V2(name,type)                                   \
 331 static void                                                             \
 332 video_chroma_down_v2_##name (GstVideoChromaResample *resample,          \
 333     gpointer lines[], gint width)                                       \
 334 {                                                                       \
 335   type *l0 = lines[0];                                                  \
 336   type *l1 = lines[1];                                                  \
 337                                                                         \
<a name="3" id="anc3"></a><span class="line-modified"> 338   if (l0 != l1) {                           \</span>
<span class="line-modified"> 339     type *d0 = l0;                          \</span>
 340     video_orc_chroma_down_v2_##name (d0, l0, l1, width);                \
<a name="4" id="anc4"></a><span class="line-modified"> 341   }                                 \</span>
 342                                                                         \
 343   if (resample-&gt;h_resample)                                             \
 344     resample-&gt;h_resample (resample, l0, width);                         \
 345 }
 346 /* 2x vertical downsampling interlaced without cositing
 347  *
 348  *   even           odd
 349  *
 350  * a x--x--x---------------
 351  *   O  O  O                &lt;---
 352  * b --------------x--x--x-
 353  * c x--x--x---------------
 354  *                 O  O  O  &lt;---
 355  * d --------------x--x--x-
 356  */
 357 #define MAKE_DOWNSAMPLE_VI2(name,type)                                  \
 358 static void                                                             \
 359 video_chroma_down_vi2_##name (GstVideoChromaResample *resample,         \
 360     gpointer lines[], gint width)                                       \
 361 {                                                                       \
 362   /* FIXME */                                                           \
 363   if (resample-&gt;h_resample)                                             \
 364     resample-&gt;h_resample (resample, lines[0], width);                   \
 365 }
 366 
 367 MAKE_UPSAMPLE_H2 (u16, guint16);
 368 MAKE_UPSAMPLE_H2 (u8, guint8);
 369 MAKE_UPSAMPLE_V2 (u16, guint16);
 370 MAKE_UPSAMPLE_V2 (u8, guint8);
 371 MAKE_UPSAMPLE_VI2 (u16, guint16);
 372 MAKE_UPSAMPLE_VI2 (u8, guint8);
 373 MAKE_DOWNSAMPLE_H2 (u16, guint16);
 374 MAKE_DOWNSAMPLE_H2_ORC (u8, guint8);
 375 MAKE_DOWNSAMPLE_V2 (u16, guint16);
 376 MAKE_DOWNSAMPLE_V2 (u8, guint8);
 377 MAKE_DOWNSAMPLE_VI2 (u16, guint16);
 378 MAKE_DOWNSAMPLE_VI2 (u8, guint8);
 379 
 380 /* 4x horizontal upsampling without cositing
 381  *
 382  *     +---------- (7*a +   b + 4) &gt;&gt; 3
 383  *     | +-------- (5*a + 3*b + 4) &gt;&gt; 3
 384  * a a | | +------ (3*a + 5*b + 4) &gt;&gt; 3
 385  * | | | | | +---- (  a + 7*b + 4) &gt;&gt; 3
 386  * v v v v v v
 387  * O-O-O-O-O-O-O-O-
 388  *    x       x
 389  *    a       b
 390  */
 391 #define MAKE_UPSAMPLE_H4(name,type)                                          \
 392 static void                                                             \
 393 video_chroma_up_h4_##name (GstVideoChromaResample *resample,           \
 394     gpointer pixels, gint width)                        \
 395 {                                                                       \
 396   type *p = pixels;                                                     \
 397   gint i;                                                               \
 398   type tr0, tr1;                                                        \
 399   type tb0, tb1;                                                        \
 400                                                                         \
 401   tr1 = PR(0);                                                          \
 402   tb1 = PB(0);                                                          \
 403   for (i = 2; i &lt; width - 3; i += 4) {                                  \
 404     tr0 = tr1, tr1 = PR(i+2);                                           \
 405     tb0 = tb1, tb1 = PB(i+2);                                           \
 406                                                                         \
 407     PR(i) = FILT_7_1 (tr0, tr1);                                        \
 408     PB(i) = FILT_7_1 (tb0, tb1);                                        \
 409     PR(i+1) = FILT_5_3 (tr0, tr1);                                      \
 410     PB(i+1) = FILT_5_3 (tb0, tb1);                                      \
 411     PR(i+2) = FILT_3_5 (tr0, tr1);                                      \
 412     PB(i+2) = FILT_3_5 (tb0, tb1);                                      \
 413     PR(i+3) = FILT_1_7 (tr0, tr1);                                      \
 414     PB(i+3) = FILT_1_7 (tb0, tb1);                                      \
 415   }                                                                     \
 416 }
 417 
 418 /* 4x vertical upsampling without cositing
 419  *
 420  *   O--O--O-  &lt;---- a
 421  *   O--O--O-  &lt;---- a
 422  * a x  x  x
 423  *   O--O--O-  &lt;---- (7*a +   b + 4) &gt;&gt; 3
 424  *   O--O--O-  &lt;---- (5*a + 3*b + 4) &gt;&gt; 3
 425  *   O--O--O-  &lt;---- (3*a + 5*b + 4) &gt;&gt; 3
 426  *   O--O--O-  &lt;-----(  a + 7*b + 4) &gt;&gt; 3
 427  * b x  x  x
 428  *   O--O--O-
 429  *   O--O--O-
 430  */
 431 #define MAKE_UPSAMPLE_V4(name,type)                                          \
 432 static void                                                             \
 433 video_chroma_up_v4_##name (GstVideoChromaResample *resample,            \
 434     gpointer lines[], gint width)                                       \
 435 {                                                                       \
 436   gint i;                                                               \
 437   type *l0 = lines[0];                                                  \
 438   type *l1 = lines[1];                                                  \
 439   type *l2 = lines[2];                                                  \
 440   type *l3 = lines[3];                                                  \
 441   type tr0, tr1;                                                        \
 442   type tb0, tb1;                                                        \
 443                                                                         \
 444   if (resample-&gt;h_resample) {                                           \
 445     if (l0 != l1) {                                                     \
 446       resample-&gt;h_resample (resample, l0, width);                       \
 447       resample-&gt;h_resample (resample, l1, width);                       \
 448     }                                                                   \
 449     if (l2 != l3) {                                                     \
 450       resample-&gt;h_resample (resample, l2, width);                       \
 451       resample-&gt;h_resample (resample, l3, width);                       \
 452     }                                                                   \
 453   }                                                                     \
 454   if (l0 != l1 &amp;&amp; l2 != l3) {                                           \
 455     for (i = 0; i &lt; width; i++) {                                       \
 456       tr0 = PR0(i), tr1 = PR2(i);                                       \
 457       tb0 = PB0(i), tb1 = PB2(i);                                       \
 458                                                                         \
 459       PR0(i) = FILT_7_1 (tr0, tr1);                                     \
 460       PB0(i) = FILT_7_1 (tb0, tb1);                                     \
 461       PR1(i) = FILT_5_3 (tr0, tr1);                                     \
 462       PB1(i) = FILT_5_3 (tb0, tb1);                                     \
 463       PR2(i) = FILT_3_5 (tr0, tr1);                                     \
 464       PB2(i) = FILT_3_5 (tb0, tb1);                                     \
 465       PR3(i) = FILT_1_7 (tr0, tr1);                                     \
 466       PB3(i) = FILT_1_7 (tb0, tb1);                                     \
 467     }                                                                   \
 468   }                                                                     \
 469 }
 470 /* 4x vertical upsampling interlaced without cositing
 471  *
 472  */
 473 #define MAKE_UPSAMPLE_VI4(name,type)                                         \
 474 static void                                                             \
 475 video_chroma_up_vi4_##name (GstVideoChromaResample *resample,           \
 476     gpointer lines[], gint width)                                       \
 477 {                                                                       \
 478   /* FIXME */                                                           \
 479   if (resample-&gt;h_resample) {                                           \
 480     resample-&gt;h_resample (resample, lines[0], width);                   \
 481   }                                                                     \
 482 }
 483 
 484 /* 4x horizontal downsampling without cositing
 485  *
 486  *    +------ (a + 3*b + 3*c + d + 4) &gt;&gt; 3
 487  *    |
 488  *    v
 489  * ---O-------O---
 490  * x x x x x x x x
 491  * a b c d e f g h
 492  */
 493 #define MAKE_DOWNSAMPLE_H4(name,type)                                        \
 494 static void                                                             \
 495 video_chroma_down_h4_##name (GstVideoChromaResample *resample,         \
 496     gpointer pixels, gint width)                        \
 497 {                                                                       \
 498   type *p = pixels;                                                     \
 499   gint i;                                                               \
 500                                                                         \
 501   for (i = 0; i &lt; width - 4; i += 4) {                                  \
 502     type tr0 = PR(i), tr1 = PR(i+1), tr2 = PR(i+2), tr3 = PR(i+3);      \
 503     type tb0 = PB(i), tb1 = PB(i+1), tb2 = PB(i+2), tb3 = PB(i+3);      \
 504                                                                         \
 505     PR(i) = FILT_1_3_3_1 (tr0, tr1, tr2, tr3);                          \
 506     PB(i) = FILT_1_3_3_1 (tb0, tb1, tb2, tb3);                          \
 507   }                                                                     \
 508 }
 509 
 510 /* 4x vertical downsampling without cositing
 511  *
 512  * a x--x--x-
 513  * b x--x--x-
 514  *   O  O  O   &lt;---- (a + 3*b + 3*c + d + 4) &gt;&gt; 4
 515  * c x--x--x-
 516  * d x--x--x-
 517  * e x--x--x-
 518  * f x--x--x-
 519  *   O  O  O
 520  * g x--x--x-
 521  * h x--x--x-
 522  */
 523 #define MAKE_DOWNSAMPLE_V4(name,type)                               \
 524 static void                                                             \
 525 video_chroma_down_v4_##name (GstVideoChromaResample *resample,          \
 526     gpointer lines[], gint width)                                       \
 527 {                                                                       \
 528   type *l0 = lines[0];                                                  \
 529   type *l1 = lines[1];                                                  \
 530   type *l2 = lines[2];                                                  \
 531   type *l3 = lines[3];                                                  \
<a name="5" id="anc5"></a><span class="line-modified"> 532   type *d = l0;                             \</span>
<span class="line-modified"> 533                                                                         \</span>
<span class="line-modified"> 534   video_orc_chroma_down_v4_##name(d, l0, l1, l2, l3, width);        \</span>
 535                                                                         \
 536   if (resample-&gt;h_resample)                                             \
 537     resample-&gt;h_resample (resample, l0, width);                         \
 538 }
 539 /* 4x vertical downsampling interlaced without cositing
 540  *
 541  */
 542 #define MAKE_DOWNSAMPLE_VI4(name,type)                                       \
 543 static void                                                             \
 544 video_chroma_down_vi4_##name (GstVideoChromaResample *resample,         \
 545     gpointer lines[], gint width)                                       \
 546 {                                                                       \
 547   /* FIXME */                                                           \
 548   if (resample-&gt;h_resample) {                                           \
 549     resample-&gt;h_resample (resample, lines[0], width);                   \
 550   }                                                                     \
 551 }
 552 
 553 MAKE_UPSAMPLE_H4 (u16, guint16);
 554 MAKE_UPSAMPLE_H4 (u8, guint8);
 555 MAKE_UPSAMPLE_V4 (u16, guint16);
 556 MAKE_UPSAMPLE_V4 (u8, guint8);
 557 MAKE_UPSAMPLE_VI4 (u16, guint16);
 558 MAKE_UPSAMPLE_VI4 (u8, guint8);
 559 MAKE_DOWNSAMPLE_H4 (u16, guint16);
 560 MAKE_DOWNSAMPLE_H4 (u8, guint8);
 561 MAKE_DOWNSAMPLE_V4 (u16, guint16);
 562 MAKE_DOWNSAMPLE_V4 (u8, guint8);
 563 MAKE_DOWNSAMPLE_VI4 (u16, guint16);
 564 MAKE_DOWNSAMPLE_VI4 (u8, guint8);
 565 
 566 /* 2x horizontal upsampling with cositing
 567  *
 568  * a +------ (a + b + 1) &gt;&gt; 1
 569  * | |
 570  * v v
 571  * O-O-O-O
 572  * x   x
 573  * a   b
 574  */
 575 #define MAKE_UPSAMPLE_H2_CS_ORC(name,type)                              \
 576 static void                                                             \
 577 video_chroma_up_h2_cs_##name (GstVideoChromaResample *resample,         \
 578     gpointer pixels, gint width)                                        \
 579 {                                                                       \
 580   type *p = pixels;                                                     \
 581   /* ORC version is slower */                                           \
 582   video_orc_chroma_up_h2_cs_##name (p, p, p, width-1);                  \
 583 }
 584 
 585 #define MAKE_UPSAMPLE_H2_CS(name,type)                                  \
 586 static void                                                             \
 587 video_chroma_up_h2_cs_##name (GstVideoChromaResample *resample,         \
 588     gpointer pixels, gint width)                                        \
 589 {                                                                       \
 590   type *p = pixels;                                                     \
 591   gint i;                                                               \
 592                                                                         \
 593   for (i = 1; i &lt; width - 1; i += 2) {                                  \
 594     PR(i) = FILT_1_1 (PR(i-1), PR(i+1));                                \
 595     PB(i) = FILT_1_1 (PB(i-1), PB(i+1));                                \
 596   }                                                                     \
 597 }
 598 /* 2x vertical upsampling with cositing
 599  *
 600  * a x O--O--O-  &lt;---- a
 601  *     O--O--O-  &lt;---- (a +  b + 1) &gt;&gt; 1
 602  * b x O--O--O-
 603  *     O--O--O-
 604  */
 605 #define MAKE_UPSAMPLE_V2_CS(name,type)                                       \
 606 static void                                                             \
 607 video_chroma_up_v2_cs_##name (GstVideoChromaResample *resample,         \
 608     gpointer lines[], gint width)                                       \
 609 {                                                                       \
 610   /* FIXME */                                                           \
 611   if (resample-&gt;h_resample) {                                           \
 612     resample-&gt;h_resample (resample, lines[0], width);                   \
 613   }                                                                     \
 614 }
 615 /* 2x vertical upsampling interlaced with cositing
 616  *
 617  */
 618 #define MAKE_UPSAMPLE_VI2_CS(name,type)                                      \
 619 static void                                                             \
 620 video_chroma_up_vi2_cs_##name (GstVideoChromaResample *resample,        \
 621     gpointer lines[], gint width)                                       \
 622 {                                                                       \
 623   /* FIXME */                                                           \
 624   if (resample-&gt;h_resample) {                                           \
 625     resample-&gt;h_resample (resample, lines[0], width);                   \
 626   }                                                                     \
 627 }
 628 
 629 /* 2x horizontal downsampling with cositing
 630  *
 631  * a
 632  * |   +------ (b + 2*c + d + 2) &gt;&gt; 2
 633  * v   v
 634  * O---O---O---
 635  * x x x x x x
 636  * a b c d e f
 637  */
 638 #define MAKE_DOWNSAMPLE_H2_CS(name,type)                                     \
 639 static void                                                             \
 640 video_chroma_down_h2_cs_##name (GstVideoChromaResample *resample,       \
 641     gpointer pixels, gint width)                                        \
 642 {                                                                       \
 643   type *p = pixels;                                                     \
 644   gint i;                                                               \
 645                                                                         \
 646   if (width &lt; 2)                                                        \
 647     return;                                                             \
 648                                                                         \
 649   PR(0) = FILT_3_1 (PR(0), PR(1));                                      \
 650   PB(0) = FILT_3_1 (PB(0), PB(1));                                      \
 651                                                                         \
 652   for (i = 2; i &lt; width - 2; i += 2) {                                  \
 653     PR(i) = FILT_1_2_1 (PR(i-1), PR(i), PR(i+1));                       \
 654     PB(i) = FILT_1_2_1 (PB(i-1), PB(i), PB(i+1));                       \
 655   }                                                                     \
 656   if (i &lt; width) {                                                      \
 657     PR(i) = FILT_1_3 (PR(i-1), PR(i));                                  \
 658     PB(i) = FILT_1_3 (PB(i-1), PB(i));                                  \
 659   }                                                                     \
 660 }
 661 /* 2x vertical downsampling with cositing
 662  *
 663  * a x O--O--O-  &lt;---- a
 664  * b x --------
 665  * c x O--O--O-  &lt;---- (b + 2*c + d + 2) &gt;&gt; 2
 666  * d x --------
 667  * e x O--O--O-
 668  * f x --------
 669  */
 670 #define MAKE_DOWNSAMPLE_V2_CS(name,type)                                     \
 671 static void                                                             \
 672 video_chroma_down_v2_cs_##name (GstVideoChromaResample *resample,       \
 673     gpointer lines[], gint width)                                       \
 674 {                                                                       \
 675   /* FIXME */                                                           \
 676   if (resample-&gt;h_resample) {                                           \
 677     resample-&gt;h_resample (resample, lines[0], width);                   \
 678   }                                                                     \
 679 }
 680 /* 2x vertical downsampling interlaced with cositing
 681  *
 682  */
 683 #define MAKE_DOWNSAMPLE_VI2_CS(name,type)                                    \
 684 static void                                                             \
 685 video_chroma_down_vi2_cs_##name (GstVideoChromaResample *resample,      \
 686     gpointer lines[], gint width)                                       \
 687 {                                                                       \
 688   /* FIXME */                                                           \
 689   if (resample-&gt;h_resample) {                                           \
 690     resample-&gt;h_resample (resample, lines[0], width);                   \
 691   }                                                                     \
 692 }
 693 
 694 MAKE_UPSAMPLE_H2_CS (u16, guint16);
 695 MAKE_UPSAMPLE_H2_CS (u8, guint8);
 696 MAKE_UPSAMPLE_V2_CS (u16, guint16);
 697 MAKE_UPSAMPLE_V2_CS (u8, guint8);
 698 MAKE_UPSAMPLE_VI2_CS (u16, guint16);
 699 MAKE_UPSAMPLE_VI2_CS (u8, guint8);
 700 MAKE_DOWNSAMPLE_H2_CS (u16, guint16);
 701 MAKE_DOWNSAMPLE_H2_CS (u8, guint8);
 702 MAKE_DOWNSAMPLE_V2_CS (u16, guint16);
 703 MAKE_DOWNSAMPLE_V2_CS (u8, guint8);
 704 MAKE_DOWNSAMPLE_VI2_CS (u16, guint16);
 705 MAKE_DOWNSAMPLE_VI2_CS (u8, guint8);
 706 
 707 /* 4x horizontal upsampling with cositing
 708  *
 709  *   +---------- (3*a +   b + 2) &gt;&gt; 2
 710  * a | +-------- (  a +   b + 1) &gt;&gt; 1
 711  * | | | +------ (  a + 3*b + 2) &gt;&gt; 2
 712  * v v v v
 713  * O-O-O-O-O-O-O-O
 714  * x       x
 715  * a       b
 716  */
 717 #define MAKE_UPSAMPLE_H4_CS(name,type)                                       \
 718 static void                                                             \
 719 video_chroma_up_h4_cs_##name (GstVideoChromaResample *resample,        \
 720     gpointer pixels, gint width)                        \
 721 {                                                                       \
 722   type *p = pixels;                                                        \
 723   gint i;                                                               \
 724                                                                         \
 725   for (i = 0; i &lt; width - 4; i += 4) {                                  \
 726     type tr0 = PR(i), tr1 = PR(i+4);                                    \
 727     type tb0 = PB(i), tb1 = PB(i+4);                                    \
 728                                                                         \
 729     PR(i+1) = FILT_3_1 (tr0, tr1);                                      \
 730     PB(i+1) = FILT_3_1 (tb0, tb1);                                      \
 731     PR(i+2) = FILT_1_1 (tr0, tr1);                                      \
 732     PB(i+2) = FILT_1_1 (tb0, tb1);                                      \
 733     PR(i+3) = FILT_1_3 (tr0, tr1);                                      \
 734     PB(i+3) = FILT_1_3 (tb0, tb1);                                      \
 735   }                                                                     \
 736 }
 737 /* 4x vertical upsampling with cositing
 738  *
 739  * a x O--O--O-  &lt;---- a
 740  *     O--O--O-  &lt;---- (3*a +   b + 2) &gt;&gt; 2
 741  *     O--O--O-  &lt;---- (  a +   b + 1) &gt;&gt; 1
 742  *     O--O--O-  &lt;---- (  a + 3*b + 2) &gt;&gt; 2
 743  * b x O--O--O-
 744  *     O--O--O-
 745  */
 746 #define MAKE_UPSAMPLE_V4_CS(name,type)                                       \
 747 static void                                                             \
 748 video_chroma_up_v4_cs_##name (GstVideoChromaResample *resample,         \
 749     gpointer lines[], gint width)                                       \
 750 {                                                                       \
 751   /* FIXME */                                                           \
 752   if (resample-&gt;h_resample) {                                           \
 753     resample-&gt;h_resample (resample, lines[0], width);                   \
 754   }                                                                     \
 755 }
 756 /* 4x vertical upsampling interlaced with cositing
 757  *
 758  */
 759 #define MAKE_UPSAMPLE_VI4_CS(name,type)                                      \
 760 static void                                                             \
 761 video_chroma_up_vi4_cs_##name (GstVideoChromaResample *resample,        \
 762     gpointer lines[], gint width)                                       \
 763 {                                                                       \
 764   /* FIXME */                                                           \
 765   if (resample-&gt;h_resample) {                                           \
 766     resample-&gt;h_resample (resample, lines[0], width);                   \
 767   }                                                                     \
 768 }
 769 /* 4x horizontal downsampling with cositing
 770  *
 771  * a
 772  * |       +------ (b + 2*c + 3*d + 4*e + 3*f + 2*g + h + 8) &gt;&gt; 16
 773  * v       v
 774  * O-------O-------
 775  * x x x x x x x x
 776  * a b c d e f g h
 777  */
 778 #define MAKE_DOWNSAMPLE_H4_CS(name,type)                                     \
 779 static void                                                             \
 780 video_chroma_down_h4_cs_##name (GstVideoChromaResample *resample,      \
 781     gpointer pixels, gint width)                        \
 782 {                                                                       \
 783   type *p = pixels;                                                     \
 784   gint i;                                                               \
 785                                                                         \
 786   if (width &lt; 4)                                                        \
 787     return;                                                             \
 788                                                                         \
 789   PR(0) = FILT_10_3_2_1 (PR(0), PR(1), PR(2), PR(3));                   \
 790   PB(0) = FILT_10_3_2_1 (PB(0), PB(1), PB(2), PB(3));                   \
 791                                                                         \
 792   for (i = 4; i &lt; width - 4; i += 4) {                                  \
 793     PR(i) = FILT_1_2_3_4_3_2_1 (PR(i-3), PR(i-2), PR(i-1), PR(i), PR(i+1), PR(i+2), PR(i+3));   \
 794     PB(i) = FILT_1_2_3_4_3_2_1 (PB(i-3), PB(i-2), PB(i-1), PB(i), PB(i+1), PB(i+2), PB(i+3));   \
 795   }                                                                     \
 796   if (i &lt; width) {                                                      \
 797     PR(i) = FILT_1_2_3_10 (PR(i-3), PR(i-2), PR(i-1), PR(i));           \
 798     PB(i) = FILT_1_2_3_10 (PB(i-3), PB(i-2), PB(i-1), PB(i));           \
 799   }                                                                     \
 800 }
 801 /* 4x vertical downsampling with cositing
 802  *
 803  * a x O--O--O-  &lt;---- a
 804  * b x --------
 805  * c x --------
 806  * d x --------
 807  * e x O--O--O-  &lt;---- (b + 2*c + 3*d + 4*e + 3*f + 2*g + h + 8) &gt;&gt; 16
 808  * f x --------
 809  * g x --------
 810  * h x --------
 811  * i x O--O--O-
 812  * j x --------
 813  */
 814 #define MAKE_DOWNSAMPLE_V4_CS(name,type)                                     \
 815 static void                                                             \
 816 video_chroma_down_v4_cs_##name (GstVideoChromaResample *resample,       \
 817     gpointer lines[], gint width)                                       \
 818 {                                                                       \
 819   /* FIXME */                                                           \
 820   if (resample-&gt;h_resample) {                                           \
 821     resample-&gt;h_resample (resample, lines[0], width);                   \
 822   }                                                                     \
 823 }
 824 /* 4x vertical downsampling interlaced with cositing
 825  *
 826  */
 827 #define MAKE_DOWNSAMPLE_VI4_CS(name,type)                                    \
 828 static void                                                             \
 829 video_chroma_down_vi4_cs_##name (GstVideoChromaResample *resample,      \
 830     gpointer lines[], gint width)                                       \
 831 {                                                                       \
 832   /* FIXME */                                                           \
 833   if (resample-&gt;h_resample) {                                           \
 834     resample-&gt;h_resample (resample, lines[0], width);                   \
 835   }                                                                     \
 836 }
 837 
 838 MAKE_UPSAMPLE_H4_CS (u16, guint16);
 839 MAKE_UPSAMPLE_H4_CS (u8, guint8);
 840 MAKE_UPSAMPLE_V4_CS (u16, guint16);
 841 MAKE_UPSAMPLE_V4_CS (u8, guint8);
 842 MAKE_UPSAMPLE_VI4_CS (u16, guint16);
 843 MAKE_UPSAMPLE_VI4_CS (u8, guint8);
 844 MAKE_DOWNSAMPLE_H4_CS (u16, guint16);
 845 MAKE_DOWNSAMPLE_H4_CS (u8, guint8);
 846 MAKE_DOWNSAMPLE_V4_CS (u16, guint16);
 847 MAKE_DOWNSAMPLE_V4_CS (u8, guint8);
 848 MAKE_DOWNSAMPLE_VI4_CS (u16, guint16);
 849 MAKE_DOWNSAMPLE_VI4_CS (u8, guint8);
 850 
 851 typedef struct
 852 {
 853   void (*resample) (GstVideoChromaResample * resample, gpointer pixels,
 854       gint width);
 855 } HorizResampler;
 856 
 857 static const HorizResampler h_resamplers[] = {
 858   {NULL},
 859   {video_chroma_up_h2_u8},
 860   {video_chroma_down_h2_u8},
 861   {video_chroma_up_h2_u16},
 862   {video_chroma_down_h2_u16},
 863   {video_chroma_up_h2_cs_u8},
 864   {video_chroma_down_h2_cs_u8},
 865   {video_chroma_up_h2_cs_u16},
 866   {video_chroma_down_h2_cs_u16},
 867   {video_chroma_up_h4_u8},
 868   {video_chroma_down_h4_u8},
 869   {video_chroma_up_h4_u16},
 870   {video_chroma_down_h4_u16},
 871   {video_chroma_up_h4_cs_u8},
 872   {video_chroma_down_h4_cs_u8},
 873   {video_chroma_up_h4_cs_u16},
 874   {video_chroma_down_h4_cs_u16}
 875 };
 876 
 877 typedef struct
 878 {
 879   void (*resample) (GstVideoChromaResample * resample, gpointer lines[],
 880       gint width);
 881   guint n_lines;
 882   gint offset;
 883 } VertResampler;
 884 
 885 static void
 886 video_chroma_none (GstVideoChromaResample * resample,
 887     gpointer lines[], gint width)
 888 {
 889   if (resample-&gt;h_resample)
 890     resample-&gt;h_resample (resample, lines[0], width);
 891 }
 892 
 893 static const VertResampler v_resamplers[] = {
 894   {video_chroma_none, 1, 0},
 895   {video_chroma_up_v2_u8, 2, -1},
 896   {video_chroma_down_v2_u8, 2, 0},
 897   /* 16 bits */
 898   {video_chroma_up_v2_u16, 2, -1},
 899   {video_chroma_down_v2_u16, 2, 0},
 900   /* cosited */
 901   {video_chroma_up_v2_cs_u8, 1, 0},     /* IMPLEMENT ME */
 902   {video_chroma_down_v2_cs_u8, 1, 0},   /* IMPLEMENT ME */
 903   {video_chroma_up_v2_cs_u16, 1, 0},    /* IMPLEMENT ME */
 904   {video_chroma_down_v2_cs_u16, 1, 0},  /* IMPLEMENT ME */
 905   /* 4x */
 906   {video_chroma_up_v4_u8, 4, -2},
 907   {video_chroma_down_v4_u8, 4, 0},
 908   {video_chroma_up_v4_u16, 4, -2},
 909   {video_chroma_down_v4_u16, 4, 0},
 910   {video_chroma_up_v4_cs_u8, 1, 0},     /* IMPLEMENT ME */
 911   {video_chroma_down_v4_cs_u8, 1, 0},   /* IMPLEMENT ME */
 912   {video_chroma_up_v4_cs_u16, 1, 0},    /* IMPLEMENT ME */
 913   {video_chroma_down_v4_cs_u16, 1, 0},  /* IMPLEMENT ME */
 914   /* interlaced */
 915   {video_chroma_up_vi2_u8, 4, -2},
 916   {video_chroma_down_vi2_u8, 1, 0},     /* IMPLEMENT ME */
 917   {video_chroma_up_vi2_u16, 4, -2},
 918   {video_chroma_down_vi2_u16, 1, 0},    /* IMPLEMENT ME */
 919   {video_chroma_up_vi2_cs_u8, 1, 0},    /* IMPLEMENT ME */
 920   {video_chroma_down_vi2_cs_u8, 1, 0},  /* IMPLEMENT ME */
 921   {video_chroma_up_vi2_cs_u16, 1, 0},   /* IMPLEMENT ME */
 922   {video_chroma_down_vi2_cs_u16, 1, 0}, /* IMPLEMENT ME */
 923   {video_chroma_up_vi4_u8, 1, 0},       /* IMPLEMENT ME */
 924   {video_chroma_down_vi4_u8, 1, 0},     /* IMPLEMENT ME */
 925   {video_chroma_up_vi4_u16, 1, 0},      /* IMPLEMENT ME */
 926   {video_chroma_down_vi4_u16, 1, 0},    /* IMPLEMENT ME */
 927   {video_chroma_up_vi4_cs_u8, 1, 0},    /* IMPLEMENT ME */
 928   {video_chroma_down_vi4_cs_u8, 1, 0},  /* IMPLEMENT ME */
 929   {video_chroma_up_vi4_cs_u16, 1, 0},   /* IMPLEMENT ME */
 930   {video_chroma_down_vi4_cs_u16, 1, 0}, /* IMPLEMENT ME */
 931 };
 932 
 933 /**
 934  * gst_video_chroma_resample_new: (skip)
 935  * @method: a #GstVideoChromaMethod
 936  * @site: a #GstVideoChromaSite
 937  * @flags: #GstVideoChromaFlags
 938  * @format: the #GstVideoFormat
 939  * @h_factor: horizontal resampling factor
 940  * @v_factor: vertical resampling factor
 941  *
 942  * Create a new resampler object for the given parameters. When @h_factor or
 943  * @v_factor is &gt; 0, upsampling will be used, otherwise subsampling is
 944  * performed.
 945  *
 946  * Returns: a new #GstVideoChromaResample that should be freed with
 947  *     gst_video_chroma_resample_free() after usage.
 948  */
 949 GstVideoChromaResample *
 950 gst_video_chroma_resample_new (GstVideoChromaMethod method,
 951     GstVideoChromaSite site, GstVideoChromaFlags flags,
 952     GstVideoFormat format, gint h_factor, gint v_factor)
 953 {
 954   GstVideoChromaResample *result;
 955   guint cosite, h_index, v_index, bits;
 956 
 957   /* no resampling */
 958   if (h_factor == 0 &amp;&amp; v_factor == 0)
 959     return NULL;
 960 
 961   if (format == GST_VIDEO_FORMAT_AYUV)
 962     bits = 8;
 963   else if (format == GST_VIDEO_FORMAT_AYUV64)
 964     bits = 16;
 965   else
 966     return NULL;
 967 
 968   cosite = (site &amp; GST_VIDEO_CHROMA_SITE_H_COSITED ? 1 : 0);
 969   if (h_factor == 0)
 970     h_index = 0;
 971   else
 972     h_index =
 973         ((ABS (h_factor) - 1) * 8) + (cosite ? 4 : 0) + (bits ==
 974         16 ? 2 : 0) + (h_factor &lt; 0 ? 1 : 0) + 1;
 975 
 976   GST_DEBUG (&quot;h_resample %d, factor %d, cosite %d&quot;, h_index, h_factor, cosite);
 977 
 978   cosite = (site &amp; GST_VIDEO_CHROMA_SITE_V_COSITED ? 1 : 0);
 979   if (v_factor == 0)
 980     v_index = 0;
 981   else
 982     v_index =
 983         ((ABS (v_factor) - 1) * 8) + (cosite ? 4 : 0) + (bits ==
 984         16 ? 2 : 0) + (v_factor &lt; 0 ? 1 : 0) + 1;
 985 
 986   if (flags &amp; GST_VIDEO_CHROMA_FLAG_INTERLACED)
 987     v_index += 16;
 988 
 989   GST_DEBUG (&quot;v_resample %d, factor %d, cosite %d&quot;, v_index, v_factor, cosite);
 990 
 991   result = g_slice_new (GstVideoChromaResample);
 992   result-&gt;method = method;
 993   result-&gt;site = site;
 994   result-&gt;flags = flags;
 995   result-&gt;format = format;
 996   result-&gt;h_factor = h_factor;
 997   result-&gt;v_factor = v_factor;
 998   result-&gt;h_resample = h_resamplers[h_index].resample;
 999   result-&gt;v_resample = v_resamplers[v_index].resample;
1000   result-&gt;n_lines = v_resamplers[v_index].n_lines;
1001   result-&gt;offset = v_resamplers[v_index].offset;
1002 
1003   GST_DEBUG (&quot;resample %p, bits %d, n_lines %u, offset %d&quot;, result, bits,
1004       result-&gt;n_lines, result-&gt;offset);
1005 
1006   return result;
1007 }
1008 
1009 /**
1010  * gst_video_chroma_resample_get_info:
1011  * @resample: a #GstVideoChromaResample
1012  * @n_lines: the number of input lines
1013  * @offset: the first line
1014  *
1015  * The resampler must be fed @n_lines at a time. The first line should be
1016  * at @offset.
1017  */
1018 void
1019 gst_video_chroma_resample_get_info (GstVideoChromaResample * resample,
1020     guint * n_lines, gint * offset)
1021 {
1022   g_return_if_fail (resample != NULL);
1023 
1024   if (n_lines)
1025     *n_lines = resample-&gt;n_lines;
1026   if (offset)
1027     *offset = resample-&gt;offset;
1028 }
1029 
1030 /**
1031  * gst_video_chroma_resample_free:
1032  * @resample: a #GstVideoChromaResample
1033  *
1034  * Free @resample
1035  */
1036 void
1037 gst_video_chroma_resample_free (GstVideoChromaResample * resample)
1038 {
1039   g_return_if_fail (resample != NULL);
1040 
1041   g_slice_free (GstVideoChromaResample, resample);
1042 }
1043 
1044 /**
1045  * gst_video_chroma_resample:
1046  * @resample: a #GstVideoChromaResample
1047  * @lines: pixel lines
1048  * @width: the number of pixels on one line
1049  *
1050  * Perform resampling of @width chroma pixels in @lines.
1051  */
1052 void
1053 gst_video_chroma_resample (GstVideoChromaResample * resample,
1054     gpointer lines[], gint width)
1055 {
1056   g_return_if_fail (resample != NULL);
1057 
1058   resample-&gt;v_resample (resample, lines, width);
1059 }
<a name="6" id="anc6"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="6" type="hidden" />
</body>
</html>