<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gst-plugins-base/gst/volume/gstvolume.c</title>
    <link rel="stylesheet" href="../../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../typefind/gsttypefindfunctions.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../win32/common/config.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gst-plugins-base/gst/volume/gstvolume.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 181,52 ***</span>
      return FALSE;
  
    switch (format) {
      case GST_AUDIO_FORMAT_S32:
        /* only clamp if the gain is greater than 1.0 */
<span class="line-modified">!           if (self-&gt;current_vol_i32 &gt; VOLUME_UNITY_INT32) {</span>
<span class="line-modified">!             self-&gt;process = volume_process_int32_clamp;</span>
<span class="line-modified">!           } else {</span>
<span class="line-modified">!             self-&gt;process = volume_process_int32;</span>
<span class="line-modified">!           }</span>
<span class="line-modified">!           self-&gt;process_controlled = volume_process_controlled_int32_clamp;</span>
<span class="line-modified">!           break;</span>
      case GST_AUDIO_FORMAT_S24:
        /* only clamp if the gain is greater than 1.0 */
<span class="line-modified">!           if (self-&gt;current_vol_i24 &gt; VOLUME_UNITY_INT24) {</span>
<span class="line-modified">!             self-&gt;process = volume_process_int24_clamp;</span>
<span class="line-modified">!           } else {</span>
<span class="line-modified">!             self-&gt;process = volume_process_int24;</span>
<span class="line-modified">!           }</span>
<span class="line-modified">!           self-&gt;process_controlled = volume_process_controlled_int24_clamp;</span>
<span class="line-modified">!           break;</span>
      case GST_AUDIO_FORMAT_S16:
        /* only clamp if the gain is greater than 1.0 */
<span class="line-modified">!           if (self-&gt;current_vol_i16 &gt; VOLUME_UNITY_INT16) {</span>
<span class="line-modified">!             self-&gt;process = volume_process_int16_clamp;</span>
<span class="line-modified">!           } else {</span>
<span class="line-modified">!             self-&gt;process = volume_process_int16;</span>
<span class="line-modified">!           }</span>
<span class="line-modified">!           self-&gt;process_controlled = volume_process_controlled_int16_clamp;</span>
<span class="line-modified">!           break;</span>
      case GST_AUDIO_FORMAT_S8:
        /* only clamp if the gain is greater than 1.0 */
        if (self-&gt;current_vol_i8 &gt; VOLUME_UNITY_INT8) {
<span class="line-modified">!             self-&gt;process = volume_process_int8_clamp;</span>
<span class="line-modified">!           } else {</span>
<span class="line-modified">!             self-&gt;process = volume_process_int8;</span>
<span class="line-modified">!           }</span>
<span class="line-modified">!           self-&gt;process_controlled = volume_process_controlled_int8_clamp;</span>
<span class="line-modified">!           break;</span>
      case GST_AUDIO_FORMAT_F32:
<span class="line-modified">!           self-&gt;process = volume_process_float;</span>
<span class="line-modified">!           self-&gt;process_controlled = volume_process_controlled_float;</span>
<span class="line-modified">!           break;</span>
      case GST_AUDIO_FORMAT_F64:
<span class="line-modified">!           self-&gt;process = volume_process_double;</span>
<span class="line-modified">!           self-&gt;process_controlled = volume_process_controlled_double;</span>
<span class="line-modified">!           break;</span>
      default:
        break;
    }
  
    return (self-&gt;process != NULL);
<span class="line-new-header">--- 181,52 ---</span>
      return FALSE;
  
    switch (format) {
      case GST_AUDIO_FORMAT_S32:
        /* only clamp if the gain is greater than 1.0 */
<span class="line-modified">!       if (self-&gt;current_vol_i32 &gt; VOLUME_UNITY_INT32) {</span>
<span class="line-modified">!         self-&gt;process = volume_process_int32_clamp;</span>
<span class="line-modified">!       } else {</span>
<span class="line-modified">!         self-&gt;process = volume_process_int32;</span>
<span class="line-modified">!       }</span>
<span class="line-modified">!       self-&gt;process_controlled = volume_process_controlled_int32_clamp;</span>
<span class="line-modified">!       break;</span>
      case GST_AUDIO_FORMAT_S24:
        /* only clamp if the gain is greater than 1.0 */
<span class="line-modified">!       if (self-&gt;current_vol_i24 &gt; VOLUME_UNITY_INT24) {</span>
<span class="line-modified">!         self-&gt;process = volume_process_int24_clamp;</span>
<span class="line-modified">!       } else {</span>
<span class="line-modified">!         self-&gt;process = volume_process_int24;</span>
<span class="line-modified">!       }</span>
<span class="line-modified">!       self-&gt;process_controlled = volume_process_controlled_int24_clamp;</span>
<span class="line-modified">!       break;</span>
      case GST_AUDIO_FORMAT_S16:
        /* only clamp if the gain is greater than 1.0 */
<span class="line-modified">!       if (self-&gt;current_vol_i16 &gt; VOLUME_UNITY_INT16) {</span>
<span class="line-modified">!         self-&gt;process = volume_process_int16_clamp;</span>
<span class="line-modified">!       } else {</span>
<span class="line-modified">!         self-&gt;process = volume_process_int16;</span>
<span class="line-modified">!       }</span>
<span class="line-modified">!       self-&gt;process_controlled = volume_process_controlled_int16_clamp;</span>
<span class="line-modified">!       break;</span>
      case GST_AUDIO_FORMAT_S8:
        /* only clamp if the gain is greater than 1.0 */
        if (self-&gt;current_vol_i8 &gt; VOLUME_UNITY_INT8) {
<span class="line-modified">!         self-&gt;process = volume_process_int8_clamp;</span>
<span class="line-modified">!       } else {</span>
<span class="line-modified">!         self-&gt;process = volume_process_int8;</span>
<span class="line-modified">!       }</span>
<span class="line-modified">!       self-&gt;process_controlled = volume_process_controlled_int8_clamp;</span>
<span class="line-modified">!       break;</span>
      case GST_AUDIO_FORMAT_F32:
<span class="line-modified">!       self-&gt;process = volume_process_float;</span>
<span class="line-modified">!       self-&gt;process_controlled = volume_process_controlled_float;</span>
<span class="line-modified">!       break;</span>
      case GST_AUDIO_FORMAT_F64:
<span class="line-modified">!       self-&gt;process = volume_process_double;</span>
<span class="line-modified">!       self-&gt;process_controlled = volume_process_controlled_double;</span>
<span class="line-modified">!       break;</span>
      default:
        break;
    }
  
    return (self-&gt;process != NULL);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 749,23 ***</span>
      if (mute_cb || (volume_cb &amp;&amp; !self-&gt;current_mute)) {
        gint rate = GST_AUDIO_INFO_RATE (&amp;filter-&gt;info);
        gint width = GST_AUDIO_FORMAT_INFO_WIDTH (filter-&gt;info.finfo) / 8;
        gint channels = GST_AUDIO_INFO_CHANNELS (&amp;filter-&gt;info);
        guint nsamples = map.size / (width * channels);
<span class="line-modified">!     GstClockTime interval = gst_util_uint64_scale_int (1, GST_SECOND, rate);</span>
        gboolean have_mutes = FALSE;
        gboolean have_volumes = FALSE;
  
        if (self-&gt;mutes_count &lt; nsamples &amp;&amp; mute_cb) {
<span class="line-modified">!       self-&gt;mutes = g_realloc (self-&gt;mutes, sizeof (gboolean) * nsamples);</span>
<span class="line-modified">!       self-&gt;mutes_count = nsamples;</span>
<span class="line-modified">!     }</span>
  
<span class="line-modified">!     if (self-&gt;volumes_count &lt; nsamples) {</span>
<span class="line-modified">!       self-&gt;volumes = g_realloc (self-&gt;volumes, sizeof (gdouble) * nsamples);</span>
<span class="line-modified">!       self-&gt;volumes_count = nsamples;</span>
<span class="line-modified">!     }</span>
  
        if (volume_cb &amp;&amp; self-&gt;volumes) {
          have_volumes =
              gst_control_binding_get_value_array (volume_cb, ts, interval,
              nsamples, (gpointer) self-&gt;volumes);
<span class="line-new-header">--- 749,23 ---</span>
      if (mute_cb || (volume_cb &amp;&amp; !self-&gt;current_mute)) {
        gint rate = GST_AUDIO_INFO_RATE (&amp;filter-&gt;info);
        gint width = GST_AUDIO_FORMAT_INFO_WIDTH (filter-&gt;info.finfo) / 8;
        gint channels = GST_AUDIO_INFO_CHANNELS (&amp;filter-&gt;info);
        guint nsamples = map.size / (width * channels);
<span class="line-modified">!       GstClockTime interval = gst_util_uint64_scale_int (1, GST_SECOND, rate);</span>
        gboolean have_mutes = FALSE;
        gboolean have_volumes = FALSE;
  
        if (self-&gt;mutes_count &lt; nsamples &amp;&amp; mute_cb) {
<span class="line-modified">!         self-&gt;mutes = g_realloc (self-&gt;mutes, sizeof (gboolean) * nsamples);</span>
<span class="line-modified">!         self-&gt;mutes_count = nsamples;</span>
<span class="line-modified">!       }</span>
  
<span class="line-modified">!       if (self-&gt;volumes_count &lt; nsamples) {</span>
<span class="line-modified">!         self-&gt;volumes = g_realloc (self-&gt;volumes, sizeof (gdouble) * nsamples);</span>
<span class="line-modified">!         self-&gt;volumes_count = nsamples;</span>
<span class="line-modified">!       }</span>
  
        if (volume_cb &amp;&amp; self-&gt;volumes) {
          have_volumes =
              gst_control_binding_get_value_array (volume_cb, ts, interval,
              nsamples, (gpointer) self-&gt;volumes);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 780,24 ***</span>
              nsamples, (gpointer) self-&gt;mutes);
          gst_object_replace ((GstObject **) &amp; mute_cb, NULL);
        }
        if (have_mutes) {
          volume_orc_prepare_volumes (self-&gt;volumes, self-&gt;mutes, nsamples);
<span class="line-modified">!     } else {</span>
<span class="line-modified">!       g_free (self-&gt;mutes);</span>
<span class="line-modified">!       self-&gt;mutes = NULL;</span>
<span class="line-modified">!       self-&gt;mutes_count = 0;</span>
<span class="line-modified">!     }</span>
  
        self-&gt;process_controlled (self, map.data, self-&gt;volumes, channels,
            map.size);
  
        goto done;
      } else if (volume_cb) {
        gst_object_unref (volume_cb);
      }
<span class="line-modified">!     }</span>
  
    if (self-&gt;current_volume == 0.0 || self-&gt;current_mute) {
      orc_memset (map.data, 0, map.size);
      GST_BUFFER_FLAG_SET (outbuf, GST_BUFFER_FLAG_GAP);
    } else if (self-&gt;current_volume != 1.0) {
<span class="line-new-header">--- 780,24 ---</span>
              nsamples, (gpointer) self-&gt;mutes);
          gst_object_replace ((GstObject **) &amp; mute_cb, NULL);
        }
        if (have_mutes) {
          volume_orc_prepare_volumes (self-&gt;volumes, self-&gt;mutes, nsamples);
<span class="line-modified">!       } else {</span>
<span class="line-modified">!         g_free (self-&gt;mutes);</span>
<span class="line-modified">!         self-&gt;mutes = NULL;</span>
<span class="line-modified">!         self-&gt;mutes_count = 0;</span>
<span class="line-modified">!       }</span>
  
        self-&gt;process_controlled (self, map.data, self-&gt;volumes, channels,
            map.size);
  
        goto done;
      } else if (volume_cb) {
        gst_object_unref (volume_cb);
      }
<span class="line-modified">!   }</span>
  
    if (self-&gt;current_volume == 0.0 || self-&gt;current_mute) {
      orc_memset (map.data, 0, map.size);
      GST_BUFFER_FLAG_SET (outbuf, GST_BUFFER_FLAG_GAP);
    } else if (self-&gt;current_volume != 1.0) {
</pre>
<center><a href="../typefind/gsttypefindfunctions.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../../index.html" target="_top">index</a> <a href="../../win32/common/config.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>