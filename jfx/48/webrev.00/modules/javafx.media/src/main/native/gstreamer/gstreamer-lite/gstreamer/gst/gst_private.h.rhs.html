<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Frames modules/javafx.media/src/main/native/gstreamer/gstreamer-lite/gstreamer/gst/gst_private.h</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
    <script type="text/javascript" src="../../../../../../../../../navigation.js"></script>
  </head>
<body onkeypress="keypress(event);">
<a name="0"></a>
<hr />
<pre>  1 /* GStreamer
  2  * Copyright (C) 1999,2000 Erik Walthinsen &lt;omega@cse.ogi.edu&gt;
  3  *                    2000 Wim Taymans &lt;wtay@chello.be&gt;
  4  *
  5  * gst_private.h: Private header for within libgst
  6  *
  7  * This library is free software; you can redistribute it and/or
  8  * modify it under the terms of the GNU Library General Public
  9  * License as published by the Free Software Foundation; either
 10  * version 2 of the License, or (at your option) any later version.
 11  *
 12  * This library is distributed in the hope that it will be useful,
 13  * but WITHOUT ANY WARRANTY; without even the implied warranty of
 14  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 15  * Library General Public License for more details.
 16  *
 17  * You should have received a copy of the GNU Library General Public
 18  * License along with this library; if not, write to the
 19  * Free Software Foundation, Inc., 51 Franklin St, Fifth Floor,
 20  * Boston, MA 02110-1301, USA.
 21  */
 22 
 23 #ifndef __GST_PRIVATE_H__
 24 #define __GST_PRIVATE_H__
 25 
 26 #ifdef HAVE_CONFIG_H
 27 # ifndef GST_LICENSE   /* don&#39;t include config.h twice, it has no guards */
 28 #  include &quot;config.h&quot;
 29 # endif
 30 #endif
 31 
 32 /* This needs to be before glib.h, since it might be used in inline
 33  * functions */
 34 extern const char             g_log_domain_gstreamer[];
 35 
 36 #include &lt;glib.h&gt;
 37 
 38 #include &lt;stdlib.h&gt;
 39 #include &lt;string.h&gt;
 40 
 41 /* Needed for GST_API */
 42 #include &quot;gst/gstconfig.h&quot;
 43 
 44 /* Needed for GstRegistry * */
 45 #include &quot;gstregistry.h&quot;
 46 #include &quot;gststructure.h&quot;
 47 
 48 /* we need this in pretty much all files */
 49 #include &quot;gstinfo.h&quot;
 50 
 51 /* for the flags in the GstPluginDep structure below */
 52 #include &quot;gstplugin.h&quot;
 53 
 54 /* for the pad cache */
 55 #include &quot;gstpad.h&quot;
 56 
 57 /* for GstElement */
 58 #include &quot;gstelement.h&quot;
 59 
 60 #ifndef GSTREAMER_LITE
 61 /* for GstDeviceProvider */
 62 #include &quot;gstdeviceprovider.h&quot;
 63 #endif // GSTREAMER_LITE
 64 
 65 /* for GstToc */
 66 #include &quot;gsttoc.h&quot;
 67 
 68 #include &quot;gstdatetime.h&quot;
 69 
 70 #include &quot;gsttracerutils.h&quot;
 71 
 72 G_BEGIN_DECLS
 73 
 74 /* used by gstparse.c and grammar.y */
 75 struct _GstParseContext {
 76   GList * missing_elements;
 77 };
 78 
 79 /* used by gstplugin.c and gstregistrybinary.c */
 80 typedef struct {
 81   /* details registered via gst_plugin_add_dependency() */
 82   GstPluginDependencyFlags  flags;
 83   gchar **env_vars;
 84   gchar **paths;
 85   gchar **names;
 86 
 87   /* information saved from the last time the plugin was loaded (-1 = unset) */
 88   guint   env_hash;  /* hash of content of environment variables in env_vars */
 89   guint   stat_hash; /* hash of stat() on all relevant files and directories */
 90 } GstPluginDep;
 91 
 92 struct _GstPluginPrivate {
 93   GList *deps;    /* list of GstPluginDep structures */
 94   GstStructure *cache_data;
 95 };
 96 
<a name="1" id="anc1"></a><span class="line-added"> 97 /* Needed by GstMeta (to access meta seq) and GstBuffer (create/free/iterate) */</span>
<span class="line-added"> 98 typedef struct _GstMetaItem GstMetaItem;</span>
<span class="line-added"> 99 struct _GstMetaItem {</span>
<span class="line-added">100   GstMetaItem *next;</span>
<span class="line-added">101   guint64 seq_num;</span>
<span class="line-added">102   GstMeta meta;</span>
<span class="line-added">103 };</span>
<span class="line-added">104 </span>
105 /* FIXME: could rename all priv_gst_* functions to __gst_* now */
106 G_GNUC_INTERNAL  gboolean priv_gst_plugin_loading_have_whitelist (void);
107 
108 G_GNUC_INTERNAL  guint32  priv_gst_plugin_loading_get_whitelist_hash (void);
109 
110 G_GNUC_INTERNAL  gboolean priv_gst_plugin_desc_is_whitelisted (const GstPluginDesc * desc,
111                                                                const gchar   * filename);
112 
113 G_GNUC_INTERNAL  gboolean _priv_plugin_deps_env_vars_changed (GstPlugin * plugin);
114 
115 G_GNUC_INTERNAL  gboolean _priv_plugin_deps_files_changed (GstPlugin * plugin);
116 
117 G_GNUC_INTERNAL  gboolean _priv_gst_in_valgrind (void);
118 
119 /* init functions called from gst_init(). */
120 G_GNUC_INTERNAL  void  _priv_gst_quarks_initialize (void);
121 G_GNUC_INTERNAL  void  _priv_gst_mini_object_initialize (void);
122 G_GNUC_INTERNAL  void  _priv_gst_memory_initialize (void);
123 G_GNUC_INTERNAL  void  _priv_gst_allocator_initialize (void);
124 G_GNUC_INTERNAL  void  _priv_gst_buffer_initialize (void);
125 G_GNUC_INTERNAL  void  _priv_gst_buffer_list_initialize (void);
126 G_GNUC_INTERNAL  void  _priv_gst_structure_initialize (void);
127 G_GNUC_INTERNAL  void  _priv_gst_caps_initialize (void);
128 G_GNUC_INTERNAL  void  _priv_gst_caps_features_initialize (void);
129 G_GNUC_INTERNAL  void  _priv_gst_event_initialize (void);
130 G_GNUC_INTERNAL  void  _priv_gst_format_initialize (void);
131 G_GNUC_INTERNAL  void  _priv_gst_message_initialize (void);
132 G_GNUC_INTERNAL  void  _priv_gst_meta_initialize (void);
133 G_GNUC_INTERNAL  void  _priv_gst_plugin_initialize (void);
134 G_GNUC_INTERNAL  void  _priv_gst_query_initialize (void);
135 G_GNUC_INTERNAL  void  _priv_gst_sample_initialize (void);
136 G_GNUC_INTERNAL  void  _priv_gst_tag_initialize (void);
137 G_GNUC_INTERNAL  void  _priv_gst_value_initialize (void);
138 G_GNUC_INTERNAL  void  _priv_gst_debug_init (void);
139 G_GNUC_INTERNAL  void  _priv_gst_context_initialize (void);
140 G_GNUC_INTERNAL  void  _priv_gst_toc_initialize (void);
141 G_GNUC_INTERNAL  void  _priv_gst_date_time_initialize (void);
142 
143 /* cleanup functions called from gst_deinit(). */
144 G_GNUC_INTERNAL  void  _priv_gst_allocator_cleanup (void);
145 G_GNUC_INTERNAL  void  _priv_gst_caps_features_cleanup (void);
146 G_GNUC_INTERNAL  void  _priv_gst_caps_cleanup (void);
<a name="2" id="anc2"></a><span class="line-added">147 G_GNUC_INTERNAL  void  _priv_gst_debug_cleanup (void);</span>
148 
149 /* called from gst_task_cleanup_all(). */
150 G_GNUC_INTERNAL  void  _priv_gst_element_cleanup (void);
151 
152 /* Private registry functions */
153 G_GNUC_INTERNAL
154 gboolean _priv_gst_registry_remove_cache_plugins (GstRegistry *registry);
155 
156 G_GNUC_INTERNAL  void _priv_gst_registry_cleanup (void);
157 
158 GST_API
159 gboolean _gst_plugin_loader_client_run (void);
160 
161 G_GNUC_INTERNAL  GstPlugin * _priv_gst_plugin_load_file_for_registry (const gchar *filename,
162                                                                       GstRegistry * registry,
163                                                                       GError** error);
164 
165 /* GValue serialization/deserialization */
166 
167 G_GNUC_INTERNAL const char * _priv_gst_value_gtype_to_abbr (GType type);
168 
169 G_GNUC_INTERNAL gboolean _priv_gst_value_parse_string (gchar * s, gchar ** end, gchar ** next, gboolean unescape);
170 G_GNUC_INTERNAL gboolean _priv_gst_value_parse_simple_string (gchar * str, gchar ** end);
171 G_GNUC_INTERNAL gboolean _priv_gst_value_parse_value (gchar * str, gchar ** after, GValue * value, GType default_type);
172 G_GNUC_INTERNAL gchar * _priv_gst_value_serialize_any_list (const GValue * value, const gchar * begin, const gchar * end, gboolean print_type);
173 
174 /* Used in GstBin for manual state handling */
175 G_GNUC_INTERNAL  void _priv_gst_element_state_changed (GstElement *element,
176                       GstState oldstate, GstState newstate, GstState pending);
177 
178 /* used in both gststructure.c and gstcaps.c; numbers are completely made up */
179 #define STRUCTURE_ESTIMATED_STRING_LEN(s) (16 + gst_structure_n_fields(s) * 22)
180 #define FEATURES_ESTIMATED_STRING_LEN(s) (16 + gst_caps_features_get_size(s) * 14)
181 
182 G_GNUC_INTERNAL
183 gboolean  priv_gst_structure_append_to_gstring (const GstStructure * structure,
184                                                 GString            * s);
185 G_GNUC_INTERNAL
186 gboolean priv__gst_structure_append_template_to_gstring (GQuark field_id,
187                                                         const GValue *value,
188                                                         gpointer user_data);
189 
190 G_GNUC_INTERNAL
191 void priv_gst_caps_features_append_to_gstring (const GstCapsFeatures * features, GString *s);
192 
193 G_GNUC_INTERNAL
194 gboolean priv_gst_structure_parse_name (gchar * str, gchar **start, gchar ** end, gchar ** next);
195 G_GNUC_INTERNAL
196 gboolean priv_gst_structure_parse_fields (gchar *str, gchar ** end, GstStructure *structure);
197 
198 /* used in gstvalue.c and gststructure.c */
199 
200 #define GST_WRAPPED_PTR_FORMAT     &quot;p\aa&quot;
201 
202 G_GNUC_INTERNAL
203 gchar *priv_gst_string_take_and_wrap (gchar * s);
204 
205 /* registry cache backends */
206 G_GNUC_INTERNAL
<a name="3" id="anc3"></a><span class="line-modified">207 gboolean    priv_gst_registry_binary_read_cache (GstRegistry * registry, const char *location);</span>
208 
209 G_GNUC_INTERNAL
<a name="4" id="anc4"></a><span class="line-modified">210 gboolean    priv_gst_registry_binary_write_cache  (GstRegistry * registry, GList * plugins, const char *location);</span>
211 
212 
213 G_GNUC_INTERNAL
214 void      __gst_element_factory_add_static_pad_template (GstElementFactory    * elementfactory,
215                                                          GstStaticPadTemplate * templ);
216 
217 G_GNUC_INTERNAL
218 void      __gst_element_factory_add_interface           (GstElementFactory    * elementfactory,
219                                                          const gchar          * interfacename);
220 
221 /* used in gstvalue.c and gststructure.c */
222 #define GST_ASCII_IS_STRING(c) (g_ascii_isalnum((c)) || ((c) == &#39;_&#39;) || \
223     ((c) == &#39;-&#39;) || ((c) == &#39;+&#39;) || ((c) == &#39;/&#39;) || ((c) == &#39;:&#39;) || \
224     ((c) == &#39;.&#39;))
225 
226 /* This is only meant for internal uses */
227 G_GNUC_INTERNAL
228 gint __gst_date_time_compare (const GstDateTime * dt1, const GstDateTime * dt2);
229 
230 G_GNUC_INTERNAL
231 gchar * __gst_date_time_serialize (GstDateTime * datetime, gboolean with_usecs);
232 
233 /* For use in gstdebugutils */
234 G_GNUC_INTERNAL
235 GstCapsFeatures * __gst_caps_get_features_unchecked (const GstCaps * caps, guint idx);
236 
237 #ifndef GST_DISABLE_REGISTRY
238 /* Secret variable to initialise gst without registry cache */
239 
240 GST_API gboolean _gst_disable_registry_cache;
241 #endif
242 
243 /* Secret variable to let the plugin scanner use the same base path
244  * as the main application in order to determine dependencies */
245 GST_API gchar *_gst_executable_path;
246 
247 /* provide inline gst_g_value_get_foo_unchecked(), used in gststructure.c */
248 #define DEFINE_INLINE_G_VALUE_GET_UNCHECKED(ret_type,name_type,v_field) \
249 static inline ret_type                                                  \
250 gst_g_value_get_##name_type##_unchecked (const GValue *value)           \
251 {                                                                       \
252   return value-&gt;data[0].v_field;                                        \
253 }
254 
255 DEFINE_INLINE_G_VALUE_GET_UNCHECKED(gboolean,boolean,v_int)
256 DEFINE_INLINE_G_VALUE_GET_UNCHECKED(gint,int,v_int)
257 DEFINE_INLINE_G_VALUE_GET_UNCHECKED(guint,uint,v_uint)
258 DEFINE_INLINE_G_VALUE_GET_UNCHECKED(gint64,int64,v_int64)
259 DEFINE_INLINE_G_VALUE_GET_UNCHECKED(guint64,uint64,v_uint64)
260 DEFINE_INLINE_G_VALUE_GET_UNCHECKED(gfloat,float,v_float)
261 DEFINE_INLINE_G_VALUE_GET_UNCHECKED(gdouble,double,v_double)
262 DEFINE_INLINE_G_VALUE_GET_UNCHECKED(const gchar *,string,v_pointer)
263 
264 
265 /*** debugging categories *****************************************************/
266 
267 #ifndef GST_REMOVE_GST_DEBUG
268 
269 GST_API GstDebugCategory *GST_CAT_GST_INIT;
270 GST_API GstDebugCategory *GST_CAT_MEMORY;
271 GST_API GstDebugCategory *GST_CAT_PARENTAGE;
272 GST_API GstDebugCategory *GST_CAT_STATES;
273 GST_API GstDebugCategory *GST_CAT_SCHEDULING;
274 GST_API GstDebugCategory *GST_CAT_BUFFER;
275 GST_API GstDebugCategory *GST_CAT_BUFFER_LIST;
276 GST_API GstDebugCategory *GST_CAT_BUS;
277 GST_API GstDebugCategory *GST_CAT_CAPS;
278 GST_API GstDebugCategory *GST_CAT_CLOCK;
279 GST_API GstDebugCategory *GST_CAT_ELEMENT_PADS;
280 GST_API GstDebugCategory *GST_CAT_PADS;
281 GST_API GstDebugCategory *GST_CAT_PERFORMANCE;
282 GST_API GstDebugCategory *GST_CAT_PIPELINE;
283 GST_API GstDebugCategory *GST_CAT_PLUGIN_LOADING;
284 GST_API GstDebugCategory *GST_CAT_PLUGIN_INFO;
285 GST_API GstDebugCategory *GST_CAT_PROPERTIES;
286 GST_API GstDebugCategory *GST_CAT_NEGOTIATION;
287 GST_API GstDebugCategory *GST_CAT_REFCOUNTING;
288 GST_API GstDebugCategory *GST_CAT_ERROR_SYSTEM;
289 GST_API GstDebugCategory *GST_CAT_EVENT;
290 GST_API GstDebugCategory *GST_CAT_MESSAGE;
291 GST_API GstDebugCategory *GST_CAT_PARAMS;
292 GST_API GstDebugCategory *GST_CAT_CALL_TRACE;
293 GST_API GstDebugCategory *GST_CAT_SIGNAL;
294 GST_API GstDebugCategory *GST_CAT_PROBE;
295 GST_API GstDebugCategory *GST_CAT_REGISTRY;
296 GST_API GstDebugCategory *GST_CAT_QOS;
297 GST_API GstDebugCategory *GST_CAT_META;
298 GST_API GstDebugCategory *GST_CAT_LOCKING;
299 GST_API GstDebugCategory *GST_CAT_CONTEXT;
300 
301 /* Categories that should be completely private to
302  * libgstreamer should be done like this: */
303 #define GST_CAT_POLL _priv_GST_CAT_POLL
304 extern GstDebugCategory *_priv_GST_CAT_POLL;
305 
306 #define GST_CAT_PROTECTION _priv_GST_CAT_PROTECTION
307 extern GstDebugCategory *_priv_GST_CAT_PROTECTION;
308 
309 extern GstClockTime _priv_gst_start_time;
310 
311 #else
312 
313 #define GST_CAT_GST_INIT         NULL
314 #define GST_CAT_AUTOPLUG         NULL
315 #define GST_CAT_AUTOPLUG_ATTEMPT NULL
316 #define GST_CAT_PARENTAGE        NULL
317 #define GST_CAT_STATES           NULL
318 #define GST_CAT_SCHEDULING       NULL
319 #define GST_CAT_DATAFLOW         NULL
320 #define GST_CAT_BUFFER           NULL
321 #define GST_CAT_BUFFER_LIST      NULL
322 #define GST_CAT_BUS              NULL
323 #define GST_CAT_CAPS             NULL
324 #define GST_CAT_CLOCK            NULL
325 #define GST_CAT_ELEMENT_PADS     NULL
326 #define GST_CAT_PADS             NULL
327 #define GST_CAT_PERFORMANCE      NULL
328 #define GST_CAT_PIPELINE         NULL
329 #define GST_CAT_PLUGIN_LOADING   NULL
330 #define GST_CAT_PLUGIN_INFO      NULL
331 #define GST_CAT_PROPERTIES       NULL
332 #define GST_CAT_NEGOTIATION      NULL
333 #define GST_CAT_REFCOUNTING      NULL
334 #define GST_CAT_ERROR_SYSTEM     NULL
335 #define GST_CAT_EVENT            NULL
336 #define GST_CAT_MESSAGE          NULL
337 #define GST_CAT_PARAMS           NULL
338 #define GST_CAT_CALL_TRACE       NULL
339 #define GST_CAT_SIGNAL           NULL
340 #define GST_CAT_PROBE            NULL
341 #define GST_CAT_REGISTRY         NULL
342 #define GST_CAT_QOS              NULL
343 #define GST_CAT_TYPES            NULL
344 #define GST_CAT_POLL             NULL
345 #define GST_CAT_META             NULL
346 #define GST_CAT_LOCKING          NULL
347 #define GST_CAT_CONTEXT          NULL
348 #define GST_CAT_PROTECTION       NULL
349 
350 #endif
351 
352 #ifdef GST_DISABLE_GST_DEBUG
353 /* for _gst_element_error_printf */
354 #define __gst_vasprintf __gst_info_fallback_vasprintf
355 int __gst_vasprintf (char **result, char const *format, va_list args);
356 #endif
357 
358 /**** objects made opaque until the private bits have been made private ****/
359 
360 #include &lt;gmodule.h&gt;
361 #include &lt;time.h&gt; /* time_t */
362 #include &lt;sys/types.h&gt; /* off_t */
363 #include &lt;sys/stat.h&gt; /* off_t */
364 
365 typedef struct _GstPluginPrivate GstPluginPrivate;
366 
367 struct _GstPlugin {
368   GstObject       object;
369 
370   /*&lt; private &gt;*/
371   GstPluginDesc desc;
372 
<a name="5" id="anc5"></a><span class="line-modified">373   gchar * filename;</span>
<span class="line-modified">374   gchar * basename;       /* base name (non-dir part) of plugin path */</span>
375 
<a name="6" id="anc6"></a><span class="line-modified">376   GModule * module;   /* contains the module if plugin is loaded */</span>
377 
378   off_t         file_size;
379   time_t        file_mtime;
380   gboolean      registered;     /* TRUE when the registry has seen a filename
381                                  * that matches the plugin&#39;s basename */
382 
383   GstPluginPrivate *priv;
384 
385   gpointer _gst_reserved[GST_PADDING];
386 };
387 
388 struct _GstPluginClass {
389   GstObjectClass  object_class;
390 
391   /*&lt; private &gt;*/
392   gpointer _gst_reserved[GST_PADDING];
393 };
394 
395 struct _GstPluginFeature {
396   GstObject      object;
397 
398   /*&lt; private &gt;*/
399   gboolean       loaded;
400   guint          rank;
401 
402   const gchar   *plugin_name;
403   GstPlugin     *plugin;      /* weak ref */
404 
405   /*&lt; private &gt;*/
406   gpointer _gst_reserved[GST_PADDING];
407 };
408 
409 struct _GstPluginFeatureClass {
410   GstObjectClass        parent_class;
411 
412   /*&lt; private &gt;*/
413   gpointer _gst_reserved[GST_PADDING];
414 };
415 
416 #include &quot;gsttypefind.h&quot;
417 
418 struct _GstTypeFindFactory {
419   GstPluginFeature              feature;
420   /* &lt;private&gt; */
421 
422   GstTypeFindFunction           function;
423   gchar **                      extensions;
424   GstCaps *                     caps;
425 
426   gpointer                      user_data;
427   GDestroyNotify                user_data_notify;
428 
429   gpointer _gst_reserved[GST_PADDING];
430 };
431 
432 struct _GstTypeFindFactoryClass {
433   GstPluginFeatureClass         parent;
434   /* &lt;private&gt; */
435 
436   gpointer _gst_reserved[GST_PADDING];
437 };
438 
439 struct _GstTracerFactory {
440   GstPluginFeature              feature;
441   /* &lt;private&gt; */
442 
443   GType                         type;
444 
445   /*
446   gpointer                      user_data;
447   GDestroyNotify                user_data_notify;
448   */
449 
450   gpointer _gst_reserved[GST_PADDING];
451 };
452 
453 struct _GstTracerFactoryClass {
454   GstPluginFeatureClass         parent;
455   /* &lt;private&gt; */
456 
457   gpointer _gst_reserved[GST_PADDING];
458 };
459 
460 struct _GstElementFactory {
461   GstPluginFeature      parent;
462 
463   GType                 type;                   /* unique GType of element or 0 if not loaded */
464 
465   gpointer              metadata;
466 
467   GList *               staticpadtemplates;     /* GstStaticPadTemplate list */
468   guint                 numpadtemplates;
469 
470   /* URI interface stuff */
471   GstURIType            uri_type;
472   gchar **              uri_protocols;
473 
474   GList *               interfaces;             /* interface type names this element implements */
475 
476   /*&lt; private &gt;*/
477   gpointer _gst_reserved[GST_PADDING];
478 };
479 
480 struct _GstElementFactoryClass {
481   GstPluginFeatureClass parent_class;
482 
483   gpointer _gst_reserved[GST_PADDING];
484 };
485 
486 #ifndef GSTREAMER_LITE
487 struct _GstDeviceProviderFactory {
488   GstPluginFeature           feature;
489   /* &lt;private&gt; */
490 
491   GType                      type;              /* unique GType the device factory or 0 if not loaded */
492 
493   volatile GstDeviceProvider *provider;
494   gpointer                   metadata;
495 
496   gpointer _gst_reserved[GST_PADDING];
497 };
498 
499 struct _GstDeviceProviderFactoryClass {
500   GstPluginFeatureClass         parent;
501   /* &lt;private&gt; */
502 
503   gpointer _gst_reserved[GST_PADDING];
504 };
505 #endif // GSTREAMER_LITE
506 
507 struct _GstDynamicTypeFactory {
508   GstPluginFeature           feature;
509 
510   GType                      type; /* GType of the type, when loaded. 0 if not */
511 };
512 
513 struct _GstDynamicTypeFactoryClass {
514   GstPluginFeatureClass      parent;
515 };
516 
517 /* privat flag used by GstBus / GstMessage */
518 #define GST_MESSAGE_FLAG_ASYNC_DELIVERY (GST_MINI_OBJECT_FLAG_LAST &lt;&lt; 0)
519 
520 G_END_DECLS
521 #endif /* __GST_PRIVATE_H__ */
<a name="7" id="anc7"></a><b style="font-size: large; color: red">--- EOF ---</b>
















































































</pre>
<input id="eof" value="7" type="hidden" />
</body>
</html>