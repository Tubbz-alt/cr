<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/ghook.c</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center><a href="ghmac.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="ghook.h.cdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.media/src/main/native/gstreamer/3rd_party/glib/glib/ghook.c</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 176,11 ***</span>
   */
  
  /* --- functions --- */
  static void
  default_finalize_hook (GHookList *hook_list,
<span class="line-modified">!                GHook     *hook)</span>
  {
    GDestroyNotify destroy = hook-&gt;destroy;
  
    if (destroy)
      {
<span class="line-new-header">--- 176,11 ---</span>
   */
  
  /* --- functions --- */
  static void
  default_finalize_hook (GHookList *hook_list,
<span class="line-modified">!            GHook     *hook)</span>
  {
    GDestroyNotify destroy = hook-&gt;destroy;
  
    if (destroy)
      {
</pre>
<hr />
<pre>
<span class="line-old-header">*** 198,11 ***</span>
   * Initializes a #GHookList.
   * This must be called before the #GHookList is used.
   */
  void
  g_hook_list_init (GHookList *hook_list,
<span class="line-modified">!           guint      hook_size)</span>
  {
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_size &gt;= sizeof (GHook));
  
    hook_list-&gt;seq_id = 1;
<span class="line-new-header">--- 198,11 ---</span>
   * Initializes a #GHookList.
   * This must be called before the #GHookList is used.
   */
  void
  g_hook_list_init (GHookList *hook_list,
<span class="line-modified">!       guint      hook_size)</span>
  {
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_size &gt;= sizeof (GHook));
  
    hook_list-&gt;seq_id = 1;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 232,25 ***</span>
  
        hook_list-&gt;is_setup = FALSE;
  
        hook = hook_list-&gt;hooks;
        if (!hook)
<span class="line-modified">!     {</span>
<span class="line-modified">!       /* destroy hook_list-&gt;hook_memchunk */</span>
<span class="line-modified">!     }</span>
        else
<span class="line-modified">!     do</span>
<span class="line-modified">!       {</span>
<span class="line-modified">!         GHook *tmp;</span>
  
<span class="line-modified">!         g_hook_ref (hook_list, hook);</span>
<span class="line-modified">!         g_hook_destroy_link (hook_list, hook);</span>
<span class="line-modified">!         tmp = hook-&gt;next;</span>
<span class="line-modified">!         g_hook_unref (hook_list, hook);</span>
<span class="line-modified">!         hook = tmp;</span>
<span class="line-modified">!       }</span>
<span class="line-modified">!     while (hook);</span>
      }
  }
  
  /**
   * g_hook_alloc:
<span class="line-new-header">--- 232,25 ---</span>
  
        hook_list-&gt;is_setup = FALSE;
  
        hook = hook_list-&gt;hooks;
        if (!hook)
<span class="line-modified">!   {</span>
<span class="line-modified">!     /* destroy hook_list-&gt;hook_memchunk */</span>
<span class="line-modified">!   }</span>
        else
<span class="line-modified">!   do</span>
<span class="line-modified">!     {</span>
<span class="line-modified">!       GHook *tmp;</span>
  
<span class="line-modified">!       g_hook_ref (hook_list, hook);</span>
<span class="line-modified">!       g_hook_destroy_link (hook_list, hook);</span>
<span class="line-modified">!       tmp = hook-&gt;next;</span>
<span class="line-modified">!       g_hook_unref (hook_list, hook);</span>
<span class="line-modified">!       hook = tmp;</span>
<span class="line-modified">!     }</span>
<span class="line-modified">!   while (hook);</span>
      }
  }
  
  /**
   * g_hook_alloc:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 288,11 ***</span>
   * Calls the #GHookList @finalize_hook function if it exists,
   * and frees the memory allocated for the #GHook.
   */
  void
  g_hook_free (GHookList *hook_list,
<span class="line-modified">!          GHook     *hook)</span>
  {
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
    g_return_if_fail (hook != NULL);
    g_return_if_fail (G_HOOK_IS_UNLINKED (hook));
<span class="line-new-header">--- 288,11 ---</span>
   * Calls the #GHookList @finalize_hook function if it exists,
   * and frees the memory allocated for the #GHook.
   */
  void
  g_hook_free (GHookList *hook_list,
<span class="line-modified">!        GHook     *hook)</span>
  {
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
    g_return_if_fail (hook != NULL);
    g_return_if_fail (G_HOOK_IS_UNLINKED (hook));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 311,11 ***</span>
   * Removes one #GHook from a #GHookList, marking it
   * inactive and calling g_hook_unref() on it.
   */
  void
  g_hook_destroy_link (GHookList *hook_list,
<span class="line-modified">!              GHook     *hook)</span>
  {
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook != NULL);
  
    hook-&gt;flags &amp;= ~G_HOOK_FLAG_ACTIVE;
<span class="line-new-header">--- 311,11 ---</span>
   * Removes one #GHook from a #GHookList, marking it
   * inactive and calling g_hook_unref() on it.
   */
  void
  g_hook_destroy_link (GHookList *hook_list,
<span class="line-modified">!          GHook     *hook)</span>
  {
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook != NULL);
  
    hook-&gt;flags &amp;= ~G_HOOK_FLAG_ACTIVE;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 335,11 ***</span>
   *
   * Returns: %TRUE if the #GHook was found in the #GHookList and destroyed
   */
  gboolean
  g_hook_destroy (GHookList   *hook_list,
<span class="line-modified">!         gulong       hook_id)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, FALSE);
    g_return_val_if_fail (hook_id &gt; 0, FALSE);
<span class="line-new-header">--- 335,11 ---</span>
   *
   * Returns: %TRUE if the #GHook was found in the #GHookList and destroyed
   */
  gboolean
  g_hook_destroy (GHookList   *hook_list,
<span class="line-modified">!     gulong       hook_id)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, FALSE);
    g_return_val_if_fail (hook_id &gt; 0, FALSE);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 363,11 ***</span>
   * If the reference count falls to 0, the #GHook is removed
   * from the #GHookList and g_hook_free() is called to free it.
   */
  void
  g_hook_unref (GHookList *hook_list,
<span class="line-modified">!           GHook *hook)</span>
  {
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook != NULL);
    g_return_if_fail (hook-&gt;ref_count &gt; 0);
  
<span class="line-new-header">--- 363,11 ---</span>
   * If the reference count falls to 0, the #GHook is removed
   * from the #GHookList and g_hook_free() is called to free it.
   */
  void
  g_hook_unref (GHookList *hook_list,
<span class="line-modified">!         GHook *hook)</span>
  {
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook != NULL);
    g_return_if_fail (hook-&gt;ref_count &gt; 0);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 376,33 ***</span>
      {
        g_return_if_fail (hook-&gt;hook_id == 0);
        g_return_if_fail (!G_HOOK_IN_CALL (hook));
  
        if (hook-&gt;prev)
<span class="line-modified">!     hook-&gt;prev-&gt;next = hook-&gt;next;</span>
        else
<span class="line-modified">!     hook_list-&gt;hooks = hook-&gt;next;</span>
        if (hook-&gt;next)
<span class="line-modified">!     {</span>
<span class="line-modified">!       hook-&gt;next-&gt;prev = hook-&gt;prev;</span>
<span class="line-modified">!       hook-&gt;next = NULL;</span>
<span class="line-modified">!     }</span>
        hook-&gt;prev = NULL;
  
        if (!hook_list-&gt;is_setup)
<span class="line-modified">!     {</span>
<span class="line-modified">!       hook_list-&gt;is_setup = TRUE;</span>
<span class="line-modified">!       g_hook_free (hook_list, hook);</span>
<span class="line-modified">!       hook_list-&gt;is_setup = FALSE;</span>
  
<span class="line-modified">!       if (!hook_list-&gt;hooks)</span>
<span class="line-modified">!         {</span>
<span class="line-modified">!           /* destroy hook_list-&gt;hook_memchunk */</span>
<span class="line-modified">!         }</span>
<span class="line-modified">!     }</span>
        else
<span class="line-modified">!     g_hook_free (hook_list, hook);</span>
      }
  }
  
  /**
   * g_hook_ref:
<span class="line-new-header">--- 376,33 ---</span>
      {
        g_return_if_fail (hook-&gt;hook_id == 0);
        g_return_if_fail (!G_HOOK_IN_CALL (hook));
  
        if (hook-&gt;prev)
<span class="line-modified">!   hook-&gt;prev-&gt;next = hook-&gt;next;</span>
        else
<span class="line-modified">!   hook_list-&gt;hooks = hook-&gt;next;</span>
        if (hook-&gt;next)
<span class="line-modified">!   {</span>
<span class="line-modified">!     hook-&gt;next-&gt;prev = hook-&gt;prev;</span>
<span class="line-modified">!     hook-&gt;next = NULL;</span>
<span class="line-modified">!   }</span>
        hook-&gt;prev = NULL;
  
        if (!hook_list-&gt;is_setup)
<span class="line-modified">!   {</span>
<span class="line-modified">!     hook_list-&gt;is_setup = TRUE;</span>
<span class="line-modified">!     g_hook_free (hook_list, hook);</span>
<span class="line-modified">!     hook_list-&gt;is_setup = FALSE;</span>
  
<span class="line-modified">!     if (!hook_list-&gt;hooks)</span>
<span class="line-modified">!       {</span>
<span class="line-modified">!         /* destroy hook_list-&gt;hook_memchunk */</span>
<span class="line-modified">!       }</span>
<span class="line-modified">!   }</span>
        else
<span class="line-modified">!   g_hook_free (hook_list, hook);</span>
      }
  }
  
  /**
   * g_hook_ref:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 413,11 ***</span>
   *
   * Returns: the @hook that was passed in (since 2.6)
   */
  GHook *
  g_hook_ref (GHookList *hook_list,
<span class="line-modified">!         GHook     *hook)</span>
  {
    g_return_val_if_fail (hook_list != NULL, NULL);
    g_return_val_if_fail (hook != NULL, NULL);
    g_return_val_if_fail (hook-&gt;ref_count &gt; 0, NULL);
  
<span class="line-new-header">--- 413,11 ---</span>
   *
   * Returns: the @hook that was passed in (since 2.6)
   */
  GHook *
  g_hook_ref (GHookList *hook_list,
<span class="line-modified">!       GHook     *hook)</span>
  {
    g_return_val_if_fail (hook_list != NULL, NULL);
    g_return_val_if_fail (hook != NULL, NULL);
    g_return_val_if_fail (hook-&gt;ref_count &gt; 0, NULL);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 441,11 ***</span>
   *
   * Prepends a #GHook on the start of a #GHookList.
   */
  void
  g_hook_prepend (GHookList *hook_list,
<span class="line-modified">!         GHook     *hook)</span>
  {
    g_return_if_fail (hook_list != NULL);
  
    g_hook_insert_before (hook_list, hook_list-&gt;hooks, hook);
  }
<span class="line-new-header">--- 441,11 ---</span>
   *
   * Prepends a #GHook on the start of a #GHookList.
   */
  void
  g_hook_prepend (GHookList *hook_list,
<span class="line-modified">!     GHook   *hook)</span>
  {
    g_return_if_fail (hook_list != NULL);
  
    g_hook_insert_before (hook_list, hook_list-&gt;hooks, hook);
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 458,12 ***</span>
   *
   * Inserts a #GHook into a #GHookList, before a given #GHook.
   */
  void
  g_hook_insert_before (GHookList *hook_list,
<span class="line-modified">!               GHook *sibling,</span>
<span class="line-modified">!               GHook *hook)</span>
  {
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
    g_return_if_fail (hook != NULL);
    g_return_if_fail (G_HOOK_IS_UNLINKED (hook));
<span class="line-new-header">--- 458,12 ---</span>
   *
   * Inserts a #GHook into a #GHookList, before a given #GHook.
   */
  void
  g_hook_insert_before (GHookList *hook_list,
<span class="line-modified">!           GHook *sibling,</span>
<span class="line-modified">!           GHook *hook)</span>
  {
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
    g_return_if_fail (hook != NULL);
    g_return_if_fail (G_HOOK_IS_UNLINKED (hook));
</pre>
<hr />
<pre>
<span class="line-old-header">*** 473,35 ***</span>
    hook-&gt;ref_count = 1; /* counterpart to g_hook_destroy_link */
  
    if (sibling)
      {
        if (sibling-&gt;prev)
<span class="line-modified">!     {</span>
<span class="line-modified">!       hook-&gt;prev = sibling-&gt;prev;</span>
<span class="line-modified">!       hook-&gt;prev-&gt;next = hook;</span>
<span class="line-modified">!       hook-&gt;next = sibling;</span>
<span class="line-modified">!       sibling-&gt;prev = hook;</span>
<span class="line-modified">!     }</span>
        else
<span class="line-modified">!     {</span>
<span class="line-modified">!       hook_list-&gt;hooks = hook;</span>
<span class="line-modified">!       hook-&gt;next = sibling;</span>
<span class="line-modified">!       sibling-&gt;prev = hook;</span>
<span class="line-modified">!     }</span>
      }
    else
      {
        if (hook_list-&gt;hooks)
<span class="line-modified">!     {</span>
<span class="line-modified">!       sibling = hook_list-&gt;hooks;</span>
<span class="line-modified">!       while (sibling-&gt;next)</span>
<span class="line-modified">!         sibling = sibling-&gt;next;</span>
<span class="line-modified">!       hook-&gt;prev = sibling;</span>
<span class="line-modified">!       sibling-&gt;next = hook;</span>
<span class="line-modified">!     }</span>
        else
<span class="line-modified">!     hook_list-&gt;hooks = hook;</span>
      }
  }
  
  /**
   * g_hook_list_invoke:
<span class="line-new-header">--- 473,35 ---</span>
    hook-&gt;ref_count = 1; /* counterpart to g_hook_destroy_link */
  
    if (sibling)
      {
        if (sibling-&gt;prev)
<span class="line-modified">!   {</span>
<span class="line-modified">!     hook-&gt;prev = sibling-&gt;prev;</span>
<span class="line-modified">!     hook-&gt;prev-&gt;next = hook;</span>
<span class="line-modified">!     hook-&gt;next = sibling;</span>
<span class="line-modified">!     sibling-&gt;prev = hook;</span>
<span class="line-modified">!   }</span>
        else
<span class="line-modified">!   {</span>
<span class="line-modified">!     hook_list-&gt;hooks = hook;</span>
<span class="line-modified">!     hook-&gt;next = sibling;</span>
<span class="line-modified">!     sibling-&gt;prev = hook;</span>
<span class="line-modified">!   }</span>
      }
    else
      {
        if (hook_list-&gt;hooks)
<span class="line-modified">!   {</span>
<span class="line-modified">!     sibling = hook_list-&gt;hooks;</span>
<span class="line-modified">!     while (sibling-&gt;next)</span>
<span class="line-modified">!       sibling = sibling-&gt;next;</span>
<span class="line-modified">!     hook-&gt;prev = sibling;</span>
<span class="line-modified">!     sibling-&gt;next = hook;</span>
<span class="line-modified">!   }</span>
        else
<span class="line-modified">!   hook_list-&gt;hooks = hook;</span>
      }
  }
  
  /**
   * g_hook_list_invoke:
</pre>
<hr />
<pre>
<span class="line-old-header">*** 512,11 ***</span>
   *
   * Calls all of the #GHook functions in a #GHookList.
   */
  void
  g_hook_list_invoke (GHookList *hook_list,
<span class="line-modified">!             gboolean   may_recurse)</span>
  {
    GHook *hook;
  
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
<span class="line-new-header">--- 512,11 ---</span>
   *
   * Calls all of the #GHook functions in a #GHookList.
   */
  void
  g_hook_list_invoke (GHookList *hook_list,
<span class="line-modified">!         gboolean   may_recurse)</span>
  {
    GHook *hook;
  
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 531,11 ***</span>
  
        was_in_call = G_HOOK_IN_CALL (hook);
        hook-&gt;flags |= G_HOOK_FLAG_IN_CALL;
        func (hook-&gt;data);
        if (!was_in_call)
<span class="line-modified">!     hook-&gt;flags &amp;= ~G_HOOK_FLAG_IN_CALL;</span>
  
        hook = g_hook_next_valid (hook_list, hook, may_recurse);
      }
  }
  
<span class="line-new-header">--- 531,11 ---</span>
  
        was_in_call = G_HOOK_IN_CALL (hook);
        hook-&gt;flags |= G_HOOK_FLAG_IN_CALL;
        func (hook-&gt;data);
        if (!was_in_call)
<span class="line-modified">!   hook-&gt;flags &amp;= ~G_HOOK_FLAG_IN_CALL;</span>
  
        hook = g_hook_next_valid (hook_list, hook, may_recurse);
      }
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 549,11 ***</span>
   * Calls all of the #GHook functions in a #GHookList.
   * Any function which returns %FALSE is removed from the #GHookList.
   */
  void
  g_hook_list_invoke_check (GHookList *hook_list,
<span class="line-modified">!               gboolean   may_recurse)</span>
  {
    GHook *hook;
  
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
<span class="line-new-header">--- 549,11 ---</span>
   * Calls all of the #GHook functions in a #GHookList.
   * Any function which returns %FALSE is removed from the #GHookList.
   */
  void
  g_hook_list_invoke_check (GHookList *hook_list,
<span class="line-modified">!         gboolean   may_recurse)</span>
  {
    GHook *hook;
  
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 569,13 ***</span>
  
        was_in_call = G_HOOK_IN_CALL (hook);
        hook-&gt;flags |= G_HOOK_FLAG_IN_CALL;
        need_destroy = !func (hook-&gt;data);
        if (!was_in_call)
<span class="line-modified">!     hook-&gt;flags &amp;= ~G_HOOK_FLAG_IN_CALL;</span>
        if (need_destroy)
<span class="line-modified">!     g_hook_destroy_link (hook_list, hook);</span>
  
        hook = g_hook_next_valid (hook_list, hook, may_recurse);
      }
  }
  
<span class="line-new-header">--- 569,13 ---</span>
  
        was_in_call = G_HOOK_IN_CALL (hook);
        hook-&gt;flags |= G_HOOK_FLAG_IN_CALL;
        need_destroy = !func (hook-&gt;data);
        if (!was_in_call)
<span class="line-modified">!   hook-&gt;flags &amp;= ~G_HOOK_FLAG_IN_CALL;</span>
        if (need_destroy)
<span class="line-modified">!   g_hook_destroy_link (hook_list, hook);</span>
  
        hook = g_hook_next_valid (hook_list, hook, may_recurse);
      }
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 600,14 ***</span>
   *
   * Calls a function on each valid #GHook and destroys it if the
   * function returns %FALSE.
   */
  void
<span class="line-modified">! g_hook_list_marshal_check (GHookList           *hook_list,</span>
<span class="line-modified">!                gboolean     may_recurse,</span>
<span class="line-modified">!                            GHookCheckMarshaller marshaller,</span>
<span class="line-modified">!                gpointer     data)</span>
  {
    GHook *hook;
  
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
<span class="line-new-header">--- 600,14 ---</span>
   *
   * Calls a function on each valid #GHook and destroys it if the
   * function returns %FALSE.
   */
  void
<span class="line-modified">! g_hook_list_marshal_check (GHookList         *hook_list,</span>
<span class="line-modified">!          gboolean   may_recurse,</span>
<span class="line-modified">!          GHookCheckMarshaller marshaller,</span>
<span class="line-modified">!          gpointer   data)</span>
  {
    GHook *hook;
  
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 621,13 ***</span>
  
        was_in_call = G_HOOK_IN_CALL (hook);
        hook-&gt;flags |= G_HOOK_FLAG_IN_CALL;
        need_destroy = !marshaller (hook, data);
        if (!was_in_call)
<span class="line-modified">!     hook-&gt;flags &amp;= ~G_HOOK_FLAG_IN_CALL;</span>
        if (need_destroy)
<span class="line-modified">!     g_hook_destroy_link (hook_list, hook);</span>
  
        hook = g_hook_next_valid (hook_list, hook, may_recurse);
      }
  }
  
<span class="line-new-header">--- 621,13 ---</span>
  
        was_in_call = G_HOOK_IN_CALL (hook);
        hook-&gt;flags |= G_HOOK_FLAG_IN_CALL;
        need_destroy = !marshaller (hook, data);
        if (!was_in_call)
<span class="line-modified">!   hook-&gt;flags &amp;= ~G_HOOK_FLAG_IN_CALL;</span>
        if (need_destroy)
<span class="line-modified">!   g_hook_destroy_link (hook_list, hook);</span>
  
        hook = g_hook_next_valid (hook_list, hook, may_recurse);
      }
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 649,14 ***</span>
   * @marshal_data: data to pass to @marshaller
   *
   * Calls a function on each valid #GHook.
   */
  void
<span class="line-modified">! g_hook_list_marshal (GHookList           *hook_list,</span>
<span class="line-modified">!              gboolean             may_recurse,</span>
<span class="line-modified">!              GHookMarshaller          marshaller,</span>
<span class="line-modified">!              gpointer             data)</span>
  {
    GHook *hook;
  
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
<span class="line-new-header">--- 649,14 ---</span>
   * @marshal_data: data to pass to @marshaller
   *
   * Calls a function on each valid #GHook.
   */
  void
<span class="line-modified">! g_hook_list_marshal (GHookList         *hook_list,</span>
<span class="line-modified">!          gboolean         may_recurse,</span>
<span class="line-modified">!          GHookMarshaller        marshaller,</span>
<span class="line-modified">!          gpointer         data)</span>
  {
    GHook *hook;
  
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 669,11 ***</span>
  
        was_in_call = G_HOOK_IN_CALL (hook);
        hook-&gt;flags |= G_HOOK_FLAG_IN_CALL;
        marshaller (hook, data);
        if (!was_in_call)
<span class="line-modified">!     hook-&gt;flags &amp;= ~G_HOOK_FLAG_IN_CALL;</span>
  
        hook = g_hook_next_valid (hook_list, hook, may_recurse);
      }
  }
  
<span class="line-new-header">--- 669,11 ---</span>
  
        was_in_call = G_HOOK_IN_CALL (hook);
        hook-&gt;flags |= G_HOOK_FLAG_IN_CALL;
        marshaller (hook, data);
        if (!was_in_call)
<span class="line-modified">!   hook-&gt;flags &amp;= ~G_HOOK_FLAG_IN_CALL;</span>
  
        hook = g_hook_next_valid (hook_list, hook, may_recurse);
      }
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 691,27 ***</span>
   *
   * Returns: the first valid #GHook, or %NULL if none are valid
   */
  GHook*
  g_hook_first_valid (GHookList *hook_list,
<span class="line-modified">!             gboolean   may_be_in_call)</span>
  {
    g_return_val_if_fail (hook_list != NULL, NULL);
  
    if (hook_list-&gt;is_setup)
      {
        GHook *hook;
  
        hook = hook_list-&gt;hooks;
        if (hook)
<span class="line-modified">!     {</span>
<span class="line-modified">!       g_hook_ref (hook_list, hook);</span>
<span class="line-modified">!       if (G_HOOK_IS_VALID (hook) &amp;&amp; (may_be_in_call || !G_HOOK_IN_CALL (hook)))</span>
<span class="line-modified">!         return hook;</span>
<span class="line-modified">!       else</span>
<span class="line-modified">!         return g_hook_next_valid (hook_list, hook, may_be_in_call);</span>
<span class="line-modified">!     }</span>
      }
  
    return NULL;
  }
  
<span class="line-new-header">--- 691,27 ---</span>
   *
   * Returns: the first valid #GHook, or %NULL if none are valid
   */
  GHook*
  g_hook_first_valid (GHookList *hook_list,
<span class="line-modified">!         gboolean   may_be_in_call)</span>
  {
    g_return_val_if_fail (hook_list != NULL, NULL);
  
    if (hook_list-&gt;is_setup)
      {
        GHook *hook;
  
        hook = hook_list-&gt;hooks;
        if (hook)
<span class="line-modified">!   {</span>
<span class="line-modified">!     g_hook_ref (hook_list, hook);</span>
<span class="line-modified">!     if (G_HOOK_IS_VALID (hook) &amp;&amp; (may_be_in_call || !G_HOOK_IN_CALL (hook)))</span>
<span class="line-modified">!       return hook;</span>
<span class="line-modified">!     else</span>
<span class="line-modified">!       return g_hook_next_valid (hook_list, hook, may_be_in_call);</span>
<span class="line-modified">!   }</span>
      }
  
    return NULL;
  }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 730,12 ***</span>
   *
   * Returns: the next valid #GHook, or %NULL if none are valid
   */
  GHook*
  g_hook_next_valid (GHookList *hook_list,
<span class="line-modified">!            GHook     *hook,</span>
<span class="line-modified">!            gboolean   may_be_in_call)</span>
  {
    GHook *ohook = hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
  
<span class="line-new-header">--- 730,12 ---</span>
   *
   * Returns: the next valid #GHook, or %NULL if none are valid
   */
  GHook*
  g_hook_next_valid (GHookList *hook_list,
<span class="line-modified">!        GHook     *hook,</span>
<span class="line-modified">!        gboolean   may_be_in_call)</span>
  {
    GHook *ohook = hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 744,16 ***</span>
  
    hook = hook-&gt;next;
    while (hook)
      {
        if (G_HOOK_IS_VALID (hook) &amp;&amp; (may_be_in_call || !G_HOOK_IN_CALL (hook)))
<span class="line-modified">!     {</span>
<span class="line-modified">!       g_hook_ref (hook_list, hook);</span>
<span class="line-modified">!       g_hook_unref (hook_list, ohook);</span>
  
<span class="line-modified">!       return hook;</span>
<span class="line-modified">!     }</span>
        hook = hook-&gt;next;
      }
    g_hook_unref (hook_list, ohook);
  
    return NULL;
<span class="line-new-header">--- 744,16 ---</span>
  
    hook = hook-&gt;next;
    while (hook)
      {
        if (G_HOOK_IS_VALID (hook) &amp;&amp; (may_be_in_call || !G_HOOK_IN_CALL (hook)))
<span class="line-modified">!   {</span>
<span class="line-modified">!     g_hook_ref (hook_list, hook);</span>
<span class="line-modified">!     g_hook_unref (hook_list, ohook);</span>
  
<span class="line-modified">!     return hook;</span>
<span class="line-modified">!   }</span>
        hook = hook-&gt;next;
      }
    g_hook_unref (hook_list, ohook);
  
    return NULL;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 768,22 ***</span>
   *
   * Returns: the #GHook with the given id, or %NULL if it is not found
   */
  GHook*
  g_hook_get (GHookList *hook_list,
<span class="line-modified">!         gulong     hook_id)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
    g_return_val_if_fail (hook_id &gt; 0, NULL);
  
    hook = hook_list-&gt;hooks;
    while (hook)
      {
        if (hook-&gt;hook_id == hook_id)
<span class="line-modified">!     return hook;</span>
        hook = hook-&gt;next;
      }
  
    return NULL;
  }
<span class="line-new-header">--- 768,22 ---</span>
   *
   * Returns: the #GHook with the given id, or %NULL if it is not found
   */
  GHook*
  g_hook_get (GHookList *hook_list,
<span class="line-modified">!       gulong     hook_id)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
    g_return_val_if_fail (hook_id &gt; 0, NULL);
  
    hook = hook_list-&gt;hooks;
    while (hook)
      {
        if (hook-&gt;hook_id == hook_id)
<span class="line-modified">!   return hook;</span>
        hook = hook-&gt;next;
      }
  
    return NULL;
  }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 812,13 ***</span>
   *
   * Returns: the found #GHook or %NULL if no matching #GHook is found
   */
  GHook*
  g_hook_find (GHookList    *hook_list,
<span class="line-modified">!          gboolean      need_valids,</span>
<span class="line-modified">!              GHookFindFunc func,</span>
<span class="line-modified">!          gpointer      data)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
    g_return_val_if_fail (func != NULL, NULL);
<span class="line-new-header">--- 812,13 ---</span>
   *
   * Returns: the found #GHook or %NULL if no matching #GHook is found
   */
  GHook*
  g_hook_find (GHookList    *hook_list,
<span class="line-modified">!        gboolean    need_valids,</span>
<span class="line-modified">!        GHookFindFunc func,</span>
<span class="line-modified">!        gpointer    data)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
    g_return_val_if_fail (func != NULL, NULL);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 828,23 ***</span>
      {
        GHook *tmp;
  
        /* test only non-destroyed hooks */
        if (!hook-&gt;hook_id)
<span class="line-modified">!     {</span>
<span class="line-modified">!       hook = hook-&gt;next;</span>
<span class="line-modified">!       continue;</span>
<span class="line-modified">!     }</span>
  
        g_hook_ref (hook_list, hook);
  
        if (func (hook, data) &amp;&amp; hook-&gt;hook_id &amp;&amp; (!need_valids || G_HOOK_ACTIVE (hook)))
<span class="line-modified">!     {</span>
<span class="line-modified">!       g_hook_unref (hook_list, hook);</span>
  
<span class="line-modified">!       return hook;</span>
<span class="line-modified">!     }</span>
  
        tmp = hook-&gt;next;
        g_hook_unref (hook_list, hook);
        hook = tmp;
      }
<span class="line-new-header">--- 828,23 ---</span>
      {
        GHook *tmp;
  
        /* test only non-destroyed hooks */
        if (!hook-&gt;hook_id)
<span class="line-modified">!   {</span>
<span class="line-modified">!     hook = hook-&gt;next;</span>
<span class="line-modified">!     continue;</span>
<span class="line-modified">!   }</span>
  
        g_hook_ref (hook_list, hook);
  
        if (func (hook, data) &amp;&amp; hook-&gt;hook_id &amp;&amp; (!need_valids || G_HOOK_ACTIVE (hook)))
<span class="line-modified">!   {</span>
<span class="line-modified">!     g_hook_unref (hook_list, hook);</span>
  
<span class="line-modified">!     return hook;</span>
<span class="line-modified">!   }</span>
  
        tmp = hook-&gt;next;
        g_hook_unref (hook_list, hook);
        hook = tmp;
      }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 864,25 ***</span>
   * Returns: the #GHook with the given @data or %NULL if no matching
   *     #GHook is found
   */
  GHook*
  g_hook_find_data (GHookList *hook_list,
<span class="line-modified">!           gboolean   need_valids,</span>
<span class="line-modified">!           gpointer   data)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
  
    hook = hook_list-&gt;hooks;
    while (hook)
      {
        /* test only non-destroyed hooks */
        if (hook-&gt;data == data &amp;&amp;
<span class="line-modified">!       hook-&gt;hook_id &amp;&amp;</span>
<span class="line-modified">!       (!need_valids || G_HOOK_ACTIVE (hook)))</span>
<span class="line-modified">!     return hook;</span>
  
        hook = hook-&gt;next;
      }
  
    return NULL;
<span class="line-new-header">--- 864,25 ---</span>
   * Returns: the #GHook with the given @data or %NULL if no matching
   *     #GHook is found
   */
  GHook*
  g_hook_find_data (GHookList *hook_list,
<span class="line-modified">!       gboolean   need_valids,</span>
<span class="line-modified">!       gpointer   data)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
  
    hook = hook_list-&gt;hooks;
    while (hook)
      {
        /* test only non-destroyed hooks */
        if (hook-&gt;data == data &amp;&amp;
<span class="line-modified">!     hook-&gt;hook_id &amp;&amp;</span>
<span class="line-modified">!     (!need_valids || G_HOOK_ACTIVE (hook)))</span>
<span class="line-modified">!   return hook;</span>
  
        hook = hook-&gt;next;
      }
  
    return NULL;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 900,12 ***</span>
   * Returns: the #GHook with the given @func or %NULL if no matching
   *     #GHook is found
   */
  GHook*
  g_hook_find_func (GHookList *hook_list,
<span class="line-modified">!           gboolean   need_valids,</span>
<span class="line-modified">!           gpointer   func)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
    g_return_val_if_fail (func != NULL, NULL);
<span class="line-new-header">--- 900,12 ---</span>
   * Returns: the #GHook with the given @func or %NULL if no matching
   *     #GHook is found
   */
  GHook*
  g_hook_find_func (GHookList *hook_list,
<span class="line-modified">!       gboolean   need_valids,</span>
<span class="line-modified">!       gpointer   func)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
    g_return_val_if_fail (func != NULL, NULL);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 913,13 ***</span>
    hook = hook_list-&gt;hooks;
    while (hook)
      {
        /* test only non-destroyed hooks */
        if (hook-&gt;func == func &amp;&amp;
<span class="line-modified">!       hook-&gt;hook_id &amp;&amp;</span>
<span class="line-modified">!       (!need_valids || G_HOOK_ACTIVE (hook)))</span>
<span class="line-modified">!     return hook;</span>
  
        hook = hook-&gt;next;
      }
  
    return NULL;
<span class="line-new-header">--- 913,13 ---</span>
    hook = hook_list-&gt;hooks;
    while (hook)
      {
        /* test only non-destroyed hooks */
        if (hook-&gt;func == func &amp;&amp;
<span class="line-modified">!     hook-&gt;hook_id &amp;&amp;</span>
<span class="line-modified">!     (!need_valids || G_HOOK_ACTIVE (hook)))</span>
<span class="line-modified">!   return hook;</span>
  
        hook = hook-&gt;next;
      }
  
    return NULL;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 938,13 ***</span>
   * Returns: the #GHook with the given @func and @data or %NULL if
   *     no matching #GHook is found
   */
  GHook*
  g_hook_find_func_data (GHookList *hook_list,
<span class="line-modified">!                gboolean   need_valids,</span>
<span class="line-modified">!                gpointer   func,</span>
<span class="line-modified">!                gpointer   data)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
    g_return_val_if_fail (func != NULL, NULL);
<span class="line-new-header">--- 938,13 ---</span>
   * Returns: the #GHook with the given @func and @data or %NULL if
   *     no matching #GHook is found
   */
  GHook*
  g_hook_find_func_data (GHookList *hook_list,
<span class="line-modified">!            gboolean   need_valids,</span>
<span class="line-modified">!            gpointer   func,</span>
<span class="line-modified">!            gpointer   data)</span>
  {
    GHook *hook;
  
    g_return_val_if_fail (hook_list != NULL, NULL);
    g_return_val_if_fail (func != NULL, NULL);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 952,14 ***</span>
    hook = hook_list-&gt;hooks;
    while (hook)
      {
        /* test only non-destroyed hooks */
        if (hook-&gt;data == data &amp;&amp;
<span class="line-modified">!       hook-&gt;func == func &amp;&amp;</span>
<span class="line-modified">!       hook-&gt;hook_id &amp;&amp;</span>
<span class="line-modified">!       (!need_valids || G_HOOK_ACTIVE (hook)))</span>
<span class="line-modified">!     return hook;</span>
  
        hook = hook-&gt;next;
      }
  
    return NULL;
<span class="line-new-header">--- 952,14 ---</span>
    hook = hook_list-&gt;hooks;
    while (hook)
      {
        /* test only non-destroyed hooks */
        if (hook-&gt;data == data &amp;&amp;
<span class="line-modified">!     hook-&gt;func == func &amp;&amp;</span>
<span class="line-modified">!     hook-&gt;hook_id &amp;&amp;</span>
<span class="line-modified">!     (!need_valids || G_HOOK_ACTIVE (hook)))</span>
<span class="line-modified">!   return hook;</span>
  
        hook = hook-&gt;next;
      }
  
    return NULL;
</pre>
<hr />
<pre>
<span class="line-old-header">*** 984,12 ***</span>
   *
   * Inserts a #GHook into a #GHookList, sorted by the given function.
   */
  void
  g_hook_insert_sorted (GHookList       *hook_list,
<span class="line-modified">!               GHook       *hook,</span>
<span class="line-modified">!                       GHookCompareFunc func)</span>
  {
    GHook *sibling;
  
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
<span class="line-new-header">--- 984,12 ---</span>
   *
   * Inserts a #GHook into a #GHookList, sorted by the given function.
   */
  void
  g_hook_insert_sorted (GHookList       *hook_list,
<span class="line-modified">!           GHook       *hook,</span>
<span class="line-modified">!           GHookCompareFunc func)</span>
  {
    GHook *sibling;
  
    g_return_if_fail (hook_list != NULL);
    g_return_if_fail (hook_list-&gt;is_setup);
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1007,19 ***</span>
      {
        GHook *tmp;
  
        g_hook_ref (hook_list, sibling);
        if (func (hook, sibling) &lt;= 0 &amp;&amp; sibling-&gt;hook_id)
<span class="line-modified">!     {</span>
<span class="line-modified">!       g_hook_unref (hook_list, sibling);</span>
<span class="line-modified">!       break;</span>
<span class="line-modified">!     }</span>
  
        /* next non-destroyed hook */
        tmp = sibling-&gt;next;
        while (tmp &amp;&amp; !tmp-&gt;hook_id)
<span class="line-modified">!     tmp = tmp-&gt;next;</span>
  
        g_hook_unref (hook_list, sibling);
        sibling = tmp;
  
   }
<span class="line-new-header">--- 1007,19 ---</span>
      {
        GHook *tmp;
  
        g_hook_ref (hook_list, sibling);
        if (func (hook, sibling) &lt;= 0 &amp;&amp; sibling-&gt;hook_id)
<span class="line-modified">!   {</span>
<span class="line-modified">!     g_hook_unref (hook_list, sibling);</span>
<span class="line-modified">!     break;</span>
<span class="line-modified">!   }</span>
  
        /* next non-destroyed hook */
        tmp = sibling-&gt;next;
        while (tmp &amp;&amp; !tmp-&gt;hook_id)
<span class="line-modified">!   tmp = tmp-&gt;next;</span>
  
        g_hook_unref (hook_list, sibling);
        sibling = tmp;
  
   }
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1037,11 ***</span>
   *
   * Returns: a value &lt;= 0 if the id of @sibling is &gt;= the id of @new_hook
   */
  gint
  g_hook_compare_ids (GHook *new_hook,
<span class="line-modified">!             GHook *sibling)</span>
  {
    if (new_hook-&gt;hook_id &lt; sibling-&gt;hook_id)
      return -1;
    else if (new_hook-&gt;hook_id &gt; sibling-&gt;hook_id)
      return 1;
<span class="line-new-header">--- 1037,11 ---</span>
   *
   * Returns: a value &lt;= 0 if the id of @sibling is &gt;= the id of @new_hook
   */
  gint
  g_hook_compare_ids (GHook *new_hook,
<span class="line-modified">!         GHook *sibling)</span>
  {
    if (new_hook-&gt;hook_id &lt; sibling-&gt;hook_id)
      return -1;
    else if (new_hook-&gt;hook_id &gt; sibling-&gt;hook_id)
      return 1;
</pre>
<center><a href="ghmac.c.cdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../../index.html" target="_top">index</a> <a href="ghook.h.cdiff.html" target="_top">next &gt;</a></center>  </body>
</html>