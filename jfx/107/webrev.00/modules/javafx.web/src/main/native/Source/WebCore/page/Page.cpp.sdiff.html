<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/page/Page.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="FrameView.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../platform/graphics/ComplexTextController.cpp.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/page/Page.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
2697     if (m_useSystemAppearance == value)
2698         return;
2699 
2700     m_useSystemAppearance = value;
2701 
2702     appearanceDidChange();
2703 
2704     for (auto* frame = &amp;mainFrame(); frame; frame = frame-&gt;tree().traverseNext()) {
2705         auto* document = frame-&gt;document();
2706         if (!document)
2707             continue;
2708 
2709         // System apperance change may affect stylesheet parsing. We need to reparse.
2710         document-&gt;extensionStyleSheets().clearPageUserSheet();
2711         document-&gt;extensionStyleSheets().invalidateInjectedStyleSheetCache();
2712     }
2713 }
2714 
2715 void Page::effectiveAppearanceDidChange(bool useDarkAppearance, bool useElevatedUserInterfaceLevel)
2716 {
<span class="line-modified">2717 #if HAVE(OS_DARK_MODE_SUPPORT)</span>
2718     if (m_useDarkAppearance == useDarkAppearance &amp;&amp; m_useElevatedUserInterfaceLevel == useElevatedUserInterfaceLevel)
2719         return;
2720 
2721     m_useDarkAppearance = useDarkAppearance;
2722     m_useElevatedUserInterfaceLevel = useElevatedUserInterfaceLevel;
2723 
2724     InspectorInstrumentation::defaultAppearanceDidChange(*this, useDarkAppearance);
2725 
2726     appearanceDidChange();
2727 #else
2728     UNUSED_PARAM(useDarkAppearance);
2729 
2730     if (m_useElevatedUserInterfaceLevel == useElevatedUserInterfaceLevel)
2731         return;
2732 
2733     m_useElevatedUserInterfaceLevel = useElevatedUserInterfaceLevel;
2734 
2735     appearanceDidChange();
2736 #endif
2737 }
2738 
2739 bool Page::useDarkAppearance() const
2740 {
<span class="line-modified">2741 #if HAVE(OS_DARK_MODE_SUPPORT)</span>
2742     FrameView* view = mainFrame().view();
2743     if (!view || !equalLettersIgnoringASCIICase(view-&gt;mediaType(), &quot;screen&quot;))
2744         return false;
2745     if (m_useDarkAppearanceOverride)
2746         return m_useDarkAppearanceOverride.value();
2747     return m_useDarkAppearance;
2748 #else
2749     return false;
2750 #endif
2751 }
2752 
2753 void Page::setUseDarkAppearanceOverride(Optional&lt;bool&gt; valueOverride)
2754 {
2755 #if HAVE(OS_DARK_MODE_SUPPORT)
2756     if (valueOverride == m_useDarkAppearanceOverride)
2757         return;
2758 
2759     m_useDarkAppearanceOverride = valueOverride;
2760 
2761     appearanceDidChange();
</pre>
</td>
<td>
<hr />
<pre>
2697     if (m_useSystemAppearance == value)
2698         return;
2699 
2700     m_useSystemAppearance = value;
2701 
2702     appearanceDidChange();
2703 
2704     for (auto* frame = &amp;mainFrame(); frame; frame = frame-&gt;tree().traverseNext()) {
2705         auto* document = frame-&gt;document();
2706         if (!document)
2707             continue;
2708 
2709         // System apperance change may affect stylesheet parsing. We need to reparse.
2710         document-&gt;extensionStyleSheets().clearPageUserSheet();
2711         document-&gt;extensionStyleSheets().invalidateInjectedStyleSheetCache();
2712     }
2713 }
2714 
2715 void Page::effectiveAppearanceDidChange(bool useDarkAppearance, bool useElevatedUserInterfaceLevel)
2716 {
<span class="line-modified">2717 #if ENABLE(DARK_MODE_CSS)</span>
2718     if (m_useDarkAppearance == useDarkAppearance &amp;&amp; m_useElevatedUserInterfaceLevel == useElevatedUserInterfaceLevel)
2719         return;
2720 
2721     m_useDarkAppearance = useDarkAppearance;
2722     m_useElevatedUserInterfaceLevel = useElevatedUserInterfaceLevel;
2723 
2724     InspectorInstrumentation::defaultAppearanceDidChange(*this, useDarkAppearance);
2725 
2726     appearanceDidChange();
2727 #else
2728     UNUSED_PARAM(useDarkAppearance);
2729 
2730     if (m_useElevatedUserInterfaceLevel == useElevatedUserInterfaceLevel)
2731         return;
2732 
2733     m_useElevatedUserInterfaceLevel = useElevatedUserInterfaceLevel;
2734 
2735     appearanceDidChange();
2736 #endif
2737 }
2738 
2739 bool Page::useDarkAppearance() const
2740 {
<span class="line-modified">2741 #if ENABLE(DARK_MODE_CSS)</span>
2742     FrameView* view = mainFrame().view();
2743     if (!view || !equalLettersIgnoringASCIICase(view-&gt;mediaType(), &quot;screen&quot;))
2744         return false;
2745     if (m_useDarkAppearanceOverride)
2746         return m_useDarkAppearanceOverride.value();
2747     return m_useDarkAppearance;
2748 #else
2749     return false;
2750 #endif
2751 }
2752 
2753 void Page::setUseDarkAppearanceOverride(Optional&lt;bool&gt; valueOverride)
2754 {
2755 #if HAVE(OS_DARK_MODE_SUPPORT)
2756     if (valueOverride == m_useDarkAppearanceOverride)
2757         return;
2758 
2759     m_useDarkAppearanceOverride = valueOverride;
2760 
2761     appearanceDidChange();
</pre>
</td>
</tr>
</table>
<center><a href="FrameView.cpp.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../platform/graphics/ComplexTextController.cpp.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>