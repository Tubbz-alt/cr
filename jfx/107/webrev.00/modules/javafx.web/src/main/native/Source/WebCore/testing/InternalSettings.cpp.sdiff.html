<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.web/src/main/native/Source/WebCore/testing/InternalSettings.cpp</title>
    <link rel="stylesheet" href="../../../../../../../../style.css" />
  </head>
<body>
<center><a href="../svg/properties/SVGAnimatedPropertyPairAccessor.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../cmake/OptionsGTK.cmake.sdiff.html" target="_top">next &gt;</a></center>    <h2>modules/javafx.web/src/main/native/Source/WebCore/testing/InternalSettings.cpp</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
  34 #include &quot;Frame.h&quot;
  35 #include &quot;FrameView.h&quot;
  36 #include &quot;LocaleToScriptMapping.h&quot;
  37 #include &quot;Page.h&quot;
  38 #include &quot;PageGroup.h&quot;
  39 #include &quot;PlatformMediaSessionManager.h&quot;
  40 #include &quot;RenderTheme.h&quot;
  41 #include &quot;RuntimeEnabledFeatures.h&quot;
  42 #include &quot;Settings.h&quot;
  43 #include &quot;Supplementable.h&quot;
  44 #include &lt;wtf/Language.h&gt;
  45 
  46 #if ENABLE(INPUT_TYPE_COLOR)
  47 #include &quot;ColorChooser.h&quot;
  48 #endif
  49 
  50 #if USE(SOUP)
  51 #include &quot;SoupNetworkSession.h&quot;
  52 #endif
  53 
<span class="line-removed">  54 #if PLATFORM(GTK)</span>
<span class="line-removed">  55 #include &lt;gtk/gtk.h&gt;</span>
<span class="line-removed">  56 #endif</span>
<span class="line-removed">  57 </span>
  58 namespace WebCore {
  59 
  60 InternalSettings::Backup::Backup(Settings&amp; settings)
  61     : m_originalEditingBehavior(settings.editingBehaviorType())
  62 #if ENABLE(TEXT_AUTOSIZING)
  63     , m_originalTextAutosizingEnabled(settings.textAutosizingEnabled())
  64     , m_originalTextAutosizingWindowSizeOverride(settings.textAutosizingWindowSizeOverride())
  65     , m_originalTextAutosizingUsesIdempotentMode(settings.textAutosizingUsesIdempotentMode())
  66 #endif
  67     , m_originalMediaTypeOverride(settings.mediaTypeOverride())
  68     , m_originalCanvasUsesAcceleratedDrawing(settings.canvasUsesAcceleratedDrawing())
  69     , m_originalMockScrollbarsEnabled(DeprecatedGlobalSettings::mockScrollbarsEnabled())
  70     , m_imagesEnabled(settings.areImagesEnabled())
  71     , m_preferMIMETypeForImages(settings.preferMIMETypeForImages())
  72     , m_minimumDOMTimerInterval(settings.minimumDOMTimerInterval())
  73 #if ENABLE(VIDEO_TRACK)
  74     , m_shouldDisplaySubtitles(settings.shouldDisplaySubtitles())
  75     , m_shouldDisplayCaptions(settings.shouldDisplayCaptions())
  76     , m_shouldDisplayTextDescriptions(settings.shouldDisplayTextDescriptions())
  77 #endif
</pre>
<hr />
<pre>
 525     if (!m_page)
 526         return Exception { InvalidAccessError };
 527 #if ENABLE(VIDEO_TRACK)
 528     auto&amp; captionPreferences = m_page-&gt;group().captionPreferences();
 529     if (equalLettersIgnoringASCIICase(kind, &quot;subtitles&quot;))
 530         return captionPreferences.userPrefersSubtitles();
 531     if (equalLettersIgnoringASCIICase(kind, &quot;captions&quot;))
 532         return captionPreferences.userPrefersCaptions();
 533     if (equalLettersIgnoringASCIICase(kind, &quot;textdescriptions&quot;))
 534         return captionPreferences.userPrefersTextDescriptions();
 535 
 536     return Exception { SyntaxError };
 537 #else
 538     UNUSED_PARAM(kind);
 539     return false;
 540 #endif
 541 }
 542 
 543 void InternalSettings::setUseDarkAppearanceInternal(bool useDarkAppearance)
 544 {
<span class="line-removed"> 545 #if PLATFORM(GTK)</span>
<span class="line-removed"> 546     // GTK doesn&#39;t allow to change the theme from the web process, but tests need to do it, so</span>
<span class="line-removed"> 547     // we do it here only for tests.</span>
<span class="line-removed"> 548     if (auto* settings = gtk_settings_get_default()) {</span>
<span class="line-removed"> 549         gboolean preferDarkTheme;</span>
<span class="line-removed"> 550         g_object_get(settings, &quot;gtk-application-prefer-dark-theme&quot;, &amp;preferDarkTheme, nullptr);</span>
<span class="line-removed"> 551         if (preferDarkTheme != useDarkAppearance)</span>
<span class="line-removed"> 552             g_object_set(settings, &quot;gtk-application-prefer-dark-theme&quot;, useDarkAppearance, nullptr);</span>
<span class="line-removed"> 553     }</span>
<span class="line-removed"> 554 #endif</span>
 555     ASSERT(m_page);
 556     m_page-&gt;effectiveAppearanceDidChange(useDarkAppearance, m_page-&gt;useElevatedUserInterfaceLevel());
 557 }
 558 
 559 ExceptionOr&lt;void&gt; InternalSettings::setUseDarkAppearance(bool useDarkAppearance)
 560 {
 561     if (!m_page)
 562         return Exception { InvalidAccessError };
 563     setUseDarkAppearanceInternal(useDarkAppearance);
 564     return { };
 565 }
 566 
 567 ExceptionOr&lt;void&gt; InternalSettings::setStorageBlockingPolicy(const String&amp; mode)
 568 {
 569     if (!m_page)
 570         return Exception { InvalidAccessError };
 571     if (mode == &quot;AllowAll&quot;)
 572         settings().setStorageBlockingPolicy(SecurityOrigin::AllowAllStorage);
 573     else if (mode == &quot;BlockThirdParty&quot;)
 574         settings().setStorageBlockingPolicy(SecurityOrigin::BlockThirdPartyStorage);
</pre>
</td>
<td>
<hr />
<pre>
  34 #include &quot;Frame.h&quot;
  35 #include &quot;FrameView.h&quot;
  36 #include &quot;LocaleToScriptMapping.h&quot;
  37 #include &quot;Page.h&quot;
  38 #include &quot;PageGroup.h&quot;
  39 #include &quot;PlatformMediaSessionManager.h&quot;
  40 #include &quot;RenderTheme.h&quot;
  41 #include &quot;RuntimeEnabledFeatures.h&quot;
  42 #include &quot;Settings.h&quot;
  43 #include &quot;Supplementable.h&quot;
  44 #include &lt;wtf/Language.h&gt;
  45 
  46 #if ENABLE(INPUT_TYPE_COLOR)
  47 #include &quot;ColorChooser.h&quot;
  48 #endif
  49 
  50 #if USE(SOUP)
  51 #include &quot;SoupNetworkSession.h&quot;
  52 #endif
  53 




  54 namespace WebCore {
  55 
  56 InternalSettings::Backup::Backup(Settings&amp; settings)
  57     : m_originalEditingBehavior(settings.editingBehaviorType())
  58 #if ENABLE(TEXT_AUTOSIZING)
  59     , m_originalTextAutosizingEnabled(settings.textAutosizingEnabled())
  60     , m_originalTextAutosizingWindowSizeOverride(settings.textAutosizingWindowSizeOverride())
  61     , m_originalTextAutosizingUsesIdempotentMode(settings.textAutosizingUsesIdempotentMode())
  62 #endif
  63     , m_originalMediaTypeOverride(settings.mediaTypeOverride())
  64     , m_originalCanvasUsesAcceleratedDrawing(settings.canvasUsesAcceleratedDrawing())
  65     , m_originalMockScrollbarsEnabled(DeprecatedGlobalSettings::mockScrollbarsEnabled())
  66     , m_imagesEnabled(settings.areImagesEnabled())
  67     , m_preferMIMETypeForImages(settings.preferMIMETypeForImages())
  68     , m_minimumDOMTimerInterval(settings.minimumDOMTimerInterval())
  69 #if ENABLE(VIDEO_TRACK)
  70     , m_shouldDisplaySubtitles(settings.shouldDisplaySubtitles())
  71     , m_shouldDisplayCaptions(settings.shouldDisplayCaptions())
  72     , m_shouldDisplayTextDescriptions(settings.shouldDisplayTextDescriptions())
  73 #endif
</pre>
<hr />
<pre>
 521     if (!m_page)
 522         return Exception { InvalidAccessError };
 523 #if ENABLE(VIDEO_TRACK)
 524     auto&amp; captionPreferences = m_page-&gt;group().captionPreferences();
 525     if (equalLettersIgnoringASCIICase(kind, &quot;subtitles&quot;))
 526         return captionPreferences.userPrefersSubtitles();
 527     if (equalLettersIgnoringASCIICase(kind, &quot;captions&quot;))
 528         return captionPreferences.userPrefersCaptions();
 529     if (equalLettersIgnoringASCIICase(kind, &quot;textdescriptions&quot;))
 530         return captionPreferences.userPrefersTextDescriptions();
 531 
 532     return Exception { SyntaxError };
 533 #else
 534     UNUSED_PARAM(kind);
 535     return false;
 536 #endif
 537 }
 538 
 539 void InternalSettings::setUseDarkAppearanceInternal(bool useDarkAppearance)
 540 {










 541     ASSERT(m_page);
 542     m_page-&gt;effectiveAppearanceDidChange(useDarkAppearance, m_page-&gt;useElevatedUserInterfaceLevel());
 543 }
 544 
 545 ExceptionOr&lt;void&gt; InternalSettings::setUseDarkAppearance(bool useDarkAppearance)
 546 {
 547     if (!m_page)
 548         return Exception { InvalidAccessError };
 549     setUseDarkAppearanceInternal(useDarkAppearance);
 550     return { };
 551 }
 552 
 553 ExceptionOr&lt;void&gt; InternalSettings::setStorageBlockingPolicy(const String&amp; mode)
 554 {
 555     if (!m_page)
 556         return Exception { InvalidAccessError };
 557     if (mode == &quot;AllowAll&quot;)
 558         settings().setStorageBlockingPolicy(SecurityOrigin::AllowAllStorage);
 559     else if (mode == &quot;BlockThirdParty&quot;)
 560         settings().setStorageBlockingPolicy(SecurityOrigin::BlockThirdPartyStorage);
</pre>
</td>
</tr>
</table>
<center><a href="../svg/properties/SVGAnimatedPropertyPairAccessor.h.sdiff.html" target="_top">&lt; prev</a> <a href="../../../../../../../../index.html" target="_top">index</a> <a href="../../cmake/OptionsGTK.cmake.sdiff.html" target="_top">next &gt;</a></center>  </body>
</html>