<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Old modules/javafx.graphics/src/test/java/test/javafx/scene/layout/BorderPaneTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
  1 /*
  2  * Copyright (c) 2011, 2015, Oracle and/or its affiliates. All rights reserved.
  3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
  4  *
  5  * This code is free software; you can redistribute it and/or modify it
  6  * under the terms of the GNU General Public License version 2 only, as
  7  * published by the Free Software Foundation.  Oracle designates this
  8  * particular file as subject to the &quot;Classpath&quot; exception as provided
  9  * by Oracle in the LICENSE file that accompanied this code.
 10  *
 11  * This code is distributed in the hope that it will be useful, but WITHOUT
 12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 14  * version 2 for more details (a copy is included in the LICENSE file that
 15  * accompanied this code).
 16  *
 17  * You should have received a copy of the GNU General Public License version
 18  * 2 along with this work; if not, write to the Free Software Foundation,
 19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 20  *
 21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
 22  * or visit www.oracle.com if you need additional information or have any
 23  * questions.
 24  */
 25 
 26 package test.javafx.scene.layout;
 27 
 28 import test.javafx.scene.layout.MockBiased;
 29 import javafx.geometry.Insets;
 30 import static org.junit.Assert.*;
 31 import javafx.geometry.Orientation;
 32 import javafx.scene.ParentShim;
 33 import javafx.scene.layout.BorderPane;
 34 import org.junit.Before;
 35 
 36 import org.junit.Test;
 37 
 38 
 39 public class BorderPaneTest {
 40 
 41     BorderPane borderpane;
 42 
 43     @Before public void setUp() {
 44         this.borderpane = new BorderPane();
 45     }
 46 
 47     @Test public void testEmptyBorderPane() {
 48         assertNull(borderpane.getTop());
 49         assertNull(borderpane.getCenter());
 50         assertNull(borderpane.getBottom());
 51         assertNull(borderpane.getLeft());
 52         assertNull(borderpane.getRight());
 53     }
 54 
 55     @Test public void testChildrenRemovedDirectly() {
 56         MockResizable node = new MockResizable(10,20, 100,200, 700,800);
 57 
 58         borderpane.setCenter(node);
 59         assertSame(node, borderpane.getCenter());
 60         assertNull(borderpane.getLeft());
 61         assertNull(borderpane.getRight());
 62         assertNull(borderpane.getBottom());
 63         assertNull(borderpane.getTop());
 64 
 65         borderpane.autosize();
 66         borderpane.layout();
 67         assertEquals(0, node.getLayoutX(), 1e-100);
 68         assertEquals(0, node.getLayoutY(), 1e-100);
 69         assertEquals(100, node.getWidth(), 1e-100);
 70         assertEquals(200, node.getHeight(), 1e-100);
 71 
 72         ParentShim.getChildren(borderpane).remove(node);
 73         assertNull(borderpane.getCenter());
 74 
 75         borderpane.setLeft(node);
 76         assertNull(borderpane.getCenter());
 77         assertSame(node, borderpane.getLeft());
 78         assertNull(borderpane.getRight());
 79         assertNull(borderpane.getBottom());
 80         assertNull(borderpane.getTop());
 81 
 82         borderpane.autosize();
 83         borderpane.layout();
 84         assertEquals(0, node.getLayoutX(), 1e-100);
 85         assertEquals(0, node.getLayoutY(), 1e-100);
 86         assertEquals(100, node.getWidth(), 1e-100);
 87         assertEquals(200, node.getHeight(), 1e-100);
 88 
 89         ParentShim.getChildren(borderpane).remove(node);
 90         assertNull(borderpane.getLeft());
 91 
 92         borderpane.setRight(node);
 93         assertNull(borderpane.getCenter());
 94         assertNull(borderpane.getLeft());
 95         assertSame(node, borderpane.getRight());
 96         assertNull(borderpane.getBottom());
 97         assertNull(borderpane.getTop());
 98 
 99         borderpane.autosize();
100         borderpane.layout();
101         assertEquals(0, node.getLayoutX(), 1e-100);
102         assertEquals(0, node.getLayoutY(), 1e-100);
103         assertEquals(100, node.getWidth(), 1e-100);
104         assertEquals(200, node.getHeight(), 1e-100);
105 
106         ParentShim.getChildren(borderpane).remove(node);
107         assertNull(borderpane.getRight());
108 
109         borderpane.setBottom(node);
110         assertNull(borderpane.getCenter());
111         assertNull(borderpane.getLeft());
112         assertNull(borderpane.getRight());
113         assertSame(node, borderpane.getBottom());
114         assertNull(borderpane.getTop());
115 
116         borderpane.autosize();
117         borderpane.layout();
118         assertEquals(0, node.getLayoutX(), 1e-100);
119         assertEquals(0, node.getLayoutY(), 1e-100);
120         assertEquals(100, node.getWidth(), 1e-100);
121         assertEquals(200, node.getHeight(), 1e-100);
122 
123         ParentShim.getChildren(borderpane).remove(node);
124         assertNull(borderpane.getBottom());
125 
126         borderpane.setTop(node);
127         assertNull(borderpane.getCenter());
128         assertNull(borderpane.getLeft());
129         assertNull(borderpane.getRight());
130         assertNull(borderpane.getBottom());
131         assertSame(node, borderpane.getTop());
132 
133         borderpane.autosize();
134         borderpane.layout();
135         assertEquals(0, node.getLayoutX(), 1e-100);
136         assertEquals(0, node.getLayoutY(), 1e-100);
137         assertEquals(100, node.getWidth(), 1e-100);
138         assertEquals(200, node.getHeight(), 1e-100);
139 
140         ParentShim.getChildren(borderpane).remove(node);
141         assertNull(borderpane.getTop());
142 
143     }
144 
145     @Test public void testCenterChildOnly() {
146         MockResizable center = new MockResizable(10,20, 100,200, 700,800);
147         borderpane.setCenter(center);
148 
149         assertEquals(center, borderpane.getCenter());
150         assertEquals(1, ParentShim.getChildren(borderpane).size());
151         assertEquals(center, ParentShim.getChildren(borderpane).get(0));
152         assertEquals(10, borderpane.minWidth(-1), 1e-100);
153         assertEquals(20, borderpane.minHeight(-1), 1e-100);
154         assertEquals(100, borderpane.prefWidth(-1), 1e-100);
155         assertEquals(200, borderpane.prefHeight(-1), 1e-100);
156         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
157         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
158 
159         borderpane.autosize();
160         borderpane.layout();
161         assertEquals(0, center.getLayoutX(), 1e-100);
162         assertEquals(0, center.getLayoutY(), 1e-100);
163         assertEquals(100, center.getWidth(), 1e-100);
164         assertEquals(200, center.getHeight(), 1e-100);
165 
166     }
167 
168     @Test public void testTopChildOnly() {
169         MockResizable top = new MockResizable(10,20, 100,200, 700,800);
170         borderpane.setTop(top);
171 
172         assertEquals(top, borderpane.getTop());
173         assertEquals(1, ParentShim.getChildren(borderpane).size());
174         assertEquals(top, ParentShim.getChildren(borderpane).get(0));
175         assertEquals(10, borderpane.minWidth(-1), 1e-100);
176         assertEquals(200, borderpane.minHeight(-1), 1e-100); // Top is always at it&#39;s pref height
177         assertEquals(100, borderpane.prefWidth(-1), 1e-100);
178         assertEquals(200, borderpane.prefHeight(-1), 1e-100);
179         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
180         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
181 
182         borderpane.autosize();
183         borderpane.layout();
184         assertEquals(0, top.getLayoutX(), 1e-100);
185         assertEquals(0, top.getLayoutY(), 1e-100);
186         assertEquals(100, top.getWidth(), 1e-100);
187         assertEquals(200, top.getHeight(), 1e-100);
188     }
189 
190     @Test public void testBottomChildOnly() {
191         MockResizable bottom = new MockResizable(10,20, 100,200, 700,800);
192         borderpane.setBottom(bottom);
193 
194         assertEquals(bottom, borderpane.getBottom());
195         assertEquals(1, ParentShim.getChildren(borderpane).size());
196         assertEquals(bottom, ParentShim.getChildren(borderpane).get(0));
197         assertEquals(10, borderpane.minWidth(-1), 1e-100);
198         assertEquals(200, borderpane.minHeight(-1), 1e-100);  // Bottom is always at it&#39;s pref height
199         assertEquals(100, borderpane.prefWidth(-1), 1e-100);
200         assertEquals(200, borderpane.prefHeight(-1), 1e-100);
201         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
202         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
203 
204         borderpane.autosize();
205         borderpane.layout();
206         assertEquals(0, bottom.getLayoutX(), 1e-100);
207         assertEquals(0, bottom.getLayoutY(), 1e-100);
208         assertEquals(100, bottom.getWidth(), 1e-100);
209         assertEquals(200, bottom.getHeight(), 1e-100);
210     }
211 
212     @Test public void testRightChildOnly() {
213         MockResizable right = new MockResizable(10,20, 100,200, 700,800);
214         borderpane.setRight(right);
215 
216         assertEquals(right, borderpane.getRight());
217         assertEquals(1, ParentShim.getChildren(borderpane).size());
218         assertEquals(right, ParentShim.getChildren(borderpane).get(0));
219         assertEquals(100, borderpane.minWidth(-1), 1e-100);
220         assertEquals(20, borderpane.minHeight(-1), 1e-100);
221         assertEquals(100, borderpane.prefWidth(-1), 1e-100);
222         assertEquals(200, borderpane.prefHeight(-1), 1e-100);
223         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
224         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
225 
226         borderpane.autosize();
227         borderpane.layout();
228         assertEquals(0, right.getLayoutX(), 1e-100);
229         assertEquals(0, right.getLayoutY(), 1e-100);
230         assertEquals(100, right.getWidth(), 1e-100);
231         assertEquals(200, right.getHeight(), 1e-100);
232     }
233 
234     @Test public void testLeftChildOnly() {
235         MockResizable left = new MockResizable(10,20, 100,200, 700,800);
236         borderpane.setLeft(left);
237 
238         assertEquals(left, borderpane.getLeft());
239         assertEquals(1, ParentShim.getChildren(borderpane).size());
240         assertEquals(left, ParentShim.getChildren(borderpane).get(0));
241         assertEquals(100, borderpane.minWidth(-1), 1e-100);
242         assertEquals(20, borderpane.minHeight(-1), 1e-100);
243         assertEquals(100, borderpane.prefWidth(-1), 1e-100);
244         assertEquals(200, borderpane.prefHeight(-1), 1e-100);
245         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
246         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
247 
248         borderpane.autosize();
249         borderpane.layout();
250         assertEquals(0, left.getLayoutX(), 1e-100);
251         assertEquals(0, left.getLayoutY(), 1e-100);
252         assertEquals(100, left.getWidth(), 1e-100);
253         assertEquals(200, left.getHeight(), 1e-100);
254     }
255 
256     @Test public void testChildrenInAllPositions() {
257         MockResizable center = new MockResizable(10,20, 100,200, 1000,1000);
258         borderpane.setCenter(center);
259         MockResizable top = new MockResizable(100,10, 200, 20, 1000,1000);
260         borderpane.setTop(top);
261         MockResizable bottom = new MockResizable(80,8, 220,22, 1000,1000);
262         borderpane.setBottom(bottom);
263         MockResizable left = new MockResizable(10,100, 15,150, 1000,1000);
264         borderpane.setLeft(left);
265         MockResizable right = new MockResizable(50,115, 60,120, 1000,1000);
266         borderpane.setRight(right);
267 
268         assertEquals(5, ParentShim.getChildren(borderpane).size());
269         assertEquals(center, borderpane.getCenter());
270         assertEquals(top, borderpane.getTop());
271         assertEquals(bottom, borderpane.getBottom());
272         assertEquals(left, borderpane.getLeft());
273         assertEquals(right, borderpane.getRight());
274         assertTrue(ParentShim.getChildren(borderpane).contains(center));
275         assertTrue(ParentShim.getChildren(borderpane).contains(top));
276         assertTrue(ParentShim.getChildren(borderpane).contains(bottom));
277         assertTrue(ParentShim.getChildren(borderpane).contains(left));
278         assertTrue(ParentShim.getChildren(borderpane).contains(right));
279 
280         assertEquals(100, borderpane.minWidth(-1), 1e-100);
281         assertEquals(top.prefHeight(-1) + bottom.prefHeight(-1) +
282                 Math.max(center.minHeight(-1), Math.max(left.minHeight(-1), right.minHeight(-1))),
283                 borderpane.minHeight(-1), 1e-100);
284         assertEquals(220, borderpane.prefWidth(-1), 1e-100);
285         assertEquals(242, borderpane.prefHeight(-1), 1e-100);
286         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
287         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
288 
289         borderpane.autosize();
290         borderpane.layout();
291         assertEquals(0, top.getLayoutX(), 1e-100);
292         assertEquals(0, top.getLayoutY(), 1e-100);
293         assertEquals(220, top.getWidth(), 1e-100);
294         assertEquals(20, top.getHeight(), 1e-100);
295 
296         assertEquals(0, left.getLayoutX(), 1e-100);
297         assertEquals(20, left.getLayoutY(), 1e-100);
298         assertEquals(15, left.getWidth(), 1e-100);
299         assertEquals(200, left.getHeight(), 1e-100);
300 
301         assertEquals(15, center.getLayoutX(), 1e-100);
302         assertEquals(20, center.getLayoutY(), 1e-100);
303         assertEquals(145, center.getWidth(), 1e-100);
304         assertEquals(200, center.getHeight(), 1e-100);
305 
306         assertEquals(160, right.getLayoutX(), 1e-100);
307         assertEquals(20, right.getLayoutY(), 1e-100);
308         assertEquals(60, right.getWidth(), 1e-100);
309         assertEquals(200, right.getHeight(), 1e-100);
310 
311         assertEquals(0, bottom.getLayoutX(), 1e-100);
312         assertEquals(220, bottom.getLayoutY(), 1e-100);
313         assertEquals(220, bottom.getWidth(), 1e-100);
314         assertEquals(22, bottom.getHeight(), 1e-100);
315 
316     }
317 
318     @Test public void testWithBiasedChildren() {
319         MockBiased top = new MockBiased(Orientation.HORIZONTAL, 100, 20); // 300 x 6.666
320         borderpane.setTop(top);
321 
322         MockBiased left = new MockBiased(Orientation.VERTICAL, 40, 100); // 20 x 200
323         borderpane.setLeft(left);
324 
325         MockBiased center = new MockBiased(Orientation.HORIZONTAL, 200, 200);
326         borderpane.setCenter(center);
327 
328         MockBiased right = new MockBiased(Orientation.VERTICAL, 60, 200); // 60 x 200
329         borderpane.setRight(right);
330 
331         MockBiased bottom = new MockBiased(Orientation.HORIZONTAL, 200, 20); // 300 x 13.333
332         borderpane.setBottom(bottom);
333 
334         assertEquals(40/*l*/ + 60/*r*/ + 200/*c*/, borderpane.prefWidth(-1), 1e-100);
335         assertEquals(240 /* l + r + c*/, borderpane.prefHeight(-1), 1e-10);
336         assertEquals(110, borderpane.minWidth(-1), 1e-100); /* min center + 2x pref width (l, r) */
337         assertEquals(50, borderpane.minHeight(-1), 1e-10);
338         assertEquals(110, borderpane.minWidth(240), 1e-100);
339         assertEquals(221, borderpane.minHeight(300), 1e-10);
340 
341         borderpane.resize(300, 240);
342         borderpane.layout();
343 
344         assertEquals(0, top.getLayoutX(), 1e-100);
345         assertEquals(0, top.getLayoutY(), 1e-100);
346         assertEquals(300, top.getWidth(), 1e-100);
347         assertEquals(7, top.getHeight(), 1e-100);
348 
349         assertEquals(0, bottom.getLayoutX(), 1e-100);
350         assertEquals(226, bottom.getLayoutY(), 1e-100);
351         assertEquals(300, bottom.getWidth(), 1e-100);
352         assertEquals(14, bottom.getHeight(), 1e-100);
353 
354         assertEquals(0, left.getLayoutX(), 1e-100);
355         assertEquals(7, left.getLayoutY(), 1e-100);
356         assertEquals(240 - 14 - 7, left.getHeight(), 1e-100);
357         final double leftWidth = Math.ceil(40*100.0/(240 - 14 - 7));
358         assertEquals(leftWidth, left.getWidth(), 1e-100);
359 
360         assertEquals(7, right.getLayoutY(), 1e-100);
361         assertEquals(240 - 14 - 7, right.getHeight(), 1e-100);
362         final double rightWidth = Math.ceil(60*200.0/(240 - 14 - 7));
363         assertEquals(rightWidth, right.getWidth(), 1e-100);
364         assertEquals(300 - rightWidth, right.getLayoutX(), 1e-100);
365 
366         // Center is HORIZONTALLY biased, so when width is stretched, height is lower
367         double centerWidth = 300 - leftWidth - rightWidth;
368         double centerHeight = Math.ceil(200 * 200 / centerWidth);
369 
370         assertEquals(19, center.getLayoutX(), 1e-100);
371         // center alignment, Math.round == snapPosition
372         assertEquals(Math.round(7 + (240 - 7 - 14 - centerHeight) / 2), center.getLayoutY(), 1e-100);
373         assertEquals(centerWidth, center.getWidth(), 1e-100);
374         assertEquals(centerHeight, center.getHeight(), 1e-100);
375 
376     }
377 
378     @Test public void testWithHorizontalBiasedChildrenAtPrefSize() {
379         MockResizable top = new MockResizable(400, 100);
380         borderpane.setTop(top);
381 
382         MockResizable left = new MockResizable(100, 100);
383         borderpane.setLeft(left);
384 
385         MockBiased center = new MockBiased(Orientation.HORIZONTAL, 200, 100);
386         borderpane.setCenter(center);
387 
388         MockResizable right = new MockResizable(100, 100);
389         borderpane.setRight(right);
390 
391         MockResizable bottom = new MockResizable(400, 100);
392         borderpane.setBottom(bottom);
393 
394         assertEquals(Orientation.HORIZONTAL, borderpane.getContentBias());
395         assertEquals(400, borderpane.prefWidth(-1), 1e-200);
396         assertEquals(300, borderpane.prefHeight(-1), 1e-200);
397 
398         borderpane.autosize();
399         borderpane.layout();
400 
401         assertEquals(0, top.getLayoutX(), 1e-200);
402         assertEquals(0, top.getLayoutY(), 1e-200);
403         assertEquals(400, top.getLayoutBounds().getWidth(), 1e-200);
404         assertEquals(100, top.getLayoutBounds().getHeight(), 1e-200);
405 
406         assertEquals(0, left.getLayoutX(), 1e-200);
407         assertEquals(100, left.getLayoutY(), 1e-200);
408         assertEquals(100, left.getLayoutBounds().getWidth(), 1e-200);
409         assertEquals(100, left.getLayoutBounds().getHeight(), 1e-200);
410 
411         assertEquals(100, center.getLayoutX(), 1e-200);
412         assertEquals(100, center.getLayoutY(), 1e-200);
413         assertEquals(200, center.getLayoutBounds().getWidth(), 1e-200);
414         assertEquals(100, center.getLayoutBounds().getHeight(), 1e-200);
415 
416         assertEquals(300, right.getLayoutX(), 1e-200);
417         assertEquals(100, right.getLayoutY(), 1e-200);
418         assertEquals(100, right.getLayoutBounds().getWidth(), 1e-200);
419         assertEquals(100, right.getLayoutBounds().getHeight(), 1e-200);
420 
421         assertEquals(0, bottom.getLayoutX(), 1e-200);
422         assertEquals(200, bottom.getLayoutY(), 1e-200);
423         assertEquals(400, bottom.getLayoutBounds().getWidth(), 1e-200);
424         assertEquals(100, bottom.getLayoutBounds().getHeight(), 1e-200);
425     }
426 
427     @Test public void testWithHorizontalBiasedChildrenGrowing() {
428         MockBiased top = new MockBiased(Orientation.HORIZONTAL, 200, 100);
429         borderpane.setTop(top);
430 
431         MockResizable left = new MockResizable(100, 100);
432         borderpane.setLeft(left);
433 
434         MockBiased center = new MockBiased(Orientation.HORIZONTAL, 200, 100);
435         borderpane.setCenter(center);
436 
437         MockResizable right = new MockResizable(100, 100);
438         borderpane.setRight(right);
439 
440         MockResizable bottom = new MockResizable(400, 100);
441         borderpane.setBottom(bottom);
442 
443         assertEquals(240, borderpane.prefHeight(500), 1e-200);
444         borderpane.resize(500, 240);
445         borderpane.layout();
446 
447         assertEquals(0, top.getLayoutX(), 1e-200);
448         assertEquals(0, top.getLayoutY(), 1e-200);
449         assertEquals(500, top.getLayoutBounds().getWidth(), 1e-200);
450         assertEquals(40, top.getLayoutBounds().getHeight(), 1e-200);
451 
452         assertEquals(0, left.getLayoutX(), 1e-200);
453         assertEquals(40, left.getLayoutY(), 1e-200);
454         assertEquals(100, left.getLayoutBounds().getWidth(), 1e-200);
455         assertEquals(100, left.getLayoutBounds().getHeight(), 1e-200);
456 
457         assertEquals(100, center.getLayoutX(), 1e-200);
458         // 57 because the default alignment is Pos.CENTER
459         assertEquals(57, center.getLayoutY(), 1e-200);
460         assertEquals(300, center.getLayoutBounds().getWidth(), 1e-200);
461         assertEquals(67, center.getLayoutBounds().getHeight(), 1e-200);
462 
463         assertEquals(400, right.getLayoutX(), 1e-200);
464         assertEquals(40, right.getLayoutY(), 1e-200);
465         assertEquals(100, right.getLayoutBounds().getWidth(), 1e-200);
466         assertEquals(100, right.getLayoutBounds().getHeight(), 1e-200);
467 
468         assertEquals(0, bottom.getLayoutX(), 1e-200);
469         assertEquals(140, bottom.getLayoutY(), 1e-200);
470         assertEquals(500, bottom.getLayoutBounds().getWidth(), 1e-200);
471         assertEquals(100, bottom.getLayoutBounds().getHeight(), 1e-200);
472     }
473 
474     @Test public void testWithHorizontalBiasedChildrenShrinking() {
475         MockBiased top = new MockBiased(Orientation.HORIZONTAL, 200, 100);
476         borderpane.setTop(top);
477 
478         MockResizable left = new MockResizable(100, 100);
479         borderpane.setLeft(left);
480 
481         MockBiased center = new MockBiased(Orientation.HORIZONTAL, 200, 100);
482         borderpane.setCenter(center);
483 
484         MockResizable right = new MockResizable(100, 100);
485         borderpane.setRight(right);
486 
487         MockResizable bottom = new MockResizable(400, 100);
488         borderpane.setBottom(bottom);
489 
490         assertEquals(367, borderpane.prefHeight(300), 1e-200);
491         borderpane.resize(300, 367);
492         borderpane.layout();
493 
494         assertEquals(0, top.getLayoutX(), 1e-200);
495         assertEquals(0, top.getLayoutY(), 1e-200);
496         assertEquals(300, top.getLayoutBounds().getWidth(), 1e-200);
497         assertEquals(67, top.getLayoutBounds().getHeight(), 1e-200);
498 
499         assertEquals(0, left.getLayoutX(), 1e-200);
500         assertEquals(67, left.getLayoutY(), 1e-200);
501         assertEquals(100, left.getLayoutBounds().getWidth(), 1e-200);
502         assertEquals(200, left.getLayoutBounds().getHeight(), 1e-200);
503 
504         assertEquals(100, center.getLayoutX(), 1e-200);
505         assertEquals(67, center.getLayoutY(), 1e-200);
506         assertEquals(100, center.getLayoutBounds().getWidth(), 1e-200);
507         assertEquals(200, center.getLayoutBounds().getHeight(), 1e-200);
508 
509         assertEquals(200, right.getLayoutX(), 1e-200);
510         assertEquals(67, right.getLayoutY(), 1e-200);
511         assertEquals(100, right.getLayoutBounds().getWidth(), 1e-200);
512         assertEquals(200, right.getLayoutBounds().getHeight(), 1e-200);
513 
514         assertEquals(0, bottom.getLayoutX(), 1e-200);
515         assertEquals(267, bottom.getLayoutY(), 1e-200);
516         assertEquals(300, bottom.getLayoutBounds().getWidth(), 1e-200);
517         assertEquals(100, bottom.getLayoutBounds().getHeight(), 1e-200);
518     }
519 
520     @Test public void testWithVerticalBiasedChildrenAtPrefSize() {
521         MockResizable top = new MockResizable(400, 100);
522         borderpane.setTop(top);
523 
524         MockResizable left = new MockResizable(100, 100);
525         borderpane.setLeft(left);
526 
527         MockBiased center = new MockBiased(Orientation.VERTICAL, 200, 100);
528         borderpane.setCenter(center);
529 
530         MockResizable right = new MockResizable(100, 100);
531         borderpane.setRight(right);
532 
533         MockResizable bottom = new MockResizable(400, 100);
534         borderpane.setBottom(bottom);
535 
536         assertEquals(Orientation.VERTICAL, borderpane.getContentBias());
537         assertEquals(400, borderpane.prefWidth(-1), 1e-200);
538         assertEquals(300, borderpane.prefHeight(-1), 1e-200);
539 
540         borderpane.autosize();
541         borderpane.layout();
542 
543         assertEquals(0, top.getLayoutX(), 1e-200);
544         assertEquals(0, top.getLayoutY(), 1e-200);
545         assertEquals(400, top.getLayoutBounds().getWidth(), 1e-200);
546         assertEquals(100, top.getLayoutBounds().getHeight(), 1e-200);
547 
548         assertEquals(0, left.getLayoutX(), 1e-200);
549         assertEquals(100, left.getLayoutY(), 1e-200);
550         assertEquals(100, left.getLayoutBounds().getWidth(), 1e-200);
551         assertEquals(100, left.getLayoutBounds().getHeight(), 1e-200);
552 
553         assertEquals(100, center.getLayoutX(), 1e-200);
554         assertEquals(100, center.getLayoutY(), 1e-200);
555         assertEquals(200, center.getLayoutBounds().getWidth(), 1e-200);
556         assertEquals(100, center.getLayoutBounds().getHeight(), 1e-200);
557 
558         assertEquals(300, right.getLayoutX(), 1e-200);
559         assertEquals(100, right.getLayoutY(), 1e-200);
560         assertEquals(100, right.getLayoutBounds().getWidth(), 1e-200);
561         assertEquals(100, right.getLayoutBounds().getHeight(), 1e-200);
562 
563         assertEquals(0, bottom.getLayoutX(), 1e-200);
564         assertEquals(200, bottom.getLayoutY(), 1e-200);
565         assertEquals(400, bottom.getLayoutBounds().getWidth(), 1e-200);
566         assertEquals(100, bottom.getLayoutBounds().getHeight(), 1e-200);
567     }
568 
569     @Test public void testWithVerticalBiasedChildrenGrowing() {
570         MockBiased top = new MockBiased(Orientation.VERTICAL, 200, 100);
571         borderpane.setTop(top);
572 
573         MockResizable left = new MockResizable(100, 100);
574         borderpane.setLeft(left);
575 
576         MockBiased center = new MockBiased(Orientation.VERTICAL, 200, 100);
577         borderpane.setCenter(center);
578 
579         MockResizable right = new MockResizable(100, 100);
580         borderpane.setRight(right);
581 
582         MockResizable bottom = new MockResizable(400, 100);
583         borderpane.setBottom(bottom);
584 
585         assertEquals(400, borderpane.prefWidth(500), 1e-200);
586         borderpane.resize(400, 500);
587         borderpane.layout();
588 
589         assertEquals(0, top.getLayoutX(), 1e-200);
590         assertEquals(0, top.getLayoutY(), 1e-200);
591         assertEquals(200, top.getLayoutBounds().getWidth(), 1e-200);
592         assertEquals(100, top.getLayoutBounds().getHeight(), 1e-200);
593 
594         assertEquals(0, left.getLayoutX(), 1e-200);
595         assertEquals(100, left.getLayoutY(), 1e-200);
596         assertEquals(100, left.getLayoutBounds().getWidth(), 1e-200);
597         assertEquals(300, left.getLayoutBounds().getHeight(), 1e-200); // 500 - 100(top) - 100 (bottom)
598 
599         // not growing to max width, because the bias is vertical (pref width depends on height) and
600         // the default alignment is Pos.CENTER
601         double centerWidth = Math.round((200 * 100) /*original area*/ / 300.0) /*new height*/;
602         assertEquals(100 /*x position == left width*/ + centerWidth,
603                 center.getLayoutX(), 1e-200);
604         assertEquals(100, center.getLayoutY(), 1e-200);
605         assertEquals(centerWidth, center.getLayoutBounds().getWidth(), 1e-200);
606         assertEquals(300, center.getLayoutBounds().getHeight(), 1e-200);
607 
608         assertEquals(300, right.getLayoutX(), 1e-200);
609         assertEquals(100, right.getLayoutY(), 1e-200);
610         assertEquals(100, right.getLayoutBounds().getWidth(), 1e-200);
611         assertEquals(300, right.getLayoutBounds().getHeight(), 1e-200);
612 
613         assertEquals(0, bottom.getLayoutX(), 1e-200);
614         assertEquals(400, bottom.getLayoutY(), 1e-200);
615         assertEquals(400, bottom.getLayoutBounds().getWidth(), 1e-200);
616         assertEquals(100, bottom.getLayoutBounds().getHeight(), 1e-200);
617     }
618 
619     @Test public void testWithVerticalBiasedChildrenShrinking() {
620         MockBiased top = new MockBiased(Orientation.VERTICAL, 200, 100);
621         borderpane.setTop(top);
622 
623         MockResizable left = new MockResizable(100, 100);
624         borderpane.setLeft(left);
625 
626         MockBiased center = new MockBiased(Orientation.VERTICAL, 200, 100);
627         borderpane.setCenter(center);
628 
629         MockResizable right = new MockResizable(100, 100);
630         borderpane.setRight(right);
631 
632         MockResizable bottom = new MockResizable(400, 100);
633         borderpane.setBottom(bottom);
634 
635         // The total pref height of top + (l c r) + bottom is 300
636         // Shrinking this to 250 will lead to shrinking the center to 50
637         // which means center pref width will grow to 200 * 100 / 50 = 400
638         // (l, r) prefwidth is 100, which means 100 + 200 + 100 = 600,
639         // bottom prefwidth is 400
640         assertEquals(600, borderpane.prefWidth(250), 1e-200);
641         borderpane.resize(600, 250);
642         borderpane.layout();
643 
644         assertEquals(0, top.getLayoutX(), 1e-200);
645         assertEquals(0, top.getLayoutY(), 1e-200);
646         assertEquals(200, top.getLayoutBounds().getWidth(), 1e-200);
647         assertEquals(100, top.getLayoutBounds().getHeight(), 1e-200);
648 
649         assertEquals(0, left.getLayoutX(), 1e-200);
650         assertEquals(100, left.getLayoutY(), 1e-200);
651         assertEquals(100, left.getLayoutBounds().getWidth(), 1e-200);
652         assertEquals(50, left.getLayoutBounds().getHeight(), 1e-200);
653 
654         assertEquals(100, center.getLayoutX(), 1e-200);
655         assertEquals(100, center.getLayoutY(), 1e-200);
656         assertEquals(400, center.getLayoutBounds().getWidth(), 1e-200);
657         assertEquals(50, center.getLayoutBounds().getHeight(), 1e-200);
658 
659         assertEquals(500, right.getLayoutX(), 1e-200);
660         assertEquals(100, right.getLayoutY(), 1e-200);
661         assertEquals(100, right.getLayoutBounds().getWidth(), 1e-200);
662         assertEquals(50, right.getLayoutBounds().getHeight(), 1e-200);
663 
664         assertEquals(0, bottom.getLayoutX(), 1e-200);
665         assertEquals(150, bottom.getLayoutY(), 1e-200);
666         assertEquals(600, bottom.getLayoutBounds().getWidth(), 1e-200);
667         assertEquals(100, bottom.getLayoutBounds().getHeight(), 1e-200);
668 
669 
670         // Now make it a little wider (center should be in the middle now)
671         borderpane.resize(700, 250);
672         borderpane.layout();
673 
674         assertEquals(0, top.getLayoutX(), 1e-200);
675         assertEquals(0, top.getLayoutY(), 1e-200);
676         assertEquals(200, top.getLayoutBounds().getWidth(), 1e-200);
677         assertEquals(100, top.getLayoutBounds().getHeight(), 1e-200);
678 
679         assertEquals(0, left.getLayoutX(), 1e-200);
680         assertEquals(100, left.getLayoutY(), 1e-200);
681         assertEquals(100, left.getLayoutBounds().getWidth(), 1e-200);
682         assertEquals(50, left.getLayoutBounds().getHeight(), 1e-200);
683 
684         assertEquals(150, center.getLayoutX(), 1e-200);
685         assertEquals(100, center.getLayoutY(), 1e-200);
686         assertEquals(400, center.getLayoutBounds().getWidth(), 1e-200);
687         assertEquals(50, center.getLayoutBounds().getHeight(), 1e-200);
688 
689         assertEquals(600, right.getLayoutX(), 1e-200);
690         assertEquals(100, right.getLayoutY(), 1e-200);
691         assertEquals(100, right.getLayoutBounds().getWidth(), 1e-200);
692         assertEquals(50, right.getLayoutBounds().getHeight(), 1e-200);
693 
694         assertEquals(0, bottom.getLayoutX(), 1e-200);
695         assertEquals(150, bottom.getLayoutY(), 1e-200);
696         assertEquals(700, bottom.getLayoutBounds().getWidth(), 1e-200);
697         assertEquals(100, bottom.getLayoutBounds().getHeight(), 1e-200);
698     }
699 
700     @Test public void testFitsTopChildWithinBounds() {
701         MockResizable child = new MockResizable(10,20, 100,200, 700,800);
702         borderpane.setTop(child);
703 
704         borderpane.resize(50,50);
705         borderpane.layout();
706 
707         assertEquals(50, child.getWidth(), 1e-100);
708         assertEquals(200, child.getHeight(), 1e-100); //Top always at it&#39;s pref height
709     }
710 
711     @Test public void testFitsBottomChildWithinBounds() {
712         MockResizable child = new MockResizable(10,20, 100,200, 700,800);
713         borderpane.setBottom(child);
714 
715         borderpane.resize(50,50);
716         borderpane.layout();
717 
718         assertEquals(50, child.getWidth(), 1e-100);
719         assertEquals(200, child.getHeight(), 1e-100); //Bottom always at it&#39;s pref height
720     }
721 
722     @Test public void testFitsLeftChildWithinBounds() {
723         MockResizable child = new MockResizable(10,20, 100,200, 700,800);
724         borderpane.setLeft(child);
725 
726         borderpane.resize(50,50);
727         borderpane.layout();
728 
729         assertEquals(100, child.getWidth(), 1e-100); //Left always at it&#39;s pref width
730         assertEquals(50, child.getHeight(), 1e-100);
731     }
732 
733     @Test public void testFitsRightChildWithinBounds() {
734         MockResizable child = new MockResizable(10,20, 100,200, 700,800);
735         borderpane.setRight(child);
736 
737         borderpane.resize(50,50);
738         borderpane.layout();
739 
740         assertEquals(100, child.getWidth(), 1e-100); //Right always at it&#39;s pref width
741         assertEquals(50, child.getHeight(), 1e-100);
742     }
743 
744     @Test public void testFitsCenterChildWithinBounds() {
745         MockResizable child = new MockResizable(10,20, 100,200, 700,800);
746         borderpane.setCenter(child);
747 
748         borderpane.resize(50,50);
749         borderpane.layout();
750 
751         assertEquals(50, child.getWidth(), 1e-100);
752         assertEquals(50, child.getHeight(), 1e-100);
753     }
754 
755     @Test public void testFitsAllChildrenWithinBounds() {
756         MockResizable top = new MockResizable(10,20, 200,100, 700,800);
757         MockResizable bottom = new MockResizable(10,20, 200,100, 700,800);
758         MockResizable left = new MockResizable(10,20, 100,200, 700,800);
759         MockResizable right = new MockResizable(10,20, 100,200, 700,800);
760         MockResizable center = new MockResizable(10,20, 200,200, 700,800);
761 
762         borderpane.setTop(top);
763         borderpane.setBottom(bottom);
764         borderpane.setLeft(left);
765         borderpane.setRight(right);
766         borderpane.setCenter(center);
767 
768         borderpane.resize(300,300);
769         borderpane.layout();
770 
771         assertEquals(300, top.getWidth(), 1e-100);
772         assertEquals(100, top.getHeight(), 1e-100);
773         assertEquals(0,   top.getLayoutX(), 1e-100);
774         assertEquals(0,   top.getLayoutY(), 1e-100);
775         assertEquals(300, bottom.getWidth(), 1e-100);
776         assertEquals(100, bottom.getHeight(), 1e-100);
777         assertEquals(0,   bottom.getLayoutX(), 1e-100);
778         assertEquals(200, bottom.getLayoutY(), 1e-100);
779         assertEquals(100, left.getWidth(), 1e-100);
780         assertEquals(100, left.getHeight(), 1e-100);
781         assertEquals(0,   left.getLayoutX(), 1e-100);
782         assertEquals(100, left.getLayoutY(), 1e-100);
783         assertEquals(100, right.getWidth(), 1e-100);
784         assertEquals(100, right.getHeight(), 1e-100);
785         assertEquals(200, right.getLayoutX(), 1e-100);
786         assertEquals(100, right.getLayoutY(), 1e-100);
787         assertEquals(100, center.getWidth(), 1e-100);
788         assertEquals(100, center.getHeight(), 1e-100);
789         assertEquals(100, center.getLayoutX(), 1e-100);
790         assertEquals(100, center.getLayoutY(), 1e-100);
791     }
792 
793     @Test public void testTopChildWithMargin() {
794         MockResizable top = new MockResizable(10,10,130,30,150,50);
795         MockResizable center = new MockResizable(10,10,100,100,200,200);
796         Insets insets = new Insets(10, 5, 20, 30);
797         BorderPane.setMargin(top, insets);
798         borderpane.setTop(top);
799         borderpane.setCenter(center);
800 
801         assertEquals(45, borderpane.minWidth(-1), 1e-100);
802         // 10 + 20 (margin) + 30 (top.prefHeight) + 10 (center.minHeight)
803         // Top is always at it&#39;s pref height
804         assertEquals(70, borderpane.minHeight(-1), 1e-100);
805         assertEquals(165, borderpane.prefWidth(-1), 1e-100);
806         assertEquals(160, borderpane.prefHeight(-1), 1e-100);
807         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
808         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
809 
810         borderpane.autosize();
811         borderpane.layout();
812         assertEquals(30, top.getLayoutX(), 1e-100);
813         assertEquals(10, top.getLayoutY(), 1e-100);
814         assertEquals(130, top.getWidth(), 1e-100);
815         assertEquals(30, top.getHeight(), 1e-100);
816 
817         assertEquals(0, center.getLayoutX(), 1e-100);
818         assertEquals(60, center.getLayoutY(), 1e-100);
819     }
820 
821     @Test public void testBottomChildWithMargin() {
822         MockResizable bottom = new MockResizable(10,10,130,30,150,50);
823         MockResizable center = new MockResizable(10,10,100,100,200,200);
824         Insets insets = new Insets(10, 5, 20, 30);
825         BorderPane.setMargin(bottom, insets);
826         borderpane.setBottom(bottom);
827         borderpane.setCenter(center);
828 
829         assertEquals(45, borderpane.minWidth(-1), 1e-100);
830         assertEquals(70, borderpane.minHeight(-1), 1e-100);
831         assertEquals(165, borderpane.prefWidth(-1), 1e-100);
832         assertEquals(160, borderpane.prefHeight(-1), 1e-100);
833         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
834         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
835 
836         borderpane.autosize();
837         borderpane.layout();
838         assertEquals(30, bottom.getLayoutX(), 1e-100);
839         assertEquals(110, bottom.getLayoutY(), 1e-100);
840         assertEquals(130, bottom.getWidth(), 1e-100);
841         assertEquals(30, bottom.getHeight(), 1e-100);
842 
843         assertEquals(0, center.getLayoutX(), 1e-100);
844         assertEquals(0, center.getLayoutY(), 1e-100);
845     }
846 
847     @Test public void testLeftChildWithMargin() {
848         MockResizable left = new MockResizable(10,10,130,130,150,150);
849         MockResizable center = new MockResizable(10,10,100,100,200,200);
850         Insets insets = new Insets(5, 10, 30, 20);
851         BorderPane.setMargin(left, insets);
852         borderpane.setLeft(left);
853         borderpane.setCenter(center);
854 
855         assertEquals(45, borderpane.minHeight(-1), 1e-100);
856         assertEquals(170, borderpane.minWidth(-1), 1e-100);
857         assertEquals(165, borderpane.prefHeight(-1), 1e-100);
858         assertEquals(260, borderpane.prefWidth(-1), 1e-100);
859         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
860         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
861 
862         borderpane.autosize();
863         borderpane.layout();
864         assertEquals(20, left.getLayoutX(), 1e-100);
865         assertEquals(5, left.getLayoutY(), 1e-100);
866         assertEquals(130, left.getWidth(), 1e-100);
867         assertEquals(130, left.getHeight(), 1e-100);
868 
869         assertEquals(160, center.getLayoutX(), 1e-100);
870         assertEquals(0, center.getLayoutY(), 1e-100);
871     }
872 
873     @Test public void testRightChildWithMargin() {
874         MockResizable right = new MockResizable(10,10,130,130,150,150);
875         MockResizable center = new MockResizable(10,10,100,100,200,200);
876         Insets insets = new Insets(5, 10, 30, 20);
877         BorderPane.setMargin(right, insets);
878         borderpane.setRight(right);
879         borderpane.setCenter(center);
880 
881         assertEquals(45, borderpane.minHeight(-1), 1e-100);
882         assertEquals(170, borderpane.minWidth(-1), 1e-100);
883         assertEquals(165, borderpane.prefHeight(-1), 1e-100);
884         assertEquals(260, borderpane.prefWidth(-1), 1e-100);
885         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
886         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
887 
888         borderpane.autosize();
889         borderpane.layout();
890         assertEquals(120, right.getLayoutX(), 1e-100);
891         assertEquals(5, right.getLayoutY(), 1e-100);
892         assertEquals(130, right.getWidth(), 1e-100);
893         assertEquals(130, right.getHeight(), 1e-100);
894 
895         assertEquals(0, center.getLayoutX(), 1e-100);
896         assertEquals(0, center.getLayoutY(), 1e-100);
897     }
898 
899     @Test public void testCenterChildWithMargin() {
900         MockResizable center = new MockResizable(10,10,100,100,200,200);
901         Insets insets = new Insets(5, 10, 30, 20);
902         BorderPane.setMargin(center, insets);
903         borderpane.setCenter(center);
904 
905         assertEquals(45, borderpane.minHeight(-1), 1e-100);
906         assertEquals(40, borderpane.minWidth(-1), 1e-100);
907         assertEquals(135, borderpane.prefHeight(-1), 1e-100);
908         assertEquals(130, borderpane.prefWidth(-1), 1e-100);
909         assertEquals(Double.MAX_VALUE, borderpane.maxWidth(-1), 1e-100);
910         assertEquals(Double.MAX_VALUE, borderpane.maxHeight(-1), 1e-100);
911 
912         borderpane.autosize();
913         borderpane.layout();
914 
915         assertEquals(20, center.getLayoutX(), 1e-100);
916         assertEquals(5, center.getLayoutY(), 1e-100);
917     }
918 
919     @Test
920     public void testResizeBelowMinimum() {
921         MockResizable left = new MockResizable(10,10,100,100,150,150);
922         MockResizable center = new MockResizable(30,30,100,100,200,200);
923 
924         borderpane.setCenter(center);
925         borderpane.setLeft(left);
926 
927         borderpane.resize(30, 30);
928 
929         borderpane.layout();
930 
931         assertEquals(100, left.getWidth(), 1e-100); // Always at pref.
932         assertEquals(30, left.getHeight(), 1e-100);
933 
934         assertEquals(100, center.getLayoutX(), 1e-100);
935         assertEquals(0, center.getLayoutY(), 1e-100);
936         assertEquals(30, center.getWidth(), 1e-100);
937         assertEquals(30, center.getHeight(), 1e-100);
938     }
939 
940 }
    </pre>
  </body>
</html>