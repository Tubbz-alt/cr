<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>New modules/javafx.controls/src/test/java/test/javafx/scene/control/TabPaneTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
  <body>
    <pre>
   1 /*
   2  * Copyright (c) 2010, 2018, Oracle and/or its affiliates. All rights reserved.
   3  * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4  *
   5  * This code is free software; you can redistribute it and/or modify it
   6  * under the terms of the GNU General Public License version 2 only, as
   7  * published by the Free Software Foundation.  Oracle designates this
   8  * particular file as subject to the &quot;Classpath&quot; exception as provided
   9  * by Oracle in the LICENSE file that accompanied this code.
  10  *
  11  * This code is distributed in the hope that it will be useful, but WITHOUT
  12  * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  13  * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  14  * version 2 for more details (a copy is included in the LICENSE file that
  15  * accompanied this code).
  16  *
  17  * You should have received a copy of the GNU General Public License version
  18  * 2 along with this work; if not, write to the Free Software Foundation,
  19  * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  20  *
  21  * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  22  * or visit www.oracle.com if you need additional information or have any
  23  * questions.
  24  */
  25 
  26 package test.javafx.scene.control;
  27 
  28 import com.sun.javafx.scene.SceneHelper;
  29 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.assertPseudoClassDoesNotExist;
  30 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.assertPseudoClassExists;
  31 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.assertStyleClassContains;
  32 import static org.junit.Assert.assertEquals;
  33 import static org.junit.Assert.assertFalse;
  34 import static org.junit.Assert.assertNotNull;
  35 import static org.junit.Assert.assertNull;
  36 import static org.junit.Assert.assertSame;
  37 import static org.junit.Assert.assertTrue;
  38 import static org.junit.Assert.fail;
  39 
  40 import test.com.sun.javafx.scene.control.infrastructure.StageLoader;
  41 import javafx.application.Platform;
  42 import javafx.beans.property.BooleanProperty;
  43 import javafx.beans.property.DoubleProperty;
  44 import javafx.beans.property.ObjectProperty;
  45 import javafx.beans.property.SimpleBooleanProperty;
  46 import javafx.beans.property.SimpleDoubleProperty;
  47 import javafx.beans.property.SimpleObjectProperty;
  48 import javafx.beans.value.ChangeListener;
  49 import javafx.css.CssMetaData;
  50 import javafx.css.StyleableProperty;
  51 import javafx.event.Event;
  52 import javafx.geometry.Bounds;
  53 import javafx.geometry.Side;
  54 import javafx.scene.Group;
  55 import javafx.scene.Scene;
  56 import javafx.scene.input.KeyEvent;
  57 import javafx.scene.input.MouseButton;
  58 import javafx.scene.input.MouseEvent;
  59 import javafx.scene.layout.StackPane;
  60 import javafx.scene.layout.VBox;
  61 import javafx.stage.Stage;
  62 
  63 import org.junit.Before;
  64 import org.junit.Ignore;
  65 import org.junit.Test;
  66 
  67 import test.com.sun.javafx.pgstub.StubToolkit;
  68 import test.com.sun.javafx.scene.control.infrastructure.KeyEventFirer;
  69 import test.com.sun.javafx.scene.control.infrastructure.MouseEventGenerator;
  70 import com.sun.javafx.scene.input.KeyCodeMap;
  71 import com.sun.javafx.tk.Toolkit;
  72 
  73 import java.util.Arrays;
  74 import java.util.HashMap;
  75 import java.util.LinkedList;
  76 import java.util.List;
  77 import java.util.Map;
  78 import javafx.scene.control.Button;
  79 import javafx.scene.control.ContextMenu;
  80 import javafx.scene.control.ScrollPane;
  81 import javafx.scene.control.SingleSelectionModel;
  82 import javafx.scene.control.SingleSelectionModelShim;
  83 import javafx.scene.control.skin.TabPaneSkin;
  84 import javafx.scene.control.skin.TabPaneSkinShim;
  85 import javafx.scene.control.SplitPane;
  86 import javafx.scene.control.Tab;
  87 import javafx.scene.control.TabPane;
  88 import javafx.scene.control.TabPaneShim;
  89 
  90 import java.lang.ref.WeakReference;
  91 
  92 public class TabPaneTest {
  93     private TabPane tabPane;//Empty string
  94     private Toolkit tk;
  95     private SingleSelectionModel&lt;Tab&gt; sm;
  96     private Tab tab1;
  97     private Tab tab2;
  98     private Tab tab3;
  99     private Scene scene;
 100     private Stage stage;
 101     private StackPane root;
 102 
 103     @Before public void setup() {
 104         tk = (StubToolkit)Toolkit.getToolkit();//This step is not needed (Just to make sure StubToolkit is loaded into VM)
 105         tabPane = new TabPane();
 106         tab1 = new Tab(&quot;one&quot;);
 107         tab2 = new Tab(&quot;two&quot;);
 108         tab3 = new Tab(&quot;three&quot;);
 109         sm = TabPaneShim.getTabPaneSelectionModel(tabPane);
 110         root = new StackPane();
 111         scene = new Scene(root);
 112         stage = new Stage();
 113         stage.setScene(scene);
 114     }
 115 
 116     /*********************************************************************
 117      * Helper methods                                                    *
 118      ********************************************************************/
 119 
 120     private void show() {
 121         stage.show();
 122         stage.requestFocus();
 123     }
 124 
 125     /*********************************************************************
 126      * Tests for default values                                         *
 127      ********************************************************************/
 128 
 129     @Test public void defaultConstructorShouldSetStyleClassTo_tabpane() {
 130         assertStyleClassContains(tabPane, &quot;tab-pane&quot;);
 131     }
 132 
 133     @Test public void defaultConstructorSelectionModelNotNull() {
 134         assertNotNull(tabPane.getSelectionModel());
 135     }
 136 
 137     @Test public void defaultConstructorInitialTabsEmpty() {
 138         assertNotNull(tabPane.getTabs());
 139         assertEquals(tabPane.getTabs().size(), 0.0, 0.0);
 140     }
 141 
 142     @Test public void defaultSideIsTop() {
 143         assertSame(tabPane.getSide(), Side.TOP);
 144     }
 145 
 146     @Test public void defaultConstructorTabClosingPolicy() {
 147         assertNotNull(tabPane.getTabClosingPolicy());
 148         assertSame(tabPane.getTabClosingPolicy(), TabPane.TabClosingPolicy.SELECTED_TAB);
 149     }
 150 
 151     @Test public void defaultConstructorRotateGraphic() {
 152         assertFalse(tabPane.isRotateGraphic());
 153     }
 154 
 155     @Test public void defaultTabMinWidth() {
 156         assertEquals(tabPane.getTabMinWidth(), 0.0, 0.0);
 157     }
 158 
 159     @Test public void defaultTabMaxWidth() {
 160         assertEquals(tabPane.getTabMaxWidth(), Double.MAX_VALUE, 0.0);
 161     }
 162 
 163     @Test public void defaultTabMinHeight() {
 164         assertEquals(tabPane.getTabMinHeight(), 0.0, 0.0);
 165     }
 166 
 167     @Test public void defaultTabMaxHeight() {
 168         assertEquals(tabPane.getTabMaxHeight(), Double.MAX_VALUE, 0.0);
 169     }
 170 
 171     @Test public void defaultSelectionModelEmpty() {
 172         assertTrue(tabPane.getSelectionModel().isEmpty());
 173     }
 174 
 175     @Test public void initialBoundsInParentMatchesWidthAndHeight() {
 176         TabPane testPane = new TabPane();
 177         testPane.resize(400, 400);
 178         testPane.setSkin(new TabPaneSkin(testPane));
 179         Bounds boundsInParent = testPane.getBoundsInParent();
 180         assertEquals(testPane.getWidth(), boundsInParent.getWidth(), 0.0);
 181         assertEquals(testPane.getHeight(), boundsInParent.getHeight(), 0.0);
 182     }
 183 
 184     /*********************************************************************
 185      * Tests for property binding                                        *
 186      ********************************************************************/
 187 
 188     @Test public void checkSelectionModelPropertyBind() {
 189         ObjectProperty objPr = new SimpleObjectProperty&lt;SingleSelectionModel&lt;Tab&gt;&gt;(null);
 190         tabPane.selectionModelProperty().bind(objPr);
 191         assertNull(&quot;selectionModel cannot be bound&quot;, tabPane.selectionModelProperty().getValue());
 192         objPr.setValue(sm);
 193         assertSame(&quot;selectionModel cannot be bound&quot;, tabPane.selectionModelProperty().getValue(), sm);
 194     }
 195 
 196     @Test public void checkSidePropertyBind() {
 197         ObjectProperty objPr = new SimpleObjectProperty&lt;Side&gt;(Side.BOTTOM);
 198         tabPane.sideProperty().bind(objPr);
 199         assertSame(&quot;side cannot be bound&quot;, tabPane.sideProperty().getValue(), Side.BOTTOM);
 200         objPr.setValue(Side.RIGHT);
 201         assertSame(&quot;side cannot be bound&quot;, tabPane.sideProperty().getValue(), Side.RIGHT);
 202     }
 203 
 204     @Test public void checkTabClosingPropertyBind() {
 205         ObjectProperty objPr = new SimpleObjectProperty&lt;TabPane.TabClosingPolicy&gt;(TabPane.TabClosingPolicy.UNAVAILABLE);
 206         tabPane.tabClosingPolicyProperty().bind(objPr);
 207         assertSame(&quot;side cannot be bound&quot;, tabPane.tabClosingPolicyProperty().getValue(), TabPane.TabClosingPolicy.UNAVAILABLE);
 208         objPr.setValue(TabPane.TabClosingPolicy.ALL_TABS);
 209         assertSame(&quot;side cannot be bound&quot;, tabPane.tabClosingPolicyProperty().getValue(), TabPane.TabClosingPolicy.ALL_TABS);
 210     }
 211 
 212     @Test public void checkRotateGraphicsPropertyBind() {
 213         BooleanProperty objPr = new SimpleBooleanProperty(false);
 214         tabPane.rotateGraphicProperty().bind(objPr);
 215         assertFalse(&quot;rotateGraphic cannot be bound&quot;, tabPane.rotateGraphicProperty().getValue());
 216         objPr.setValue(true);
 217         assertTrue(&quot;rotateGraphic cannot be bound&quot;, tabPane.rotateGraphicProperty().getValue());
 218     }
 219 
 220     @Test public void checkTabMinWidthPropertyBind() {
 221         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 222         tabPane.tabMinWidthProperty().bind(objPr);
 223         assertEquals(&quot;tabMinWidthProperty cannot be bound&quot;, tabPane.tabMinWidthProperty().getValue(), 2.0, 0.0);
 224         objPr.setValue(5.0);
 225         assertEquals(&quot;tabMinWidthProperty cannot be bound&quot;, tabPane.tabMinWidthProperty().getValue(), 5.0, 0.0);
 226     }
 227 
 228     @Test public void checkTabMaxWidthPropertyBind() {
 229         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 230         tabPane.tabMaxWidthProperty().bind(objPr);
 231         assertEquals(&quot;tabMaxWidthProperty cannot be bound&quot;, tabPane.tabMaxWidthProperty().getValue(), 2.0, 0.0);
 232         objPr.setValue(5.0);
 233         assertEquals(&quot;tabMaxWidthProperty cannot be bound&quot;, tabPane.tabMaxWidthProperty().getValue(), 5.0, 0.0);
 234     }
 235 
 236 
 237     @Test public void checkTabMinHeightPropertyBind() {
 238         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 239         tabPane.tabMinHeightProperty().bind(objPr);
 240         assertEquals(&quot;tabMinHeightProperty cannot be bound&quot;, tabPane.tabMinHeightProperty().getValue(), 2.0, 0.0);
 241         objPr.setValue(5.0);
 242         assertEquals(&quot;tabMinHeightProperty cannot be bound&quot;, tabPane.tabMinHeightProperty().getValue(), 5.0, 0.0);
 243     }
 244 
 245     @Test public void checkTabMaxHeightPropertyBind() {
 246         DoubleProperty objPr = new SimpleDoubleProperty(2.0);
 247         tabPane.tabMaxHeightProperty().bind(objPr);
 248         assertEquals(&quot;tabMaxHeightProperty cannot be bound&quot;, tabPane.tabMaxHeightProperty().getValue(), 2.0, 0.0);
 249         objPr.setValue(5.0);
 250         assertEquals(&quot;tabMaxHeightProperty cannot be bound&quot;, tabPane.tabMaxHeightProperty().getValue(), 5.0, 0.0);
 251     }
 252 
 253     @Test public void selectionModelPropertyHasBeanReference() {
 254         assertSame(tabPane, tabPane.selectionModelProperty().getBean());
 255     }
 256 
 257     @Test public void selectionModelPropertyHasName() {
 258         assertEquals(&quot;selectionModel&quot;, tabPane.selectionModelProperty().getName());
 259     }
 260 
 261     @Test public void sidePropertyHasBeanReference() {
 262         assertSame(tabPane, tabPane.sideProperty().getBean());
 263     }
 264 
 265     @Test public void sidePropertyHasName() {
 266         assertEquals(&quot;side&quot;, tabPane.sideProperty().getName());
 267     }
 268 
 269     @Test public void tabClosingPolicyPropertyHasBeanReference() {
 270         assertSame(tabPane, tabPane.tabClosingPolicyProperty().getBean());
 271     }
 272 
 273     @Test public void tabClosingPolicyPropertyHasName() {
 274         assertEquals(&quot;tabClosingPolicy&quot;, tabPane.tabClosingPolicyProperty().getName());
 275     }
 276 
 277     @Test public void rotateGraphicPropertyHasBeanReference() {
 278         assertSame(tabPane, tabPane.rotateGraphicProperty().getBean());
 279     }
 280 
 281     @Test public void rotateGraphicPropertyHasName() {
 282         assertEquals(&quot;rotateGraphic&quot;, tabPane.rotateGraphicProperty().getName());
 283     }
 284 
 285     @Test public void tabMinWidthPropertyHasBeanReference() {
 286         assertSame(tabPane, tabPane.tabMinWidthProperty().getBean());
 287     }
 288 
 289     @Test public void tabMinWidthPropertyHasName() {
 290         assertEquals(&quot;tabMinWidth&quot;, tabPane.tabMinWidthProperty().getName());
 291     }
 292 
 293     @Test public void tabMaxWidthPropertyHasBeanReference() {
 294         assertSame(tabPane, tabPane.tabMaxWidthProperty().getBean());
 295     }
 296 
 297     @Test public void tabMaxWidthPropertyHasName() {
 298         assertEquals(&quot;tabMaxWidth&quot;, tabPane.tabMaxWidthProperty().getName());
 299     }
 300 
 301     @Test public void tabMinHeightPropertyHasBeanReference() {
 302         assertSame(tabPane, tabPane.tabMinHeightProperty().getBean());
 303     }
 304 
 305     @Test public void tabMinHeightPropertyHasName() {
 306         assertEquals(&quot;tabMinHeight&quot;, tabPane.tabMinHeightProperty().getName());
 307     }
 308 
 309     @Test public void tabMaxHeightPropertyHasBeanReference() {
 310         assertSame(tabPane, tabPane.tabMaxHeightProperty().getBean());
 311     }
 312 
 313     @Test public void tabMaxHeightPropertyHasName() {
 314         assertEquals(&quot;tabMaxHeight&quot;, tabPane.tabMaxHeightProperty().getName());
 315     }
 316 
 317 
 318     /*********************************************************************
 319      * Check for Pseudo classes                                          *
 320      ********************************************************************/
 321 
 322     @Test public void settingSideSetsPseudoClass() {
 323         tabPane.setSide(Side.BOTTOM);
 324         assertPseudoClassExists(tabPane, &quot;bottom&quot;);
 325         assertPseudoClassDoesNotExist(tabPane, &quot;top&quot;);
 326         assertPseudoClassDoesNotExist(tabPane, &quot;left&quot;);
 327         assertPseudoClassDoesNotExist(tabPane, &quot;right&quot;);
 328     }
 329 
 330     @Test public void clearingSideClearsPseudoClass() {
 331         tabPane.setSide(Side.BOTTOM);
 332         tabPane.setSide(Side.LEFT);
 333         assertPseudoClassExists(tabPane, &quot;left&quot;);
 334         assertPseudoClassDoesNotExist(tabPane, &quot;bottom&quot;);
 335         assertPseudoClassDoesNotExist(tabPane, &quot;top&quot;);
 336         assertPseudoClassDoesNotExist(tabPane, &quot;right&quot;);
 337     }
 338 
 339 
 340     /*********************************************************************
 341      * CSS related Tests                                                 *
 342      ********************************************************************/
 343 
 344     @Test public void whenTabMinWidthIsBound_impl_cssSettable_ReturnsFalse() {
 345         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinWidthProperty()).getCssMetaData();
 346         assertTrue(styleable.isSettable(tabPane));
 347         DoubleProperty other = new SimpleDoubleProperty(30.0);
 348         tabPane.tabMinWidthProperty().bind(other);
 349         assertFalse(styleable.isSettable(tabPane));
 350     }
 351 
 352     @Test public void whenTabMinWidthIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 353         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinWidthProperty()).getCssMetaData();
 354         assertTrue(styleable.isSettable(tabPane));
 355     }
 356 
 357     @Test public void canSpecifyTabMinWidthViaCSS() {
 358         ((StyleableProperty)tabPane.tabMinWidthProperty()).applyStyle(null, 34.0);
 359         assertEquals(34.0, tabPane.getTabMinWidth(), 0.0);
 360     }
 361 
 362     @Test public void whenTabMaxWidthIsBound_impl_cssSettable_ReturnsFalse() {
 363         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxWidthProperty()).getCssMetaData();
 364         assertTrue(styleable.isSettable(tabPane));
 365         DoubleProperty other = new SimpleDoubleProperty(30.0);
 366         tabPane.tabMaxWidthProperty().bind(other);
 367         assertFalse(styleable.isSettable(tabPane));
 368     }
 369 
 370     @Test public void whenTabMaxWidthIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 371         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxWidthProperty()).getCssMetaData();
 372         assertTrue(styleable.isSettable(tabPane));
 373     }
 374 
 375     @Test public void canSpecifyTabMaxWidthViaCSS() {
 376         ((StyleableProperty)tabPane.tabMaxWidthProperty()).applyStyle(null, 34.0);
 377         assertEquals(34.0, tabPane.getTabMaxWidth(), 0.0);
 378     }
 379 
 380     @Test public void whenTabMinHeightIsBound_impl_cssSettable_ReturnsFalse() {
 381         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinHeightProperty()).getCssMetaData();
 382         assertTrue(styleable.isSettable(tabPane));
 383         DoubleProperty other = new SimpleDoubleProperty(30.0);
 384         tabPane.tabMinHeightProperty().bind(other);
 385         assertFalse(styleable.isSettable(tabPane));
 386     }
 387 
 388     @Test public void whenTabMinHeightIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 389         CssMetaData styleable = ((StyleableProperty)tabPane.tabMinHeightProperty()).getCssMetaData();
 390         assertTrue(styleable.isSettable(tabPane));
 391     }
 392 
 393     @Test public void canSpecifyTabMinHeightViaCSS() {
 394         ((StyleableProperty)tabPane.tabMinHeightProperty()).applyStyle(null, 34.0);
 395         assertEquals(34.0, tabPane.getTabMinHeight(), 0.0);
 396     }
 397 
 398     @Test public void whenTabMaxHeightIsBound_impl_cssSettable_ReturnsFalse() {
 399         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxHeightProperty()).getCssMetaData();
 400         assertTrue(styleable.isSettable(tabPane));
 401         DoubleProperty other = new SimpleDoubleProperty(30.0);
 402         tabPane.tabMaxHeightProperty().bind(other);
 403         assertFalse(styleable.isSettable(tabPane));
 404     }
 405 
 406     @Test public void whenTabMaxHeightIsSpecifiedViaCSSAndIsNotBound_impl_cssSettable_ReturnsTrue() {
 407         CssMetaData styleable = ((StyleableProperty)tabPane.tabMaxHeightProperty()).getCssMetaData();
 408         assertTrue(styleable.isSettable(tabPane));
 409     }
 410 
 411     @Test public void canSpecifyTabMaxHeightViaCSS() {
 412         ((StyleableProperty)tabPane.tabMaxHeightProperty()).applyStyle(null, 34.0);
 413         assertEquals(34.0, tabPane.getTabMaxHeight(), 0.0);
 414     }
 415 
 416 
 417     /*********************************************************************
 418      * Miscellaneous Tests                                               *
 419      ********************************************************************/
 420 
 421     @Test public void setSelectionModelAndSeeValueIsReflectedInModel() {
 422         tabPane.setSelectionModel(sm);
 423         assertSame(tabPane.selectionModelProperty().getValue(), sm);
 424     }
 425 
 426     @Test public void setselectionModelAndSeeValue() {
 427         tabPane.setSelectionModel(sm);
 428         assertSame(tabPane.getSelectionModel(), sm);
 429     }
 430 
 431     @Test public void setSideAndSeeValueIsReflectedInModel() {
 432         tabPane.setSide(Side.BOTTOM);
 433         assertSame(tabPane.sideProperty().getValue(), Side.BOTTOM);
 434     }
 435 
 436     @Test public void setSideAndSeeValue() {
 437         tabPane.setSide(Side.LEFT);
 438         assertSame(tabPane.getSide(), Side.LEFT);
 439     }
 440 
 441     @Test public void setTabClosingPolicyAndSeeValueIsReflectedInModel() {
 442         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.ALL_TABS);
 443         assertSame(tabPane.tabClosingPolicyProperty().getValue(), TabPane.TabClosingPolicy.ALL_TABS);
 444     }
 445 
 446     @Test public void setTabClosingPolicyAndSeeValue() {
 447         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.UNAVAILABLE);
 448         assertSame(tabPane.getTabClosingPolicy(), TabPane.TabClosingPolicy.UNAVAILABLE);
 449     }
 450 
 451     @Test public void setTabDragPolicyAndSeeValueIsReflectedInModel() {
 452         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.REORDER);
 453         assertSame(TabPane.TabDragPolicy.REORDER, tabPane.tabDragPolicyProperty().getValue());
 454 
 455         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.FIXED);
 456         assertSame(TabPane.TabDragPolicy.FIXED, tabPane.tabDragPolicyProperty().getValue());
 457     }
 458 
 459     @Test public void setTabDragPolicyAndSeeValue() {
 460         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.REORDER);
 461         assertSame(TabPane.TabDragPolicy.REORDER, tabPane.getTabDragPolicy());
 462 
 463         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.FIXED);
 464         assertSame(TabPane.TabDragPolicy.FIXED, tabPane.getTabDragPolicy());
 465     }
 466 
 467     @Test public void tabDragPolicyReorderAndAsymmetricMouseEvent() {
 468         tabPane.setTabDragPolicy(TabPane.TabDragPolicy.REORDER);
 469         tabPane.getTabs().add(tab1);
 470         tabPane.getTabs().add(tab2);
 471         root.getChildren().add(tabPane);
 472         show();
 473 
 474         root.layout();
 475 
 476         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
 477         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
 478 
 479         SceneHelper.processMouseEvent(scene,
 480             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_RELEASED, xval+75, yval+20));
 481         tk.firePulse();
 482     }
 483 
 484 
 485     @Test public void setRotateGraphicAndSeeValueIsReflectedInModel() {
 486         tabPane.setRotateGraphic(true);
 487         assertTrue(tabPane.rotateGraphicProperty().getValue());
 488     }
 489 
 490     @Test public void setRotateGraphicAndSeeValue() {
 491         tabPane.setRotateGraphic(true);
 492         assertTrue(tabPane.isRotateGraphic());
 493     }
 494 
 495     @Test public void setTabMinWidthAndSeeValueIsReflectedInModel() {
 496         tabPane.setTabMinWidth(30.0);
 497         assertEquals(tabPane.tabMinWidthProperty().getValue(), 30.0, 0.0);
 498     }
 499 
 500     @Test public void setTabMinWidthAndSeeValue() {
 501         tabPane.setTabMinWidth(30.0);
 502         assertEquals(tabPane.getTabMinWidth(), 30.0, 0.0);
 503     }
 504 
 505     @Test public void setTabMaxWidthAndSeeValueIsReflectedInModel() {
 506         tabPane.setTabMaxWidth(30.0);
 507         assertEquals(tabPane.tabMaxWidthProperty().getValue(), 30.0, 0.0);
 508     }
 509 
 510     @Test public void setTabMaxWidthAndSeeValue() {
 511         tabPane.setTabMaxWidth(30.0);
 512         assertEquals(tabPane.getTabMaxWidth(), 30.0, 0.0);
 513     }
 514 
 515     @Test public void setTabMinHeightAndSeeValueIsReflectedInModel() {
 516         tabPane.setTabMinHeight(30.0);
 517         assertEquals(tabPane.tabMinHeightProperty().getValue(), 30.0, 0.0);
 518     }
 519 
 520     @Test public void setTabMinHeightAndSeeValue() {
 521         tabPane.setTabMinHeight(30.0);
 522         assertEquals(tabPane.getTabMinHeight(), 30.0, 0.0);
 523     }
 524 
 525     @Test public void setTabMaxHeightAndSeeValueIsReflectedInModel() {
 526         tabPane.setTabMaxHeight(30.0);
 527         assertEquals(tabPane.tabMaxHeightProperty().getValue(), 30.0, 0.0);
 528     }
 529 
 530     @Test public void setTabMaxHeightAndSeeValue() {
 531         tabPane.setTabMaxHeight(30.0);
 532         assertEquals(tabPane.getTabMaxHeight(), 30.0, 0.0);
 533     }
 534 
 535     @Test public void addTabsCheckItemCountInSelectionModel() {
 536         tabPane.getTabs().add(tab1);
 537         tabPane.getTabs().add(tab2);
 538         assertEquals(SingleSelectionModelShim.getItemCount(tabPane.getSelectionModel()), 2.0, 0.0);
 539     }
 540 
 541     @Test public void addTabsCheckItemInSelectionModel() {
 542         tabPane.getTabs().add(tab1);
 543         tabPane.getTabs().add(tab2);
 544         assertSame(SingleSelectionModelShim.getModelItem(tabPane.getSelectionModel(), 0), tab1);
 545         assertSame(SingleSelectionModelShim.getModelItem(tabPane.getSelectionModel(), 1), tab2);
 546     }
 547 
 548     @Test public void addTabsCheckSelectUsingObjInSelectionModel() {
 549         tabPane.getTabs().add(tab1);
 550         tabPane.getTabs().add(tab2);
 551         tabPane.getSelectionModel().select(tab1);
 552         assertTrue(tabPane.getSelectionModel().isSelected(0));
 553     }
 554 
 555     @Test public void addTabsCheckSelectUsingIndexInSelectionModel() {
 556         tabPane.getTabs().add(tab1);
 557         tabPane.getTabs().add(tab2);
 558         tabPane.getSelectionModel().select(1);
 559         assertTrue(tabPane.getSelectionModel().isSelected(1));
 560     }
 561 
 562     @Test public void addTabsCheckClearAndSelectUsingIndexInSelectionModel() {
 563         tabPane.getTabs().add(tab1);
 564         tabPane.getTabs().add(tab2);
 565         tabPane.getSelectionModel().clearAndSelect(1);
 566         assertTrue(tabPane.getSelectionModel().isSelected(1));
 567     }
 568 
 569     @Test public void addTabsCheckSelectMultipleItemsAndClearOneItemInSelectionModel() {
 570         tabPane.getTabs().add(tab1);
 571         tabPane.getTabs().add(tab2);
 572         tabPane.getSelectionModel().select(0);
 573         tabPane.getSelectionModel().select(1);
 574         tabPane.getSelectionModel().clearSelection(0);
 575         assertFalse(tabPane.getSelectionModel().isSelected(0));
 576         assertTrue(tabPane.getSelectionModel().isSelected(1));
 577     }
 578 
 579     @Test public void addTabsCheckSelectMultipleItemsAndClearAllSelectionInSelectionModel() {
 580         tabPane.getTabs().add(tab1);
 581         tabPane.getTabs().add(tab2);
 582         tabPane.getSelectionModel().select(0);
 583         tabPane.getSelectionModel().select(1);
 584         tabPane.getSelectionModel().clearSelection();
 585         assertFalse(tabPane.getSelectionModel().isSelected(0));
 586         assertFalse(tabPane.getSelectionModel().isSelected(1));
 587         assertTrue(tabPane.getSelectionModel().isEmpty());
 588     }
 589 
 590     @Test public void addTabsCheckSelectUsingIteratorKindOfMethodsInSelectionModel() {
 591         tabPane.getTabs().add(tab1);
 592         tabPane.getTabs().add(tab2);
 593         tabPane.getSelectionModel().selectFirst();
 594         assertTrue(tabPane.getSelectionModel().isSelected(0));
 595         assertFalse(tabPane.getSelectionModel().isSelected(1));
 596         tabPane.getSelectionModel().selectNext();
 597         assertFalse(tabPane.getSelectionModel().isSelected(0));
 598         assertTrue(tabPane.getSelectionModel().isSelected(1));
 599         tabPane.getSelectionModel().clearSelection();
 600         tabPane.getSelectionModel().selectLast();
 601         assertFalse(tabPane.getSelectionModel().isSelected(0));
 602         assertTrue(tabPane.getSelectionModel().isSelected(1));
 603         tabPane.getSelectionModel().selectPrevious();
 604         assertTrue(tabPane.getSelectionModel().isSelected(0));
 605         assertFalse(tabPane.getSelectionModel().isSelected(1));
 606     }
 607 
 608     @Test public void flipTabOrder_RT20156() {
 609         tabPane.setSkin(new TabPaneSkin(tabPane));
 610         tabPane.getTabs().add(tab1);
 611         tabPane.getTabs().add(tab2);
 612         tabPane.getTabs().add(tab3);
 613 
 614         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 615         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 616         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 617 
 618         final int lastTabIndex = tabPane.getTabs().size()-1;
 619         final Tab lastTab = tabPane.getTabs().get(lastTabIndex);
 620         tabPane.getTabs().remove(lastTabIndex);
 621         tabPane.getTabs().add(0, lastTab);
 622 
 623         assertEquals(&quot;three&quot;, tabPane.getTabs().get(0).getText());
 624         assertEquals(&quot;one&quot;, tabPane.getTabs().get(1).getText());
 625         assertEquals(&quot;two&quot;, tabPane.getTabs().get(2).getText());
 626         assertTrue(tabPane.getSelectionModel().isSelected(1));
 627     }
 628 
 629     @Test public void disableAllTabs() {
 630         tabPane.setSkin(new TabPaneSkin(tabPane));
 631         tabPane.getTabs().add(tab1);
 632         tabPane.getTabs().add(tab2);
 633         tabPane.getTabs().add(tab3);
 634 
 635         tab1.setDisable(true);
 636         tab2.setDisable(true);
 637         tab3.setDisable(true);
 638 
 639         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 640         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 641     }
 642 
 643     @Test public void disableFirstTabs() {
 644         tabPane.setSkin(new TabPaneSkin(tabPane));
 645         tabPane.getTabs().add(tab1);
 646         tabPane.getTabs().add(tab2);
 647         tabPane.getTabs().add(tab3);
 648 
 649         tab1.setDisable(true);
 650         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 651         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 652     }
 653 
 654     @Test public void disableATabAndSelectItByIndex() {
 655         tabPane.setSkin(new TabPaneSkin(tabPane));
 656         tabPane.getTabs().add(tab1);
 657         tabPane.getTabs().add(tab2);
 658         tabPane.getTabs().add(tab3);
 659 
 660         tab2.setDisable(true);
 661         tabPane.getSelectionModel().select(1);
 662         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 663         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 664     }
 665 
 666     @Test public void selectByIndexADisableTab() {
 667         tabPane.setSkin(new TabPaneSkin(tabPane));
 668         tabPane.getTabs().add(tab1);
 669         tabPane.getTabs().add(tab2);
 670         tabPane.getTabs().add(tab3);
 671 
 672         tabPane.getSelectionModel().select(1);
 673         tab2.setDisable(true);
 674         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 675         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 676         assertTrue(tab2.isDisable());
 677     }
 678 
 679     @Test public void disableATabAndSelectItByTab() {
 680         tabPane.setSkin(new TabPaneSkin(tabPane));
 681         tabPane.getTabs().add(tab1);
 682         tabPane.getTabs().add(tab2);
 683         tabPane.getTabs().add(tab3);
 684 
 685         tab2.setDisable(true);
 686         tabPane.getSelectionModel().select(tab2);
 687         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 688         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 689     }
 690 
 691     @Test public void selectByTabADisableTab() {
 692         tabPane.setSkin(new TabPaneSkin(tabPane));
 693         tabPane.getTabs().add(tab1);
 694         tabPane.getTabs().add(tab2);
 695         tabPane.getTabs().add(tab3);
 696 
 697         tabPane.getSelectionModel().select(tab2);
 698         tab2.setDisable(true);
 699         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 700         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 701         assertTrue(tab2.isDisable());
 702     }
 703 
 704     @Test public void navigateOverDisableTab() {
 705         tabPane.getTabs().add(tab1);
 706         tabPane.getTabs().add(tab2);
 707         tabPane.getTabs().add(tab3);
 708 
 709         root.getChildren().add(tabPane);
 710         show();
 711         tabPane.requestFocus();
 712 
 713         assertTrue(tabPane.isFocused());
 714 
 715         tab2.setDisable(true);
 716         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 717         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 718         assertTrue(tab2.isDisable());
 719 
 720         KeyEventFirer keyboard = new KeyEventFirer(tabPane);
 721         keyboard.doRightArrowPress();
 722 
 723         assertEquals(2, tabPane.getSelectionModel().getSelectedIndex());
 724         assertEquals(tab3, tabPane.getSelectionModel().getSelectedItem());
 725 
 726         keyboard.doLeftArrowPress();
 727 
 728         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 729         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 730     }
 731 
 732     @Ignore
 733     @Test public void mousePressSelectsATab_RT20476() {
 734         tabPane.getTabs().add(tab1);
 735         tabPane.getTabs().add(tab2);
 736         tabPane.getTabs().add(tab3);
 737 
 738         tab1.setContent(new Button(&quot;TAB1&quot;));
 739         tab2.setContent(new Button(&quot;TAB2&quot;));
 740         tab3.setContent(new Button(&quot;TAB3&quot;));
 741 
 742         root.getChildren().add(tabPane);
 743         show();
 744 
 745         root.applyCss();
 746         root.resize(300, 300);
 747         root.layout();
 748 
 749         tk.firePulse();
 750         assertTrue(tabPane.isFocused());
 751 
 752         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
 753         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
 754 
 755         SceneHelper.processMouseEvent(scene,
 756             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval+75, yval+20));
 757         tk.firePulse();
 758 
 759         assertEquals(1, tabPane.getSelectionModel().getSelectedIndex());
 760         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 761     }
 762 
 763     private int counter = 0;
 764     @Ignore
 765     @Test public void setOnSelectionChangedFiresTwice_RT21089() {
 766         tabPane.getTabs().add(tab1);
 767         tabPane.getTabs().add(tab2);
 768 
 769         tab1.setContent(new Button(&quot;TAB1&quot;));
 770         tab2.setContent(new Button(&quot;TAB2&quot;));
 771 
 772         root.getChildren().add(tabPane);
 773         show();
 774 
 775         root.applyCss();
 776         root.resize(300, 300);
 777         root.layout();
 778 
 779         tk.firePulse();
 780         assertTrue(tabPane.isFocused());
 781 
 782         tab2.setOnSelectionChanged(event -&gt; {
 783             assertEquals(0, counter++);
 784         });
 785 
 786         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
 787         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
 788 
 789         SceneHelper.processMouseEvent(scene,
 790             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval+75, yval+20));
 791         tk.firePulse();
 792 
 793         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 794 
 795         SceneHelper.processMouseEvent(scene,
 796             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval+75, yval+20));
 797         tk.firePulse();
 798         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 799     }
 800 
 801     @Test public void unableToSelectNextTabWhenFirstTabIsClosed_RT22326() {
 802         tabPane.getTabs().add(tab1);
 803         tabPane.getTabs().add(tab2);
 804         tabPane.getTabs().add(tab3);
 805 
 806         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 807         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 808         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 809 
 810         tabPane.getTabs().remove(tab1);
 811 
 812         assertEquals(2, tabPane.getTabs().size());
 813         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 814         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 815         tabPane.getSelectionModel().selectNext();
 816         assertEquals(tab3, tabPane.getSelectionModel().getSelectedItem());
 817     }
 818 
 819     @Test public void removeFirstTabNextTabShouldBeSelected() {
 820         tabPane.getTabs().add(tab1);
 821         tabPane.getTabs().add(tab2);
 822         tabPane.getTabs().add(tab3);
 823 
 824         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 825         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 826         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 827 
 828         tabPane.getTabs().remove(tab1);
 829 
 830         assertEquals(2, tabPane.getTabs().size());
 831         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 832         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 833     }
 834 
 835     @Test public void selectionModelShouldNotBeNullWhenClosingFirstTab_RT22925() {
 836         tabPane.getTabs().add(tab1);
 837         tabPane.getTabs().add(tab2);
 838         tabPane.getTabs().add(tab3);
 839 
 840         tabPane.getSelectionModel().selectedItemProperty().addListener((ov, t, t1) -&gt; {
 841             assertEquals(t.getText(), &quot;one&quot;);
 842             assertEquals(t1.getText(), &quot;two&quot;);
 843         });
 844 
 845         assertEquals(&quot;one&quot;, tabPane.getTabs().get(0).getText());
 846         assertEquals(&quot;two&quot;, tabPane.getTabs().get(1).getText());
 847         assertEquals(&quot;three&quot;, tabPane.getTabs().get(2).getText());
 848 
 849         tabPane.getTabs().remove(tab1);
 850 
 851         assertEquals(2, tabPane.getTabs().size());
 852         assertEquals(0, tabPane.getSelectionModel().getSelectedIndex());
 853         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 854     }
 855 
 856 
 857     boolean button1Focused = false;
 858     @Test public void focusTraversalShouldLookInsideEmbeddedEngines() {
 859 
 860         Button b1 = new Button(&quot;Button1&quot;);
 861         final ChangeListener&lt;Boolean&gt; focusListener = (observable, oldVal, newVal) -&gt; {
 862             button1Focused = true;
 863         };
 864         b1.focusedProperty().addListener(focusListener);
 865 
 866         final ScrollPane sp = new ScrollPane();
 867         final VBox vbox1 = new VBox();
 868         vbox1.setSpacing(10);
 869         vbox1.setTranslateX(10);
 870         vbox1.setTranslateY(10);
 871         vbox1.getChildren().addAll(b1);
 872         tab1.setContent(vbox1);
 873         sp.setContent(vbox1);
 874         tab1.setContent(sp);
 875         tabPane.getTabs().add(tab1);
 876 
 877         tabPane.getTabs().add(tab2);
 878 
 879         final Scene scene1 = new Scene(new Group(), 400, 400);
 880         ((Group)scene1.getRoot()).getChildren().add(tabPane);
 881 
 882         stage.setScene(scene1);
 883         stage.show();
 884         stage.requestFocus();
 885 
 886         final KeyEvent tabEvent = new KeyEvent(KeyEvent.KEY_PRESSED, &quot;&quot;, &quot;&quot;, KeyCodeMap.valueOf(0x09),
 887                                                          false, false, false, false);
 888         Platform.runLater(() -&gt; {
 889             tabPane.requestFocus();
 890             Event.fireEvent(tabPane, tabEvent);
 891 
 892         });
 893 
 894         assertTrue(button1Focused);
 895 
 896     }
 897 
 898     @Test public void test_rt_35013() {
 899         SplitPane splitPane = new SplitPane();
 900         splitPane.getItems().addAll(new Button(&quot;Button1&quot;), new Button(&quot;Button2&quot;));
 901 
 902         TabPane tabPane = new TabPane();
 903         Tab emptyTab;
 904         Tab splitTab = new Tab(&quot;SplitPane Tab&quot;);
 905         splitTab.setContent(splitPane);
 906         tabPane.getTabs().addAll(emptyTab = new Tab(&quot;Empty Tab&quot;), splitTab);
 907 
 908         StageLoader sl = new StageLoader(tabPane);
 909 
 910         tabPane.getSelectionModel().select(emptyTab);
 911         Toolkit.getToolkit().firePulse();
 912         assertFalse(splitPane.getParent().isVisible());
 913 
 914         tabPane.getSelectionModel().select(splitTab);
 915         Toolkit.getToolkit().firePulse();
 916         assertTrue(splitPane.getParent().isVisible());
 917 
 918         sl.dispose();
 919     }
 920 
 921     @Test public void test_rt_36456_default_selectionMovesBackwardOne() {
 922         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 923         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 924         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 925 
 926         TabPane tabPane = new TabPane();
 927         tabPane.getTabs().addAll(tab0, tab1, tab2);
 928         tabPane.getSelectionModel().select(tab1);
 929 
 930         StageLoader sl = new StageLoader(tabPane);
 931 
 932         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 933         tabPane.getTabs().remove(tab1);
 934         assertEquals(tab0, tabPane.getSelectionModel().getSelectedItem());
 935 
 936         sl.dispose();
 937     }
 938 
 939     @Test public void test_rt_36456_selectionMovesBackwardTwoSkippingDisabledTab() {
 940         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 941         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 942         tab1.setDisable(true);
 943         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 944 
 945         TabPane tabPane = new TabPane();
 946         tabPane.getTabs().addAll(tab0, tab1, tab2);
 947         tabPane.getSelectionModel().select(tab2);
 948 
 949         StageLoader sl = new StageLoader(tabPane);
 950 
 951         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 952         tabPane.getTabs().remove(tab2);
 953 
 954         // selection should jump from tab2 to tab0, as tab1 is disabled
 955         assertEquals(tab0, tabPane.getSelectionModel().getSelectedItem());
 956 
 957         sl.dispose();
 958     }
 959 
 960     @Test public void test_rt_36456_selectionMovesForwardOne() {
 961         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 962         tab0.setDisable(true);
 963         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 964         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 965 
 966         TabPane tabPane = new TabPane();
 967         tabPane.getTabs().addAll(tab0, tab1, tab2);
 968         tabPane.getSelectionModel().select(tab1);
 969 
 970         StageLoader sl = new StageLoader(tabPane);
 971 
 972         assertEquals(tab1, tabPane.getSelectionModel().getSelectedItem());
 973         tabPane.getTabs().remove(tab1);
 974 
 975         // selection should move to the next non-disabled tab - in this case tab2
 976         assertEquals(tab2, tabPane.getSelectionModel().getSelectedItem());
 977 
 978         sl.dispose();
 979     }
 980 
 981     @Test public void test_rt_36456_selectionMovesForwardTwoSkippingDisabledTab() {
 982         Tab tab0 = new Tab(&quot;Tab 0&quot;);
 983         Tab tab1 = new Tab(&quot;Tab 1&quot;);
 984         tab1.setDisable(true);
 985         Tab tab2 = new Tab(&quot;Tab 2&quot;);
 986 
 987         TabPane tabPane = new TabPane();
 988         tabPane.getTabs().addAll(tab0, tab1, tab2);
 989         tabPane.getSelectionModel().select(tab0);
 990 
 991         StageLoader sl = new StageLoader(tabPane);
 992 
 993         Tab selectedTab = tabPane.getSelectionModel().getSelectedItem();
 994         assertEquals(tab0, selectedTab);
 995         tabPane.getTabs().remove(tab0);
 996 
 997         // selection should move to the next non-disabled tab - in this case tab2
 998         selectedTab = tabPane.getSelectionModel().getSelectedItem();
 999         assertEquals(tab2.getText() + &quot; != &quot; +  tab2.getText(), tab2, selectedTab);
1000 
1001         sl.dispose();
1002     }
1003 
1004     @Test public void test_rt_36908() {
1005         TabPane pane = new TabPane();
1006         final Tab disabled = new Tab(&quot;Disabled&quot;);
1007         disabled.setDisable(true);
1008 
1009         Tab tab1 = new Tab(&quot;Tab 1&quot;);
1010         Tab tab2 = new Tab(&quot;Tab 2&quot;);
1011         pane.getTabs().addAll(disabled, tab1, tab2);
1012 
1013         assertEquals(1, pane.getSelectionModel().getSelectedIndex());
1014         assertEquals(tab1, pane.getSelectionModel().getSelectedItem());
1015     }
1016 
1017     @Test public void test_rt_24658() {
1018         Button btn = new Button(&quot;Button&quot;);
1019         final Tab disabled = new Tab(&quot;Disabled&quot;);
1020         disabled.setContent(btn);
1021 
1022         TabPane pane = new TabPane();
1023         pane.getTabs().addAll(disabled);
1024 
1025         assertEquals(0, pane.getSelectionModel().getSelectedIndex());
1026         assertEquals(disabled, pane.getSelectionModel().getSelectedItem());
1027         assertFalse(btn.isDisabled());
1028 
1029         disabled.setDisable(true);
1030         assertTrue(btn.isDisabled());
1031 
1032         disabled.setDisable(false);
1033         assertFalse(btn.isDisabled());
1034     }
1035 
1036     @Test public void test_rt_38382_noAddToTabPane() {
1037         test_rt_38382(false);
1038     }
1039 
1040     @Test public void test_rt_38382_addToTabPane() {
1041         test_rt_38382(true);
1042     }
1043 
1044     public void test_rt_38382(boolean addToTabPane) {
1045         final List&lt;String&gt; names = Arrays.asList(
1046                 &quot;Biomass&quot;,
1047                 &quot;Exploitable Population Biomass&quot;,
1048                 &quot;MSY&quot;,
1049                 &quot;Yield&quot;,
1050                 &quot;Recruitment&quot;,
1051                 &quot;Catch&quot;,
1052                 &quot;Effort&quot;);
1053         final Map&lt;Tab, List&lt;String&gt;&gt; fooMap = new HashMap&lt;&gt;();
1054         final List&lt;Tab&gt; tabList = new LinkedList&lt;&gt;();
1055         for (String name : names) {
1056             final Tab tab = new Tab();
1057             tab.setText(name);
1058             fooMap.put(tab, new LinkedList&lt;&gt;());
1059             tabList.add(tab);
1060         }
1061         TabPane tabPane = new TabPane();
1062 
1063         if (addToTabPane) {
1064             tabPane.getTabs().setAll(tabList);
1065         }
1066 
1067         fooMap.entrySet().forEach(entry -&gt; {
1068             final Tab tab = entry.getKey();
1069             assertTrue(tabList.contains(tab));
1070             assertTrue(fooMap.containsKey(tab));
1071         });
1072     }
1073 
1074     // Test for JDK-8189424
1075     int selectionChangeCount = 0;
1076     @Test public void testTabClosingEventAndSelectionChange() {
1077         Tab t1 = new Tab(&quot;&quot;);
1078         Tab t2 = new Tab(&quot;&quot;);
1079         tabPane.getTabs().add(t1);
1080         tabPane.getTabs().add(t2);
1081         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.ALL_TABS);
1082 
1083         tabPane.getSelectionModel().selectedItemProperty().addListener((ov, oldTab, newTab) -&gt; {
1084             selectionChangeCount++;
1085         });
1086         t1.setOnCloseRequest((event) -&gt; {
1087             event.consume();
1088             tabPane.getTabs().remove(t1);
1089         });
1090 
1091         root.getChildren().add(tabPane);
1092         show();
1093 
1094         root.applyCss();
1095         root.resize(300, 300);
1096         root.layout();
1097 
1098         tk.firePulse();
1099         assertTrue(tabPane.isFocused());
1100 
1101         tabPane.getSelectionModel().select(t1);
1102 
1103         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
1104         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
1105 
1106         SceneHelper.processMouseEvent(scene,
1107             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval + 19, yval + 17));
1108         tk.firePulse();
1109         SceneHelper.processMouseEvent(scene,
1110             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_RELEASED, xval + 19, yval + 17));
1111         tk.firePulse();
1112 
1113         assertEquals(1, tabPane.getTabs().size());
1114         assertEquals(t2, tabPane.getSelectionModel().getSelectedItem());
1115         assertEquals(1, selectionChangeCount);
1116 
1117         tabPane.getTabs().remove(t2);
1118     }
1119 
1120     // Test for JDK-8193495
1121     @Test public void testQuickRemoveAddTab() {
1122         int tabHeaderMinWidth = 200;
1123         int tabHeaderMinHeight = 50;
1124         tabPane.setMaxSize(400, 200);
1125         tabPane.setTabMinWidth(tabHeaderMinWidth);
1126         tabPane.setTabMinHeight(tabHeaderMinHeight);
1127         tabPane.getTabs().addAll(tab1, tab2, tab3);
1128         tabPane.setTabClosingPolicy(TabPane.TabClosingPolicy.UNAVAILABLE);
1129 
1130         root.getChildren().add(tabPane);
1131         show();
1132         tabPane.requestFocus();
1133         tk.firePulse();
1134         assertTrue(tabPane.isFocused());
1135 
1136         tabPane.getTabs().add(1, tabPane.getTabs().remove(0));
1137         tk.firePulse();
1138         tabPane.getSelectionModel().select(tab1);
1139         tk.firePulse();
1140 
1141         double xval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinX();
1142         double yval = (tabPane.localToScene(tabPane.getLayoutBounds())).getMinY();
1143 
1144         SceneHelper.processMouseEvent(scene,
1145             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval + 19, yval + 17));
1146         tk.firePulse();
1147         SceneHelper.processMouseEvent(scene,
1148             MouseEventGenerator.generateMouseEvent(MouseEvent.MOUSE_PRESSED, xval + 19, yval + 17));
1149         tk.firePulse();
1150 
1151         assertEquals(&quot;Tabpane should have 3 tabs.&quot;, 3, tabPane.getTabs().size());
1152         assertEquals(&quot;tab2 should be at index 0.&quot;, tab2, tabPane.getSelectionModel().getSelectedItem());
1153     }
1154 
1155     // Test for JDK-8154039
1156     WeakReference&lt;Tab&gt; weakTab;
1157     @Test public void testSelectNonChildTab() {
1158         tabPane.getTabs().addAll(tab1);
1159         root.getChildren().add(tabPane);
1160         show();
1161         tk.firePulse();
1162         weakTab = new WeakReference&lt;&gt;(new Tab(&quot;NonChildTab&quot;));
1163         tabPane.getSelectionModel().select(weakTab.get());
1164         tk.firePulse();
1165         attemptGC(10);
1166         tk.firePulse();
1167         assertNull(weakTab.get());
1168     }
1169 
1170     private void attemptGC(int n) {
1171         // Attempt gc n times
1172         for (int i = 0; i &lt; n; i++) {
1173             System.gc();
1174             System.runFinalization();
1175 
1176             if (weakTab.get() == null) {
1177                 break;
1178             }
1179             try {
1180                 Thread.sleep(500);
1181             } catch (InterruptedException e) {
1182                 fail(&quot;InterruptedException occurred during Thread.sleep()&quot;);
1183             }
1184         }
1185     }
1186 
1187     // Test for JDK-8157690
1188     @Test public void testPopupItemsOnSortingTabs() {
1189         tabPane.setMaxSize(20, 20);
1190         root.getChildren().add(tabPane);
1191         tabPane.getTabs().addAll(tab1, tab2, tab3);
1192         show();
1193         tk.firePulse();
1194         TabPaneSkin tbSkin = (TabPaneSkin) tabPane.getSkin();
1195         assertNotNull(tbSkin);
1196         ContextMenu tabsMenu = TabPaneSkinShim.getTabsMenu(tbSkin);
1197         assertNotNull(tabsMenu);
1198         assertEquals(&quot;ContextMenu should contain 3 items.&quot;, 3, tabsMenu.getItems().size());
1199 
1200         tabPane.getTabs().sort((o1, o2) -&gt; sortCompare(o1, o2));
1201         tk.firePulse();
1202         assertEquals(&quot;ContextMenu should contain 3 items.&quot;, 3, tabsMenu.getItems().size());
1203     }
1204 
1205     private int sortCompare(Tab t1, Tab t2) {
1206         return t2.getText().compareTo(t1.getText());
1207     }
1208 }
    </pre>
  </body>
</html>