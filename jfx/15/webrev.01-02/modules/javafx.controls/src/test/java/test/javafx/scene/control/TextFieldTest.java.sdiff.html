<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Sdiff modules/javafx.controls/src/test/java/test/javafx/scene/control/TextFieldTest.java</title>
    <link rel="stylesheet" href="../../../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>modules/javafx.controls/src/test/java/test/javafx/scene/control/TextFieldTest.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<table>
<tr valign="top">
<td>
<hr />
<pre>
 34 import org.junit.Test;
 35 
 36 import com.sun.javafx.tk.Toolkit;
 37 
 38 import static javafx.scene.input.KeyCode.*;
 39 import static javafx.scene.input.KeyEvent.*;
 40 import static java.util.stream.Collectors.*;
 41 import static org.junit.Assert.*;
 42 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.*;
 43 
 44 import javafx.beans.property.ObjectProperty;
 45 import javafx.beans.property.SimpleObjectProperty;
 46 import javafx.beans.property.SimpleStringProperty;
 47 import javafx.beans.property.StringProperty;
 48 import javafx.collections.ObservableSet;
 49 import javafx.css.PseudoClass;
 50 import javafx.event.ActionEvent;
 51 import javafx.event.Event;
 52 import javafx.event.EventHandler;
 53 import javafx.scene.Scene;

 54 import javafx.scene.control.TextField;
 55 import javafx.scene.control.TextInputControlShim;
 56 import javafx.scene.input.KeyCode;
 57 import javafx.scene.input.KeyCodeCombination;
 58 import javafx.scene.input.KeyEvent;
 59 import javafx.scene.layout.StackPane;
 60 import javafx.stage.Stage;
 61 import test.com.sun.javafx.pgstub.StubToolkit;
 62 import test.com.sun.javafx.scene.control.infrastructure.KeyEventFirer;
 63 import test.com.sun.javafx.scene.control.infrastructure.StageLoader;
 64 
 65 public class TextFieldTest {
 66     private TextField txtField;//Empty string
 67     private TextField dummyTxtField;//With string value
 68 
 69     @Before public void setup() {
 70         txtField = new TextField();
 71         dummyTxtField = new TextField(&quot;dummy&quot;);
 72     }
 73 
</pre>
<hr />
<pre>
289     @Test public void appendAndCheckSubRangeInText() {
290         dummyTxtField.appendText(&quot;x&quot;);
291         assertEquals(&quot;x&quot;, dummyTxtField.getText().substring(dummyTxtField.getLength() - 1,dummyTxtField.getLength()));
292     }
293 
294     @Test public void appendAndCheckSubRangeInContent() {
295         dummyTxtField.appendText(&quot;x&quot;);
296         assertEquals(&quot;x&quot;, TextInputControlShim.getContent_get(dummyTxtField, dummyTxtField.getLength() - 1,dummyTxtField.getLength()));
297     }
298 
299     @Test public void deleteAndCheckText() {
300         TextInputControlShim.getContent_insert(dummyTxtField, 0, &quot;x&quot;, false);
301         TextInputControlShim.getContent_delete(dummyTxtField, 1, dummyTxtField.getLength(), true);
302         assertEquals(&quot;x&quot;, dummyTxtField.getText());
303     }
304 
305     private Scene scene;
306     private Stage stage;
307     private StackPane root;
308 







































309     /**
310      * Test related to https://bugs.openjdk.java.net/browse/JDK-8207759
311      * broken event dispatch sequence by forwardToParent.
312      */
313     @Test
314     public void testEventSequenceEnterHandler() {
315         initStage();
316         root.getChildren().add(txtField);
317         stage.show();
318         List&lt;Event&gt; events = new ArrayList&lt;&gt;();
319         EventHandler&lt;KeyEvent&gt; adder = events::add;
320         scene.addEventHandler(KEY_PRESSED, adder);
321         root.addEventHandler(KEY_PRESSED, adder);
322         txtField.addEventHandler(KEY_PRESSED, adder);
323         KeyCode key = ENTER;
324         KeyEventFirer keyFirer = new KeyEventFirer(txtField);
325         keyFirer.doKeyPress(key);
326         assertEquals(&quot;event count&quot;, 3, events.size());
327         List&lt;Object&gt; sources = events.stream()
328                 .map(e -&gt; e.getSource())
</pre>
</td>
<td>
<hr />
<pre>
 34 import org.junit.Test;
 35 
 36 import com.sun.javafx.tk.Toolkit;
 37 
 38 import static javafx.scene.input.KeyCode.*;
 39 import static javafx.scene.input.KeyEvent.*;
 40 import static java.util.stream.Collectors.*;
 41 import static org.junit.Assert.*;
 42 import static test.com.sun.javafx.scene.control.infrastructure.ControlTestUtils.*;
 43 
 44 import javafx.beans.property.ObjectProperty;
 45 import javafx.beans.property.SimpleObjectProperty;
 46 import javafx.beans.property.SimpleStringProperty;
 47 import javafx.beans.property.StringProperty;
 48 import javafx.collections.ObservableSet;
 49 import javafx.css.PseudoClass;
 50 import javafx.event.ActionEvent;
 51 import javafx.event.Event;
 52 import javafx.event.EventHandler;
 53 import javafx.scene.Scene;
<span class="line-added"> 54 import javafx.scene.control.ComboBox;</span>
 55 import javafx.scene.control.TextField;
 56 import javafx.scene.control.TextInputControlShim;
 57 import javafx.scene.input.KeyCode;
 58 import javafx.scene.input.KeyCodeCombination;
 59 import javafx.scene.input.KeyEvent;
 60 import javafx.scene.layout.StackPane;
 61 import javafx.stage.Stage;
 62 import test.com.sun.javafx.pgstub.StubToolkit;
 63 import test.com.sun.javafx.scene.control.infrastructure.KeyEventFirer;
 64 import test.com.sun.javafx.scene.control.infrastructure.StageLoader;
 65 
 66 public class TextFieldTest {
 67     private TextField txtField;//Empty string
 68     private TextField dummyTxtField;//With string value
 69 
 70     @Before public void setup() {
 71         txtField = new TextField();
 72         dummyTxtField = new TextField(&quot;dummy&quot;);
 73     }
 74 
</pre>
<hr />
<pre>
290     @Test public void appendAndCheckSubRangeInText() {
291         dummyTxtField.appendText(&quot;x&quot;);
292         assertEquals(&quot;x&quot;, dummyTxtField.getText().substring(dummyTxtField.getLength() - 1,dummyTxtField.getLength()));
293     }
294 
295     @Test public void appendAndCheckSubRangeInContent() {
296         dummyTxtField.appendText(&quot;x&quot;);
297         assertEquals(&quot;x&quot;, TextInputControlShim.getContent_get(dummyTxtField, dummyTxtField.getLength() - 1,dummyTxtField.getLength()));
298     }
299 
300     @Test public void deleteAndCheckText() {
301         TextInputControlShim.getContent_insert(dummyTxtField, 0, &quot;x&quot;, false);
302         TextInputControlShim.getContent_delete(dummyTxtField, 1, dummyTxtField.getLength(), true);
303         assertEquals(&quot;x&quot;, dummyTxtField.getText());
304     }
305 
306     private Scene scene;
307     private Stage stage;
308     private StackPane root;
309 
<span class="line-added">310     /**</span>
<span class="line-added">311      * Guard against potential regression of JDK-8145515: eventFilter</span>
<span class="line-added">312      * on editor not notified for ENTER released.</span>
<span class="line-added">313      */</span>
<span class="line-added">314     @Test</span>
<span class="line-added">315     public void testEditorInComboBoxEnterReleasedFilter() {</span>
<span class="line-added">316         initStage();</span>
<span class="line-added">317         ComboBox&lt;String&gt; combo = new ComboBox&lt;&gt;();</span>
<span class="line-added">318         combo.setEditable(true);</span>
<span class="line-added">319         root.getChildren().add(combo);</span>
<span class="line-added">320         stage.show();</span>
<span class="line-added">321         List&lt;Event&gt; events = new ArrayList&lt;&gt;();</span>
<span class="line-added">322         combo.getEditor().addEventFilter(KEY_RELEASED, events::add);</span>
<span class="line-added">323         KeyCode key = ENTER;</span>
<span class="line-added">324         KeyEventFirer keyFirer = new KeyEventFirer(combo);</span>
<span class="line-added">325         keyFirer.doKeyPress(key);</span>
<span class="line-added">326         assertEquals(1, events.size());</span>
<span class="line-added">327     }</span>
<span class="line-added">328 </span>
<span class="line-added">329     /**</span>
<span class="line-added">330      * Unfixed part of JDK-8145515, reported as regression JDK-8229914: eventFilter</span>
<span class="line-added">331      * on editor not notified for ENTER pressed.</span>
<span class="line-added">332      */</span>
<span class="line-added">333     @Ignore(&quot;JDK-8229914&quot;)</span>
<span class="line-added">334     @Test</span>
<span class="line-added">335     public void testEditorInComboBoxEnterPressedFilter() {</span>
<span class="line-added">336         initStage();</span>
<span class="line-added">337         ComboBox&lt;String&gt; combo = new ComboBox&lt;&gt;();</span>
<span class="line-added">338         combo.setEditable(true);</span>
<span class="line-added">339         root.getChildren().add(combo);</span>
<span class="line-added">340         stage.show();</span>
<span class="line-added">341         List&lt;Event&gt; events = new ArrayList&lt;&gt;();</span>
<span class="line-added">342         combo.getEditor().addEventFilter(KEY_PRESSED, events::add);</span>
<span class="line-added">343         KeyCode key = ENTER;</span>
<span class="line-added">344         KeyEventFirer keyFirer = new KeyEventFirer(combo);</span>
<span class="line-added">345         keyFirer.doKeyPress(key);</span>
<span class="line-added">346         assertEquals(1, events.size());</span>
<span class="line-added">347     }</span>
<span class="line-added">348 </span>
349     /**
350      * Test related to https://bugs.openjdk.java.net/browse/JDK-8207759
351      * broken event dispatch sequence by forwardToParent.
352      */
353     @Test
354     public void testEventSequenceEnterHandler() {
355         initStage();
356         root.getChildren().add(txtField);
357         stage.show();
358         List&lt;Event&gt; events = new ArrayList&lt;&gt;();
359         EventHandler&lt;KeyEvent&gt; adder = events::add;
360         scene.addEventHandler(KEY_PRESSED, adder);
361         root.addEventHandler(KEY_PRESSED, adder);
362         txtField.addEventHandler(KEY_PRESSED, adder);
363         KeyCode key = ENTER;
364         KeyEventFirer keyFirer = new KeyEventFirer(txtField);
365         keyFirer.doKeyPress(key);
366         assertEquals(&quot;event count&quot;, 3, events.size());
367         List&lt;Object&gt; sources = events.stream()
368                 .map(e -&gt; e.getSource())
</pre>
</td>
</tr>
</table>
<center>&lt; prev <a href="../../../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>