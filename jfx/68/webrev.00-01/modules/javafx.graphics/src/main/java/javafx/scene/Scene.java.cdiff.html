<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cdiff modules/javafx.graphics/src/main/java/javafx/scene/Scene.java</title>
    <link rel="stylesheet" href="../../../../../../../style.css" />
  </head>
<body>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>    <h2>modules/javafx.graphics/src/main/java/javafx/scene/Scene.java</h2>
     <a class="print" href="javascript:print()">Print this page</a>
<hr />
<pre>
<span class="line-old-header">*** 1279,26 ***</span>
      }
  
      // Shared method for Scene.snapshot and Node.snapshot. It is static because
      // we might be doing a Node snapshot with a null scene
      static WritableImage doSnapshot(Scene scene,
<span class="line-modified">!                                     double x, double y, double w, double h,</span>
<span class="line-modified">!                                     Node root, BaseTransform transform, boolean depthBuffer,</span>
<span class="line-modified">!                                     Paint fill, Camera camera, WritableImage wimg) {</span>
<span class="line-modified">! </span>
<span class="line-modified">!         int xMin = (int) Math.floor(x);</span>
<span class="line-modified">!         int yMin = (int) Math.floor(y);</span>
<span class="line-modified">!         int xMax = (int) Math.ceil(x + w);</span>
<span class="line-modified">!         int yMax = (int) Math.ceil(y + h);</span>
          int width = Math.max(xMax - xMin, 1);
          int height = Math.max(yMax - yMin, 1);
          if (wimg == null) {
              wimg = new WritableImage(width, height);
<span class="line-modified">!         }</span>
<span class="line-modified">!         else {</span>
<span class="line-modified">!             width = (int) wimg.getWidth();</span>
<span class="line-removed">-             height = (int) wimg.getHeight();</span>
          }
  
          int maxTextureSize = PrismSettings.maxTextureSize;
          if (height &gt; maxTextureSize || width &gt; maxTextureSize) {
              // The requested size for the screenshot is to big to fit a single texture,
<span class="line-new-header">--- 1279,25 ---</span>
      }
  
      // Shared method for Scene.snapshot and Node.snapshot. It is static because
      // we might be doing a Node snapshot with a null scene
      static WritableImage doSnapshot(Scene scene,
<span class="line-modified">!             double x, double y, double w, double h,</span>
<span class="line-modified">!             Node root, BaseTransform transform, boolean depthBuffer,</span>
<span class="line-modified">!             Paint fill, Camera camera, WritableImage wimg) {</span>
<span class="line-modified">! </span>
<span class="line-modified">!         int xMin = (int)Math.floor(x);</span>
<span class="line-modified">!         int yMin = (int)Math.floor(y);</span>
<span class="line-modified">!         int xMax = (int)Math.ceil(x + w);</span>
<span class="line-modified">!         int yMax = (int)Math.ceil(y + h);</span>
          int width = Math.max(xMax - xMin, 1);
          int height = Math.max(yMax - yMin, 1);
          if (wimg == null) {
              wimg = new WritableImage(width, height);
<span class="line-modified">!         } else {</span>
<span class="line-modified">!             width = (int)wimg.getWidth();</span>
<span class="line-modified">!             height = (int)wimg.getHeight();</span>
          }
  
          int maxTextureSize = PrismSettings.maxTextureSize;
          if (height &gt; maxTextureSize || width &gt; maxTextureSize) {
              // The requested size for the screenshot is to big to fit a single texture,
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1313,12 ***</span>
                      int tileHeight = Math.min(maxTextureSize, height - yOffset);
                      WritableImage tile = doSnapshotTile(scene, xMin + xOffset, yMin + yOffset, tileWidth, tileHeight, root, transform, depthBuffer, fill, camera, null);
                      wimg.getPixelWriter().setPixels(xOffset, yOffset, tileWidth, tileHeight, tile.getPixelReader(), 0, 0);
                  }
              }
<span class="line-modified">!         }</span>
<span class="line-removed">-         else {</span>
              // The requested size for the screenshot fits max texture size,
              // so we can directly return the one generated tile and avoid the extra pixel copy.
              wimg = doSnapshotTile(scene, xMin, yMin, width, height, root, transform, depthBuffer, fill, camera, wimg);
          }
  
<span class="line-new-header">--- 1312,11 ---</span>
                      int tileHeight = Math.min(maxTextureSize, height - yOffset);
                      WritableImage tile = doSnapshotTile(scene, xMin + xOffset, yMin + yOffset, tileWidth, tileHeight, root, transform, depthBuffer, fill, camera, null);
                      wimg.getPixelWriter().setPixels(xOffset, yOffset, tileWidth, tileHeight, tile.getPixelReader(), 0, 0);
                  }
              }
<span class="line-modified">!         } else {</span>
              // The requested size for the screenshot fits max texture size,
              // so we can directly return the one generated tile and avoid the extra pixel copy.
              wimg = doSnapshotTile(scene, xMin, yMin, width, height, root, transform, depthBuffer, fill, camera, wimg);
          }
  
</pre>
<hr />
<pre>
<span class="line-old-header">*** 1334,13 ***</span>
  
      /**
       * Capture a single snapshot tile
       */
      private static WritableImage doSnapshotTile(Scene scene,
<span class="line-modified">!                                                 int x, int y, int w, int h,</span>
<span class="line-modified">!                                                 Node root, BaseTransform transform, boolean depthBuffer,</span>
<span class="line-modified">!                                                 Paint fill, Camera camera, WritableImage tileImg) {</span>
          Toolkit tk = Toolkit.getToolkit();
          Toolkit.ImageRenderingContext context = new Toolkit.ImageRenderingContext();
          if (tileImg == null) {
              tileImg = new WritableImage(w, h);
          }
<span class="line-new-header">--- 1332,13 ---</span>
  
      /**
       * Capture a single snapshot tile
       */
      private static WritableImage doSnapshotTile(Scene scene,
<span class="line-modified">!                     int x, int y, int w, int h,</span>
<span class="line-modified">!                     Node root, BaseTransform transform, boolean depthBuffer,</span>
<span class="line-modified">!                     Paint fill, Camera camera, WritableImage tileImg) {</span>
          Toolkit tk = Toolkit.getToolkit();
          Toolkit.ImageRenderingContext context = new Toolkit.ImageRenderingContext();
          if (tileImg == null) {
              tileImg = new WritableImage(w, h);
          }
</pre>
<center>&lt; prev <a href="../../../../../../../index.html" target="_top">index</a> next &gt;</center>  </body>
</html>